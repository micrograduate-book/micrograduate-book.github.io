{"version":3,"kind":"Notebook","sha256":"bd5d3a8f038342e8335e6cc4efc45d959b0408137ddd85173b1d529542fdea62","slug":"micrograduate.micrograd","location":"/micrograduate/micrograd.ipynb","dependencies":[],"frontmatter":{"title":"1. micrograd: implementing an autograd engine","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"micrograduate-env","language":"python"},"github":"https://github.com/ckaraneen/micrograduate","copyright":"MIT License","source_url":"https://github.com/ckaraneen/micrograduate/blob/main/micrograduate/micrograd.ipynb","edit_url":"https://github.com/ckaraneen/micrograduate/edit/main/micrograduate/micrograd.ipynb","exports":[{"format":"ipynb","filename":"micrograd.ipynb","url":"/build/micrograd-210d79c1aae80b2eb37867205ad728f1.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import sys\n\nIN_COLAB = \"google.colab\" in sys.modules\nif IN_COLAB:\n    print(\"Cloning repo...\")\n    !git clone --quiet https://github.com/ckaraneen/micrograduate.git > /dev/null\n    %cd micrograduate\n    print(\"Installing requirements...\")\n    !pip install --quiet uv\n    !uv pip install --system --quiet -r requirements.txt","key":"mkyeOQkLv2"},{"type":"outputs","id":"DRfAF3s6GVjTQb5iS0ddB","children":[],"key":"pAnzTzbAPU"}],"key":"O2chSMWBgJ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Intro","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XhYDxHz7gL"}],"identifier":"intro","label":"Intro","html_id":"intro","implicit":true,"key":"GwOiLTHqTl"}],"key":"XqP7BAsxKX"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Welcome! Let’s begin by implementing ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ltA544hdCW"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"micrograd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OCspjmgHXN"}],"key":"J6wtVjNclH"},{"type":"text","value":": an autograd engine. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z61jmR7MTp"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"autograd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JqnW15SLCz"}],"key":"fXSelaBlKT"},{"type":"text","value":" stands for automatic gradient computation/differentiation and it is a feature that facilitates the backpropagation algorithm (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MibMysBTlc"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JQAWGYKjdC"}],"key":"KDk9K48ZCJ"},{"type":"text","value":"), enabling efficient calculation the gradient of an error or ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mPyYwxpNAo"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wSe62UdQ17"}],"key":"Jz6lOEoIBy"},{"type":"text","value":" function ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WdZFKsyfdU"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kYVclUNFzo"}],"key":"csuPFrKoNc"},{"type":"text","value":" (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zkPgBxgQL2"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P0oQA8lddL"}],"key":"AYHKwxISDk"},{"type":"text","value":") the weights and biases of a neural network (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S44VJTeC4m"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KOOOANPpNs"}],"key":"uMdj5ulRw0"},{"type":"text","value":"). This allows us to iteratively tune these parameters, minimize the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wTbd1qFEqy"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HAaf1ycYAD"}],"key":"TRxcWQoVCy"},{"type":"text","value":" and therefore improve the accuracy of the network. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V0C1zlHveo"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uYimHxniIF"}],"key":"lsHQW5SG7K"},{"type":"text","value":" is at the mathematical core of any modern deep neural network library, like PyTorch or jax. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LM4AjE0r7W"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"micrograd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EMAJv8d5LO"}],"key":"egIvtz4Uxy"},{"type":"text","value":"’s functionality is best illustrated by an example.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TCdtpNfEqt"}],"key":"InGg6AnI1b"}],"key":"yJiTSzsIak"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Sneak peek","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"g3RNgwIHxA"}],"identifier":"sneak-peek","label":"Sneak peek","html_id":"sneak-peek","implicit":true,"key":"veRaYHXpUc"}],"key":"rBtLMBhnNc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from micrograd.engine import Value\n\na = Value(-4.0)\nb = Value(2.0)\nc = a + b\nd = a * b + b**3\nc += c + 1\nc += 1 + c + (-a)\nd += d * 2 + (b + a).relu()\nd += 3 * d + (b - a).relu()\ne = c - d\nf = e**2\ng = f / 2.0\ng += 10.0 / f\nprint(f\"{g.data:.4f}, the outcome of this forward pass\")\ng.backward()\nprint(f\"{a.grad:.4f}, i.e. the numerical value of dg/da\")\nprint(f\"{b.grad:.4f}, i.e. the numerical value of dg/db\")","key":"GbCBKRwYqd"},{"type":"outputs","id":"FUtbFdk2kiAsw-yb9sQkm","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"24.7041, the outcome of this forward pass\n138.8338, i.e. the numerical value of dg/da\n645.5773, i.e. the numerical value of dg/db\n"},"children":[],"key":"Cxsufutq6Z"}],"key":"zv0ZP9kMrr"}],"key":"YWMpaEdwfI"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"You’ll see that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uFNDKbXK5J"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"micrograd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ss7nZKewcq"}],"key":"Sle7kvF494"},{"type":"text","value":" allows us to build out mathematical expressions. Here, we have an expression that we’re building out where you have two inputs ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gZ35W3pWfp"},{"type":"inlineCode","value":"a","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fgkHD5rAgX"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ytnRVPprn2"},{"type":"inlineCode","value":"b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P2JHrPlINH"},{"type":"text","value":" whose values have been wrapped into a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Zqe2q60uKX"},{"type":"inlineCode","value":"Value","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zA17EUB1Py"},{"type":"text","value":" object. In this example, we build a mathematical expression graph. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WGRpQmDhcs"},{"type":"inlineCode","value":"a","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oJMhvid2s9"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W95ojdv1ww"},{"type":"inlineCode","value":"b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yDygd3UjlL"},{"type":"text","value":" are transformed into ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tVplgcNmIR"},{"type":"inlineCode","value":"c","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"csqcV2HYmC"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JfBe0dzF8z"},{"type":"inlineCode","value":"d","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"e61FBqV1o6"},{"type":"text","value":", and eventually into ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SRwrcslTjG"},{"type":"inlineCode","value":"e","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PWfJQxL9lU"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nr4sXI5bUt"},{"type":"inlineCode","value":"f","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ajekFJ6iVk"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dNW4c0dP3w"},{"type":"inlineCode","value":"g","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"laKMa3dWPz"},{"type":"text","value":" through some intermediary operations such as ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BXa23NYr2C"},{"type":"inlineCode","value":"+","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ie15FP8R9E"},{"type":"text","value":" (addition), ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S9rsD6d6ec"},{"type":"inlineCode","value":"*","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kmrjuVnl2C"},{"type":"text","value":" (multiplication) and exponentiation to a constant power (e.g. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ye8yfG98Oq"},{"type":"inlineCode","value":"b**3","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IWMgiWFNz2"},{"type":"text","value":"). Other operations include offsetting by one, negation, squashing at zero, squaring, division, etc. And so from these values ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p2CLmWBgi6"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"micrograd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kaBAPspTVx"}],"key":"I3T1nX8PKS"},{"type":"text","value":" will, in the background, build out a mathematical expression graph. It will know, for example, that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PqNxEQavry"},{"type":"inlineCode","value":"c","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"E1XGBCBYZ1"},{"type":"text","value":" is also a value but also a result of the addition operation of two child value nodes ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kQvBFR2Dw2"},{"type":"inlineCode","value":"a","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wnODrdJRNj"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MiaAJYD4FU"},{"type":"inlineCode","value":"b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SClwZYgfc8"},{"type":"text","value":", to which it will maintain pointers. So, we’ll basically know exactly how all this operations graph is laid out. Then, we can do a forward pass (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tYOntCuXcT"},{"type":"inlineCode","value":"a","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xQyhbJEBrr"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kRqqVNHRmp"},{"type":"inlineCode","value":"b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wrDZaMMxAN"},{"type":"text","value":" -> ... -> ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kkZBgyJ9Oi"},{"type":"inlineCode","value":"g","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DTaf7J7Lif"},{"type":"text","value":"), but also initiate the backward pass that constitutes ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iXCoKBSIMM"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KMxcOgjXsZ"}],"key":"RxtuErOMRi"},{"type":"text","value":" by calling ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jw4Ip1R2V1"},{"type":"inlineCode","value":"backward","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p89H9CDaJf"},{"type":"text","value":" at node ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JUa5r4tMkx"},{"type":"inlineCode","value":"g","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zbnH2Mz1rP"},{"type":"text","value":": ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qAuNxPudBR"},{"type":"inlineCode","value":"g.backward()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vUZ7raqBHe"},{"type":"text","value":". What ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sjhPzYuqAZ"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lOfYu7wLz8"}],"key":"S8w8egrbX2"},{"type":"text","value":" is going to do is start at ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ei1iSoFbeg"},{"type":"inlineCode","value":"g","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eaN1mbUeWX"},{"type":"text","value":" and it’s going to go backwards through that expression graph and it’s going to recursively apply the chain rule from calculus. This allows it to evaluate the derivative of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j6PHR1WjqS"},{"type":"inlineCode","value":"g","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FHYJNXpYkV"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ACGAhpUlax"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xkyl8XLlX2"}],"key":"zqq7WxO3LQ"},{"type":"text","value":" all the internal nodes, like ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wL1ww2YZvN"},{"type":"inlineCode","value":"e","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZVCNmFOAwY"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IHlEZkgBs1"},{"type":"inlineCode","value":"d","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ygmx9DDbzG"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eF67ObzaOA"},{"type":"inlineCode","value":"c","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SaGcVFkjDK"},{"type":"text","value":" (i.e. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OXtRW4YSHc"},{"type":"inlineMath","value":"\\dfrac{\\partial g}{\\partial e}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>g</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>e</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial g}{\\partial e}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">e</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"lM53P7gYwq"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LSaWumlKof"},{"type":"inlineMath","value":"\\dfrac{\\partial g}{\\partial d}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>g</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>d</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial g}{\\partial d}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">d</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"vJjdaINIo5"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fwbRoBIlVo"},{"type":"inlineMath","value":"\\dfrac{\\partial g}{\\partial c}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>g</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial g}{\\partial c}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">c</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"h6cMLoIego"},{"type":"text","value":"), but also ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T3XZLt5bsV"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"csgfwK1BTg"}],"key":"TLMtHEJo2c"},{"type":"text","value":" the inputs ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TZVAXw3uiu"},{"type":"inlineCode","value":"a","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qRnSu4WSTP"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LqG3dSAImB"},{"type":"inlineCode","value":"b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CyDDE1cEKk"},{"type":"text","value":" (i.e. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"G8hjwUeziJ"},{"type":"inlineMath","value":"\\dfrac{\\partial g}{\\partial a}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>g</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>a</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial g}{\\partial a}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">a</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"IJcYHgsSWB"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UsWRtFZNBQ"},{"type":"inlineMath","value":"\\dfrac{\\partial g}{\\partial b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>g</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>b</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial g}{\\partial b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">b</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"B8F3f3ebNt"},{"type":"text","value":"). Then we can actually query this derivative of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CHsHr67Du0"},{"type":"inlineCode","value":"g","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a1hsIM09Ut"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hX5rYj4OMc"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JYbDXn5br4"}],"key":"QYCCfGTvBH"},{"type":"text","value":", for example, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s5evIWoOHp"},{"type":"inlineCode","value":"a","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BYpXG1JNDP"},{"type":"text","value":" (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YAD4rmKM5V"},{"type":"inlineMath","value":"\\dfrac{\\partial g}{\\partial a}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>g</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>a</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial g}{\\partial a}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">a</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"KEOHRkwXBK"},{"type":"text","value":") as such: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uyOoLPEF3w"},{"type":"inlineCode","value":"a.grad","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EdFTU4CVEO"},{"type":"text","value":", or the derivative of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OgWQ9eiQhs"},{"type":"inlineCode","value":"g","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l0bBx53Y4o"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Dt7tZxUY6S"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B7GxxeVTR6"}],"key":"Xl0ZogXzbg"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mL4rJUgazp"},{"type":"inlineCode","value":"b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dXo9wso583"},{"type":"text","value":" (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nvCSjE4Cpr"},{"type":"inlineMath","value":"\\dfrac{\\partial g}{\\partial b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>g</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>b</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial g}{\\partial b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">b</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"tt4SQo4yXc"},{"type":"text","value":") as such: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pFZMnqf99R"},{"type":"inlineCode","value":"b.grad","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tpXzxBAtrF"},{"type":"text","value":". The values of these ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OEsJCSrylB"},{"type":"inlineCode","value":"grad","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YNurtMZsYv"},{"type":"text","value":" attributes tell us how a tiny change of the values of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ECJxQq9Rc7"},{"type":"inlineCode","value":"a","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PKhpdjcNGG"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dpiY8uVL2y"},{"type":"inlineCode","value":"b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Sx96EDylM8"},{"type":"text","value":" is affecting ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"scMJeJTmZJ"},{"type":"inlineCode","value":"g","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"b6I5FKCnV7"},{"type":"text","value":". If we slightly nudge ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NsGUf7dp5p"},{"type":"inlineCode","value":"a","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kb2ohbTgDm"},{"type":"text","value":" and make it slightly larger, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OIcla7KiV6"},{"type":"inlineCode","value":"a.grad == 138.8338","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NJ8KBxH0QG"},{"type":"text","value":" is telling us that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aEWhQz7nOB"},{"type":"inlineCode","value":"g","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Xq0ppuJkMg"},{"type":"text","value":" will grow and that the slope of that growth is going to be equal to that number. Similarly, the slope of the growth of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EbVcYjlM9w"},{"type":"inlineCode","value":"g","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GqwwO3UPDS"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SsSO35pJtP"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cUeR0CCrxY"}],"key":"PkDZflXW0o"},{"type":"text","value":" a slight positive nudge of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PuUlIFFubW"},{"type":"inlineCode","value":"b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RXnyxCZ7s0"},{"type":"text","value":" is going to be ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H4BKfNxTQA"},{"type":"text","value":"645.5773","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XfffCoe3sF"},{"type":"text","value":". A ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RBAAXR78AO"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vcFq89BPRI"}],"key":"LE7NQHZOcB"},{"type":"text","value":" is a function that takes in inputs and weights and returns an output: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KojinJ1xXd"},{"type":"inlineMath","value":"F(in, w) = out","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi><mo stretchy=\"false\">(</mo><mi>i</mi><mi>n</mi><mo separator=\"true\">,</mo><mi>w</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>o</mi><mi>u</mi><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">F(in, w) = out</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">in</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">t</span></span></span></span>","key":"Spz69qmnvx"},{"type":"text","value":". ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"biAYbbotFv"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"micrograd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"h2OVxvpX9a"}],"key":"LDhWm1XXX9"},{"type":"text","value":" will help you understand ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DqodoK0G4o"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i5ZJmIHmZ6"}],"key":"goddYbSuDA"},{"type":"text","value":"s at such a fundamental level by disregarding non-essential elements (e.g. tensors) that you would otherwise encounter in practice, production, etc. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SvE6SwUaya"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"micrograd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Jc22g82kMX"}],"key":"kh4PCJSCYc"},{"type":"text","value":" is all you need in order to understand the basics. Everything else is just efficiency. Now, let’s dive right in and start implementing!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J1pe0LqLfS"}],"key":"nicaQ5By5D"}],"key":"VqA3zPF2dg"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"First, we must make sure that we develop a very good, intuitive understanding of what a derivative is and exactly what information it gives us.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wOhFrkLdzl"}],"key":"R65BQmjsyp"}],"key":"NwsAxdQdkr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import math\nimport numpy as np\nimport matplotlib.pyplot as plt\nif IN_COLAB:\n    %matplotlib inline\nelse:\n    %matplotlib ipympl","key":"tYLUQjRCzJ"},{"type":"outputs","id":"ZUEuObquuBDqk0xw1I0fr","children":[],"key":"yTLwykpDfH"}],"key":"FTyrKnZBwZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def y(x):\n    return 3 * x**2 - 4 * x + 5","key":"XBEdJsIIcV"},{"type":"outputs","id":"hOJm9YkB5T4reou-GHyB4","children":[],"key":"XbBShh6isT"}],"key":"nSVnVDzfFF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y(3.0)","key":"WL1r8bvILm"},{"type":"outputs","id":"-Cp4xKJ-ew5O59CTDq3Oj","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"20.0","content_type":"text/plain"}}},"children":[],"key":"FKPtxSRlaW"}],"key":"lmd0tDtBoN"}],"key":"hRddyoHQkq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"xs = np.arange(-5, 5, 0.25)\nys = y(xs)\nplt.figure()\nplt.plot(xs, ys);","key":"lKTotvudPn"},{"type":"outputs","id":"BFC0fYEeepyv1DSs5byJa","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/vnd.jupyter.widget-view+json":{"content":"{\"model_id\":\"8944ae2541004187a74481785b5dc7a2\",\"version_major\":2,\"version_minor\":0}","content_type":"application/vnd.jupyter.widget-view+json"},"image/png":{"content_type":"image/png","hash":"53ad855f2cb7106cb0dd560f8828828d","path":"/build/53ad855f2cb7106cb0dd560f8828828d.png"},"text/html":{"content":"\n            <div style=\"display: inline-block;\">\n                <div class=\"jupyter-widgets widget-label\" style=\"text-align: center;\">\n                    Figure\n                </div>\n                <img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAoAAAAHgCAYAAAA10dzkAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjAsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvlHJYcgAAAAlwSFlzAAAPYQAAD2EBqD+naQAARepJREFUeJzt3Xd4VGXi9vF7SnolQBICCYQmvUNAXESNomJBbCg21gXXBVxE1xVdcX821LWtDVDXLtgRsaCICiq9g/SakJACIZNG2sy8fwTzGkUFUp7MnO/nuuZSzkyGO8Mh5+ac8zyPzev1egUAAADLsJsOAAAAgIZFAQQAALAYCiAAAIDFUAABAAAshgIIAABgMRRAAAAAi6EAAgAAWAwFEAAAwGIogAAAABZDAQQAALAYCiAAAIDFUAABAAAshgIIAABgMRRAAAAAi6EAAgAAWAwFEAAAwGIogAAAABZDAQQAALAYCiAAAIDFUAABAAAshgIIAABgMRRAAAAAi6EAAgAAWAwFEAAAwGIogAAAABZDAQQAALAYCiAAAIDFUAABAAAshgIIAABgMRRAAAAAi6EAAgAAWAwFEAAAwGIogAAAABZDAQQAALAYCiAAAIDFUAABAAAshgIIAABgMRRAAAAAi6EAAgAAWAwFEAAAwGIogAAAABZDAQQAALAYCiAAAIDFUAABAAAshgIIAABgMRRAAAAAi6EAAgAAWAwFEAAAwGIogAAAABZDAQQAALAYCiAAAIDFUAABAAAshgIIAABgMRRAAAAAi6EAAgAAWAwFEAAAwGKcpgP4Mo/Ho8zMTEVERMhms5mOAwAAjoPX61VhYaESEhJkt1vzXBgFsBYyMzOVmJhoOgYAADgJ6enpatWqlekYRlAAayEiIkJS1Q4UGRlpOA0AADgeBQUFSkxMrD6OWxEFsBZ+uuwbGRlJAQQAwMdY+fYta174BgAAsDAKIAAAgMVQAAEAACyGAggAAGAxFEAAAACLoQACAABYDAUQAADAYiiAAAAAFkMBBAAAsBifLICLFy/WhRdeqISEBNlsNn300Uc1nvd6vZo6dapatGihkJAQpaamaseOHTVek5eXp9GjRysyMlLR0dG68cYbVVRU1IDfBQAAgBk+WQCLi4vVs2dPPffcc8d8/tFHH9XTTz+tGTNmaPny5QoLC9OwYcNUWlpa/ZrRo0frxx9/1IIFC/TJJ59o8eLFGjduXEN9CwAAAMbYvF6v13SI2rDZbJozZ45GjBghqersX0JCgm677TbdfvvtkiSXy6W4uDi9+uqrGjVqlLZs2aIuXbpo5cqV6tevnyRp/vz5Ov/887V//34lJCQc1+9dUFCgqKgouVwu1gIGAMBHcPz20TOAv2fPnj3KyspSampq9baoqCilpKRo6dKlkqSlS5cqOjq6uvxJUmpqqux2u5YvX/6b711WVqaCgoIaj/qweHuuxryyQl9tzq6X9wcAANbmdwUwKytLkhQXF1dje1xcXPVzWVlZio2NrfG80+lUTExM9WuOZdq0aYqKiqp+JCYm1nH6Kj/sPKhvtuXqreX76uX9AQCAtfldAaxPU6ZMkcvlqn6kp6fXy+9zZf+qYvnt9lxl5B+pl98DAABYl98VwPj4eElSdnbNy6fZ2dnVz8XHxysnJ6fG85WVlcrLy6t+zbEEBQUpMjKyxqM+tG0erkFtm8rrld5ZWT8lEwAAWJffFcDk5GTFx8dr4cKF1dsKCgq0fPlyDRo0SJI0aNAg5efna/Xq1dWv+frrr+XxeJSSktLgmY/lqpQkSdK7K9NV6fYYTgMAAPyJ03SAk1FUVKSdO3dW/3rPnj1at26dYmJilJSUpEmTJumBBx5Qhw4dlJycrHvuuUcJCQnVI4U7d+6sc889V2PHjtWMGTNUUVGhCRMmaNSoUcc9Ari+Desap5iwQGUVlOrbbblK7RL3x18EAABwHHzyDOCqVavUu3dv9e7dW5I0efJk9e7dW1OnTpUk3XHHHZo4caLGjRun/v37q6ioSPPnz1dwcHD1e7z11lvq1KmTzjrrLJ1//vk67bTT9MILLxj5fo4lyOnQZX1bSZJmr0gznAYAAPgTn58H0KT6nkdod26Rznx8kew26ft/nqmE6JA6/z0AALAa5gH00TOAVtG2ebgGto2Rxyu9u4rBIAAAoG5QABu5qwZUDQZ5Z2W63B5O1gIAgNqjADZyw7rGq0logA64SrVoe84ffwEAAMAfoAA2csEBDl3ap2owyKzlXAYGAAC1RwH0AaOOXgb+emu2slylhtMAAABfRwH0Ae1jwzUgmcEgAACgblAAfcTVDAYBAAB1hALoI87tFq+okABl5B/R4h25puMAAAAfRgH0ETUHg7AyCAAAOHkUQB9ydUqiJOnrrTkMBgEAACeNAuhD2sdGaECbGLk9Xr3HYBAAAHCSKIA+5qqjZwHfZjAIAAA4SRRAH3NetxbVg0G+YzAIAAA4CRRAHxMc4NDIPi0lSbNXMBgEAACcOAqgD7rq6JyAX23JUU4Bg0EAAMCJoQD6oI5xEerXuknVYJDV+03HAQAAPoYC6KN+Ogs4e0WaPAwGAQAAJ4AC6KOG92ihyGCn9h8+ou93HjQdBwAA+BAKoI+qGgxStTIIg0EAAMCJoAD6sFEDquYEXLA5WzmFDAYBAADHhwLowzrFR6pPUrQqPV69z2AQAABwnCiAPu6nwSBvr0hnMAgAADguFEAfd0GPBEUEO5WWV6LvGAwCAACOAwXQx4UEOnRZ36rBIG8s3Ws2DAAA8AkUQD9wzcDWkqSFW3OUnldiOA0AAGjsKIB+oF3zcJ3Wvpm8Xumt5UwJAwAAfh8F0E9cO6jqLOC7q9JVWuE2nAYAADRmFEA/cVanWCVEBSuvuFyfbTxgOg4AAGjEKIB+wumwa/TRewFfX7rPcBoAANCYUQD9yJX9ExXosGtder427neZjgMAABopCqAfaRYepPO7x0uSXmdKGAAA8BsogH7m2kFtJEkfr8/U4eJys2EAAECjRAH0M32SotWlRaTKKj16b3W66TgAAKARogD6GZvNpuuOTgnz5rI01gcGAAC/QgH0Qxf3aqnIo+sDL9qeazoOAABoZCiAfigk0KHL+yVKkt5YxpQwAACgJgqgn/ppfeBvtrE+MAAAqIkC6KeSm4VpSMfm8nqlNzkLCAAAfoYC6MeuO3oW8B3WBwYAAD9DAfRjZ3SKVcvoEOWXVGje+kzTcQAAQCNBAfRjDrtNowcmSWIwCAAA+P8ogH7uyn5V6wNv2O/SuvR803EAAEAjQAH0c03Dg3RBjxaSWB8YAABUoQBawLVHVwb5ZMMB5bE+MAAAlkcBtIBeidHq3jJK5ZUevbuK9YEBALA6CqAF2Gy26rOAby7bJzfrAwMAYGkUQIu4qGeCokICtP/wEX27Lcd0HAAAYBAF0CKCAxy6ol8rSdLrS5kSBgAAK6MAWsg1A1vLZpMWbc/V3oPFpuMAAABDKIAW0rppmE7v2FwS6wMDAGBlFECLuX5QG0lV6wMXl1WaDQMAAIygAFrM6R2bq22zMBWWVur91ftNxwEAAAZQAC3GbrdpzOA2kqRXftgjD1PCAABgORRACxrZp5Uig53ae6hE3zAlDAAAlkMBtKCwIKeuGpAkSXr5hz2G0wAAgIZGAbSo605tI4fdph92HtKWAwWm4wAAgAZEAbSoltEhOrdbvKSqewEBAIB1UAAt7M+DkyVJH63L1MGiMsNpAABAQ6EAWlifpGj1TIxWeaVHs5anmY4DAAAaiN8WQLfbrXvuuUfJyckKCQlRu3btdP/998vr/f/Tnni9Xk2dOlUtWrRQSEiIUlNTtWPHDoOpG5bNZtOfj04J88ayfSqrdJsNBAAAGoTfFsBHHnlE06dP17PPPqstW7bokUce0aOPPqpnnnmm+jWPPvqonn76ac2YMUPLly9XWFiYhg0bptLSUoPJG9b53VsoLjJIuYVl+nTDAdNxAABAA/DbArhkyRJdfPHFGj58uNq0aaPLLrtM55xzjlasWCGp6uzfU089pX/961+6+OKL1aNHD73++uvKzMzURx99ZDZ8Awpw2HXd0eXh/vf9nhpnSAEAgH/y2wJ46qmnauHChdq+fbskaf369fr+++913nnnSZL27NmjrKwspaamVn9NVFSUUlJStHTp0mO+Z1lZmQoKCmo8/MHVA5IUHGDXj5kFWrEnz3QcAABQz/y2AN55550aNWqUOnXqpICAAPXu3VuTJk3S6NGjJUlZWVmSpLi4uBpfFxcXV/3cL02bNk1RUVHVj8TExPr9JhpIk7BAjezTShITQwMAYAV+WwDfffddvfXWW5o1a5bWrFmj1157TY899phee+21k37PKVOmyOVyVT/S09PrMLFZY05tI0n6cnO20g6VmA0DAADqld8WwH/84x/VZwG7d++ua6+9VrfeequmTZsmSYqPr5oEOTs7u8bXZWdnVz/3S0FBQYqMjKzx8Bcd4iI0pGNzeb3Sa0v3mo4DAADqkd8WwJKSEtntNb89h8Mhj8cjSUpOTlZ8fLwWLlxY/XxBQYGWL1+uQYMGNWjWxuKnKWHeWZmuwtIKs2EAAEC98dsCeOGFF+rBBx/Up59+qr1792rOnDl64okndMkll0iqmgNv0qRJeuCBB/Txxx9r48aNuu6665SQkKARI0aYDW/I6R2bq31suIrKKvXeqv2m4wAAgHriNB2gvjzzzDO655579Le//U05OTlKSEjQTTfdpKlTp1a/5o477lBxcbHGjRun/Px8nXbaaZo/f76Cg4MNJjfHZrNpzOA2unvOJr26ZK+uP7WNHHab6VgAAKCO2bxM/HbSCgoKFBUVJZfL5Tf3Ax4pd2vgtIVyHanQC9f21Tldj30/JAAAvsofj98nym8vAePkhAQ6dHVKkiSmhAEAwF9RAPEr1w1qLafdpmW78/Rjpst0HAAAUMcogPiVFlEhOr97C0nSy9/vNRsGAADUOQogjunPpyVLkuatz1ROYanhNAAAoC5RAHFMvRKj1ScpWuVuj95almY6DgAAqEMUQPymn84CvrV8n0or3IbTAACAukIBxG86t2u8EqKCdbCoXB+tzTAdBwAA1BEKIH6T02GvPgv4wne75fEwZSQAAP6AAojfNWpAkiKCndqdW6yvtmSbjgMAAOoABRC/KzzIqWsHtpYkzVy823AaAABQFyiA+EM3DG6jQIddq/cd1qq9eabjAACAWqIA4g/FRgTr0r4tJUkzFnEWEAAAX0cBxHH5y5/aymaTvtqSrZ05habjAACAWqAA4ri0ax6uc7rESZJe4F5AAAB8GgUQx+2m09tJkuaszVCWi+XhAADwVRRAHLc+SU00oE2MKtxevfLDHtNxAADASaIA4oT8dWhbSdJby9NUUFphOA0AADgZFECckKEdY9UxLlxFZZWatTzNdBwAAHASKIA4IXa7TeOGVN0L+PL3e1RW6TacCAAAnCgKIE7YRT0TFB8ZrJzCMs1dm2k6DgAAOEEUQJywQKddN56WLEmauXiXPB6v4UQAAOBEUABxUkYNSFREsFO7cou1cGuO6TgAAOAEUABxUiKCA3TNwNaSpJmLdhlOAwAATgQFECdtzKltFOiwa9W+w1q1N890HAAAcJwogDhpsZHBGtmnpSRpJsvDAQDgMyiAqJWxQ9rKZpMWbM7Wzpwi03EAAMBxoACiVto1D9fZneMkSS9yFhAAAJ9AAUSt3XR61cTQc9ZmKLug1HAaAADwRyiAqLW+rZuof5smKnd79MoPe03HAQAAf4ACiDpx09Hl4d5atk+FpRWG0wAAgN9DAUSdOLNTrNrHhquwrFKzlqeZjgMAAH4HBRB1wm63adyQtpKk/32/R6UVbsOJAADAb6EAos6M6NVSCVHByiks03ur0k3HAQAAv4ECiDoT6LTrr0Or7gWcsWi3yis9hhMBAIBjoQCiTl3RL1HNI4KUkX9Ec9buNx0HAAAcAwUQdSo4wKGbjt4L+Py3u1Tp5iwgAACNDQUQde7qlCTFhAVq36ESzduQaToOAAD4BQog6lxooFM3npYsSXr2651ye7yGEwEAgJ+jAKJeXDeotSKDndqVW6z5m7JMxwEAAD9DAUS9iAgO0JjBVWcBn/l6hzycBQQAoNGgAKLejBncRuFBTm3NKtTCrTmm4wAAgKMogKg30aGBunZQa0lVZwG9Xs4CAgDQGFAAUa/+clqyggPs2rDfpcU7DpqOAwAARAFEPWsaHqTRKUfPAi7kLCAAAI0BBRD1btyQtgp02rVq32Et251nOg4AAJZHAUS9i4sM1pX9EiVV3QsIAADMogCiQfx1aDs57TYt2XVIq/dxFhAAAJMogGgQLaNDdGmfVpKkZ77eaTgNAADWRgFEg/nbGe1kt0nfbsvVxv0u03EAALAsCiAaTOumYbq4V0tJ3AsIAIBJFEA0qPFntJPNJn25OVtbswpMxwEAwJIogGhQ7WMjdH63FpKkZ7kXEAAAIyiAaHATzmwvSfp04wHtyi0ynAYAAOuhAKLBdW4RqdTOcfJ6pee+4SwgAAANjQIIIyYePQs4d12m9h0qNpwGAABroQDCiJ6J0RrSsbncHi/zAgIA0MAogDDm1tQOkqQP1+zXbu4FBACgwVAAYUzvpCZK7Rwrj1d66ivmBQQAoKH4dQHMyMjQNddco6ZNmyokJETdu3fXqlWrqp/3er2aOnWqWrRooZCQEKWmpmrHDopIQ7r17I6SpHkbMpkXEACABuK3BfDw4cMaPHiwAgIC9Pnnn2vz5s16/PHH1aRJk+rXPProo3r66ac1Y8YMLV++XGFhYRo2bJhKS0sNJreWrglRGt69hbxe6ckF203HAQDAEmxer9drOkR9uPPOO/XDDz/ou+++O+bzXq9XCQkJuu2223T77bdLklwul+Li4vTqq69q1KhRf/h7FBQUKCoqSi6XS5GRkXWa30p2ZBfqnKcWy+uV5k04Td1bRZmOBADwYxy//fgM4Mcff6x+/frp8ssvV2xsrHr37q0XX3yx+vk9e/YoKytLqamp1duioqKUkpKipUuXmohsWR3iIjTi6BrBTyzYZjgNAAD+z28L4O7duzV9+nR16NBBX3zxhW6++Wbdcssteu211yRJWVlZkqS4uLgaXxcXF1f93C+VlZWpoKCgxgN14+9ndZDDbtM323K1el+e6TgAAPg1vy2AHo9Hffr00UMPPaTevXtr3LhxGjt2rGbMmHHS7zlt2jRFRUVVPxITE+swsbW1aRamy/u2kiQ9/iX3AgIAUJ/8tgC2aNFCXbp0qbGtc+fOSktLkyTFx8dLkrKzs2u8Jjs7u/q5X5oyZYpcLlf1Iz09vR6SW9fEszoo0GHXkl2HtGTXQdNxAADwW35bAAcPHqxt22reT7Z9+3a1bt1akpScnKz4+HgtXLiw+vmCggItX75cgwYNOuZ7BgUFKTIyssYDdadldIhGDag6q/rEl9vlp+OTAAAwzm8L4K233qply5bpoYce0s6dOzVr1iy98MILGj9+vCTJZrNp0qRJeuCBB/Txxx9r48aNuu6665SQkKARI0aYDW9h489oryCnXav2Hdai7bmm4wAA4Jf8tgD2799fc+bM0ezZs9WtWzfdf//9euqppzR69Ojq19xxxx2aOHGixo0bp/79+6uoqEjz589XcHCwweTWFhcZrOsGVZ2lfZyzgAAA1Au/nQewITCPUP04VFSmPz36jUrK3Zp5bV8N63rsezIBADgZHL/9+AwgfFfT8CD9eXCypKp7AT0e/o0CAEBdogCiURr7p7aKCHZqW3ahPt14wHQcAAD8CgUQjVJUaIDG/qmtJOnJr7ar0u0xnAgAAP9BAUSjNWZwGzUJDdDu3GJ9tC7TdBwAAPwGBRCNVkRwgP56ejtJ0n8Xbld5JWcBAQCoCxRANGrXDWqjZuFBSs87ovdWs/IKAAB1gQKIRi0k0KHxZ1SdBXz2650qrXAbTgQAgO+jAKLRu2pAklpEBeuAq1SzV6SZjgMAgM+jAKLRCw5waOKZHSRJz32zU0VllYYTAQDg2yiA8AmX92ulNk1DdbCoXC8u3m06DgAAPo0CCJ8Q4LDrjnM7SZJe/G63cgpKDScCAMB3UQDhM87rFq9eidEqKXfrqYU7TMcBAMBnUQDhM2w2m+46v7Mk6Z2V6dqZU2Q4EQAAvokCCJ8yIDlGZ3eJk9vj1aPzt5qOAwCAT6IAwuf889xOctht+nJztlbuzTMdBwBQD46Uu7Vhf77pGH6LAgif0z42XFf2T5QkPfTZFnm9XsOJAAB17aXvduuiZ3/QtM+2mI7ilyiA8EmTzuqgkACH1qbla/6mLNNxAAB1KKewVNMX7ZIkdUmINJzGP1EA4ZNiI4M1dkhbSdIj87eqwu0xnAgAUFeeXLBDJeVu9WwVpQt7JJiO45cogPBZ44a0VbPwQO09VMIScQDgJ7ZlFeqdlVU/0/91QRfZ7TbDifwTBRA+KzzIqb+ndpQk/ferHSosrTCcCABQWw99tkUer3Ru13j1bxNjOo7fogDCp43qn6i2zcJ0qLhcL7BEHAD4tMXbc7Voe64CHDbdeV4n03H8GgUQPu2XS8Rls0QcAPgkt8erh46O+L12YBu1aRZmOJF/owDC5w3rGqe+rZuotMKjJxdsNx0HAHAS3luVrq1ZhYoMduqWs9qbjuP3KIDweVVLxFWdBXx3Vbq2ZxcaTgQAOBHFZZV6/Og/4G85q4OiQwMNJ/J/FED4hb6tY3Ru13h5vNIjn7NEHAD4kpmLdyu3sExJMaG6dlBr03EsgQIIv3HHuafIYbdp4dYcLd11yHQcAMBxyHKV6oXFVZM+33leJwU5HYYTWQMFEH6jbfNwXT0gSZI07fMt8nhYIg4AGrvHvtym0gqP+rVuovO6xZuOYxkUQPiVW87qoLBAhzbsd+nTjQdMxwEA/I4fM136YM1+SdLdwzvLZmPS54ZCAYRfaR4RpJtObydJevSLrSqrdBtOBAA4Fq/Xqwc/3SKvV7qwZ4J6JzUxHclSKIDwO3/5U7KaRwQpPe+I3li6z3QcAMAxfLMtR0t2HVKgw647hp1iOo7lUADhd0IDnbrt7KNLxC3coYNFZYYTAQB+rtLt0UOfVc3YMGZwGyXGhBpOZD0UQPily/slqmtCpApLK/XYF9tMxwEA/MzslenamVOkJqEB+tsZTPpsAgUQfslht+nfF3WVJL2zKl0b97sMJwIASFJhaYWeOjrp86TUjooKCTCcyJoogPBb/dvE6OJeCfJ6pf+b96O8XqaFAQDTnv92lw4Vl6tt8zBdnZJkOo5lUQDh1+48r5NCAhxate+wPl6faToOAFja/sMl+t/3eyRJU87rrAAHNcQUPnn4tRZRIRp/RtW0MNM+26riskrDiQDAuv7zxTaVV3o0sG2MUjvHmo5jaRRA+L2//KmtEmNClFVQque/3Wk6DgBY0pq0w5q7rupKzL+Gd2HSZ8MogPB7wQEO3X1+F0nSi9/tUdqhEsOJAMBa3B6vps7dJEm6rG8rdWsZZTgRKICwhGFd43Ra+2Yqr/TogU83m44DAJYye0WaNmUUKCLYqTvP62Q6DkQBhEXYbDbde2EXOew2fbk5W9/vOGg6EgBYwuHicj32ZdV8rLed3VHNwoMMJ4JEAYSFdIiL0LUDW0uqmhamwu0xnAgA/N+jX2xTfkmFOsVH6JqjP4NhHgUQlnJrakc1CQ3QjpwivbmMdYIBoD5t2J+vt1emSZLuu7ibnEz70mjwJwFLiQoN0O1HFx1/YsF2HWKdYACoFx6PV1Pn/iivVxrRK0EDkmNMR8LPUABhOaP6J6lLi6PrBH+53XQcAPBL76/er3Xp+QoLdOiu8zubjoNfoADCcn6+TvDbK9O0KYN1ggGgLrlKKvTw/K2Sqtb7jY0MNpwIv0QBhCUNSI7RhT1ZJxgA6sMTC7Ypr7hc7WPDdcPgNqbj4BgogLCsKed1UnCAXSv3Hta8DQdMxwEAv/BjpktvHB1kd99FXVnvt5HiTwWWlRAdor8NbS9JmvbZFpWUs04wANSG1+vVvXN/lMcrDe/RQqe2b2Y6En4DBRCWNm5IW7VqEqIDrlJN/3aX6TgA4NPmrM3Qqn2HFRLg0L+GM/CjMaMAwtKCf/ZDaubi3dp7sNhwIgDwTQWlFXros6qBHxPPaq8WUSGGE+H3UABhecO6xutPHarWCb5n7iYGhADASfjvVzt0sKhMbZuF6cbTkk3HwR+gAMLybDab7r+4mwKddn2346A+Xp9pOhIA+JRtWYV6dcleSdK9F3VVkNNhNhD+EAUQkNSmWZhuObNqQMj9n2yWq6TCcCIA8A1er1f3frxJbo9Xw7rG6fSOzU1HwnGgAAJHjRvSTu1jw3WwqLx6AlMAwO+bt+GAlu3OU5DTrn8N72I6Do4TBRA4KtBp14MjukmSZq9I06q9eYYTAUDjVlxWqQc/3SxJGn9GeyXGhBpOhONFAQR+JqVtU13ZL1GSdPecTapwewwnAoDG6+mFO5RdUKakmFCNG9LWdBycAAog8At3ntdJMWGB2pZdqBe/2206DgA0SpsyXHrp+z2SpHsv7KLgAAZ++BIKIPALTcICq+cG/O9XO5R2qMRwIgBoXCrdHk35cKPcHq+Gd2+hszrHmY6EE0QBBI7hkt4tdWq7piqr9OhfzA0IADW88sNebcxwKTLYqXsvYuCHL7JEAXz44Ydls9k0adKk6m2lpaUaP368mjZtqvDwcF166aXKzs42FxKNis1m0wMjuinQYdfi7bn6ZMMB05EAoFFIO1SixxdskyTdPbyzYiOCDSfCyfD7Arhy5UrNnDlTPXr0qLH91ltv1bx58/Tee+9p0aJFyszM1MiRIw2lRGPUtnm4xp9RNTfg/83bLNcR5gYEYG1er1d3f7RRpRUeDWrbVFccHTQH3+PXBbCoqEijR4/Wiy++qCZNmlRvd7lc+t///qcnnnhCZ555pvr27atXXnlFS5Ys0bJlywwmRmPz16Ft1bZ5mA4WlelR5gYEYHEfrsnQdzsOKtBp10Mju8tms5mOhJPk1wVw/PjxGj58uFJTU2tsX716tSoqKmps79Spk5KSkrR06dKGjolGLMjp0IMjukuSZq1I0+p9hw0nAgAzDhaV6f6jc/5NSu2g5GZhhhOhNvy2AL799ttas2aNpk2b9qvnsrKyFBgYqOjo6Brb4+LilJWV9ZvvWVZWpoKCghoP+L9B7Zrqsr6t5PVKd8/ZyNyAACzp/k82K7+kQp1bRGrsn5jzz9f5ZQFMT0/X3//+d7311lsKDq67m1OnTZumqKio6kdiIvc+WMVd53dWk9AAbc0q1P+OznsFAFbxzbYczV2XKbtNenhkdwU4/LI+WIpf/gmuXr1aOTk56tOnj5xOp5xOpxYtWqSnn35aTqdTcXFxKi8vV35+fo2vy87OVnx8/G++75QpU+Ryuaof6enp9fydoLGICQvUXedXzQ341FfblZ7H3IAArKG4rFL/mrNJkvTnwcnqmRhtNhDqhF8WwLPOOksbN27UunXrqh/9+vXT6NGjq/8/ICBACxcurP6abdu2KS0tTYMGDfrN9w0KClJkZGSNB6zjsr6tlJIco9IKj6YyNyAAi3j8y+3KyD+iVk1CNPmcjqbjoI44TQeoDxEREerWrVuNbWFhYWratGn19htvvFGTJ09WTEyMIiMjNXHiRA0aNEgDBw40ERk+wGaz6cFLuuv8/36nb7bl6tONB3RBjwTTsQCg3qxLz9crS6pue3nwku4KDfTL2mBJfnkG8Hg8+eSTuuCCC3TppZdqyJAhio+P14cffmg6Fhq59rHhunloO0nSvXN/1KGiMsOJAKB+VLg9uvODDfJ6q1ZHOr1jc9ORUIdsXq5jnbSCggJFRUXJ5XJxOdhCyirduuiZH7Qtu1DDu7fQc6P7mI4EAHXuuW926j9fbFNMWKC+mny6YsICTUeqMxy/LXwGEDhZQU6HHr+ipxx2mz7deECfbMg0HQkA6tTu3CL9d+EOSdI9F3T2q/KHKhRA4CR0axml8UcvBd/z0SblFnIpGIB/8Hi8mvLhRpVXejSkY3ON6NXSdCTUAwogcJImnNlBneIjdLikQv/6aCOjggH4hXdXpWv5njyFBDj04IhuLPfmpyiAwEkKdNr1+BU95bTb9MWP2fp4PZeCAfi27IJSPfjZFknSbed0VGJMqOFEqC8UQKAWuiZEaeKZHSRJ9378o3IKSw0nAoCT4/V69c8PNqiwtFI9WkVpzOBk05FQjyiAQC397Yx26poQqfySCt09hwmiAfimWSvS9O22XAU67Xri6EA3+C8KIFBLAY6qS8EBDpsWbM7WR+syTEcCgBOy92CxHvik6tLvP8/tpPaxEYYTob5RAIE60Ck+Un8/6+il4Lk/KruAS8EAfIPb49Vt763XkQq3BraN0ZhT25iOhAZAAQTqyF9Pb6fuLaNUUFqpKR8yKhiAb5i5eJdW7zusiCCnHru8p+xc+rUECiBQR5xHLwUHOuz6emuO3l+933QkAPhdmzML9OSC7ZKkey/qqlZNGPVrFRRAoA51jIvQrWd3lCTd98lmHXAdMZwIAI6trNKtye+uU4Xbq3O6xOnSPkz4bCUUQKCOjf1TsnomRquwtFJ3fsClYACN0xMLtmtrVqGahgXqoZHdmfDZYiiAQB1zOux6/PIeCnTatWh7rt5dlW46EgDUsHJvnl5YvFuSNG1kdzULDzKcCA2NAgjUg/axEbr9nKpLwfd/skUZ+VwKBtA4FJVVavK76+T1Spf3baVzusabjgQDKIBAPbnxtLbqkxStorJK3fnBBi4FA2gUHvx0s9LzjqhldIimXtjFdBwYQgEE6onDbtNjl/dUkNOu73Yc1KtL9pqOBMDivt6ardkr0mWzSY9d3lMRwQGmI8EQCiBQj9o2D9fdwztLkqZ9tlU/ZroMJwJgVXnF5brj/Y2SpBsHJ2tQu6aGE8EkCiBQz64d2FqpneNU7vZo4uy1KimvNB0JgMV4vV7dPWejDhaVqUNsuG4fdorpSDCMAgjUM5vNpv9c1kPxkcHanVus//t4s+lIACxm7rpMfb4pS067TU9c0UvBAQ7TkWAYBRBoAE3CAvXklb1ks0nvrErXvPWZpiMBsIjM/CO6Z+4mSdItZ3VQ91ZRhhOhMaAAAg1kULummnBGe0nSXR9uVHpeieFEAPyd2+PV7e+tV2FppXomRutvQ9uZjoRGggIINKC/n9VBfZKiVVhWqVveXqsKt8d0JAB+7LlvdmrJrkMKCXDoiSt6yungsI8q7AlAA3I67PrvqN6KCHZqbVq+/vvVDtORAPippbsO6amvtkuSHhjRTe2ahxtOhMaEAgg0sMSYUD08sock6blvd2rJroOGEwHwNweLyvT3t9fK45Uu69tKl/ZtZToSGhkKIGDA8B4tNKp/orxe6dZ31imvuNx0JAB+wuPx6tZ31imnsGrKl/su7mo6EhohCiBgyNQLu6hd8zBlF5TpjvfXs1QcgDoxfdEufbfjoIID7HpudB+FBjpNR0IjRAEEDAkNdOqZq/oo0GHXV1ty9PrSfaYjAfBxK/bk6fEvt0mS7ruomzrGRRhOhMaKAggY1CUhUned30mS9OBnW7Q5s8BwIgC+6lBRmSbOXiOPVxrZu6Uu78d9f/htFEDAsOtPbaOzOsWqvNKjibPXsFQcgBPm8Xg1+d31yi4oU7vmYbp/RDfZbDbTsdCIUQABw2w2m/5zeU/FRgRpV26x7v+EpeIAnJiZi3dr0fZcBTmr7vsLC+K+P/w+CiDQCMT8bKm42SvS9emGA6YjAfARq/bm6bGj9/39+6Ku6hQfaTgRfAEFEGgkBrdvpptPr1qm6Z8fbNDOnCLDiQA0doeLyzVx9lq5PV5d3CtBo/onmo4EH0EBBBqRW8/uqJTkGBWVVWrcG6tUWFphOhKARsrj8eq299brgKtUbZuF6cFLunPfH44bBRBoRAIcdj17dR/FRwZrd26xbnt3vTwe5gcE8Gsvfb9bX2/NUaCz6udGOPf94QRQAIFGpnlEkKZfUzU/4JebszV90S7TkQA0MmvSDuvR+VX3/U29oIu6JHDfH04MBRBohHonNdH/HV2+6bEvt2nR9lzDiQA0Fvkl5Zo4a60qPV4N79FCo1OSTEeCD6IAAo3UVQOSdNWAqvWCb5m9VmmHSkxHAmBYpdujibPXKiP/iFo3DdXDI7nvDyeHAgg0Yv++qKt6JkbLdaRCN725WkfK3aYjATBo2udb9d2OgwoJcGj66L6KCA4wHQk+igIINGJBTodmXNNHTcMCteVAge78cIO8XgaFAFb0/ur9+t/3eyRJT1zRk/v+UCsUQKCRaxEVoudG95HDbtPcdZl65Ye9piMBaGBr0g7rrg83SpJuOauDzuvewnAi+DoKIOADBrZtqrvO7yxJevCzLVq2+5DhRAAaSparVDe9sVrlbo/O6RKnSWd1MB0JfoACCPiIPw9uo4t7Jcjt8WrCrDU64DpiOhKAelZa4dZNb6xSbmGZOsaF64kre8luZ9AHao8CCPgIm82mh0f2UKf4CB0sKtfNb65RWSWDQgB/5fV6NeXDjVq/36Xo0AC9dF1/JntGnaEAAj4kJNChF67tp8hgp9al5+vfH282HQlAPXnpuz2aszZDDrtNz1/dR0lNQ01Hgh+hAAI+JqlpqJ6+qrdsNmn2ijS9vSLNdCQAdWzR9lxN+3yLJOme4Z11avtmhhPB31AAAR809JRY3XZ2R0nS1Lk/avW+PMOJANSV3blFmjBrjTxe6cp+ibr+1DamI8EPUQABH/W3oe01rGucyt0e/eW1Vdp7sNh0JAC1VFBaob+8vkqFpZXq27qJ7hvRlZU+UC8ogICPstttevLKXurRKkqHSyp0wysrlFdcbjoWgJPk9ng16e112p1brBZRwZp+TR8FOR2mY8FPUQABHxYa6NRL1/dTy+gQ7T1UorGvr1JpBSODAV/02Jfb9PXWHAU57Xrh2n6KjQg2HQl+jAII+LjYiGC9Oqa/IoKdWr3vsG57d708HpaLA3zJ3HUZmv7tLknSo5f1UPdWUYYTwd9RAAE/0CEuQjOv7asAh02fbjygR77YajoSgOO0Yk+e/vH+BknSX09vp4t7tTScCFZAAQT8xKntmumRS3tIkmYu2q03l+0znAjAH9mWVai/vLZS5ZUend0lTv8YdorpSLAICiDgR0b2aaXJ1dPDbNI3W3MMJwLwWzLyj+j6l1eooLRS/Vo30TNX9ZaDZd7QQCiAgJ+ZeGZ7Xda3lTxeafysNdqU4TIdCcAv5JeU6/qXVyiroFQdYsP10vX9FBzAiF80HAog4GdsNpumjeyu09o3U0m5W2NeXamM/COmYwE4qrTCrRtfW6WdOUWKjwzWa38eoOjQQNOxYDEUQMAPBTjsev6aPjolLkK5hWUa88oKFZRWmI4FWF6l26MJs9Zq9b7Digx26vUbByghOsR0LFgQBRDwU5HBAXplTH/FRgRpe3aRbn5ztcorPaZjAZbl9Xp1z9wf9dWWbAU67Xrp+v7qGBdhOhYsigII+LGE6BC9fEN/hQY69MPOQ7przkZ5vcwRCJjw34U7NHtFmuw26elRvTUgOcZ0JFgYBRDwc91aRum5q/vIYbfp/dX79dRXO0xHAixn1vK06r97913cTed2izecCFbntwVw2rRp6t+/vyIiIhQbG6sRI0Zo27ZtNV5TWlqq8ePHq2nTpgoPD9ell16q7OxsQ4mB+nNGp1jdd3FXSVVnIV76brfhRIB1fPljlv710UZJ0i1nttc1A1sbTgT4cQFctGiRxo8fr2XLlmnBggWqqKjQOeeco+Li4urX3HrrrZo3b57ee+89LVq0SJmZmRo5cqTB1ED9GZ3SWremVs0R+MCnW/QGE0UD9W7V3jxNnL1WHq80qn+ibj06Tydgms1rkRuCcnNzFRsbq0WLFmnIkCFyuVxq3ry5Zs2apcsuu0yStHXrVnXu3FlLly7VwIED//A9CwoKFBUVJZfLpcjIyPr+FoBa83q9evSLbTXWHL2iX6LhVIB/2p5dqMtnLJXrSIVSO8dqxjV95XT47XkXn8Lx24/PAP6Sy1U1GW5MTNVNt6tXr1ZFRYVSU1OrX9OpUyclJSVp6dKlx3yPsrIyFRQU1HgAvsRms+mOYadozOA2kqR/frBBc9dlmA0F+KHMo6t8uI5UqE9StJ65qg/lD42KJfZGj8ejSZMmafDgwerWrZskKSsrS4GBgYqOjq7x2ri4OGVlZR3zfaZNm6aoqKjqR2IiZ07ge2w2m6Ze0EVXDUiS1ytNfne95m869j4P4MQdcB3RVS8u0wFXqdo1D9P/ru+vkEBW+UDjYokCOH78eG3atElvv/12rd5nypQpcrlc1Y/09PQ6Sgg0LJvNpgdHdNPIPi3l9ng1cfYa1g0G6sAB1xGNemGZ9h0qUWJMiF6/MUVNwljlA42P3xfACRMm6JNPPtE333yjVq1aVW+Pj49XeXm58vPza7w+Oztb8fHHHp4fFBSkyMjIGg/AV9ntNj16aQ8N79FCFW6vbnpztX7YedB0LMBn/bL8vT1ukFqyygcaKb8tgF6vVxMmTNCcOXP09ddfKzk5ucbzffv2VUBAgBYuXFi9bdu2bUpLS9OgQYMaOi5ghNNh11NX9tLZXeJUXunRX15bpRV78kzHAnwO5Q++xm8L4Pjx4/Xmm29q1qxZioiIUFZWlrKysnTkyBFJUlRUlG688UZNnjxZ33zzjVavXq0xY8Zo0KBBxzUCGPAXAQ67nr26t4Z0bK4jFW79+dWVWpeebzoW4DMof/BFfjsNjM1mO+b2V155RTfccIOkqomgb7vtNs2ePVtlZWUaNmyYnn/++d+8BPxLDCOHPzlS7taYV1do2e48RQY7NXvcQHVNiDIdC2jUKH++ieO3HxfAhsAOBH9TXFap615eodX7DismLFBvjxvIYvXAb6D8+S6O3358CRjAiQsLcuqVMf3Vo1WU8orLNfql5dqZU2Q6FtDoUP7g6yiAAGqIDA7Q638eoE7xEcotLNMVM5dqw/5807GARoPyB39AAQTwK9GhgXrrLynVZwKvemGZluxiihiA8gd/QQEEcExNw4M0a+xADWrbVMXlbt3w8kp98SMrhsC6KH/wJxRAAL8p/Og9ged0iVO526Ob31ytd1exAg6sZ+/BYl05k/IH/0EBBPC7ggMcen50H13Rr5U8XumO9zfoxcW7TccCGsy69HxdOn2J0vJKlBQTSvmDX6AAAvhDToddj1zaQ+OGtJUkPfjZFj0yf6uYRQr+buGWbI16YakOFZere8sovX8z5Q/+gQII4LjYbDbddX5n/fPcTpKk6d/u0l1zNsrtoQTCP81anqaxr69SaYVHp3dsrrfHDVRsRLDpWECdoAACOCE3D22naSO7y26TZq9I18TZa1RW6TYdC6gzXq9XT3y5TXfN2SiPV7q8byu9dH0/hQU5TUcD6gwFEMAJu2pAkp69uo8CHXZ9tjFLf3ltlYrLKk3HAmqtwu3RP97foKe/3ilJuuWsDnr0sh4KcHC4hH9hjwZwUs7v3kIv39BfoYEOfbfjoK5+abkOF5ebjgWctKKySt342iq9v3q/HHabpo3srslnd/zNteUBX0YBBHDSTuvQTLPGDlR0aIDWp+frshlLtOdgselYwAnLKSzVqBeWavH2XIUEOPTidX111YAk07GAekMBBFArvRKj9d5Ng9QiKli7cot18bPfa9H2XNOxgOO2K7dII59fok0ZBWoaFqi3xw3UmZ3iTMcC6hUFEECtdYiL0NwJg9UnKVoFpZUa88oKzVy0i2li0Oit3penS6cv0f7DR9Smaag+/Nup6pkYbToWUO8ogADqRGxEsGaPG6gr+yXK45Wmfb5Vk95Zp9IKRgijcfpkQ6aufnG58ksq1DMxWh/cfKpaNw0zHQtoEBRAAHUmyOnQw5d2130Xd5XTbtPcdZm6bMYSZeYfMR0NqFbh9ui+eZs1YdZalVV6dFanWM0em6Km4UGmowENhgIIoE7ZbDZdN6iN3rgxRTFhgdqUUaCLnv1eK/fmmY4GKMtVqqteWKaXf9gjSfrr6e0089q+Cg1kjj9YCwUQQL0Y1K6p5o4frM4tInWwqFxXv7hMby3fZzoWLGzJroO64JnvtGrfYUUEOTXz2r6687xOcjLHHyyIvR5AvUmMCdUHNw/S8B4tVOH26u45m3T3nI0qr/SYjgYL8Xq9mv7tLl3z0nIdLCpXp/gIzZt4moZ1jTcdDTCGAgigXoUGOvXsVb31j2GnyGaT3lqeptEvLVNuYZnpaLAA15EKjXtjtR6Zv1Uer3Rpn1aa87fBatOMwR6wNgoggHpns9k0/oz2+t/1/RQR5NTKvYd10bPfa23aYdPR4Mc2Z1bdf7pgc7YCHXZNG9ldj13eQyGBDtPRAOMogAAazJmd4jRn/GC1bRamA65SXTZjqZ5csF0Vbi4Jo269v3q/Lnn+B+07VKKW0SF6/+ZBumpAEsu6AUdRAAE0qPax4ZozfrAu6pkgt8er/y7coctmLNXu3CLT0eAHSivcmvLhRt3+3nqVVXo09JTm+vSW09SjVbTpaECjYvMyVf9JKygoUFRUlFwulyIjI03HAXzO3HUZ+tdHm1RYWqmQAIfuHt5Zo1M4S4OTsyO7ULe+u06bMgpks0m3pnbUhDPay25nf0JNHL8pgLXCDgTUXmb+Ed3+3not2XVIknTGKc31yGU9FBsRbDgZfEWl26OZi3frv1/tULnboyahAfrvqN4a0rG56WhopDh+UwBrhR0IqBsej1cv/7BHj36xTeWVHsWEBWrayO5M04E/tOVAgf7x/nptyiiQJJ3ZKVYPXdJd8VH8AwK/jeM3BbBW2IGAurUtq1CT3lmnLQeqDuaX922ley/qqvAgVmlATeWVHj3/7U49981OVbi9igoJ0L8v6qIRvVpyCwH+EMdvCmCtsAMBda+s0q0nFmzXC4t3y+uVEmNC9OQVvdSvTYzpaGgkNmW4dPt767U1q1CSdE6XOD0woptiIznrh+PD8ZsCWCvsQED9Wb77kCa/u14Z+Udkt0k3nd5Ot5zZgTncLKys0q1nFu7U9EW75PZ41SQ0QP93cTdd2KMFZ/1wQjh+UwBrhR0IqF8FpRX6v48364M1+yVJCVHBunt4F53fPZ4DvsWsT8/XP95fr+3ZVdMFDe/eQv93cVc1Cw8ynAy+iOM3BbBW2IGAhvHFj1m6b95mZeQfkSSlJMfo3xd1VecW/L3zd6UVbj351Xa9uHi3PF6pWXig7r+4m87r3sJ0NPgwjt8UwFphBwIazpFyt2Yu3qXp3+5SWaVHdps0OqW1Jp/dUU3CAk3HQx3zeLyatyFT//lim/Yfrir+I3ol6N4Lu/LnjVrj+E0BrBV2IKDh7T9commfbdWnGw9IkqJDA3TbOafo6gFJcjDhr19YsvOgHvp8S/XULvGRwbp/RDed3SXOcDL4C47fFMBaYQcCzFmy66Dum7e5eiRop/gI/fuirhrYtqnhZDhZW7MK9PDnW/XttlxJUniQUzcPbac/D05m8A/qFMdvCmCtsAMBZlW6PZq1Ik2Pf7ldriMVkqQLerTQXed3VkJ0iOF0OF4HXEf0xJfb9f6a/fJ6JafdpmsGttbEM9urKYM8UA84flMAa4UdCGgcDheX6/EF2zRreZo8Xik4wK4bTk3Wn09rw5JyjVhBaYWmf7tLL3+/R2WVHklVo3v/MewUtWkWZjgd/BnHbwpgrbADAY3L5swC/Xvej1qxJ0+SFOi064p+rTTuT+2U1DTUcDr8pLzSo7eW79PTC3focEnVmdsBbWI05fxO6p3UxHA6WAHHbwpgrbADAY2P1+vVwi05ev7bnVqTli9JcthtuqBHC908tJ06xfN31ZSiskp9sHq//vf9HqXllUiS2jUP053ndVZq51jmdkSD4fhNAawVdiCg8fJ6vVq+J0/Pf7tLi7fnVm8/s1Os/ja0HUvLNaC0QyV6belevbsyXYVllZKkZuFBmnx2R13Rr5WcDrvhhLAajt8UwFphBwJ8w6YMl6Z/u0ufbTqgn37iDWgTo5vPaKehHZtz5qkeeL1eLd19SK/8sFdfbcmu/tzbNgvTDYPb6NI+rRQW5DQbEpbF8ZsCWCvsQIBv2XOwWDMX7dIHa/arwl31o69zi0j99fS2GtY1XsEBTDVSW6UVbs1dl6FXfthbPUWPJA3p2FxjBrfR6R2ay858jTCM4zcFsFbYgQDflOUq1Uvf7dasFWkqKXdLkiKCnDqve7xG9G6pgclNKSkn6IDriN5ctk+zlqdVD+wICXDo0r4tdcOpyWofG244IfD/cfymANYKOxDg2/JLyvXakn16Z2WaMl2l1dtbRAXrol4JGtGrJesN/w5XSYUWbs3W55uy9M3WHFV6qg4nLaNDdP2prXVlvyRFhQYYTgn8GsdvCmCtsAMB/sHj8WrF3jzNXZehTzYcUGFpZfVzneIjNKJ3S13UM4HJpSXlFJZqweZszd+UpaW7DlWXPkkakByjPw9uo9TOcQzsQKPG8ZsCWCvsQID/Ka1w69ttOfpobaa+3pqjcnfVBMU2m5SSHKNLerdUauc4S61Qsf9wieZvytIXP2Zp1b7D+vlR45S4CA3rFq/zu8czxQ58BsdvCmCtsAMB/s1VUqHPNh3QR2sztPzo5NI/6RAbrpS2MUpJbqqU5BjFRvrPiiNer1c7c4r05dEzfRszXDWe75kYrXO7xmtY1zi1bc69ffA9HL8pgLXCDgRYR0b+Ec1dl6F56w9oy4GCXz2f3CxMKckxGpAco5S2TdXShy4XZxeUan16vjbsd2n9/nxtzHAp/+hADkmy26ou757bNV7ndI3nUjh8HsdvCmCtsAMB1pRXXK4Ve/K0Yk+elu85pM0HCvTLn6StmoRoQHKM+reJUXKzMCXFhCouMlgOw6OL80vKtWG/Sxv252v90f9mF5T96nWBTrtObddU53aNV2qXODWz0CVv+D+O3xTAWmEHAiBJriMVWrU3T8v3VD02Zbjk9vz6R2ugw66WTUKUGBOqpJgQJcWEKikmVK2ahCqpaagig2s3Yra0wq3cwjLlFpVV/fenR1GZcgrKtDOnUHsPlfzq6+w2qWNchHq0ilKPVtHq2Spap8RHKNDJQA74J47fFMBaYQcCcCxFZZVave+wlu8+pI0ZLqXnlWj/4SM1RsweS3RogJqEBspht8lptynAYZfTYVOA3V61zXF029HnJOlQcZlyjha9n49e/j2tm4YeLXpR6pkYra4JkQoNZFUOWAfHb4m/8QBQx8KDnDq9Y3Od3rF59bZKt0dZBaVKyytRel6J0vOOKC2vpPrXh4rLlV9SUePeu5MR6LCreURQzUd41X+TYkLVo1WUokMDa/stAvBxFEAAaABOh12tmlRd7lW7Xz9fVFap9LwSFZVVqsLtUaXbK7fHW/X/P/3X7VWlp+rXlW6vPF6vYsIC1TwiSLERQWoeHqzIECdrGwP4QxRAAGgEwoOcrDoCoMFwhy8AAIDFUAABAAAshgIIAABgMRRAAAAAi6EAAgAAWAwFEAAAwGIsXwCfe+45tWnTRsHBwUpJSdGKFStMRwIAAKhXli6A77zzjiZPnqx7771Xa9asUc+ePTVs2DDl5OSYjgYAAFBvLF0An3jiCY0dO1ZjxoxRly5dNGPGDIWGhurll182HQ0AAKDeWLYAlpeXa/Xq1UpNTa3eZrfblZqaqqVLlx7za8rKylRQUFDjAQAA4GssWwAPHjwot9utuLi4Gtvj4uKUlZV1zK+ZNm2aoqKiqh+JiYkNERUAAKBOWbYAnowpU6bI5XJVP9LT001HAgAAOGFO0wFMadasmRwOh7Kzs2tsz87OVnx8/DG/JigoSEFBQQ0RDwAAoN5YtgAGBgaqb9++WrhwoUaMGCFJ8ng8WrhwoSZMmHBc7+H1eiWJewEBAPAhPx23fzqOW5FlC6AkTZ48Wddff7369eunAQMG6KmnnlJxcbHGjBlzXF9fWFgoSdwLCACADyosLFRUVJTpGEZYugBeeeWVys3N1dSpU5WVlaVevXpp/vz5vxoY8lsSEhKUnp6uiIgI2Wy2ek7rGwoKCpSYmKj09HRFRkaajuP3+LwbHp95w+LzbnhW+My9Xq8KCwuVkJBgOooxNq+Vz3+izhUUFCgqKkoul8tvf3A0JnzeDY/PvGHxeTc8PnNrYBQwAACAxVAAAQAALIYCiDoVFBSke++9l+lyGgifd8PjM29YfN4Nj8/cGrgHEAAAwGI4AwgAAGAxFEAAAACLoQACAABYDAUQAADAYiiAqHdlZWXq1auXbDab1q1bZzqO39q7d69uvPFGJScnKyQkRO3atdO9996r8vJy09H8xnPPPac2bdooODhYKSkpWrFihelIfmvatGnq37+/IiIiFBsbqxEjRmjbtm2mY1nGww8/LJvNpkmTJpmOgnpCAUS9u+OOOyy93E5D2bp1qzwej2bOnKkff/xRTz75pGbMmKG77rrLdDS/8M4772jy5Mm69957tWbNGvXs2VPDhg1TTk6O6Wh+adGiRRo/fryWLVumBQsWqKKiQuecc46Ki4tNR/N7K1eu1MyZM9WjRw/TUVCPmAYG9erzzz/X5MmT9cEHH6hr165au3atevXqZTqWZfznP//R9OnTtXv3btNRfF5KSor69++vZ599VpLk8XiUmJioiRMn6s477zSczv/l5uYqNjZWixYt0pAhQ0zH8VtFRUXq06ePnn/+eT3wwAPq1auXnnrqKdOxUA84A4h6k52drbFjx+qNN95QaGio6TiW5HK5FBMTYzqGzysvL9fq1auVmppavc1utys1NVVLly41mMw6XC6XJLE/17Px48dr+PDhNfZ1+Cen6QDwT16vVzfccIP++te/ql+/ftq7d6/pSJazc+dOPfPMM3rsscdMR/F5Bw8elNvtVlxcXI3tcXFx2rp1q6FU1uHxeDRp0iQNHjxY3bp1Mx3Hb7399ttas2aNVq5caToKGgBnAHFC7rzzTtlstt99bN26Vc8884wKCws1ZcoU05F93vF+5j+XkZGhc889V5dffrnGjh1rKDlQN8aPH69Nmzbp7bffNh3Fb6Wnp+vvf/+73nrrLQUHB5uOgwbAPYA4Ibm5uTp06NDvvqZt27a64oorNG/ePNlsturtbrdbDodDo0eP1muvvVbfUf3G8X7mgYGBkqTMzEwNHTpUAwcO1Kuvviq7nX/n1VZ5eblCQ0P1/vvva8SIEdXbr7/+euXn52vu3Lnmwvm5CRMmaO7cuVq8eLGSk5NNx/FbH330kS655BI5HI7qbW63WzabTXa7XWVlZTWeg++jAKJepKWlqaCgoPrXmZmZGjZsmN5//32lpKSoVatWBtP5r4yMDJ1xxhnq27ev3nzzTX5g16GUlBQNGDBAzzzzjKSqy5JJSUmaMGECg0Dqgdfr1cSJEzVnzhx9++236tChg+lIfq2wsFD79u2rsW3MmDHq1KmT/vnPf3Lp3Q9xDyDqRVJSUo1fh4eHS5LatWtH+asnGRkZGjp0qFq3bq3HHntMubm51c/Fx8cbTOYfJk+erOuvv179+vXTgAED9NRTT6m4uFhjxowxHc0vjR8/XrNmzdLcuXMVERGhrKwsSVJUVJRCQkIMp/M/ERERvyp5YWFhatq0KeXPT1EAAT+xYMEC7dy5Uzt37vxVyeZEf+1deeWVys3N1dSpU5WVlaVevXpp/vz5vxoYgroxffp0SdLQoUNrbH/llVd0ww03NHwgwM9wCRgAAMBiuDscAADAYiiAAAAAFkMBBAAAsBgKIAAAgMVQAAEAACyGAggAAGAxFEAAAACLoQACAABYDAUQAADAYiiAAAAAFkMBBAAAsBgKIAAAgMVQAAEAACyGAggAAGAxFEAAAACLoQACAABYDAUQAADAYiiAAAAAFkMBBAAAsBgKIAAAgMVQAAEAACyGAggAAGAxFEAAAACLoQACAABYDAUQAADAYiiAAAAAFkMBBAAAsBgKIAAAgMVQAAEAACyGAggAAGAxFEAAAACL+X8E42Hyv1cQQAAAAABJRU5ErkJggg==' width=640.0/>\n            </div>\n        ","content_type":"text/html"},"text/plain":{"content":"Canvas(toolbar=Toolbar(toolitems=[('Home', 'Reset original view', 'home', 'home'), ('Back', 'Back to previous …","content_type":"text/plain"}}},"children":[],"key":"t8bxXPFmYl"}],"key":"E0XNfNSSW9"}],"key":"Pq7lEIRtbc"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Above, we plotted a parabola. Now, to think through what the derivative of this function at any point x is let’s look up the definition of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FL8Y38FWX3"},{"type":"link","url":"https://en.wikipedia.org/wiki/Derivative#Definition","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"what it means for a function to be differentiable","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PUz0eWME7k"}],"urlSource":"https://en.wikipedia.org/wiki/Derivative#Definition","data":{"page":"Derivative#Definition","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"Yae4aPlKbL"},{"type":"text","value":". Understanding the derivative boils down to finding how a such a function ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gx73ykFb2H"},{"type":"inlineCode","value":"f","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tvp1K7WHyG"},{"type":"text","value":" responds to a slight nudge of its input ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dxtzpK1CUZ"},{"type":"inlineCode","value":"x","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oUYarN512D"},{"type":"text","value":" by a small number ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fDUUhF4DCs"},{"type":"inlineCode","value":"h","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FXNZxV8P5e"},{"type":"text","value":". Meaning, with what sensitivity does it respond? Does the value go up or down? Or, to be more precise, what is the slope at that point ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IL8NcwYXxC"},{"type":"inlineCode","value":"x","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T0l06GVRBd"},{"type":"text","value":"? Is it positive or negative? This exact amount we are looking for is given to us by the limit equation that we can very simply approximate numerically with a small enough ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Mk4KL8xdOP"},{"type":"inlineCode","value":"h","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TbAdJGh6hQ"},{"type":"text","value":" value, as follows.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VWnKFbsANv"}],"key":"Xr3YugVhPb"}],"key":"RjcuQ1Ox06"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"h = 0.00000001\nx = 3.0  # try -3.0, 2/3, etc.\n(y(x + h) - y(x)) / h","key":"giPegHNqod"},{"type":"outputs","id":"FhqqgsmeSwrOcx42ZWbqH","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"14.00000009255109","content_type":"text/plain"}}},"children":[],"key":"D2PYzirTUq"}],"key":"K0398YN9KQ"}],"key":"zsWVtQKa4I"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, with a more complex example, to start building an intuition about the derivative, let’s find out the derivatives of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RateXjV6iq"},{"type":"inlineCode","value":"d","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RGEI8wR8ow"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fH1sPtW0Ce"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RtqffBYIRg"}],"key":"U3CO8LTh8E"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U94MDX5yLo"},{"type":"inlineCode","value":"a","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qpanD1zLi3"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dguMr4wyDh"},{"type":"inlineCode","value":"b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fHHgS8Xm5j"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iMxGEEXG73"},{"type":"inlineCode","value":"c","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z0Rwm9OzwS"},{"type":"text","value":" (i.e. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IScuyT2ob0"},{"type":"inlineMath","value":"\\dfrac{\\partial d}{\\partial a}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>d</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>a</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial d}{\\partial a}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">a</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"wqSEIMjwuh"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D5uGZHXRjK"},{"type":"inlineMath","value":"\\dfrac{\\partial d}{\\partial b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>d</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>b</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial d}{\\partial b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">b</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"cQm0DVCNwO"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nNhYJEnfri"},{"type":"inlineMath","value":"\\dfrac{\\partial d}{\\partial c}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>d</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial d}{\\partial c}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">c</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"lYDX45yppj"},{"type":"text","value":").","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kzjgCV7jmL"}],"key":"oNRzpAjiBG"}],"key":"g1uzbD5RgM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"h = 0.00000000000001\na = 2.0\nb = -3.0\nc = 10.0\nd1 = a * b + c\na += h  # try nudging `b` or `c` instead to see what happens\nd2 = a * b + c\nprint(f\"d1: {d1}\")\nprint(f\"d2: {d2}\")\nprint(f\"slope: {(d2 - d1)/h}\")","key":"wWiVRA8CIv"},{"type":"outputs","id":"NovNlX31y_feEbpqycot7","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"d1: 4.0\nd2: 3.99999999999997\nslope: -3.019806626980426\n"},"children":[],"key":"inyypIfEDv"}],"key":"BaBqfvNB5f"}],"key":"iP8qE5UGV4"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We now have some intuitive sense of what a derivative is telling us about a function. So now let’s move unto ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AJQz1CM69r"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LAsgz7SPWh"}],"key":"eR9Mwy5mS7"},{"type":"text","value":"s, which are much more massive mathematical expressions. To easily do so, we must first build some infrastructure.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yFTHzCYFdo"}],"key":"fh2plGLZkq"}],"key":"TB2X29d3ir"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"class Value:\n    def __init__(\n        self,\n        data,\n        prev=(),\n        op=\"\",\n        label=\"\",\n    ):\n        self.data = data\n        self.prev = set(prev)\n        self.op = op\n        self.label = label\n        self.grad = 0.0\n\n    def __repr__(self):\n        return f\"{self.__class__.__name__}(data='{self.data}'\" + (\n            f\", label='{self.label}')\" if self.label else \")\"\n        )\n\n    def __add__(self, other):\n        return self.__class__(\n            data=(self.data + other.data),\n            prev=(self, other),\n            op=\"+\",\n        )\n\n    def __radd__(self, other):  # other + self\n        return self + other\n\n    def __mul__(self, other):\n        return self.__class__(\n            data=(self.data * other.data),\n            prev=(self, other),\n            op=\"*\",\n        )\n\n    def __rmul__(self, other):  # other * self\n        return self * other\n\n    def __neg__(self):  # -self\n        return self * -1\n\n    def __sub__(self, other):  # self - other\n        return self + (-other)\n\n    def tanh(self):\n        return self.__class__(\n            data=math.tanh(self.data),\n            prev=(self,),\n            op=\"tanh\",\n        )\n\n\na = Value(2.0, label=\"a\")\nb = Value(-3.0, label=\"b\")\nc = Value(10.0, label=\"c\")\nf = Value(-2.0, label=\"f\")\n\n\ndef forward_pass(label=False):\n    d = a * b\n    e = d + c\n    L = e * f\n    if label:\n        d.label = \"d\"\n        e.label = \"e\"\n        L.label = \"L\"\n    return L\n\n\nL = forward_pass(label=True)\nL","key":"LVfBTVlHVv"},{"type":"outputs","id":"s6UEawkxbovAOmTd30fhi","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"Value(data='-8.0', label='L')","content_type":"text/plain"}}},"children":[],"key":"cOYIhImEgN"}],"key":"UMmrSk4RRZ"}],"key":"JUx1LZIFtK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"L.prev","key":"J2ElDodi6Y"},{"type":"outputs","id":"0fOPgVtB535wNQLs0Ks_V","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"{Value(data='-2.0', label='f'), Value(data='4.0', label='e')}","content_type":"text/plain"}}},"children":[],"key":"dqsyidwEgy"}],"key":"TWHZJcamgT"}],"key":"bgCmnrnBxk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"L.op","key":"c0EMy8nujX"},{"type":"outputs","id":"0T67ijemAVri-LKMcyWBt","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"'*'","content_type":"text/plain"}}},"children":[],"key":"Zh2WMkNl2D"}],"key":"jFtEAhZ2mM"}],"key":"VrTMJvbRCf"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jLWn4W2yED"},{"type":"inlineCode","value":"Value","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"imz6fNVOSR"},{"type":"text","value":" object we defined acts as a value holder. It can also perform operations (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kxGdn5byYV"},{"type":"inlineCode","value":"+","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DDYbbcQoQx"},{"type":"text","value":", etc.) with other ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"omJYydLksD"},{"type":"inlineCode","value":"Value","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"n91vKaqHlo"},{"type":"text","value":" objects to produce new ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HcRIItjLQ0"},{"type":"inlineCode","value":"Value","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"n4LHEvfXtT"},{"type":"text","value":" instances. Each such instance holds:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fmBMpiVc2q"}],"key":"M7VMHkB9t2"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"some value ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"O9k60bqr70"},{"type":"inlineCode","value":"data","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"r5qZ1GtJI2"}],"key":"WftZZesFVI"}],"key":"rmXdQrj7mu"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"the operation ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"begGppk0RK"},{"type":"inlineCode","value":"op","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qMtzHwmY99"},{"type":"text","value":" that produced it (e.g. ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cqPxtlLdxP"},{"type":"inlineCode","value":"+","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jbdPyuVxkw"},{"type":"text","value":")","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"soLoY0DKY0"}],"key":"C41p4Fx3L6"}],"key":"AH2xQSSLSr"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"its children ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"UBVqG5eEt8"},{"type":"inlineCode","value":"prev","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"JRoYzH0Eod"},{"type":"text","value":": a tuple of the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"YQMxpWSfQE"},{"type":"inlineCode","value":"Value","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"FKi5lrQlSf"},{"type":"text","value":" instances that produced it","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ZiTKq4r7TZ"}],"key":"MqZ4b0nVhe"}],"key":"r53JB88ZSu"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"its gradient ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"meXXaMsn2F"},{"type":"inlineCode","value":"grad","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"HoJLzLqmzz"},{"type":"text","value":" which represents the derivative of some value (e.g. ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BLOnBUAYsI"},{"type":"inlineCode","value":"L","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PjOwNPIYLq"},{"type":"text","value":")  (","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PSasFhj3iZ"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"YlXE21oxGZ"}],"key":"B6JGJcf8ge"},{"type":"text","value":" the value/instance itself)","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"lftsCEy9Jt"}],"key":"KyylxK12Mb"}],"key":"hL2IQROqhH"}],"key":"zJ1po84lDM"}],"key":"XMRsWhjrvZ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To recap what we have done so far: we have built scalar-valued mathematical expression graphs using operations such as addition and multiplication. To see such a graph that each ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KiFChdKekE"},{"type":"inlineCode","value":"Value","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"h6sbjPOc6f"},{"type":"text","value":" object represents, let’s implement visualization function ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nSi7yf4pvq"},{"type":"inlineCode","value":"draw()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B5Xv6MReP5"},{"type":"text","value":" and call it on a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eP6oU9Qreg"},{"type":"inlineCode","value":"Value","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yDl6TYk0xG"},{"type":"text","value":" object, e.g. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AokwJUYpAZ"},{"type":"inlineCode","value":"L","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RQx7Khpm91"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D5P0kmyjVJ"}],"key":"IGP8qgo0rK"}],"key":"Jz6bym4CH6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from graphviz import Digraph\n\n\ndef trace(root):\n    # builds a set of all nodes and edges in a graph\n    nodes, edges = set(), set()\n\n    def build(v):\n        if v not in nodes:\n            nodes.add(v)\n            for child in v.prev:\n                edges.add((child, v))\n                build(child)\n\n    build(root)\n    return nodes, edges\n\n\ndef draw(root):\n    dot = Digraph(format=\"svg\", graph_attr={\"rankdir\": \"LR\"})  # LR = left to right\n    nodes, edges = trace(root)\n    for n in nodes:\n        uid = str(id(n))\n        # for any value in the graph, create a rectangular ('record') node for it\n        dot.node(\n            name=uid,\n            label=\"{ %s | data %.4f | grad %.4f}\" % (n.label, n.data, n.grad),\n            shape=\"record\",\n        )\n        if n.op:\n            # if this value is a result of some operation, create an op node for it\n            dot.node(name=uid + n.op, label=n.op)\n            # and connect this node to it\n            dot.edge(uid + n.op, uid)\n    for n1, n2 in edges:\n        # connect n1 to the op node of n2\n        dot.edge(str(id(n1)), str(id(n2)) + n2.op)\n    return dot","key":"TqryNHFCk6"},{"type":"outputs","id":"PleJTZY62YLHrthYLut5K","children":[],"key":"uBMn0hx1xg"}],"key":"kIKXnqdoct"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"draw(L)","visibility":"show","key":"woIS6tuUJq"},{"type":"outputs","id":"sQFehDjDEreSldFSKJWNE","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"image/svg+xml":{"content":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 2.43.0 (0)\n -->\n<!-- Title: %3 Pages: 1 -->\n<svg width=\"1148pt\" height=\"128pt\"\n viewBox=\"0.00 0.00 1148.00 128.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 124)\">\n<title>%3</title>\n<polygon fill=\"white\" stroke=\"transparent\" points=\"-4,4 -4,-124 1144,-124 1144,4 -4,4\"/>\n<!-- 140106809588752 -->\n<g id=\"node1\" class=\"node\">\n<title>140106809588752</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"634,-82.5 634,-118.5 822,-118.5 822,-82.5 634,-82.5\"/>\n<text text-anchor=\"middle\" x=\"644.5\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">f</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"655,-82.5 655,-118.5 \"/>\n<text text-anchor=\"middle\" x=\"697.5\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;2.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"740,-82.5 740,-118.5 \"/>\n<text text-anchor=\"middle\" x=\"781\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106809584272* -->\n<g id=\"node3\" class=\"node\">\n<title>140106809584272*</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"885\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"885\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n</g>\n<!-- 140106809588752&#45;&gt;140106809584272* -->\n<g id=\"edge9\" class=\"edge\">\n<title>140106809588752&#45;&gt;140106809584272*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M822.29,-83.65C831.57,-81.97 840.52,-80.35 848.61,-78.89\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"849.46,-82.3 858.68,-77.07 848.21,-75.41 849.46,-82.3\"/>\n</g>\n<!-- 140106809584272 -->\n<g id=\"node2\" class=\"node\">\n<title>140106809584272</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"948,-54.5 948,-90.5 1140,-90.5 1140,-54.5 948,-54.5\"/>\n<text text-anchor=\"middle\" x=\"960.5\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">L</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"973,-54.5 973,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1015.5\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;8.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1058,-54.5 1058,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1099\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106809584272*&#45;&gt;140106809584272 -->\n<g id=\"edge1\" class=\"edge\">\n<title>140106809584272*&#45;&gt;140106809584272</title>\n<path fill=\"none\" stroke=\"black\" d=\"M912.28,-72.5C919.78,-72.5 928.44,-72.5 937.67,-72.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"937.87,-76 947.87,-72.5 937.87,-69 937.87,-76\"/>\n</g>\n<!-- 140106809082064 -->\n<g id=\"node4\" class=\"node\">\n<title>140106809082064</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"317,-55.5 317,-91.5 507,-91.5 507,-55.5 317,-55.5\"/>\n<text text-anchor=\"middle\" x=\"328.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">d</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"340,-55.5 340,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"382.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"425,-55.5 425,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"466\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106809473424+ -->\n<g id=\"node9\" class=\"node\">\n<title>140106809473424+</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"571\" cy=\"-45.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"571\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n</g>\n<!-- 140106809082064&#45;&gt;140106809473424+ -->\n<g id=\"edge8\" class=\"edge\">\n<title>140106809082064&#45;&gt;140106809473424+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M507.05,-56.73C516.89,-54.97 526.39,-53.28 534.9,-51.76\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"535.52,-55.2 544.75,-50 534.29,-48.31 535.52,-55.2\"/>\n</g>\n<!-- 140106809082064* -->\n<g id=\"node5\" class=\"node\">\n<title>140106809082064*</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"253\" cy=\"-73.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"253\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n</g>\n<!-- 140106809082064*&#45;&gt;140106809082064 -->\n<g id=\"edge2\" class=\"edge\">\n<title>140106809082064*&#45;&gt;140106809082064</title>\n<path fill=\"none\" stroke=\"black\" d=\"M280.28,-73.5C288.05,-73.5 297.08,-73.5 306.68,-73.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"306.88,-77 316.88,-73.5 306.88,-70 306.88,-77\"/>\n</g>\n<!-- 140106809588688 -->\n<g id=\"node6\" class=\"node\">\n<title>140106809588688</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"316,-0.5 316,-36.5 508,-36.5 508,-0.5 316,-0.5\"/>\n<text text-anchor=\"middle\" x=\"327.5\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">c</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"339,-0.5 339,-36.5 \"/>\n<text text-anchor=\"middle\" x=\"382.5\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 10.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"426,-0.5 426,-36.5 \"/>\n<text text-anchor=\"middle\" x=\"467\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106809588688&#45;&gt;140106809473424+ -->\n<g id=\"edge5\" class=\"edge\">\n<title>140106809588688&#45;&gt;140106809473424+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M508.4,-34.91C517.69,-36.5 526.64,-38.04 534.71,-39.43\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"534.32,-42.91 544.76,-41.16 535.5,-36.02 534.32,-42.91\"/>\n</g>\n<!-- 140106809584464 -->\n<g id=\"node7\" class=\"node\">\n<title>140106809584464</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"2.5,-83.5 2.5,-119.5 187.5,-119.5 187.5,-83.5 2.5,-83.5\"/>\n<text text-anchor=\"middle\" x=\"14\" y=\"-97.8\" font-family=\"Times,serif\" font-size=\"14.00\">a</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"25.5,-83.5 25.5,-119.5 \"/>\n<text text-anchor=\"middle\" x=\"65.5\" y=\"-97.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"105.5,-83.5 105.5,-119.5 \"/>\n<text text-anchor=\"middle\" x=\"146.5\" y=\"-97.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106809584464&#45;&gt;140106809082064* -->\n<g id=\"edge7\" class=\"edge\">\n<title>140106809584464&#45;&gt;140106809082064*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M187.65,-85.05C197.94,-83.2 207.91,-81.41 216.81,-79.82\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"217.48,-83.25 226.71,-78.04 216.25,-76.36 217.48,-83.25\"/>\n</g>\n<!-- 140106809473424 -->\n<g id=\"node8\" class=\"node\">\n<title>140106809473424</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"635.5,-27.5 635.5,-63.5 820.5,-63.5 820.5,-27.5 635.5,-27.5\"/>\n<text text-anchor=\"middle\" x=\"647\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">e</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"658.5,-27.5 658.5,-63.5 \"/>\n<text text-anchor=\"middle\" x=\"698.5\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 4.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"738.5,-27.5 738.5,-63.5 \"/>\n<text text-anchor=\"middle\" x=\"779.5\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106809473424&#45;&gt;140106809584272* -->\n<g id=\"edge6\" class=\"edge\">\n<title>140106809473424&#45;&gt;140106809584272*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M820.51,-61.44C830.48,-63.18 840.13,-64.86 848.77,-66.36\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"848.31,-69.84 858.77,-68.1 849.52,-62.94 848.31,-69.84\"/>\n</g>\n<!-- 140106809473424+&#45;&gt;140106809473424 -->\n<g id=\"edge3\" class=\"edge\">\n<title>140106809473424+&#45;&gt;140106809473424</title>\n<path fill=\"none\" stroke=\"black\" d=\"M598.29,-45.5C606.26,-45.5 615.54,-45.5 625.39,-45.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"625.41,-49 635.41,-45.5 625.41,-42 625.41,-49\"/>\n</g>\n<!-- 140106809585104 -->\n<g id=\"node10\" class=\"node\">\n<title>140106809585104</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"0,-28.5 0,-64.5 190,-64.5 190,-28.5 0,-28.5\"/>\n<text text-anchor=\"middle\" x=\"11.5\" y=\"-42.8\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"23,-28.5 23,-64.5 \"/>\n<text text-anchor=\"middle\" x=\"65.5\" y=\"-42.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"108,-28.5 108,-64.5 \"/>\n<text text-anchor=\"middle\" x=\"149\" y=\"-42.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106809585104&#45;&gt;140106809082064* -->\n<g id=\"edge4\" class=\"edge\">\n<title>140106809585104&#45;&gt;140106809082064*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M190.34,-62.83C199.62,-64.44 208.58,-65.99 216.66,-67.38\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"216.27,-70.87 226.72,-69.12 217.46,-63.97 216.27,-70.87\"/>\n</g>\n</g>\n</svg>\n","content_type":"image/svg+xml"},"text/plain":{"content":"<graphviz.graphs.Digraph at 0x7f6d6c1c32d0>","content_type":"text/plain"}}},"children":[],"key":"ueFJeBgJLc"}],"visibility":"show","key":"Zfz0CQVZlq"}],"visibility":"show","key":"TN1GhYbEcg"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The above graph depicts a forward pass. As a reminder, each ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lK5s3ljsPN"},{"type":"inlineCode","value":"grad","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Qu6Q9EtY0I"},{"type":"text","value":" attribute refers to how much each nudge of the value of a node (e.g. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CYj6fUCDBl"},{"type":"inlineCode","value":"c","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gLSqHmb806"},{"type":"text","value":") contributes to the output value ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Rfa61K1sSv"},{"type":"inlineCode","value":"L","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rS5vBGS6AF"},{"type":"text","value":" (i.e. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"w8rXfxxwAD"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial c}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial c}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">c</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"BksNH3sISL"},{"type":"text","value":"). Let’s now, fill in those gradients by doing ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ciwFzRUAd9"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t8ugf0UTHx"}],"key":"iWJZoJfbSI"},{"type":"text","value":" manually. Starting at ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XGuxf8YJUa"},{"type":"inlineCode","value":"L","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OpR0GW2u6X"},{"type":"text","value":" (the end of the graph), we ask: what is the derivative of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"G03krtBYgk"},{"type":"inlineCode","value":"L","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"grjA6He3ws"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Sgu5tp4t41"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cnVK3lNMaV"}],"key":"TBF1UE1CXS"},{"type":"text","value":" itself? Since ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GXtzglS5Fi"},{"type":"inlineMath","value":"f(L) = L","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>L</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">f(L) = L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">L</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span>","key":"MW54cHEOZb"},{"type":"text","value":", it is: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zhMD3mHsii"},{"type":"inlineMath","value":"\\frac{f(L + h) - f(L)}{h} = \\frac{L + h - L}{h}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>L</mi><mo>+</mo><mi>h</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>L</mi><mo stretchy=\"false\">)</mo></mrow><mi>h</mi></mfrac><mo>=</mo><mfrac><mrow><mi>L</mi><mo>+</mo><mi>h</mi><mo>−</mo><mi>L</mi></mrow><mi>h</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{f(L + h) - f(L)}{h} = \\frac{L + h - L}{h}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.355em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.01em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.485em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">L</span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\">h</span><span class=\"mclose mtight\">)</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">L</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2251em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8801em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">L</span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\">h</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">L</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"o3PoHoQvlH"},{"type":"text","value":", ...","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LlpU4HkjwJ"}],"key":"aeyIwenY2f"}],"key":"ddpKNUUEuN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"h = 0.001\nL.grad = ((L.data + h) - L.data) / h\nL.grad","key":"VVZtuXw1Po"},{"type":"outputs","id":"xY5z3e8myaEvcWmWZWCsV","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":14,"metadata":{},"data":{"text/plain":{"content":"1.000000000000334","content_type":"text/plain"}}},"children":[],"key":"uqhsJEozQx"}],"key":"SPgC9SGuWK"}],"key":"E3bjxcvmuW"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"...which of course equals ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"N7EjZCPdKR"},{"type":"text","value":"1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jwyxSMH4Zb"},{"type":"text","value":"! Now, moving backwards in the graph, what about the derivative of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vTWc6uXFUT"},{"type":"inlineCode","value":"L","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mIvPwYKtUF"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nvtQLCvd9g"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"d1450WXASu"}],"key":"nGXLm0eZEX"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ljcNchtBka"},{"type":"inlineCode","value":"e","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hQDrX2XKhG"},{"type":"text","value":" (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EJB3ksE3SA"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial e}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>e</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial e}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">e</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"fxqNPXh05q"},{"type":"text","value":"), for example? Let’s do the same and find out. Since ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VfoyvRgC2Y"},{"type":"inlineMath","value":"L(e) = e \\cdot f \\Longrightarrow \\dfrac{\\partial L}{\\partial e} = \\frac{L(e + h) - L(e)}{h} = \\frac{(e + h) \\cdot f - e \\cdot f}{h} = \\frac{e \\cdot f + h \\cdot f - e \\cdot f}{h} = f","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><mi>e</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>e</mi><mo>⋅</mo><mi>f</mi><mo>⟹</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>e</mi></mrow></mfrac></mstyle><mo>=</mo><mfrac><mrow><mi>L</mi><mo stretchy=\"false\">(</mo><mi>e</mi><mo>+</mo><mi>h</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>L</mi><mo stretchy=\"false\">(</mo><mi>e</mi><mo stretchy=\"false\">)</mo></mrow><mi>h</mi></mfrac><mo>=</mo><mfrac><mrow><mo stretchy=\"false\">(</mo><mi>e</mi><mo>+</mo><mi>h</mi><mo stretchy=\"false\">)</mo><mo>⋅</mo><mi>f</mi><mo>−</mo><mi>e</mi><mo>⋅</mo><mi>f</mi></mrow><mi>h</mi></mfrac><mo>=</mo><mfrac><mrow><mi>e</mi><mo>⋅</mo><mi>f</mi><mo>+</mo><mi>h</mi><mo>⋅</mo><mi>f</mi><mo>−</mo><mi>e</mi><mo>⋅</mo><mi>f</mi></mrow><mi>h</mi></mfrac><mo>=</mo><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">L(e) = e \\cdot f \\Longrightarrow \\dfrac{\\partial L}{\\partial e} = \\frac{L(e + h) - L(e)}{h} = \\frac{(e + h) \\cdot f - e \\cdot f}{h} = \\frac{e \\cdot f + h \\cdot f - e \\cdot f}{h} = f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">e</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⟹</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">e</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.355em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.01em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.485em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">L</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\">h</span><span class=\"mclose mtight\">)</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">L</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.355em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.01em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.485em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\">h</span><span class=\"mclose mtight\">)</span><span class=\"mbin mtight\">⋅</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mbin mtight\">⋅</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2772em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9322em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4461em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"mbin mtight\">⋅</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\">h</span><span class=\"mbin mtight\">⋅</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mbin mtight\">⋅</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10764em;\">f</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"U4G2X2Dwx8"},{"type":"text","value":". Similarly, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BUWlbCKQ46"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial f} = e","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>f</mi></mrow></mfrac></mstyle><mo>=</mo><mi>e</mi></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial f} = e</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">e</span></span></span></span>","key":"aeHdgqtLEr"},{"type":"text","value":". Therefore:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VGOEbP7WCI"}],"key":"zTdTvib087"}],"key":"w9bQIZzTzW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"e.grad = f.data\nf.grad = e.data\nprint(e.grad)\nprint(f.grad)","key":"axxhWyvH7r"},{"type":"outputs","id":"BOhPOSiMFJemOpqmud2wg","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"-2.0\n-7.0\n"},"children":[],"key":"lsaxm6V0k0"}],"key":"ECb3LTgodG"}],"key":"h5ROFCnaoN"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Now, we will find ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NkNbfGF80D"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial c}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial c}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">c</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"lxd0O4QvkC"},{"type":"text","value":", which basically constitutes the crux of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FuFg3ZI4Xz"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OJNwcFNmWb"}],"key":"nxtG8gxXCB"},{"type":"text","value":" for this example and the most important node to understand. So pay attention!\nHow ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A8h7YIFPUY"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"do","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GUxFmxOn3L"}],"key":"UR69mmVeZx"},{"type":"text","value":" we find the derivative of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SIsung8KVS"},{"type":"inlineCode","value":"L","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lGoLxf7P9f"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KyenFi2PLR"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MRQY5GmheH"}],"key":"JsgcEZyIUi"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ptvSiPn3rM"},{"type":"inlineCode","value":"c","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M5lOzcILCz"},{"type":"text","value":"? Purely intuitively, just by knowing the sensitivity of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O5tqIg6MR6"},{"type":"inlineCode","value":"L","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LUrNfDnTzn"},{"type":"text","value":" to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xJB8iZVHZj"},{"type":"inlineCode","value":"e","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tNTY3Rocth"},{"type":"text","value":" (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z2UAslD7b4"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial e}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>e</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial e}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">e</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"N4DVconugd"},{"type":"text","value":") and how ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LNh4i4x4in"},{"type":"inlineCode","value":"e","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mIp0Py4bOg"},{"type":"text","value":" is sensitive to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ylXoCfDvuj"},{"type":"inlineCode","value":"c","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QjVPNOkkse"},{"type":"text","value":" (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cv1G6MhUrs"},{"type":"inlineMath","value":"\\dfrac{\\partial e}{\\partial c}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>e</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial e}{\\partial c}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">c</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">e</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"EODfe7HHSv"},{"type":"text","value":"), we should be able to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XcJbN7G7qL"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"somehow","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zMQbTsJBPY"}],"key":"m5d0OYGE3U"},{"type":"text","value":" put this information together and get our result. Since we know the former, we just need to find the latter: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D8C7HoNCMw"},{"type":"inlineMath","value":"e(c) = c + d","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>e</mi><mo stretchy=\"false\">(</mo><mi>c</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>c</mi><mo>+</mo><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">e(c) = c + d</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">e</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">c</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"my3UdRabbm"},{"type":"text","value":" and so ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jP6B4zkfzd"},{"type":"inlineMath","value":"\\dfrac{\\partial e}{\\partial c} = \\frac{e(c + h) - e(c)}{h} = \\frac{(c + h + d) - (c + d)}{h} = 1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>e</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi></mrow></mfrac></mstyle><mo>=</mo><mfrac><mrow><mi>e</mi><mo stretchy=\"false\">(</mo><mi>c</mi><mo>+</mo><mi>h</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>e</mi><mo stretchy=\"false\">(</mo><mi>c</mi><mo stretchy=\"false\">)</mo></mrow><mi>h</mi></mfrac><mo>=</mo><mfrac><mrow><mo stretchy=\"false\">(</mo><mi>c</mi><mo>+</mo><mi>h</mi><mo>+</mo><mi>d</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mo stretchy=\"false\">(</mo><mi>c</mi><mo>+</mo><mi>d</mi><mo stretchy=\"false\">)</mo></mrow><mi>h</mi></mfrac><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial e}{\\partial c} = \\frac{e(c + h) - e(c)}{h} = \\frac{(c + h + d) - (c + d)}{h} = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">c</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">e</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.355em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.01em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.485em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">c</span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\">h</span><span class=\"mclose mtight\">)</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">e</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">c</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.355em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.01em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.485em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">c</span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\">h</span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mclose mtight\">)</span><span class=\"mbin mtight\">−</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">c</span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"EhAcaQmmrr"},{"type":"text","value":". And similarly: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pu5HoYKnsU"},{"type":"inlineMath","value":"\\dfrac{\\partial e}{\\partial d} = 1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>e</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>d</mi></mrow></mfrac></mstyle><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial e}{\\partial d} = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">d</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">e</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"jnuQidD1Ok"},{"type":"text","value":". That “","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yXUQUq4ISv"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"somehow","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j4beqtgB9m"}],"key":"fn9fRteeMr"},{"type":"text","value":"” is the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BuBEYegoTx"},{"type":"link","url":"https://en.wikipedia.org/wiki/Chain_rule","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"chain rule","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HJrpLgZKLl"}],"urlSource":"https://en.wikipedia.org/wiki/Chain_rule","data":{"page":"Chain_rule","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"PbrUqMALF2"},{"type":"text","value":", according to which: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wHWZniRHE7"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial c} = \\dfrac{\\partial L}{\\partial e} \\cdot \\dfrac{\\partial e}{\\partial c}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>e</mi></mrow></mfrac></mstyle><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>e</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial c} = \\dfrac{\\partial L}{\\partial e} \\cdot \\dfrac{\\partial e}{\\partial c}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">c</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">e</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">c</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">e</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"D6gVBCTB92"},{"type":"text","value":". For us, this means:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bNBmvGoIjR"}],"key":"fOlKljHjjU"}],"key":"Pz6RtfBpiG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"c.grad = e.grad * 1.0\nc.grad","key":"ZKLVpu44U1"},{"type":"outputs","id":"8LmTZ-Tb1pozvH3gsZcDD","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"-2.0","content_type":"text/plain"}}},"children":[],"key":"ZaFC3rcrhI"}],"key":"S8Vh9ci6FZ"}],"key":"xyfEc6ZWWJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To sum up:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fk5iOBCpMI"}],"key":"ajrr5UDjHB"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"we want ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"XTica8DkQc"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial c}","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial c}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">c</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"AL7AV6oliH"}],"key":"FHVtR9m7Gm"}],"key":"ZQJtQ9CkHq"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"we know ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oFa55MQylq"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial e}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>e</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial e}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">e</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"Yyi6JWMis9"}],"key":"smDYvZWfcX"}],"key":"L650smd8OF"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"we know ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"rhJ5Yxo85f"},{"type":"inlineMath","value":"\\dfrac{\\partial e}{\\partial c}","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>e</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial e}{\\partial c}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">c</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">e</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"ht3uzGydeB"}],"key":"SjUMhRuoCN"}],"key":"GIzzqxm0Sy"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"we apply the chain rule: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"s9Mlot8A9G"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial c} = \\dfrac{\\partial L}{\\partial e} \\cdot \\dfrac{\\partial e}{\\partial c} = \\dfrac{\\partial L}{\\partial e} \\cdot 1 = \\dfrac{\\partial L}{\\partial e}","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>e</mi></mrow></mfrac></mstyle><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>e</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>e</mi></mrow></mfrac></mstyle><mo>⋅</mo><mn>1</mn><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>e</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial c} = \\dfrac{\\partial L}{\\partial e} \\cdot \\dfrac{\\partial e}{\\partial c} = \\dfrac{\\partial L}{\\partial e} \\cdot 1 = \\dfrac{\\partial L}{\\partial e}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">c</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">e</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">c</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">e</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">e</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">e</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"ELfYEpFoSS"}],"key":"teyzyJfUCG"}],"key":"cSAfnUf73b"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"similarly: ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"lssxIFDyhY"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial d} = \\dfrac{\\partial L}{\\partial e} \\cdot \\dfrac{\\partial e}{\\partial d} = \\dfrac{\\partial L}{\\partial e} \\cdot 1 = \\dfrac{\\partial L}{\\partial e}","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>d</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>e</mi></mrow></mfrac></mstyle><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>e</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>d</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>e</mi></mrow></mfrac></mstyle><mo>⋅</mo><mn>1</mn><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>e</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial d} = \\dfrac{\\partial L}{\\partial e} \\cdot \\dfrac{\\partial e}{\\partial d} = \\dfrac{\\partial L}{\\partial e} \\cdot 1 = \\dfrac{\\partial L}{\\partial e}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">d</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">e</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">d</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">e</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">e</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">e</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"WEmKONSbih"}],"key":"WQtUYIFJLE"}],"key":"QVHdd3ejiy"}],"key":"H6Iwe7WM5Z"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Easy! Notice how ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ZRUEAi4zz8"},{"type":"inlineMath","value":"\\dfrac{\\partial e}{\\partial c} = \\dfrac{\\partial e}{\\partial d} = 1","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>e</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>e</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>d</mi></mrow></mfrac></mstyle><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial e}{\\partial c} = \\dfrac{\\partial e}{\\partial d} = 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">c</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">e</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">d</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">e</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"Rr8WP6rMn1"},{"type":"text","value":". This equality verifies the fact that the addition operator (","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"DQvqvnRa3l"},{"type":"inlineCode","value":"+","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"twNr7E7Vti"},{"type":"text","value":") just acts as a router, merely distributing the derivative of the result (e.g. ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"J4mHKAUL2T"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial e}","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>e</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial e}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">e</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"YXWcWnxF5l"},{"type":"text","value":") backwards, through all the children nodes (e.g. ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"arPpqvACVj"},{"type":"inlineCode","value":"c","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"D5nms8yDJh"},{"type":"text","value":" and ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"np7G95Xlbh"},{"type":"inlineCode","value":"d","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"lFvZ8wf4IH"},{"type":"text","value":"), unperturbed.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"oEhUbNXB96"}],"key":"iq7F0WXZOW"}],"key":"vGRxl5WyAs"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To complete this session of manual ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WT1dUq4c1l"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KK2osqRZQ9"}],"key":"MHq0XzBl5p"},{"type":"text","value":", we are going to recurse this process and re-apply the chain rule all the way back to the input nodes, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZGM4A8WJoN"},{"type":"inlineCode","value":"a","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t2qDDHqDF2"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JGRKhUoo06"},{"type":"inlineCode","value":"b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tQIRTEja5O"},{"type":"text","value":". Thus, we are looking for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r0PD9LsYNI"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial a}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>a</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial a}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">a</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"RluAU3KM1N"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O7iOdxiQvG"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>b</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">b</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"loF7ZDtSZu"},{"type":"text","value":", meaning:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tS44MIpIbx"}],"key":"TZydZjDAM2"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial a} = \\dfrac{\\partial L}{\\partial d} \\cdot \\dfrac{\\partial d}{\\partial a}","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>a</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>d</mi></mrow></mfrac></mstyle><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>d</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>a</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial a} = \\dfrac{\\partial L}{\\partial d} \\cdot \\dfrac{\\partial d}{\\partial a}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">a</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">d</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">a</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"y01VjUypLz"}],"key":"nIHQZovi4T"}],"key":"C0KijCLJVA"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial b} = \\dfrac{\\partial L}{\\partial d} \\cdot \\dfrac{\\partial d}{\\partial b}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>b</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>d</mi></mrow></mfrac></mstyle><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>d</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>b</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial b} = \\dfrac{\\partial L}{\\partial d} \\cdot \\dfrac{\\partial d}{\\partial b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">b</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">d</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">b</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"CsB939EgZM"}],"key":"dJZOkUFMms"}],"key":"ggk5jS0WTH"}],"key":"MNDDzAPZRs"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We already know that:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"AA2D7fA8X5"}],"key":"wDGWpqEY0I"}],"key":"zq9fzGUj2p"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f'dL/dd = dL/de = {e.grad}'","key":"nlmaf6E1jD"},{"type":"outputs","id":"_TwyFDgNAQawlcEGngs7W","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/plain":{"content":"'dL/dd = dL/de = -2.0'","content_type":"text/plain"}}},"children":[],"key":"qk5fw8Aify"}],"key":"DBj0BCYuKK"}],"key":"FAeHRTGg3R"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"But, what about ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ETCNQF69fi"},{"type":"inlineMath","value":"\\dfrac{\\partial d}{\\partial a}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>d</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>a</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial d}{\\partial a}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">a</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"IcrH9W9VO6"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UKkhKKmm7x"},{"type":"inlineMath","value":"\\dfrac{\\partial d}{\\partial b}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>d</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>b</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial d}{\\partial b}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">b</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"v92QSne0Sq"},{"type":"text","value":"? Let’s derive them, the same way we did with ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BShhEmVTN7"},{"type":"inlineMath","value":"\\dfrac{\\partial e}{\\partial c}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>e</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial e}{\\partial c}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">c</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">e</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"RE4MnxTKqb"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mfpW7S95nZ"}],"key":"D0MLoE2mLK"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\dfrac{\\partial d}{\\partial a} = \\frac{d(a + h) - d(a)}{h} = \\frac{(a + h) \\cdot b - a \\cdot b}{h} = b","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>d</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>a</mi></mrow></mfrac></mstyle><mo>=</mo><mfrac><mrow><mi>d</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo>+</mo><mi>h</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>d</mi><mo stretchy=\"false\">(</mo><mi>a</mi><mo stretchy=\"false\">)</mo></mrow><mi>h</mi></mfrac><mo>=</mo><mfrac><mrow><mo stretchy=\"false\">(</mo><mi>a</mi><mo>+</mo><mi>h</mi><mo stretchy=\"false\">)</mo><mo>⋅</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo>⋅</mo><mi>b</mi></mrow><mi>h</mi></mfrac><mo>=</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial d}{\\partial a} = \\frac{d(a + h) - d(a)}{h} = \\frac{(a + h) \\cdot b - a \\cdot b}{h} = b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">a</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.355em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.01em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.485em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">d</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\">h</span><span class=\"mclose mtight\">)</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">d</span><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.355em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.01em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">h</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.485em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mbin mtight\">+</span><span class=\"mord mathnormal mtight\">h</span><span class=\"mclose mtight\">)</span><span class=\"mbin mtight\">⋅</span><span class=\"mord mathnormal mtight\">b</span><span class=\"mbin mtight\">−</span><span class=\"mord mathnormal mtight\">a</span><span class=\"mbin mtight\">⋅</span><span class=\"mord mathnormal mtight\">b</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"zKkH4s5Xkj"}],"key":"F7nwD7UqDj"}],"key":"HKjdAEXRWE"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\dfrac{\\partial d}{\\partial b} = a","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>d</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>b</mi></mrow></mfrac></mstyle><mo>=</mo><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial d}{\\partial b} = a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">b</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"roEeEqlq3T"}],"key":"WzC9HYJfFo"}],"key":"NQhA4YUOZE"}],"key":"EDJjLduXAE"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Therefore:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xoZlHOZwGx"}],"key":"H9ErtNIFvF"}],"key":"lK8hn6LctC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"a.grad = e.grad * b.data\nb.grad = e.grad * a.data\nprint(a.grad)\nprint(b.grad)","key":"vT6RyY4pFK"},{"type":"outputs","id":"bZ5s4Xe0iGTaGA3T2KvPP","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"6.0\n-4.0\n"},"children":[],"key":"D1YuKVXyBW"}],"key":"Q41taWcBR6"}],"key":"GDwv0FypqF"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If we re-draw our computational graph, we get:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W3LM1tV00r"}],"key":"fIcJhszMR3"}],"key":"db5TUEKB6C"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"draw(L)","key":"UKwUtrIaUe"},{"type":"outputs","id":"IxshiyS9WBWeNO6bA_mSK","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"image/svg+xml":{"content":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 2.43.0 (0)\n -->\n<!-- Title: %3 Pages: 1 -->\n<svg width=\"1160pt\" height=\"128pt\"\n viewBox=\"0.00 0.00 1160.00 128.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 124)\">\n<title>%3</title>\n<polygon fill=\"white\" stroke=\"transparent\" points=\"-4,4 -4,-124 1156,-124 1156,4 -4,4\"/>\n<!-- 140106809588752 -->\n<g id=\"node1\" class=\"node\">\n<title>140106809588752</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"642,-82.5 642,-118.5 834,-118.5 834,-82.5 642,-82.5\"/>\n<text text-anchor=\"middle\" x=\"652.5\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">f</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"663,-82.5 663,-118.5 \"/>\n<text text-anchor=\"middle\" x=\"705.5\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;2.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"748,-82.5 748,-118.5 \"/>\n<text text-anchor=\"middle\" x=\"791\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;7.0000</text>\n</g>\n<!-- 140106809584272* -->\n<g id=\"node3\" class=\"node\">\n<title>140106809584272*</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"897\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"897\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n</g>\n<!-- 140106809588752&#45;&gt;140106809584272* -->\n<g id=\"edge9\" class=\"edge\">\n<title>140106809588752&#45;&gt;140106809584272*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M834.4,-83.49C843.69,-81.83 852.64,-80.23 860.71,-78.79\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"861.53,-82.2 870.76,-77 860.31,-75.31 861.53,-82.2\"/>\n</g>\n<!-- 140106809584272 -->\n<g id=\"node2\" class=\"node\">\n<title>140106809584272</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"960,-54.5 960,-90.5 1152,-90.5 1152,-54.5 960,-54.5\"/>\n<text text-anchor=\"middle\" x=\"972.5\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">L</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"985,-54.5 985,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1027.5\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;8.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1070,-54.5 1070,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1111\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n</g>\n<!-- 140106809584272*&#45;&gt;140106809584272 -->\n<g id=\"edge1\" class=\"edge\">\n<title>140106809584272*&#45;&gt;140106809584272</title>\n<path fill=\"none\" stroke=\"black\" d=\"M924.28,-72.5C931.78,-72.5 940.44,-72.5 949.67,-72.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"949.87,-76 959.87,-72.5 949.87,-69 949.87,-76\"/>\n</g>\n<!-- 140106809082064 -->\n<g id=\"node4\" class=\"node\">\n<title>140106809082064</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"323,-55.5 323,-91.5 513,-91.5 513,-55.5 323,-55.5\"/>\n<text text-anchor=\"middle\" x=\"334.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">d</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"346,-55.5 346,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"388.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"431,-55.5 431,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"472\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106809473424+ -->\n<g id=\"node9\" class=\"node\">\n<title>140106809473424+</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"579\" cy=\"-45.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"579\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n</g>\n<!-- 140106809082064&#45;&gt;140106809473424+ -->\n<g id=\"edge8\" class=\"edge\">\n<title>140106809082064&#45;&gt;140106809473424+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M513.33,-56.89C523.71,-55.06 533.74,-53.29 542.68,-51.72\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"543.39,-55.15 552.63,-49.97 542.17,-48.26 543.39,-55.15\"/>\n</g>\n<!-- 140106809082064* -->\n<g id=\"node5\" class=\"node\">\n<title>140106809082064*</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"257\" cy=\"-73.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"257\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n</g>\n<!-- 140106809082064*&#45;&gt;140106809082064 -->\n<g id=\"edge2\" class=\"edge\">\n<title>140106809082064*&#45;&gt;140106809082064</title>\n<path fill=\"none\" stroke=\"black\" d=\"M284.26,-73.5C292.54,-73.5 302.26,-73.5 312.6,-73.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"312.69,-77 322.69,-73.5 312.69,-70 312.69,-77\"/>\n</g>\n<!-- 140106809588688 -->\n<g id=\"node6\" class=\"node\">\n<title>140106809588688</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"320,-0.5 320,-36.5 516,-36.5 516,-0.5 320,-0.5\"/>\n<text text-anchor=\"middle\" x=\"331.5\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">c</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"343,-0.5 343,-36.5 \"/>\n<text text-anchor=\"middle\" x=\"386.5\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 10.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"430,-0.5 430,-36.5 \"/>\n<text text-anchor=\"middle\" x=\"473\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;2.0000</text>\n</g>\n<!-- 140106809588688&#45;&gt;140106809473424+ -->\n<g id=\"edge5\" class=\"edge\">\n<title>140106809588688&#45;&gt;140106809473424+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M516.07,-34.98C525.42,-36.57 534.43,-38.1 542.55,-39.48\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"542.21,-42.97 552.65,-41.2 543.38,-36.07 542.21,-42.97\"/>\n</g>\n<!-- 140106809584464 -->\n<g id=\"node7\" class=\"node\">\n<title>140106809584464</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"4.5,-83.5 4.5,-119.5 189.5,-119.5 189.5,-83.5 4.5,-83.5\"/>\n<text text-anchor=\"middle\" x=\"16\" y=\"-97.8\" font-family=\"Times,serif\" font-size=\"14.00\">a</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"27.5,-83.5 27.5,-119.5 \"/>\n<text text-anchor=\"middle\" x=\"67.5\" y=\"-97.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"107.5,-83.5 107.5,-119.5 \"/>\n<text text-anchor=\"middle\" x=\"148.5\" y=\"-97.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 6.0000</text>\n</g>\n<!-- 140106809584464&#45;&gt;140106809082064* -->\n<g id=\"edge7\" class=\"edge\">\n<title>140106809584464&#45;&gt;140106809082064*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M189.91,-85.21C200.76,-83.29 211.28,-81.43 220.61,-79.77\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"221.37,-83.19 230.6,-78 220.15,-76.3 221.37,-83.19\"/>\n</g>\n<!-- 140106809473424 -->\n<g id=\"node8\" class=\"node\">\n<title>140106809473424</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"645.5,-27.5 645.5,-63.5 830.5,-63.5 830.5,-27.5 645.5,-27.5\"/>\n<text text-anchor=\"middle\" x=\"657\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">e</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"668.5,-27.5 668.5,-63.5 \"/>\n<text text-anchor=\"middle\" x=\"708.5\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 4.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"748.5,-27.5 748.5,-63.5 \"/>\n<text text-anchor=\"middle\" x=\"789.5\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106809473424&#45;&gt;140106809584272* -->\n<g id=\"edge6\" class=\"edge\">\n<title>140106809473424&#45;&gt;140106809584272*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M830.78,-61.28C841.3,-63.09 851.48,-64.84 860.56,-66.4\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"860.21,-69.9 870.65,-68.14 861.39,-63 860.21,-69.9\"/>\n</g>\n<!-- 140106809473424+&#45;&gt;140106809473424 -->\n<g id=\"edge3\" class=\"edge\">\n<title>140106809473424+&#45;&gt;140106809473424</title>\n<path fill=\"none\" stroke=\"black\" d=\"M606.28,-45.5C614.68,-45.5 624.54,-45.5 635.02,-45.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"635.22,-49 645.22,-45.5 635.22,-42 635.22,-49\"/>\n</g>\n<!-- 140106809585104 -->\n<g id=\"node10\" class=\"node\">\n<title>140106809585104</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"0,-28.5 0,-64.5 194,-64.5 194,-28.5 0,-28.5\"/>\n<text text-anchor=\"middle\" x=\"11.5\" y=\"-42.8\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"23,-28.5 23,-64.5 \"/>\n<text text-anchor=\"middle\" x=\"65.5\" y=\"-42.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"108,-28.5 108,-64.5 \"/>\n<text text-anchor=\"middle\" x=\"151\" y=\"-42.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;4.0000</text>\n</g>\n<!-- 140106809585104&#45;&gt;140106809082064* -->\n<g id=\"edge4\" class=\"edge\">\n<title>140106809585104&#45;&gt;140106809082064*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M194.01,-62.91C203.35,-64.5 212.37,-66.04 220.49,-67.43\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"220.16,-70.93 230.6,-69.16 221.34,-64.03 220.16,-70.93\"/>\n</g>\n</g>\n</svg>\n","content_type":"image/svg+xml"},"text/plain":{"content":"<graphviz.graphs.Digraph at 0x7f6d289dbd10>","content_type":"text/plain"}}},"children":[],"key":"rTnSYdUuYm"}],"key":"WdmGgSFFnE"}],"key":"GszTFVQO26"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And that’s what ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kURBvd7gF9"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XNgAPEqP7j"}],"key":"nBGwc6WfJM"},{"type":"text","value":" is! Just the recursive application of the chain rule backwards through the computational graph for calculating the gradient of a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ogQK6p1gjJ"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EDs7ndWBDb"}],"key":"gwpaxqTnYK"},{"type":"text","value":" value (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F63SJvQZuR"},{"type":"inlineCode","value":"L","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yW6H34SzHW"},{"type":"text","value":") ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"unKE8beHTn"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aTo1QpgqQP"}],"key":"GeBkQtTATP"},{"type":"text","value":" all other values that produced it (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GeDFCPiqE3"},{"type":"inlineCode","value":"a","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"scFlCYjWSV"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aezbmGRJri"},{"type":"inlineCode","value":"b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Tid1qEWpdR"},{"type":"text","value":", etc.). The purpose being, to be able to use the gradient values to nudge the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IHninUC5nn"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X8bpHWQFhR"}],"key":"mt70JUiyPR"},{"type":"text","value":" value: optimization. This process goes as follows:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y6PWzm9rgx"}],"key":"X4nmsMIY9e"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"to ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"FdWstsTz07"},{"type":"emphasis","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"increase","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ko3EJMYOGz"}],"key":"bwfAnMQCbb"},{"type":"text","value":" ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"wQVJOcRllK"},{"type":"inlineCode","value":"L","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"I0fLQbqSWJ"},{"type":"text","value":", let each value follow the gradient in the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"J0Ef1B4lCO"},{"type":"emphasis","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"positive","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"FMToWz08yA"}],"key":"ecVI5taNeW"},{"type":"text","value":" direction","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"jm1q3HgSOA"}],"key":"PKQmZYPI0z"}],"key":"TgAUgj7rdn"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NP29jAwftn"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"decrease","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"d0cO55dpAD"}],"key":"SWrB2pM4Tc"},{"type":"text","value":" ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AZ5dUuO805"},{"type":"inlineCode","value":"L","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IvkbdYlLPU"},{"type":"text","value":", let each value follow the gradient in the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OsSW4mYwKc"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"negative","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VUNC6Ni2D5"}],"key":"fHFTnj36az"},{"type":"text","value":" direction","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RrvBxeQWUv"}],"key":"VGYdAtERLh"}],"key":"gi5jqc5XFW"}],"key":"zLNwt5QJpI"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Running the following example should increase the value of ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"OuCGghVhpS"},{"type":"inlineCode","value":"L","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dusQwxiohN"},{"type":"text","value":":","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dTv7gzJ1yb"}],"key":"LXP84KOqui"}],"key":"lQJxt45R3z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"Lold = L.data\na.data += 0.01 * a.grad\nb.data += 0.01 * b.grad\nc.data += 0.01 * c.grad\nd.data += 0.01 * d.grad\ne.data += 0.01 * e.grad\nf.data += 0.01 * f.grad\nL = forward_pass()\nprint(f\"old L: {Lold}\")\nprint(f\"new L: {L.data}\")","key":"ZZWnwSdcKT"},{"type":"outputs","id":"2OIwoK8EBeTS_Ps3swc1l","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"old L: -8.0\nnew L: -7.695431999999999\n"},"children":[],"key":"si8k4RAudz"}],"key":"m0m2Z4Zw1x"}],"key":"ClipL4bSfU"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"You just learned how to apply one optimization step! Optimization is fundamental when it comes to training ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LbfrasnV7G"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pFo4Q4KSKo"}],"key":"WH4r4YX2ze"},{"type":"text","value":"s, as you will see... Eventually we want to build up a level of understanding for training multilayer perceptrons (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RYPFL7DyRQ"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"mlp","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"duV9MhtV2a"}],"key":"GCmwhBeqgh"},{"type":"text","value":"s), as they are called.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EdCeIZPG1E"}],"key":"XzRVKggWMX"}],"key":"cljj175vU2"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Multilayer perceptron example","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JBcVcpNB3U"}],"identifier":"multilayer-perceptron-example","label":"Multilayer perceptron example","html_id":"multilayer-perceptron-example","implicit":true,"key":"ThFn91a8pE"}],"key":"C8BnUpU0J9"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from IPython.display import Image, display\n\ndisplay(Image(filename=\"mlp.jpeg\"))","visibility":"show","key":"k0ENldfQg5"},{"type":"outputs","id":"LANLM7FVL7WrHZgTygwD_","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/jpeg":{"content_type":"image/jpeg","hash":"7d371bcd7acbaf2830d28c2b8c14eac5","path":"/build/7d371bcd7acbaf2830d28c2b8c14eac5.jpeg"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}},"children":[],"key":"BC2Pdl4IuA"}],"visibility":"show","key":"F2Bfd4dYhY"}],"visibility":"show","key":"jEMSt1CsvS"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To gain some intuition necessary for training ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nDlGDLXooH"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"mlp","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fyOibtddJQ"}],"key":"sDPopsiX2t"},{"type":"text","value":"s, let’s first explore an example of doing ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q2JIwsIwMi"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D1SqGNvbwG"}],"key":"UT5m9aU6LQ"},{"type":"text","value":" through a simplified neuron.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gxNguBqYke"}],"key":"OqiFoE6xKu"}],"key":"pfdRpod9AH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"display(Image(filename=\"neuron.jpeg\"))","key":"DkWVciq0rY"},{"type":"outputs","id":"SZ-oSecjAheMt3GgEoL2I","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/jpeg":{"content_type":"image/jpeg","hash":"3e723a699519aa5224de6674d47b6b0b","path":"/build/3e723a699519aa5224de6674d47b6b0b.jpeg"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}},"children":[],"key":"WgSC1HStjD"}],"key":"LsEVwWTZdZ"}],"key":"KhUrmN3HxY"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Such a neuron:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vBbRgEh1hM"}],"key":"ZnOiMBZxIJ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"receives input ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"doLNcHhZr7"},{"type":"inlineMath","value":"w_i x_i","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">w_i x_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"PhHcC8E8bI"},{"type":"text","value":" (output ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"PFBPpqEYEc"},{"type":"inlineMath","value":"x_i","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">x_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"kCniyeZgtX"},{"type":"text","value":" of incoming neuron multiplied by a synaptic weights ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"phIJxhrqQ6"},{"type":"inlineMath","value":"w_i","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">w_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"r3xZhd1Wl9"},{"type":"text","value":")","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"wWo3b0p34w"}],"key":"p4LjUhND61"}],"key":"AV4EnjGZcN"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"summates those inputs ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"zd2QD6xikm"},{"type":"inlineMath","value":"\\displaystyle \\sum_i w_i x_i","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle scriptlevel=\"0\" displaystyle=\"true\"><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub></mstyle></mrow><annotation encoding=\"application/x-tex\">\\displaystyle \\sum_i w_i x_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.3277em;vertical-align:-1.2777em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"LhP7NBWqSk"},{"type":"text","value":" at the cell body","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qe6875jnZi"}],"key":"i6TKXHgmEL"}],"key":"Mo0p5Sl3fU"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"adds a bias ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Pz13bTbIIy"},{"type":"inlineMath","value":"b","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"ZJODKU0OuD"}],"key":"qELZtIS7ch"}],"key":"e8rgLkgWuS"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"passes the result through an activation function ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"rUA2KGv0KB"},{"type":"inlineMath","value":"f","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"bLIb8vYXr3"}],"key":"x3eTuwvz8u"}],"key":"uIU0VHv3we"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"outputs the value ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"hR7aUsQVRl"},{"type":"inlineMath","value":"f\\bigg(\\displaystyle \\sum_i w_i x_i + b\\bigg)","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi><mo fence=\"false\" stretchy=\"true\" minsize=\"2.4em\" maxsize=\"2.4em\">(</mo><mstyle scriptlevel=\"0\" displaystyle=\"true\"><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo fence=\"false\" stretchy=\"true\" minsize=\"2.4em\" maxsize=\"2.4em\">)</mo></mstyle></mrow><annotation encoding=\"application/x-tex\">f\\bigg(\\displaystyle \\sum_i w_i x_i + b\\bigg)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.7277em;vertical-align:-1.2777em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord\"><span class=\"delimsizing size3\">(</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.05em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mord\"><span class=\"delimsizing size3\">)</span></span></span></span></span>","key":"p9wFI4wq5o"}],"key":"LxIRSSqE4l"}],"key":"PMERBhI2Ka"}],"key":"iWdn3mK3CV"}],"key":"M6lctI8ExZ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"An activation function ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IJvE0MeTFq"},{"type":"inlineMath","value":"f","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>f</mi></mrow><annotation encoding=\"application/x-tex\">f</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span></span></span></span>","key":"HO5p8x5SkR"},{"type":"text","value":" is usually represented by a squashing function such as ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Pjb7kFX10o"},{"type":"inlineMath","value":"\\tanh","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>tanh</mi><mo>⁡</mo></mrow><annotation encoding=\"application/x-tex\">\\tanh</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mop\">tanh</span></span></span></span>","key":"VIscXw0GZF"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nw73MUsNVC"}],"key":"OkaxeEwkqD"}],"key":"mIbPmpb34x"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure()\nplt.plot(np.arange(-5, 5, 0.2), np.tanh(np.arange(-5, 5, 0.2)))\nplt.grid();","key":"i8THvIRyF6"},{"type":"outputs","id":"4769PEeHvCoi_ExYZeub6","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/vnd.jupyter.widget-view+json":{"content":"{\"model_id\":\"bf89e66d55fd4f949aee777ade6b7e24\",\"version_major\":2,\"version_minor\":0}","content_type":"application/vnd.jupyter.widget-view+json"},"image/png":{"content_type":"image/png","hash":"443972d76d8ffbb0faa3bbdb808ee96e","path":"/build/443972d76d8ffbb0faa3bbdb808ee96e.png"},"text/html":{"content_type":"text/html","hash":"30c9582519ee6940ecddddd811d375ad","path":"/build/30c9582519ee6940ecddddd811d375ad.html"},"text/plain":{"content":"Canvas(toolbar=Toolbar(toolitems=[('Home', 'Reset original view', 'home', 'home'), ('Back', 'Back to previous …","content_type":"text/plain"}}},"children":[],"key":"cCIkETffpI"}],"key":"TJOLV2iXrL"}],"key":"JuZZhSdgpA"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s extend our ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vd8Qja42m0"},{"type":"inlineCode","value":"Value","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DA851YSpwY"},{"type":"text","value":" class to incorporate this ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QkbRqYltzi"},{"type":"inlineCode","value":"tanh","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t5yJfx1ox9"},{"type":"text","value":" activation function:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V1uAtuRp79"}],"key":"kWXukqMomm"}],"key":"vnuEwGSdhz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"class Value(Value):\n    def tanh(self):\n        return self.__class__(\n            data=math.tanh(self.data),\n            prev=(self,),\n            op=\"tanh\",\n        )","key":"Kq9Tmpx625"},{"type":"outputs","id":"JgdiJI5Pd5r9YmjXqxanB","children":[],"key":"mS01rYLXmH"}],"key":"FLVDNbIeWC"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To simulate the functionality of this neuron:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pk5cyaxNRm"}],"key":"mtyLsqkhP4"}],"key":"nIHSGcbl3M"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def activate_neuron():\n    global x1, x2, w1, w2, b, x1w1, x2w2, sum_, n, o\n    # inputs x1,x2\n    x1 = Value(2.0, label=\"x1\")\n    x2 = Value(0.0, label=\"x2\")\n    # weights w1,w2\n    w1 = Value(-3.0, label=\"w1\")\n    w2 = Value(1.0, label=\"w2\")\n    # bias of the neuron\n    b = Value(6.8813735870195432, label=\"b\")\n    # x1*w1 + x2*w2 + b\n    x1w1 = x1 * w1\n    x1w1.label = \"x1*w1\"\n    x2w2 = x2 * w2\n    x2w2.label = \"x2*w2\"\n    sum_ = x1w1 + x2w2\n    sum_.label = \"x1*w1 + x2*w2\"\n    n = sum_ + b\n    n.label = \"n\"\n    o = n.tanh()\n    o.label = \"o\"  # see the newly implemented Value.tanh method\n\n\nactivate_neuron()","key":"PfKygO5QZF"},{"type":"outputs","id":"mT0eup28WS_W6XBwHGtm9","children":[],"key":"zG8TYMH2v1"}],"key":"YcsrFTbGIM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"draw(o)","key":"tg1iQADXAT"},{"type":"outputs","id":"56rKrkdY7_T4dSw-HeEes","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"image/svg+xml":{"content":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 2.43.0 (0)\n -->\n<!-- Title: %3 Pages: 1 -->\n<svg width=\"1575pt\" height=\"210pt\"\n viewBox=\"0.00 0.00 1575.00 210.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 206)\">\n<title>%3</title>\n<polygon fill=\"white\" stroke=\"transparent\" points=\"-4,4 -4,-206 1571,-206 1571,4 -4,4\"/>\n<!-- 140106811480656 -->\n<g id=\"node1\" class=\"node\">\n<title>140106811480656</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"4,-165.5 4,-201.5 196,-201.5 196,-165.5 4,-165.5\"/>\n<text text-anchor=\"middle\" x=\"19\" y=\"-179.8\" font-family=\"Times,serif\" font-size=\"14.00\">x2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"34,-165.5 34,-201.5 \"/>\n<text text-anchor=\"middle\" x=\"74\" y=\"-179.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"114,-165.5 114,-201.5 \"/>\n<text text-anchor=\"middle\" x=\"155\" y=\"-179.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106808381648* -->\n<g id=\"node8\" class=\"node\">\n<title>140106808381648*</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"263\" cy=\"-128.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"263\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n</g>\n<!-- 140106811480656&#45;&gt;140106808381648* -->\n<g id=\"edge7\" class=\"edge\">\n<title>140106811480656&#45;&gt;140106808381648*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M172.53,-165.44C181.84,-162.67 191.2,-159.67 200,-156.5 210.53,-152.71 221.75,-147.9 231.72,-143.33\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"233.25,-146.48 240.82,-139.07 230.28,-140.14 233.25,-146.48\"/>\n</g>\n<!-- 140106808378000 -->\n<g id=\"node2\" class=\"node\">\n<title>140106808378000</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"326,-55.5 326,-91.5 546,-91.5 546,-55.5 326,-55.5\"/>\n<text text-anchor=\"middle\" x=\"352.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">x1*w1</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"379,-55.5 379,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"421.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"464,-55.5 464,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"505\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106808385872+ -->\n<g id=\"node12\" class=\"node\">\n<title>140106808385872+</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"609\" cy=\"-100.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"609\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n</g>\n<!-- 140106808378000&#45;&gt;140106808385872+ -->\n<g id=\"edge8\" class=\"edge\">\n<title>140106808378000&#45;&gt;140106808385872+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M546.27,-90.75C555.64,-92.23 564.6,-93.65 572.65,-94.92\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"572.23,-98.4 582.65,-96.5 573.32,-91.48 572.23,-98.4\"/>\n</g>\n<!-- 140106808378000* -->\n<g id=\"node3\" class=\"node\">\n<title>140106808378000*</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"263\" cy=\"-73.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"263\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n</g>\n<!-- 140106808378000*&#45;&gt;140106808378000 -->\n<g id=\"edge1\" class=\"edge\">\n<title>140106808378000*&#45;&gt;140106808378000</title>\n<path fill=\"none\" stroke=\"black\" d=\"M290.34,-73.5C297.77,-73.5 306.37,-73.5 315.6,-73.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"315.84,-77 325.84,-73.5 315.84,-70 315.84,-77\"/>\n</g>\n<!-- 140106808389328 -->\n<g id=\"node4\" class=\"node\">\n<title>140106808389328</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"716,-27.5 716,-63.5 901,-63.5 901,-27.5 716,-27.5\"/>\n<text text-anchor=\"middle\" x=\"727.5\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"739,-27.5 739,-63.5 \"/>\n<text text-anchor=\"middle\" x=\"779\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 6.8814</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"819,-27.5 819,-63.5 \"/>\n<text text-anchor=\"middle\" x=\"860\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106808359696+ -->\n<g id=\"node10\" class=\"node\">\n<title>140106808359696+</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"1008\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"1008\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n</g>\n<!-- 140106808389328&#45;&gt;140106808359696+ -->\n<g id=\"edge9\" class=\"edge\">\n<title>140106808389328&#45;&gt;140106808359696+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M901.02,-58.01C926,-61.43 951.59,-64.93 971.37,-67.63\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"971.05,-71.12 981.43,-69.01 972,-64.18 971.05,-71.12\"/>\n</g>\n<!-- 140106808358608 -->\n<g id=\"node5\" class=\"node\">\n<title>140106808358608</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"1382,-54.5 1382,-90.5 1567,-90.5 1567,-54.5 1382,-54.5\"/>\n<text text-anchor=\"middle\" x=\"1393.5\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">o</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1405,-54.5 1405,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1445\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.7071</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1485,-54.5 1485,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1526\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106808358608tanh -->\n<g id=\"node6\" class=\"node\">\n<title>140106808358608tanh</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"1319\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"1319\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">tanh</text>\n</g>\n<!-- 140106808358608tanh&#45;&gt;140106808358608 -->\n<g id=\"edge2\" class=\"edge\">\n<title>140106808358608tanh&#45;&gt;140106808358608</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1346.04,-72.5C1353.58,-72.5 1362.3,-72.5 1371.57,-72.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1371.81,-76 1381.81,-72.5 1371.81,-69 1371.81,-76\"/>\n</g>\n<!-- 140106808381648 -->\n<g id=\"node7\" class=\"node\">\n<title>140106808381648</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"328.5,-110.5 328.5,-146.5 543.5,-146.5 543.5,-110.5 328.5,-110.5\"/>\n<text text-anchor=\"middle\" x=\"355\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">x2*w2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"381.5,-110.5 381.5,-146.5 \"/>\n<text text-anchor=\"middle\" x=\"421.5\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"461.5,-110.5 461.5,-146.5 \"/>\n<text text-anchor=\"middle\" x=\"502.5\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106808381648&#45;&gt;140106808385872+ -->\n<g id=\"edge13\" class=\"edge\">\n<title>140106808381648&#45;&gt;140106808385872+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M543.84,-111.01C554.01,-109.34 563.76,-107.74 572.44,-106.32\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"573.17,-109.75 582.47,-104.68 572.04,-102.84 573.17,-109.75\"/>\n</g>\n<!-- 140106808381648*&#45;&gt;140106808381648 -->\n<g id=\"edge3\" class=\"edge\">\n<title>140106808381648*&#45;&gt;140106808381648</title>\n<path fill=\"none\" stroke=\"black\" d=\"M290.34,-128.5C298.51,-128.5 308.08,-128.5 318.36,-128.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"318.39,-132 328.39,-128.5 318.39,-125 318.39,-132\"/>\n</g>\n<!-- 140106808359696 -->\n<g id=\"node9\" class=\"node\">\n<title>140106808359696</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"1071,-54.5 1071,-90.5 1256,-90.5 1256,-54.5 1071,-54.5\"/>\n<text text-anchor=\"middle\" x=\"1082.5\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">n</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1094,-54.5 1094,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1134\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.8814</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1174,-54.5 1174,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1215\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106808359696&#45;&gt;140106808358608tanh -->\n<g id=\"edge12\" class=\"edge\">\n<title>140106808359696&#45;&gt;140106808358608tanh</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1256.01,-72.5C1265.01,-72.5 1273.74,-72.5 1281.66,-72.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1281.91,-76 1291.91,-72.5 1281.91,-69 1281.91,-76\"/>\n</g>\n<!-- 140106808359696+&#45;&gt;140106808359696 -->\n<g id=\"edge4\" class=\"edge\">\n<title>140106808359696+&#45;&gt;140106808359696</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1035.04,-72.5C1042.58,-72.5 1051.3,-72.5 1060.57,-72.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1060.81,-76 1070.81,-72.5 1060.81,-69 1060.81,-76\"/>\n</g>\n<!-- 140106808385872 -->\n<g id=\"node11\" class=\"node\">\n<title>140106808385872</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"672,-82.5 672,-118.5 945,-118.5 945,-82.5 672,-82.5\"/>\n<text text-anchor=\"middle\" x=\"725\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">x1*w1 + x2*w2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"778,-82.5 778,-118.5 \"/>\n<text text-anchor=\"middle\" x=\"820.5\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"863,-82.5 863,-118.5 \"/>\n<text text-anchor=\"middle\" x=\"904\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106808385872&#45;&gt;140106808359696+ -->\n<g id=\"edge10\" class=\"edge\">\n<title>140106808385872&#45;&gt;140106808359696+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M936.53,-82.49C949.09,-80.71 960.99,-79.02 971.3,-77.56\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"972.03,-80.99 981.44,-76.12 971.05,-74.06 972.03,-80.99\"/>\n</g>\n<!-- 140106808385872+&#45;&gt;140106808385872 -->\n<g id=\"edge5\" class=\"edge\">\n<title>140106808385872+&#45;&gt;140106808385872</title>\n<path fill=\"none\" stroke=\"black\" d=\"M636.23,-100.5C643.7,-100.5 652.41,-100.5 661.87,-100.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"661.98,-104 671.98,-100.5 661.98,-97 661.98,-104\"/>\n</g>\n<!-- 140106808383376 -->\n<g id=\"node13\" class=\"node\">\n<title>140106808383376</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"4,-55.5 4,-91.5 196,-91.5 196,-55.5 4,-55.5\"/>\n<text text-anchor=\"middle\" x=\"19\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">x1</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"34,-55.5 34,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"74\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"114,-55.5 114,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"155\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106808383376&#45;&gt;140106808378000* -->\n<g id=\"edge11\" class=\"edge\">\n<title>140106808383376&#45;&gt;140106808378000*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M196.05,-73.5C206.52,-73.5 216.65,-73.5 225.71,-73.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"225.79,-77 235.79,-73.5 225.79,-70 225.79,-77\"/>\n</g>\n<!-- 140106808392080 -->\n<g id=\"node14\" class=\"node\">\n<title>140106808392080</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"2.5,-110.5 2.5,-146.5 197.5,-146.5 197.5,-110.5 2.5,-110.5\"/>\n<text text-anchor=\"middle\" x=\"19\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">w2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"35.5,-110.5 35.5,-146.5 \"/>\n<text text-anchor=\"middle\" x=\"75.5\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 1.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"115.5,-110.5 115.5,-146.5 \"/>\n<text text-anchor=\"middle\" x=\"156.5\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106808392080&#45;&gt;140106808381648* -->\n<g id=\"edge14\" class=\"edge\">\n<title>140106808392080&#45;&gt;140106808381648*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M197.91,-128.5C207.65,-128.5 217.05,-128.5 225.52,-128.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"225.7,-132 235.7,-128.5 225.7,-125 225.7,-132\"/>\n</g>\n<!-- 140106808392592 -->\n<g id=\"node15\" class=\"node\">\n<title>140106808392592</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"0,-0.5 0,-36.5 200,-36.5 200,-0.5 0,-0.5\"/>\n<text text-anchor=\"middle\" x=\"16.5\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">w1</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"33,-0.5 33,-36.5 \"/>\n<text text-anchor=\"middle\" x=\"75.5\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"118,-0.5 118,-36.5 \"/>\n<text text-anchor=\"middle\" x=\"159\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106808392592&#45;&gt;140106808378000* -->\n<g id=\"edge6\" class=\"edge\">\n<title>140106808392592&#45;&gt;140106808378000*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M169.28,-36.5C179.65,-39.61 190.16,-42.98 200,-46.5 210.28,-50.17 221.28,-54.74 231.11,-59.07\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"229.93,-62.37 240.48,-63.27 232.79,-55.99 229.93,-62.37\"/>\n</g>\n</g>\n</svg>\n","content_type":"image/svg+xml"},"text/plain":{"content":"<graphviz.graphs.Digraph at 0x7f6d289785d0>","content_type":"text/plain"}}},"children":[],"key":"e3xlrXEqf9"}],"key":"fmNjAbHE2y"}],"key":"YDckin2sQV"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As you can see, this graph represents a neuron that takes inputs and weights and produces a value ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uZEumIkdxT"},{"type":"inlineCode","value":"n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X8MYnKqCcA"},{"type":"text","value":" squashed by an activation function ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CAiMbR9VmC"},{"type":"inlineCode","value":"tanh","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cKncTlsjvo"},{"type":"text","value":" that yields an output ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MfmAzdoXMJ"},{"type":"inlineCode","value":"o","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mVSs7C9sjM"},{"type":"text","value":". But, the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DXeD7dgdEH"},{"type":"inlineCode","value":"grad","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WmziJSF8IO"},{"type":"text","value":" attributes are empty. Let’s fill them up by doing another manual ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f7kdyPofgL"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zlRp72dRsW"}],"key":"Yq9bgKizgP"},{"type":"text","value":"! Doing so requires finding out the derivatives of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OTR3Hs3aS6"},{"type":"inlineCode","value":"o","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jHOOm3b8Hs"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NqdPzTV8Ma"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iS5ayRZL0x"}],"key":"C0GJmWfFCN"},{"type":"text","value":" the inputs. But of course in a typical ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Uu3LCpMAym"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nObqSCS2Jg"}],"key":"CgyEG0BCmK"},{"type":"text","value":" setting what we really care about the most are the derivatives ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JfQTzNoqZB"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vLHl6ppxvZ"}],"key":"vks31Rq1Yq"},{"type":"text","value":" the weights ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sd3sBMZUbd"},{"type":"inlineMath","value":"w_i","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">w_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"mON6rZh4UU"},{"type":"text","value":" (e.g. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K1IpfRVh28"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial w_i}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>w</mi><mi>i</mi></msub></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial w_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2074em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"OPSAcOI0lD"},{"type":"text","value":") because those are the free parameters that are usually changed when improving performance.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wHdHmUvfHH"}],"key":"FTPhE0z3o6"}],"key":"vgGVxwG2gx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"o.grad = 1.0\no.grad","key":"XraXcNlA02"},{"type":"outputs","id":"vs48rjKiCWHPXVfJu2Nsv","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/plain":{"content":"1.0","content_type":"text/plain"}}},"children":[],"key":"jvaFBOfNGf"}],"key":"YwJP9k0NNQ"}],"key":"NSgWMGB4Th"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineMath","value":"\\dfrac{\\partial o}{\\partial n} = \\dfrac{\\partial \\tanh(n)}{\\partial n} = 1 - \\tanh(n)^2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>o</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>n</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>tanh</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>n</mi></mrow></mfrac></mstyle><mo>=</mo><mn>1</mn><mo>−</mo><mi>tanh</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>n</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial o}{\\partial n} = \\dfrac{\\partial \\tanh(n)}{\\partial n} = 1 - \\tanh(n)^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">n</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">o</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.113em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">n</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">tanh</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mop\">tanh</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"EvUy4Eztkz"},{"type":"text","value":", according to the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TuO42rmpK4"},{"type":"link","url":"https://en.wikipedia.org/wiki/Hyperbolic_functions#Derivatives","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"derivatives of hyperbolic functions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tfUspqKBo1"}],"urlSource":"https://en.wikipedia.org/wiki/Hyperbolic_functions#Derivatives","data":{"page":"Hyperbolic_functions#Derivatives","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"nvYCS4MHie"},{"type":"text","value":". And therefore:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Lx2Xm06tgN"}],"key":"Uj2XiFXmCG"}],"key":"S7hd2yNnFC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"n.grad = 1 - o.data**2\nn.grad","key":"PjOH13XnfT"},{"type":"outputs","id":"qEFE27BV240lurrGuBd9w","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/plain":{"content":"0.4999999999999998","content_type":"text/plain"}}},"children":[],"key":"qyHHHoVQ7B"}],"key":"JWgojlcxfB"}],"key":"JcGw97hsYJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And since we learnt from before that the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KyHdXeskk2"},{"type":"inlineCode","value":"+","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Xmjdq5pseY"},{"type":"text","value":" operation acts as a gradient router and we can see from our graph that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tXLNSAvRwg"},{"type":"inlineCode","value":"n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Lh66py3dCE"},{"type":"text","value":" is recursively preceeded by two ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W6iScXiSpc"},{"type":"inlineCode","value":"+","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XANyxJRqfd"},{"type":"text","value":" operations, the children nodes’ ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZbYkcrkWbV"},{"type":"inlineCode","value":"grad","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ueqEg7bKcC"},{"type":"text","value":" attribute will be the same value as ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YWzDmX5KZk"},{"type":"inlineCode","value":"n.grad","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DCrH5r6u17"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v6e3R5UKFb"}],"key":"DgXMBKsYq3"}],"key":"uTDHwuifcd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x2w2.grad = x1w1.grad = sum_.grad = b.grad = n.grad\nx2w2.grad","key":"DtT1dyYVcZ"},{"type":"outputs","id":"AdSC5xiTRptKw0iwxc0K0","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/plain":{"content":"0.4999999999999998","content_type":"text/plain"}}},"children":[],"key":"WyLwVomtwI"}],"key":"D008NGcm9T"}],"key":"DW6YBPKuR0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And according to the chain rule, as previously described, the derivatives of the outputs ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K6abMLV0bb"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FH7Ihiw1Dq"}],"key":"X1r8pYQFOj"},{"type":"text","value":" to the inputs will be:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XLQnVxIpsn"}],"key":"GV8axLpzVs"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\dfrac{\\partial o}{\\partial x_1} = \\dfrac{\\partial o}{\\partial {(x_1 \\cdot w_1)}} \\cdot \\dfrac{\\partial {(x_1 \\cdot w_1)}}{\\partial x_1} = \\dfrac{\\partial o}{\\partial {(x_1 \\cdot w_1)}} \\cdot w_1","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>o</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mn>1</mn></msub></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>o</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>⋅</mo><msub><mi>w</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>⋅</mo><msub><mi>w</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mn>1</mn></msub></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>o</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>⋅</mo><msub><mi>w</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle><mo>⋅</mo><msub><mi>w</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial o}{\\partial x_1} = \\dfrac{\\partial o}{\\partial {(x_1 \\cdot w_1)}} \\cdot \\dfrac{\\partial {(x_1 \\cdot w_1)}}{\\partial x_1} = \\dfrac{\\partial o}{\\partial {(x_1 \\cdot w_1)}} \\cdot w_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2074em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">o</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3074em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">o</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.263em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3074em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">o</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"MmDA5V7058"}],"key":"UURtk8tOCY"}],"key":"Zp7vksAAEX"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\dfrac{\\partial o}{\\partial w_1} = \\dfrac{\\partial o}{\\partial {(x_1 \\cdot w_1)}} \\cdot \\dfrac{\\partial {(x_1 \\cdot w_1)}}{\\partial w_1} = \\dfrac{\\partial o}{\\partial {(x_1 \\cdot w_1)}} \\cdot x_1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>o</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>w</mi><mn>1</mn></msub></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>o</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>⋅</mo><msub><mi>w</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>⋅</mo><msub><mi>w</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>w</mi><mn>1</mn></msub></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>o</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>⋅</mo><msub><mi>w</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle><mo>⋅</mo><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial o}{\\partial w_1} = \\dfrac{\\partial o}{\\partial {(x_1 \\cdot w_1)}} \\cdot \\dfrac{\\partial {(x_1 \\cdot w_1)}}{\\partial w_1} = \\dfrac{\\partial o}{\\partial {(x_1 \\cdot w_1)}} \\cdot x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2074em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">o</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3074em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">o</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.263em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3074em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">o</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"BNrITxaD6I"}],"key":"Lg8DaArEpV"}],"key":"euY1nxKF59"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\dfrac{\\partial o}{\\partial x_2} = \\dfrac{\\partial o}{\\partial {(x_2 \\cdot w_2)}} \\cdot \\dfrac{\\partial {(x_2 \\cdot w_2)}}{\\partial x_2} = \\dfrac{\\partial o}{\\partial {(x_2 \\cdot w_2)}} \\cdot w_2","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>o</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mn>2</mn></msub></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>o</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>⋅</mo><msub><mi>w</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>⋅</mo><msub><mi>w</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mn>2</mn></msub></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>o</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>⋅</mo><msub><mi>w</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle><mo>⋅</mo><msub><mi>w</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial o}{\\partial x_2} = \\dfrac{\\partial o}{\\partial {(x_2 \\cdot w_2)}} \\cdot \\dfrac{\\partial {(x_2 \\cdot w_2)}}{\\partial x_2} = \\dfrac{\\partial o}{\\partial {(x_2 \\cdot w_2)}} \\cdot w_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2074em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">o</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3074em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">o</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.263em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3074em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">o</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"tVUi6tIagI"}],"key":"xAiBgYQfbO"}],"key":"fTd2lV6F0H"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\dfrac{\\partial o}{\\partial w_2} = \\dfrac{\\partial o}{\\partial {(x_2 \\cdot w_2)}} \\cdot \\dfrac{\\partial {(x_2 \\cdot w_2)}}{\\partial w_2} = \\dfrac{\\partial o}{\\partial {(x_2 \\cdot w_2)}} \\cdot x_2","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>o</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>w</mi><mn>2</mn></msub></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>o</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>⋅</mo><msub><mi>w</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>⋅</mo><msub><mi>w</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>w</mi><mn>2</mn></msub></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>o</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo>⋅</mo><msub><mi>w</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow></mrow></mfrac></mstyle><mo>⋅</mo><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial o}{\\partial w_2} = \\dfrac{\\partial o}{\\partial {(x_2 \\cdot w_2)}} \\cdot \\dfrac{\\partial {(x_2 \\cdot w_2)}}{\\partial w_2} = \\dfrac{\\partial o}{\\partial {(x_2 \\cdot w_2)}} \\cdot x_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2074em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">o</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3074em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">o</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.263em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3074em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">o</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"LwBQ2A2shL"}],"key":"c6bNEchXWN"}],"key":"FtuXwKMluR"}],"key":"CERa42AGA7"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Thus:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"FOvCQZgiIm"}],"key":"M6Y6XcKfSi"}],"key":"myxn8KOvWu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x1.grad = x1w1.grad * w1.data\nw1.grad = x1w1.grad * x1.data\nx2.grad = x2w2.grad * w2.data\nw2.grad = x2w2.grad * x2.data\nprint(x1.grad)\nprint(w1.grad)\nprint(x2.grad)\nprint(w2.grad)","key":"iEFxoVwaop"},{"type":"outputs","id":"LmB3feqoDt_1daJ3qHPs_","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"-1.4999999999999993\n0.9999999999999996\n0.4999999999999998\n0.0\n"},"children":[],"key":"ygjaDMuIVM"}],"key":"WHFBNwYKWY"}],"key":"K37F24wdSz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"draw(o)","key":"LkeDwhNi8E"},{"type":"outputs","id":"DI9J8pRcq1wEIBCSKE10T","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"image/svg+xml":{"content":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 2.43.0 (0)\n -->\n<!-- Title: %3 Pages: 1 -->\n<svg width=\"1575pt\" height=\"210pt\"\n viewBox=\"0.00 0.00 1575.00 210.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 206)\">\n<title>%3</title>\n<polygon fill=\"white\" stroke=\"transparent\" points=\"-4,4 -4,-206 1571,-206 1571,4 -4,4\"/>\n<!-- 140106811480656 -->\n<g id=\"node1\" class=\"node\">\n<title>140106811480656</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"4,-165.5 4,-201.5 196,-201.5 196,-165.5 4,-165.5\"/>\n<text text-anchor=\"middle\" x=\"19\" y=\"-179.8\" font-family=\"Times,serif\" font-size=\"14.00\">x2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"34,-165.5 34,-201.5 \"/>\n<text text-anchor=\"middle\" x=\"74\" y=\"-179.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"114,-165.5 114,-201.5 \"/>\n<text text-anchor=\"middle\" x=\"155\" y=\"-179.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808381648* -->\n<g id=\"node8\" class=\"node\">\n<title>140106808381648*</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"263\" cy=\"-128.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"263\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n</g>\n<!-- 140106811480656&#45;&gt;140106808381648* -->\n<g id=\"edge7\" class=\"edge\">\n<title>140106811480656&#45;&gt;140106808381648*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M172.53,-165.44C181.84,-162.67 191.2,-159.67 200,-156.5 210.53,-152.71 221.75,-147.9 231.72,-143.33\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"233.25,-146.48 240.82,-139.07 230.28,-140.14 233.25,-146.48\"/>\n</g>\n<!-- 140106808378000 -->\n<g id=\"node2\" class=\"node\">\n<title>140106808378000</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"326,-55.5 326,-91.5 546,-91.5 546,-55.5 326,-55.5\"/>\n<text text-anchor=\"middle\" x=\"352.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">x1*w1</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"379,-55.5 379,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"421.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"464,-55.5 464,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"505\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808385872+ -->\n<g id=\"node12\" class=\"node\">\n<title>140106808385872+</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"609\" cy=\"-100.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"609\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n</g>\n<!-- 140106808378000&#45;&gt;140106808385872+ -->\n<g id=\"edge8\" class=\"edge\">\n<title>140106808378000&#45;&gt;140106808385872+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M546.27,-90.75C555.64,-92.23 564.6,-93.65 572.65,-94.92\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"572.23,-98.4 582.65,-96.5 573.32,-91.48 572.23,-98.4\"/>\n</g>\n<!-- 140106808378000* -->\n<g id=\"node3\" class=\"node\">\n<title>140106808378000*</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"263\" cy=\"-73.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"263\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n</g>\n<!-- 140106808378000*&#45;&gt;140106808378000 -->\n<g id=\"edge1\" class=\"edge\">\n<title>140106808378000*&#45;&gt;140106808378000</title>\n<path fill=\"none\" stroke=\"black\" d=\"M290.34,-73.5C297.77,-73.5 306.37,-73.5 315.6,-73.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"315.84,-77 325.84,-73.5 315.84,-70 315.84,-77\"/>\n</g>\n<!-- 140106808389328 -->\n<g id=\"node4\" class=\"node\">\n<title>140106808389328</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"716,-27.5 716,-63.5 901,-63.5 901,-27.5 716,-27.5\"/>\n<text text-anchor=\"middle\" x=\"727.5\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"739,-27.5 739,-63.5 \"/>\n<text text-anchor=\"middle\" x=\"779\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 6.8814</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"819,-27.5 819,-63.5 \"/>\n<text text-anchor=\"middle\" x=\"860\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808359696+ -->\n<g id=\"node10\" class=\"node\">\n<title>140106808359696+</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"1008\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"1008\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n</g>\n<!-- 140106808389328&#45;&gt;140106808359696+ -->\n<g id=\"edge9\" class=\"edge\">\n<title>140106808389328&#45;&gt;140106808359696+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M901.02,-58.01C926,-61.43 951.59,-64.93 971.37,-67.63\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"971.05,-71.12 981.43,-69.01 972,-64.18 971.05,-71.12\"/>\n</g>\n<!-- 140106808358608 -->\n<g id=\"node5\" class=\"node\">\n<title>140106808358608</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"1382,-54.5 1382,-90.5 1567,-90.5 1567,-54.5 1382,-54.5\"/>\n<text text-anchor=\"middle\" x=\"1393.5\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">o</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1405,-54.5 1405,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1445\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.7071</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1485,-54.5 1485,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1526\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n</g>\n<!-- 140106808358608tanh -->\n<g id=\"node6\" class=\"node\">\n<title>140106808358608tanh</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"1319\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"1319\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">tanh</text>\n</g>\n<!-- 140106808358608tanh&#45;&gt;140106808358608 -->\n<g id=\"edge2\" class=\"edge\">\n<title>140106808358608tanh&#45;&gt;140106808358608</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1346.04,-72.5C1353.58,-72.5 1362.3,-72.5 1371.57,-72.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1371.81,-76 1381.81,-72.5 1371.81,-69 1371.81,-76\"/>\n</g>\n<!-- 140106808381648 -->\n<g id=\"node7\" class=\"node\">\n<title>140106808381648</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"328.5,-110.5 328.5,-146.5 543.5,-146.5 543.5,-110.5 328.5,-110.5\"/>\n<text text-anchor=\"middle\" x=\"355\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">x2*w2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"381.5,-110.5 381.5,-146.5 \"/>\n<text text-anchor=\"middle\" x=\"421.5\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"461.5,-110.5 461.5,-146.5 \"/>\n<text text-anchor=\"middle\" x=\"502.5\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808381648&#45;&gt;140106808385872+ -->\n<g id=\"edge13\" class=\"edge\">\n<title>140106808381648&#45;&gt;140106808385872+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M543.84,-111.01C554.01,-109.34 563.76,-107.74 572.44,-106.32\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"573.17,-109.75 582.47,-104.68 572.04,-102.84 573.17,-109.75\"/>\n</g>\n<!-- 140106808381648*&#45;&gt;140106808381648 -->\n<g id=\"edge3\" class=\"edge\">\n<title>140106808381648*&#45;&gt;140106808381648</title>\n<path fill=\"none\" stroke=\"black\" d=\"M290.34,-128.5C298.51,-128.5 308.08,-128.5 318.36,-128.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"318.39,-132 328.39,-128.5 318.39,-125 318.39,-132\"/>\n</g>\n<!-- 140106808359696 -->\n<g id=\"node9\" class=\"node\">\n<title>140106808359696</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"1071,-54.5 1071,-90.5 1256,-90.5 1256,-54.5 1071,-54.5\"/>\n<text text-anchor=\"middle\" x=\"1082.5\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">n</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1094,-54.5 1094,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1134\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.8814</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1174,-54.5 1174,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1215\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808359696&#45;&gt;140106808358608tanh -->\n<g id=\"edge12\" class=\"edge\">\n<title>140106808359696&#45;&gt;140106808358608tanh</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1256.01,-72.5C1265.01,-72.5 1273.74,-72.5 1281.66,-72.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1281.91,-76 1291.91,-72.5 1281.91,-69 1281.91,-76\"/>\n</g>\n<!-- 140106808359696+&#45;&gt;140106808359696 -->\n<g id=\"edge4\" class=\"edge\">\n<title>140106808359696+&#45;&gt;140106808359696</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1035.04,-72.5C1042.58,-72.5 1051.3,-72.5 1060.57,-72.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1060.81,-76 1070.81,-72.5 1060.81,-69 1060.81,-76\"/>\n</g>\n<!-- 140106808385872 -->\n<g id=\"node11\" class=\"node\">\n<title>140106808385872</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"672,-82.5 672,-118.5 945,-118.5 945,-82.5 672,-82.5\"/>\n<text text-anchor=\"middle\" x=\"725\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">x1*w1 + x2*w2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"778,-82.5 778,-118.5 \"/>\n<text text-anchor=\"middle\" x=\"820.5\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"863,-82.5 863,-118.5 \"/>\n<text text-anchor=\"middle\" x=\"904\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808385872&#45;&gt;140106808359696+ -->\n<g id=\"edge10\" class=\"edge\">\n<title>140106808385872&#45;&gt;140106808359696+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M936.53,-82.49C949.09,-80.71 960.99,-79.02 971.3,-77.56\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"972.03,-80.99 981.44,-76.12 971.05,-74.06 972.03,-80.99\"/>\n</g>\n<!-- 140106808385872+&#45;&gt;140106808385872 -->\n<g id=\"edge5\" class=\"edge\">\n<title>140106808385872+&#45;&gt;140106808385872</title>\n<path fill=\"none\" stroke=\"black\" d=\"M636.23,-100.5C643.7,-100.5 652.41,-100.5 661.87,-100.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"661.98,-104 671.98,-100.5 661.98,-97 661.98,-104\"/>\n</g>\n<!-- 140106808383376 -->\n<g id=\"node13\" class=\"node\">\n<title>140106808383376</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"2,-55.5 2,-91.5 198,-91.5 198,-55.5 2,-55.5\"/>\n<text text-anchor=\"middle\" x=\"17\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">x1</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"32,-55.5 32,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"72\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"112,-55.5 112,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"155\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;1.5000</text>\n</g>\n<!-- 140106808383376&#45;&gt;140106808378000* -->\n<g id=\"edge11\" class=\"edge\">\n<title>140106808383376&#45;&gt;140106808378000*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M198.37,-73.5C208.05,-73.5 217.4,-73.5 225.8,-73.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"225.91,-77 235.91,-73.5 225.91,-70 225.91,-77\"/>\n</g>\n<!-- 140106808392080 -->\n<g id=\"node14\" class=\"node\">\n<title>140106808392080</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"2.5,-110.5 2.5,-146.5 197.5,-146.5 197.5,-110.5 2.5,-110.5\"/>\n<text text-anchor=\"middle\" x=\"19\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">w2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"35.5,-110.5 35.5,-146.5 \"/>\n<text text-anchor=\"middle\" x=\"75.5\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 1.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"115.5,-110.5 115.5,-146.5 \"/>\n<text text-anchor=\"middle\" x=\"156.5\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106808392080&#45;&gt;140106808381648* -->\n<g id=\"edge14\" class=\"edge\">\n<title>140106808392080&#45;&gt;140106808381648*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M197.91,-128.5C207.65,-128.5 217.05,-128.5 225.52,-128.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"225.7,-132 235.7,-128.5 225.7,-125 225.7,-132\"/>\n</g>\n<!-- 140106808392592 -->\n<g id=\"node15\" class=\"node\">\n<title>140106808392592</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"0,-0.5 0,-36.5 200,-36.5 200,-0.5 0,-0.5\"/>\n<text text-anchor=\"middle\" x=\"16.5\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">w1</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"33,-0.5 33,-36.5 \"/>\n<text text-anchor=\"middle\" x=\"75.5\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"118,-0.5 118,-36.5 \"/>\n<text text-anchor=\"middle\" x=\"159\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n</g>\n<!-- 140106808392592&#45;&gt;140106808378000* -->\n<g id=\"edge6\" class=\"edge\">\n<title>140106808392592&#45;&gt;140106808378000*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M169.28,-36.5C179.65,-39.61 190.16,-42.98 200,-46.5 210.28,-50.17 221.28,-54.74 231.11,-59.07\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"229.93,-62.37 240.48,-63.27 232.79,-55.99 229.93,-62.37\"/>\n</g>\n</g>\n</svg>\n","content_type":"image/svg+xml"},"text/plain":{"content":"<graphviz.graphs.Digraph at 0x7f6d288c0410>","content_type":"text/plain"}}},"children":[],"key":"vPpwbDetfy"}],"key":"mu05583Bwy"}],"key":"cLbPBt3X5v"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Done. Ok now, doing manual ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rn0FIcmkB2"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AFnw69b54A"}],"key":"wowICAjp97"},{"type":"text","value":" is obviously ridiculous! So, we are gonna put an end to our suffering and see how we can do the backward pass automatically by codifying what we have learnt so far. Specifically, inside each operation of a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WE3uXc2Jsa"},{"type":"inlineCode","value":"Value","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uqyBeahEQL"},{"type":"text","value":" instance, we will define a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Bxc2sHtpey"},{"type":"inlineCode","value":"backward","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RyS34SUXbX"},{"type":"text","value":" function that calculates the gradient:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kBppoo6iUQ"}],"key":"VsyU4jA1oY"}],"key":"oeapgF2j65"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"class Value(Value):\n    def __init__(self, *args, **kwargs):\n        super().__init__(*args, **kwargs)\n        self._backward = lambda: None\n\n    def __add__(self, other):\n        other = other if isinstance(other, self.__class__) else self.__class__(other)\n        out = super().__add__(other)\n\n        def _backward():\n            self.grad += 1.0 * out.grad\n            other.grad += 1.0 * out.grad\n\n        out._backward = _backward\n        return out\n\n    def __mul__(self, other):\n        other = other if isinstance(other, self.__class__) else self.__class__(other)\n        out = super().__mul__(other)\n\n        def _backward():\n            self.grad += other.data * out.grad\n            other.grad += self.data * out.grad\n\n        out._backward = _backward\n        return out\n\n    def tanh(self):\n        out = super().tanh()\n\n        def _backward():\n            self.grad += (1 - out.data**2) * out.grad\n\n        out._backward = _backward\n        return out","key":"pa8ZNvvg9W"},{"type":"outputs","id":"YgJdW2YNL0mUoCUeZenjV","children":[],"key":"kZJjckny9J"}],"key":"HMhQoO3Bya"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Notice how we accumulate each gradient (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KF4Vjxbr68"},{"type":"inlineCode","value":"+=","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gA3N3sVY44"},{"type":"text","value":") instead of just assigning it (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"b0DmyixvTW"},{"type":"inlineCode","value":"=","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"POzyZYzdUv"},{"type":"text","value":"). This guarantees that multiple backward calls on the same node are not overwritten, ensuring that the gradient is properly accumulated. This reflects the contributions from all paths leading to that node which respects the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Htb4GCD9co"},{"type":"link","url":"https://en.wikipedia.org/wiki/Chain_rule#Multivariable_case","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"multivariable case of the chain rule","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z8L2WkTtVB"}],"urlSource":"https://en.wikipedia.org/wiki/Chain_rule#Multivariable_case","data":{"page":"Chain_rule#Multivariable_case","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"rPXp6mwSW3"},{"type":"text","value":". Now, with our enhanced class, let’s reactivate the neuron and calculate its new output:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mlnpBKEmQt"}],"key":"hZKxdBpBgG"}],"key":"utBfe5Y6m6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"activate_neuron()","key":"cHY0XppDK5"},{"type":"outputs","id":"Ld_6ep5ggU7Im8xwvsDy4","children":[],"key":"IuY14Pwgp1"}],"key":"zaP53xw3Lg"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Then, let’s do automatic ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RTUawUzDgi"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jmx9j9afoU"}],"key":"DLakgkBkmw"},{"type":"text","value":" with the help of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RxFXWoTuyp"},{"type":"inlineCode","value":"backward","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Q3s34UyUaW"},{"type":"text","value":" functions we just defined. Calling ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DBnYVlIqze"},{"type":"inlineCode","value":"backward","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"thcTJizjZ8"},{"type":"text","value":" on a value node will populate the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FclAwitBly"},{"type":"inlineCode","value":"grad","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l5MkggXDsF"},{"type":"text","value":" attribute of the value nodes that produced it: essentially ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EKDYZdKBkI"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EGQVpUbHrc"}],"key":"xui1HzSBk4"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UVXQonTEwm"}],"key":"sSZF8nsonA"}],"key":"aZZEUAXNCf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"o.grad = 1.0  # base case\no._backward()\nn._backward()\nb._backward()  # leaf node: nothing happens!\nsum_._backward()\nx2w2._backward()\nx1w1._backward()\nx2._backward()  # leaf node: nothing happens!\nw2._backward()  # leaf node: nothing happens!\nx1._backward()  # leaf node: nothing happens!\nw1._backward()  # leaf node: nothing happens!","key":"JgkdtuavaJ"},{"type":"outputs","id":"s-38IV3K1krCMMXe96o-S","children":[],"key":"GH3J1NzUi7"}],"key":"cpd71iypa1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"draw(o)","key":"KxeoAZHrBi"},{"type":"outputs","id":"THTtbjKMt8-PO3ZTLZrlv","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"image/svg+xml":{"content":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 2.43.0 (0)\n -->\n<!-- Title: %3 Pages: 1 -->\n<svg width=\"1575pt\" height=\"210pt\"\n viewBox=\"0.00 0.00 1575.00 210.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 206)\">\n<title>%3</title>\n<polygon fill=\"white\" stroke=\"transparent\" points=\"-4,4 -4,-206 1571,-206 1571,4 -4,4\"/>\n<!-- 140106811003408 -->\n<g id=\"node1\" class=\"node\">\n<title>140106811003408</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"2,-165.5 2,-201.5 198,-201.5 198,-165.5 2,-165.5\"/>\n<text text-anchor=\"middle\" x=\"17\" y=\"-179.8\" font-family=\"Times,serif\" font-size=\"14.00\">x1</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"32,-165.5 32,-201.5 \"/>\n<text text-anchor=\"middle\" x=\"72\" y=\"-179.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"112,-165.5 112,-201.5 \"/>\n<text text-anchor=\"middle\" x=\"155\" y=\"-179.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;1.5000</text>\n</g>\n<!-- 140106807966160* -->\n<g id=\"node10\" class=\"node\">\n<title>140106807966160*</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"263\" cy=\"-128.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"263\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n</g>\n<!-- 140106811003408&#45;&gt;140106807966160* -->\n<g id=\"edge11\" class=\"edge\">\n<title>140106811003408&#45;&gt;140106807966160*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M172.53,-165.44C181.84,-162.67 191.2,-159.67 200,-156.5 210.53,-152.71 221.75,-147.9 231.72,-143.33\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"233.25,-146.48 240.82,-139.07 230.28,-140.14 233.25,-146.48\"/>\n</g>\n<!-- 140106811008528 -->\n<g id=\"node2\" class=\"node\">\n<title>140106811008528</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"0,-110.5 0,-146.5 200,-146.5 200,-110.5 0,-110.5\"/>\n<text text-anchor=\"middle\" x=\"16.5\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">w1</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"33,-110.5 33,-146.5 \"/>\n<text text-anchor=\"middle\" x=\"75.5\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"118,-110.5 118,-146.5 \"/>\n<text text-anchor=\"middle\" x=\"159\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n</g>\n<!-- 140106811008528&#45;&gt;140106807966160* -->\n<g id=\"edge14\" class=\"edge\">\n<title>140106811008528&#45;&gt;140106807966160*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M200.21,-128.5C209.2,-128.5 217.86,-128.5 225.7,-128.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"225.85,-132 235.85,-128.5 225.85,-125 225.85,-132\"/>\n</g>\n<!-- 140106808031824 -->\n<g id=\"node3\" class=\"node\">\n<title>140106808031824</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"1382,-54.5 1382,-90.5 1567,-90.5 1567,-54.5 1382,-54.5\"/>\n<text text-anchor=\"middle\" x=\"1393.5\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">o</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1405,-54.5 1405,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1445\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.7071</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1485,-54.5 1485,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1526\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n</g>\n<!-- 140106808031824tanh -->\n<g id=\"node4\" class=\"node\">\n<title>140106808031824tanh</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"1319\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"1319\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">tanh</text>\n</g>\n<!-- 140106808031824tanh&#45;&gt;140106808031824 -->\n<g id=\"edge1\" class=\"edge\">\n<title>140106808031824tanh&#45;&gt;140106808031824</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1346.04,-72.5C1353.58,-72.5 1362.3,-72.5 1371.57,-72.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1371.81,-76 1381.81,-72.5 1371.81,-69 1371.81,-76\"/>\n</g>\n<!-- 140106808030800 -->\n<g id=\"node5\" class=\"node\">\n<title>140106808030800</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"672,-82.5 672,-118.5 945,-118.5 945,-82.5 672,-82.5\"/>\n<text text-anchor=\"middle\" x=\"725\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">x1*w1 + x2*w2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"778,-82.5 778,-118.5 \"/>\n<text text-anchor=\"middle\" x=\"820.5\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"863,-82.5 863,-118.5 \"/>\n<text text-anchor=\"middle\" x=\"904\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808025040+ -->\n<g id=\"node15\" class=\"node\">\n<title>140106808025040+</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"1008\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"1008\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n</g>\n<!-- 140106808030800&#45;&gt;140106808025040+ -->\n<g id=\"edge10\" class=\"edge\">\n<title>140106808030800&#45;&gt;140106808025040+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M936.53,-82.49C949.09,-80.71 960.99,-79.02 971.3,-77.56\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"972.03,-80.99 981.44,-76.12 971.05,-74.06 972.03,-80.99\"/>\n</g>\n<!-- 140106808030800+ -->\n<g id=\"node6\" class=\"node\">\n<title>140106808030800+</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"609\" cy=\"-100.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"609\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n</g>\n<!-- 140106808030800+&#45;&gt;140106808030800 -->\n<g id=\"edge2\" class=\"edge\">\n<title>140106808030800+&#45;&gt;140106808030800</title>\n<path fill=\"none\" stroke=\"black\" d=\"M636.23,-100.5C643.7,-100.5 652.41,-100.5 661.87,-100.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"661.98,-104 671.98,-100.5 661.98,-97 661.98,-104\"/>\n</g>\n<!-- 140106808031440 -->\n<g id=\"node7\" class=\"node\">\n<title>140106808031440</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"328.5,-55.5 328.5,-91.5 543.5,-91.5 543.5,-55.5 328.5,-55.5\"/>\n<text text-anchor=\"middle\" x=\"355\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">x2*w2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"381.5,-55.5 381.5,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"421.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"461.5,-55.5 461.5,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"502.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808031440&#45;&gt;140106808030800+ -->\n<g id=\"edge12\" class=\"edge\">\n<title>140106808031440&#45;&gt;140106808030800+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M543.84,-90.37C554.01,-91.98 563.76,-93.51 572.44,-94.89\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"572.05,-98.37 582.47,-96.47 573.14,-91.45 572.05,-98.37\"/>\n</g>\n<!-- 140106808031440* -->\n<g id=\"node8\" class=\"node\">\n<title>140106808031440*</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"263\" cy=\"-73.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"263\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n</g>\n<!-- 140106808031440*&#45;&gt;140106808031440 -->\n<g id=\"edge3\" class=\"edge\">\n<title>140106808031440*&#45;&gt;140106808031440</title>\n<path fill=\"none\" stroke=\"black\" d=\"M290.34,-73.5C298.51,-73.5 308.08,-73.5 318.36,-73.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"318.39,-77 328.39,-73.5 318.39,-70 318.39,-77\"/>\n</g>\n<!-- 140106807966160 -->\n<g id=\"node9\" class=\"node\">\n<title>140106807966160</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"326,-110.5 326,-146.5 546,-146.5 546,-110.5 326,-110.5\"/>\n<text text-anchor=\"middle\" x=\"352.5\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">x1*w1</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"379,-110.5 379,-146.5 \"/>\n<text text-anchor=\"middle\" x=\"421.5\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"464,-110.5 464,-146.5 \"/>\n<text text-anchor=\"middle\" x=\"505\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106807966160&#45;&gt;140106808030800+ -->\n<g id=\"edge9\" class=\"edge\">\n<title>140106807966160&#45;&gt;140106808030800+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M546.27,-110.61C555.64,-109.07 564.6,-107.61 572.65,-106.29\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"573.35,-109.72 582.65,-104.65 572.22,-102.81 573.35,-109.72\"/>\n</g>\n<!-- 140106807966160*&#45;&gt;140106807966160 -->\n<g id=\"edge4\" class=\"edge\">\n<title>140106807966160*&#45;&gt;140106807966160</title>\n<path fill=\"none\" stroke=\"black\" d=\"M290.34,-128.5C297.77,-128.5 306.37,-128.5 315.6,-128.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"315.84,-132 325.84,-128.5 315.84,-125 315.84,-132\"/>\n</g>\n<!-- 140106808029008 -->\n<g id=\"node11\" class=\"node\">\n<title>140106808029008</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"716,-27.5 716,-63.5 901,-63.5 901,-27.5 716,-27.5\"/>\n<text text-anchor=\"middle\" x=\"727.5\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"739,-27.5 739,-63.5 \"/>\n<text text-anchor=\"middle\" x=\"779\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 6.8814</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"819,-27.5 819,-63.5 \"/>\n<text text-anchor=\"middle\" x=\"860\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808029008&#45;&gt;140106808025040+ -->\n<g id=\"edge6\" class=\"edge\">\n<title>140106808029008&#45;&gt;140106808025040+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M901.02,-58.01C926,-61.43 951.59,-64.93 971.37,-67.63\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"971.05,-71.12 981.43,-69.01 972,-64.18 971.05,-71.12\"/>\n</g>\n<!-- 140106811009872 -->\n<g id=\"node12\" class=\"node\">\n<title>140106811009872</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"4,-55.5 4,-91.5 196,-91.5 196,-55.5 4,-55.5\"/>\n<text text-anchor=\"middle\" x=\"19\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">x2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"34,-55.5 34,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"74\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"114,-55.5 114,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"155\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106811009872&#45;&gt;140106808031440* -->\n<g id=\"edge7\" class=\"edge\">\n<title>140106811009872&#45;&gt;140106808031440*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M196.05,-73.5C206.52,-73.5 216.65,-73.5 225.71,-73.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"225.79,-77 235.79,-73.5 225.79,-70 225.79,-77\"/>\n</g>\n<!-- 140106808031120 -->\n<g id=\"node13\" class=\"node\">\n<title>140106808031120</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"2.5,-0.5 2.5,-36.5 197.5,-36.5 197.5,-0.5 2.5,-0.5\"/>\n<text text-anchor=\"middle\" x=\"19\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">w2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"35.5,-0.5 35.5,-36.5 \"/>\n<text text-anchor=\"middle\" x=\"75.5\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 1.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"115.5,-0.5 115.5,-36.5 \"/>\n<text text-anchor=\"middle\" x=\"156.5\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106808031120&#45;&gt;140106808031440* -->\n<g id=\"edge8\" class=\"edge\">\n<title>140106808031120&#45;&gt;140106808031440*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M169.28,-36.5C179.65,-39.61 190.16,-42.98 200,-46.5 210.28,-50.17 221.28,-54.74 231.11,-59.07\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"229.93,-62.37 240.48,-63.27 232.79,-55.99 229.93,-62.37\"/>\n</g>\n<!-- 140106808025040 -->\n<g id=\"node14\" class=\"node\">\n<title>140106808025040</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"1071,-54.5 1071,-90.5 1256,-90.5 1256,-54.5 1071,-54.5\"/>\n<text text-anchor=\"middle\" x=\"1082.5\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">n</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1094,-54.5 1094,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1134\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.8814</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1174,-54.5 1174,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1215\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808025040&#45;&gt;140106808031824tanh -->\n<g id=\"edge13\" class=\"edge\">\n<title>140106808025040&#45;&gt;140106808031824tanh</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1256.01,-72.5C1265.01,-72.5 1273.74,-72.5 1281.66,-72.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1281.91,-76 1291.91,-72.5 1281.91,-69 1281.91,-76\"/>\n</g>\n<!-- 140106808025040+&#45;&gt;140106808025040 -->\n<g id=\"edge5\" class=\"edge\">\n<title>140106808025040+&#45;&gt;140106808025040</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1035.04,-72.5C1042.58,-72.5 1051.3,-72.5 1060.57,-72.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1060.81,-76 1070.81,-72.5 1060.81,-69 1060.81,-76\"/>\n</g>\n</g>\n</svg>\n","content_type":"image/svg+xml"},"text/plain":{"content":"<graphviz.graphs.Digraph at 0x7f6d2897a710>","content_type":"text/plain"}}},"children":[],"key":"H9dSMQidlp"}],"key":"XOV7xt7OKv"}],"key":"FbfKjKfvIC"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Hurray! Awesome. We managed to ease the pain of manually calculating the gradients of each node. However, there’s a problem: calling ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TDVmOiYHSb"},{"type":"inlineCode","value":"backward","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LHAue59zgA"},{"type":"text","value":" on a node (e.g. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"brloh50y5p"},{"type":"inlineCode","value":"x1w1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qYvpwJasED"},{"type":"text","value":") will only work if ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CCx2ZbQPDB"},{"type":"inlineCode","value":"backward","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O7A6RqEBlk"},{"type":"text","value":" has already been called on its descendant node(s) (e.g. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QRMCCLr6oJ"},{"type":"inlineCode","value":"n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HBvSodMDkI"},{"type":"text","value":"). In our graph topology this means that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ONyiu16I7U"},{"type":"inlineCode","value":"backward","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JGmOcVmEXM"},{"type":"text","value":" must be called from the rightmost to the leftmost nodes. This can be done easily by laying out our graph using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CELLjDMY9V"},{"type":"link","url":"https://en.wikipedia.org/wiki/Topological_sorting","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"topological sorting","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DfeBFUhUhS"}],"urlSource":"https://en.wikipedia.org/wiki/Topological_sorting","data":{"page":"Topological_sorting","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"RildA1ycwj"},{"type":"text","value":". Below, we re-do the forward pass and define a function that does so:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VJOJWLPQV8"}],"key":"rGah9ymhsY"}],"key":"JMHJOaicbo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"activate_neuron()\ntopo = []\nvisited = set()\n\n\ndef build_topo(v):\n    if v not in visited:\n        visited.add(v)\n        for child in v.prev:\n            build_topo(child)\n        topo.append(v)\n\n\nbuild_topo(o)\ntopo","key":"ZhD3S4wweh"},{"type":"outputs","id":"WIziqHGgGvxKcCPfNXSa8","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"text/plain":{"content":"[Value(data='1.0', label='w2'),\n Value(data='0.0', label='x2'),\n Value(data='0.0', label='x2*w2'),\n Value(data='-3.0', label='w1'),\n Value(data='2.0', label='x1'),\n Value(data='-6.0', label='x1*w1'),\n Value(data='-6.0', label='x1*w1 + x2*w2'),\n Value(data='6.881373587019543', label='b'),\n Value(data='0.8813735870195432', label='n'),\n Value(data='0.7071067811865477', label='o')]","content_type":"text/plain"}}},"children":[],"key":"VLUPA5SGIr"}],"key":"BlwuMqJIFh"}],"key":"UWQ39dFmST"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Basically, it adds children nodes first before adding non-children nodes. For examples, the first node in the resulting ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ia1SQfBy6q"},{"type":"inlineCode","value":"topo","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"G8v2Vj2tWw"},{"type":"text","value":" list is a child node. Whereas, the non-child node ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nBBi1LOqs5"},{"type":"inlineCode","value":"o","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EH3tuOTTNZ"},{"type":"text","value":" is last. In essence, what this sorting allows us to do is to traverse the graph and recursively call ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QZe9QT4QGb"},{"type":"inlineCode","value":"backward","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ld4a1lhNs6"},{"type":"text","value":" in a safe way, solving the aforementioned problem and thus facilitating automatic ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OVy2rDGgAu"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ssCoSTdUki"}],"key":"IR8Pwj3WoD"},{"type":"text","value":" with a single call. Something like this:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oNNl6I6FWl"}],"key":"xsjAYI0cx8"}],"key":"tCkmoafGWD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"o.grad = 1.0\nfor node in reversed(topo):\n    node._backward()","key":"cbK7rzAfgR"},{"type":"outputs","id":"36oa7f3-sM7e3FIxx1_IF","children":[],"key":"w5vi42Bq72"}],"key":"enHQplQWwJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"draw(o)","key":"j372W6hWQ3"},{"type":"outputs","id":"jc4Dq8O0b8uuoRYY5zWYT","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":38,"metadata":{},"data":{"image/svg+xml":{"content":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 2.43.0 (0)\n -->\n<!-- Title: %3 Pages: 1 -->\n<svg width=\"1575pt\" height=\"210pt\"\n viewBox=\"0.00 0.00 1575.00 210.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 206)\">\n<title>%3</title>\n<polygon fill=\"white\" stroke=\"transparent\" points=\"-4,4 -4,-206 1571,-206 1571,4 -4,4\"/>\n<!-- 140106809462288 -->\n<g id=\"node1\" class=\"node\">\n<title>140106809462288</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"0,-165.5 0,-201.5 200,-201.5 200,-165.5 0,-165.5\"/>\n<text text-anchor=\"middle\" x=\"16.5\" y=\"-179.8\" font-family=\"Times,serif\" font-size=\"14.00\">w1</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"33,-165.5 33,-201.5 \"/>\n<text text-anchor=\"middle\" x=\"75.5\" y=\"-179.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"118,-165.5 118,-201.5 \"/>\n<text text-anchor=\"middle\" x=\"159\" y=\"-179.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n</g>\n<!-- 140106808393424* -->\n<g id=\"node9\" class=\"node\">\n<title>140106808393424*</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"263\" cy=\"-128.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"263\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n</g>\n<!-- 140106809462288&#45;&gt;140106808393424* -->\n<g id=\"edge10\" class=\"edge\">\n<title>140106809462288&#45;&gt;140106808393424*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M172.53,-165.44C181.84,-162.67 191.2,-159.67 200,-156.5 210.53,-152.71 221.75,-147.9 231.72,-143.33\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"233.25,-146.48 240.82,-139.07 230.28,-140.14 233.25,-146.48\"/>\n</g>\n<!-- 140106809189968 -->\n<g id=\"node2\" class=\"node\">\n<title>140106809189968</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"2,-110.5 2,-146.5 198,-146.5 198,-110.5 2,-110.5\"/>\n<text text-anchor=\"middle\" x=\"17\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">x1</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"32,-110.5 32,-146.5 \"/>\n<text text-anchor=\"middle\" x=\"72\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"112,-110.5 112,-146.5 \"/>\n<text text-anchor=\"middle\" x=\"155\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;1.5000</text>\n</g>\n<!-- 140106809189968&#45;&gt;140106808393424* -->\n<g id=\"edge12\" class=\"edge\">\n<title>140106809189968&#45;&gt;140106808393424*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M198.37,-128.5C208.05,-128.5 217.4,-128.5 225.8,-128.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"225.91,-132 235.91,-128.5 225.91,-125 225.91,-132\"/>\n</g>\n<!-- 140106808383632 -->\n<g id=\"node3\" class=\"node\">\n<title>140106808383632</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"1382,-54.5 1382,-90.5 1567,-90.5 1567,-54.5 1382,-54.5\"/>\n<text text-anchor=\"middle\" x=\"1393.5\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">o</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1405,-54.5 1405,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1445\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.7071</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1485,-54.5 1485,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1526\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n</g>\n<!-- 140106808383632tanh -->\n<g id=\"node4\" class=\"node\">\n<title>140106808383632tanh</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"1319\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"1319\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">tanh</text>\n</g>\n<!-- 140106808383632tanh&#45;&gt;140106808383632 -->\n<g id=\"edge1\" class=\"edge\">\n<title>140106808383632tanh&#45;&gt;140106808383632</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1346.04,-72.5C1353.58,-72.5 1362.3,-72.5 1371.57,-72.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1371.81,-76 1381.81,-72.5 1371.81,-69 1371.81,-76\"/>\n</g>\n<!-- 140106808378000 -->\n<g id=\"node5\" class=\"node\">\n<title>140106808378000</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"672,-82.5 672,-118.5 945,-118.5 945,-82.5 672,-82.5\"/>\n<text text-anchor=\"middle\" x=\"725\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">x1*w1 + x2*w2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"778,-82.5 778,-118.5 \"/>\n<text text-anchor=\"middle\" x=\"820.5\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"863,-82.5 863,-118.5 \"/>\n<text text-anchor=\"middle\" x=\"904\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808392080+ -->\n<g id=\"node12\" class=\"node\">\n<title>140106808392080+</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"1008\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"1008\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n</g>\n<!-- 140106808378000&#45;&gt;140106808392080+ -->\n<g id=\"edge9\" class=\"edge\">\n<title>140106808378000&#45;&gt;140106808392080+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M936.53,-82.49C949.09,-80.71 960.99,-79.02 971.3,-77.56\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"972.03,-80.99 981.44,-76.12 971.05,-74.06 972.03,-80.99\"/>\n</g>\n<!-- 140106808378000+ -->\n<g id=\"node6\" class=\"node\">\n<title>140106808378000+</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"609\" cy=\"-100.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"609\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n</g>\n<!-- 140106808378000+&#45;&gt;140106808378000 -->\n<g id=\"edge2\" class=\"edge\">\n<title>140106808378000+&#45;&gt;140106808378000</title>\n<path fill=\"none\" stroke=\"black\" d=\"M636.23,-100.5C643.7,-100.5 652.41,-100.5 661.87,-100.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"661.98,-104 671.98,-100.5 661.98,-97 661.98,-104\"/>\n</g>\n<!-- 140106809049744 -->\n<g id=\"node7\" class=\"node\">\n<title>140106809049744</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"716,-27.5 716,-63.5 901,-63.5 901,-27.5 716,-27.5\"/>\n<text text-anchor=\"middle\" x=\"727.5\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"739,-27.5 739,-63.5 \"/>\n<text text-anchor=\"middle\" x=\"779\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 6.8814</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"819,-27.5 819,-63.5 \"/>\n<text text-anchor=\"middle\" x=\"860\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106809049744&#45;&gt;140106808392080+ -->\n<g id=\"edge14\" class=\"edge\">\n<title>140106809049744&#45;&gt;140106808392080+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M901.02,-58.01C926,-61.43 951.59,-64.93 971.37,-67.63\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"971.05,-71.12 981.43,-69.01 972,-64.18 971.05,-71.12\"/>\n</g>\n<!-- 140106808393424 -->\n<g id=\"node8\" class=\"node\">\n<title>140106808393424</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"326,-110.5 326,-146.5 546,-146.5 546,-110.5 326,-110.5\"/>\n<text text-anchor=\"middle\" x=\"352.5\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">x1*w1</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"379,-110.5 379,-146.5 \"/>\n<text text-anchor=\"middle\" x=\"421.5\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"464,-110.5 464,-146.5 \"/>\n<text text-anchor=\"middle\" x=\"505\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808393424&#45;&gt;140106808378000+ -->\n<g id=\"edge7\" class=\"edge\">\n<title>140106808393424&#45;&gt;140106808378000+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M546.27,-110.61C555.64,-109.07 564.6,-107.61 572.65,-106.29\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"573.35,-109.72 582.65,-104.65 572.22,-102.81 573.35,-109.72\"/>\n</g>\n<!-- 140106808393424*&#45;&gt;140106808393424 -->\n<g id=\"edge3\" class=\"edge\">\n<title>140106808393424*&#45;&gt;140106808393424</title>\n<path fill=\"none\" stroke=\"black\" d=\"M290.34,-128.5C297.77,-128.5 306.37,-128.5 315.6,-128.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"315.84,-132 325.84,-128.5 315.84,-125 315.84,-132\"/>\n</g>\n<!-- 140106809058192 -->\n<g id=\"node10\" class=\"node\">\n<title>140106809058192</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"2.5,-55.5 2.5,-91.5 197.5,-91.5 197.5,-55.5 2.5,-55.5\"/>\n<text text-anchor=\"middle\" x=\"19\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">w2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"35.5,-55.5 35.5,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"75.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 1.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"115.5,-55.5 115.5,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"156.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106808392592* -->\n<g id=\"node14\" class=\"node\">\n<title>140106808392592*</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"263\" cy=\"-73.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"263\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n</g>\n<!-- 140106809058192&#45;&gt;140106808392592* -->\n<g id=\"edge8\" class=\"edge\">\n<title>140106809058192&#45;&gt;140106808392592*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M197.91,-73.5C207.65,-73.5 217.05,-73.5 225.52,-73.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"225.7,-77 235.7,-73.5 225.7,-70 225.7,-77\"/>\n</g>\n<!-- 140106808392080 -->\n<g id=\"node11\" class=\"node\">\n<title>140106808392080</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"1071,-54.5 1071,-90.5 1256,-90.5 1256,-54.5 1071,-54.5\"/>\n<text text-anchor=\"middle\" x=\"1082.5\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">n</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1094,-54.5 1094,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1134\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.8814</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1174,-54.5 1174,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1215\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808392080&#45;&gt;140106808383632tanh -->\n<g id=\"edge11\" class=\"edge\">\n<title>140106808392080&#45;&gt;140106808383632tanh</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1256.01,-72.5C1265.01,-72.5 1273.74,-72.5 1281.66,-72.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1281.91,-76 1291.91,-72.5 1281.91,-69 1281.91,-76\"/>\n</g>\n<!-- 140106808392080+&#45;&gt;140106808392080 -->\n<g id=\"edge4\" class=\"edge\">\n<title>140106808392080+&#45;&gt;140106808392080</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1035.04,-72.5C1042.58,-72.5 1051.3,-72.5 1060.57,-72.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1060.81,-76 1070.81,-72.5 1060.81,-69 1060.81,-76\"/>\n</g>\n<!-- 140106808392592 -->\n<g id=\"node13\" class=\"node\">\n<title>140106808392592</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"328.5,-55.5 328.5,-91.5 543.5,-91.5 543.5,-55.5 328.5,-55.5\"/>\n<text text-anchor=\"middle\" x=\"355\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">x2*w2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"381.5,-55.5 381.5,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"421.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"461.5,-55.5 461.5,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"502.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808392592&#45;&gt;140106808378000+ -->\n<g id=\"edge6\" class=\"edge\">\n<title>140106808392592&#45;&gt;140106808378000+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M543.84,-90.37C554.01,-91.98 563.76,-93.51 572.44,-94.89\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"572.05,-98.37 582.47,-96.47 573.14,-91.45 572.05,-98.37\"/>\n</g>\n<!-- 140106808392592*&#45;&gt;140106808392592 -->\n<g id=\"edge5\" class=\"edge\">\n<title>140106808392592*&#45;&gt;140106808392592</title>\n<path fill=\"none\" stroke=\"black\" d=\"M290.34,-73.5C298.51,-73.5 308.08,-73.5 318.36,-73.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"318.39,-77 328.39,-73.5 318.39,-70 318.39,-77\"/>\n</g>\n<!-- 140106809469392 -->\n<g id=\"node15\" class=\"node\">\n<title>140106809469392</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"4,-0.5 4,-36.5 196,-36.5 196,-0.5 4,-0.5\"/>\n<text text-anchor=\"middle\" x=\"19\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">x2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"34,-0.5 34,-36.5 \"/>\n<text text-anchor=\"middle\" x=\"74\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"114,-0.5 114,-36.5 \"/>\n<text text-anchor=\"middle\" x=\"155\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106809469392&#45;&gt;140106808392592* -->\n<g id=\"edge13\" class=\"edge\">\n<title>140106809469392&#45;&gt;140106808392592*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M169.28,-36.5C179.65,-39.61 190.16,-42.98 200,-46.5 210.28,-50.17 221.28,-54.74 231.11,-59.07\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"229.93,-62.37 240.48,-63.27 232.79,-55.99 229.93,-62.37\"/>\n</g>\n</g>\n</svg>\n","content_type":"image/svg+xml"},"text/plain":{"content":"<graphviz.graphs.Digraph at 0x7f6d288b5590>","content_type":"text/plain"}}},"children":[],"key":"MhBt3aSGAK"}],"key":"JjA4JNvUwl"}],"key":"vT39Ujr0Fu"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s incorporate this feature into our new ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"akq2hSvH9e"},{"type":"inlineCode","value":"Value","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OknqjOxXlo"},{"type":"text","value":" class:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j919eHA7EX"}],"key":"PFurIJkCJR"}],"key":"ytAfOqnD5s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"class Value(Value):\n    def backward(self):\n        topo = []\n        visited = set()\n\n        def build_topo(v):\n            if v not in visited:\n                visited.add(v)\n                for child in v.prev:\n                    build_topo(child)\n                topo.append(v)\n\n        build_topo(self)\n        self.grad = 1.0\n        for node in reversed(topo):\n            node._backward()","key":"ygdpvLLBb5"},{"type":"outputs","id":"3QOi5QPLkAoYpvfCwFtL7","children":[],"key":"OXPd6MzKDR"}],"key":"JDoDNeRSR5"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To verify it works, we reactivate our neuron and produce a new output:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nKAv6Pev4X"}],"key":"t39gOpVOQk"}],"key":"vdTrIuyvz5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"activate_neuron()","key":"lxgpJsFu0G"},{"type":"outputs","id":"N-e5cQFFbCEaXClFaeZ_q","children":[],"key":"m88TFkHQVX"}],"key":"Qwd5vwUA2M"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"and verify our one-call ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wS68jeldS9"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zD2FR0Bvo7"}],"key":"PN1WzDHJWw"},{"type":"text","value":" works:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MkDNRtongX"}],"key":"RYa3PEWXSU"}],"key":"oUB2lUWVlG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"o.backward()\ndraw(o)","key":"F04wiB7p3R"},{"type":"outputs","id":"eOINGdcAxKJTQNRNhsoML","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":41,"metadata":{},"data":{"image/svg+xml":{"content":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 2.43.0 (0)\n -->\n<!-- Title: %3 Pages: 1 -->\n<svg width=\"1575pt\" height=\"210pt\"\n viewBox=\"0.00 0.00 1575.00 210.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 206)\">\n<title>%3</title>\n<polygon fill=\"white\" stroke=\"transparent\" points=\"-4,4 -4,-206 1571,-206 1571,4 -4,4\"/>\n<!-- 140106808376464 -->\n<g id=\"node1\" class=\"node\">\n<title>140106808376464</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"4,-165.5 4,-201.5 196,-201.5 196,-165.5 4,-165.5\"/>\n<text text-anchor=\"middle\" x=\"19\" y=\"-179.8\" font-family=\"Times,serif\" font-size=\"14.00\">x2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"34,-165.5 34,-201.5 \"/>\n<text text-anchor=\"middle\" x=\"74\" y=\"-179.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"114,-165.5 114,-201.5 \"/>\n<text text-anchor=\"middle\" x=\"155\" y=\"-179.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808430352* -->\n<g id=\"node7\" class=\"node\">\n<title>140106808430352*</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"263\" cy=\"-128.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"263\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n</g>\n<!-- 140106808376464&#45;&gt;140106808430352* -->\n<g id=\"edge12\" class=\"edge\">\n<title>140106808376464&#45;&gt;140106808430352*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M172.53,-165.44C181.84,-162.67 191.2,-159.67 200,-156.5 210.53,-152.71 221.75,-147.9 231.72,-143.33\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"233.25,-146.48 240.82,-139.07 230.28,-140.14 233.25,-146.48\"/>\n</g>\n<!-- 140106809496784 -->\n<g id=\"node2\" class=\"node\">\n<title>140106809496784</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"0,-55.5 0,-91.5 200,-91.5 200,-55.5 0,-55.5\"/>\n<text text-anchor=\"middle\" x=\"16.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">w1</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"33,-55.5 33,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"75.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"118,-55.5 118,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"159\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n</g>\n<!-- 140106808432400* -->\n<g id=\"node5\" class=\"node\">\n<title>140106808432400*</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"263\" cy=\"-73.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"263\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n</g>\n<!-- 140106809496784&#45;&gt;140106808432400* -->\n<g id=\"edge8\" class=\"edge\">\n<title>140106809496784&#45;&gt;140106808432400*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M200.21,-73.5C209.2,-73.5 217.86,-73.5 225.7,-73.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"225.85,-77 235.85,-73.5 225.85,-70 225.85,-77\"/>\n</g>\n<!-- 140106808185040 -->\n<g id=\"node3\" class=\"node\">\n<title>140106808185040</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"2,-0.5 2,-36.5 198,-36.5 198,-0.5 2,-0.5\"/>\n<text text-anchor=\"middle\" x=\"17\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">x1</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"32,-0.5 32,-36.5 \"/>\n<text text-anchor=\"middle\" x=\"72\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"112,-0.5 112,-36.5 \"/>\n<text text-anchor=\"middle\" x=\"155\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;1.5000</text>\n</g>\n<!-- 140106808185040&#45;&gt;140106808432400* -->\n<g id=\"edge11\" class=\"edge\">\n<title>140106808185040&#45;&gt;140106808432400*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M169.28,-36.5C179.65,-39.61 190.16,-42.98 200,-46.5 210.28,-50.17 221.28,-54.74 231.11,-59.07\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"229.93,-62.37 240.48,-63.27 232.79,-55.99 229.93,-62.37\"/>\n</g>\n<!-- 140106808432400 -->\n<g id=\"node4\" class=\"node\">\n<title>140106808432400</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"326,-55.5 326,-91.5 546,-91.5 546,-55.5 326,-55.5\"/>\n<text text-anchor=\"middle\" x=\"352.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">x1*w1</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"379,-55.5 379,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"421.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"464,-55.5 464,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"505\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808439120+ -->\n<g id=\"node9\" class=\"node\">\n<title>140106808439120+</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"609\" cy=\"-100.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"609\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n</g>\n<!-- 140106808432400&#45;&gt;140106808439120+ -->\n<g id=\"edge10\" class=\"edge\">\n<title>140106808432400&#45;&gt;140106808439120+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M546.27,-90.75C555.64,-92.23 564.6,-93.65 572.65,-94.92\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"572.23,-98.4 582.65,-96.5 573.32,-91.48 572.23,-98.4\"/>\n</g>\n<!-- 140106808432400*&#45;&gt;140106808432400 -->\n<g id=\"edge1\" class=\"edge\">\n<title>140106808432400*&#45;&gt;140106808432400</title>\n<path fill=\"none\" stroke=\"black\" d=\"M290.34,-73.5C297.77,-73.5 306.37,-73.5 315.6,-73.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"315.84,-77 325.84,-73.5 315.84,-70 315.84,-77\"/>\n</g>\n<!-- 140106808430352 -->\n<g id=\"node6\" class=\"node\">\n<title>140106808430352</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"328.5,-110.5 328.5,-146.5 543.5,-146.5 543.5,-110.5 328.5,-110.5\"/>\n<text text-anchor=\"middle\" x=\"355\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">x2*w2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"381.5,-110.5 381.5,-146.5 \"/>\n<text text-anchor=\"middle\" x=\"421.5\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"461.5,-110.5 461.5,-146.5 \"/>\n<text text-anchor=\"middle\" x=\"502.5\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808430352&#45;&gt;140106808439120+ -->\n<g id=\"edge9\" class=\"edge\">\n<title>140106808430352&#45;&gt;140106808439120+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M543.84,-111.01C554.01,-109.34 563.76,-107.74 572.44,-106.32\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"573.17,-109.75 582.47,-104.68 572.04,-102.84 573.17,-109.75\"/>\n</g>\n<!-- 140106808430352*&#45;&gt;140106808430352 -->\n<g id=\"edge2\" class=\"edge\">\n<title>140106808430352*&#45;&gt;140106808430352</title>\n<path fill=\"none\" stroke=\"black\" d=\"M290.34,-128.5C298.51,-128.5 308.08,-128.5 318.36,-128.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"318.39,-132 328.39,-128.5 318.39,-125 318.39,-132\"/>\n</g>\n<!-- 140106808439120 -->\n<g id=\"node8\" class=\"node\">\n<title>140106808439120</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"672,-82.5 672,-118.5 945,-118.5 945,-82.5 672,-82.5\"/>\n<text text-anchor=\"middle\" x=\"725\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">x1*w1 + x2*w2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"778,-82.5 778,-118.5 \"/>\n<text text-anchor=\"middle\" x=\"820.5\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"863,-82.5 863,-118.5 \"/>\n<text text-anchor=\"middle\" x=\"904\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808431568+ -->\n<g id=\"node15\" class=\"node\">\n<title>140106808431568+</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"1008\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"1008\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n</g>\n<!-- 140106808439120&#45;&gt;140106808431568+ -->\n<g id=\"edge7\" class=\"edge\">\n<title>140106808439120&#45;&gt;140106808431568+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M936.53,-82.49C949.09,-80.71 960.99,-79.02 971.3,-77.56\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"972.03,-80.99 981.44,-76.12 971.05,-74.06 972.03,-80.99\"/>\n</g>\n<!-- 140106808439120+&#45;&gt;140106808439120 -->\n<g id=\"edge3\" class=\"edge\">\n<title>140106808439120+&#45;&gt;140106808439120</title>\n<path fill=\"none\" stroke=\"black\" d=\"M636.23,-100.5C643.7,-100.5 652.41,-100.5 661.87,-100.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"661.98,-104 671.98,-100.5 661.98,-97 661.98,-104\"/>\n</g>\n<!-- 140106809589584 -->\n<g id=\"node10\" class=\"node\">\n<title>140106809589584</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"2.5,-110.5 2.5,-146.5 197.5,-146.5 197.5,-110.5 2.5,-110.5\"/>\n<text text-anchor=\"middle\" x=\"19\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">w2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"35.5,-110.5 35.5,-146.5 \"/>\n<text text-anchor=\"middle\" x=\"75.5\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 1.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"115.5,-110.5 115.5,-146.5 \"/>\n<text text-anchor=\"middle\" x=\"156.5\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106809589584&#45;&gt;140106808430352* -->\n<g id=\"edge13\" class=\"edge\">\n<title>140106809589584&#45;&gt;140106808430352*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M197.91,-128.5C207.65,-128.5 217.05,-128.5 225.52,-128.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"225.7,-132 235.7,-128.5 225.7,-125 225.7,-132\"/>\n</g>\n<!-- 140106808439184 -->\n<g id=\"node11\" class=\"node\">\n<title>140106808439184</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"716,-27.5 716,-63.5 901,-63.5 901,-27.5 716,-27.5\"/>\n<text text-anchor=\"middle\" x=\"727.5\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"739,-27.5 739,-63.5 \"/>\n<text text-anchor=\"middle\" x=\"779\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 6.8814</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"819,-27.5 819,-63.5 \"/>\n<text text-anchor=\"middle\" x=\"860\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808439184&#45;&gt;140106808431568+ -->\n<g id=\"edge14\" class=\"edge\">\n<title>140106808439184&#45;&gt;140106808431568+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M901.02,-58.01C926,-61.43 951.59,-64.93 971.37,-67.63\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"971.05,-71.12 981.43,-69.01 972,-64.18 971.05,-71.12\"/>\n</g>\n<!-- 140106808432080 -->\n<g id=\"node12\" class=\"node\">\n<title>140106808432080</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"1382,-54.5 1382,-90.5 1567,-90.5 1567,-54.5 1382,-54.5\"/>\n<text text-anchor=\"middle\" x=\"1393.5\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">o</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1405,-54.5 1405,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1445\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.7071</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1485,-54.5 1485,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1526\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n</g>\n<!-- 140106808432080tanh -->\n<g id=\"node13\" class=\"node\">\n<title>140106808432080tanh</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"1319\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"1319\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">tanh</text>\n</g>\n<!-- 140106808432080tanh&#45;&gt;140106808432080 -->\n<g id=\"edge4\" class=\"edge\">\n<title>140106808432080tanh&#45;&gt;140106808432080</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1346.04,-72.5C1353.58,-72.5 1362.3,-72.5 1371.57,-72.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1371.81,-76 1381.81,-72.5 1371.81,-69 1371.81,-76\"/>\n</g>\n<!-- 140106808431568 -->\n<g id=\"node14\" class=\"node\">\n<title>140106808431568</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"1071,-54.5 1071,-90.5 1256,-90.5 1256,-54.5 1071,-54.5\"/>\n<text text-anchor=\"middle\" x=\"1082.5\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">n</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1094,-54.5 1094,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1134\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.8814</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1174,-54.5 1174,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"1215\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808431568&#45;&gt;140106808432080tanh -->\n<g id=\"edge6\" class=\"edge\">\n<title>140106808431568&#45;&gt;140106808432080tanh</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1256.01,-72.5C1265.01,-72.5 1273.74,-72.5 1281.66,-72.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1281.91,-76 1291.91,-72.5 1281.91,-69 1281.91,-76\"/>\n</g>\n<!-- 140106808431568+&#45;&gt;140106808431568 -->\n<g id=\"edge5\" class=\"edge\">\n<title>140106808431568+&#45;&gt;140106808431568</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1035.04,-72.5C1042.58,-72.5 1051.3,-72.5 1060.57,-72.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1060.81,-76 1070.81,-72.5 1060.81,-69 1060.81,-76\"/>\n</g>\n</g>\n</svg>\n","content_type":"image/svg+xml"},"text/plain":{"content":"<graphviz.graphs.Digraph at 0x7f6d2886bad0>","content_type":"text/plain"}}},"children":[],"key":"v45zuQjB20"}],"key":"kaYEJl35Ax"}],"key":"J04Hg1xavT"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Voilà! ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Su8OrEeOXc"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"akwzOLfofF"}],"key":"UznaO8ePrF"},{"type":"text","value":" with a single ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zSKM1d4c78"},{"type":"inlineCode","value":"backward","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ulzRJGhHzz"},{"type":"text","value":" call. Let’s test it out one more time:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u1eC27CXRG"}],"key":"tXQoIZh4Al"}],"key":"TpmjYlNuvm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"a = Value(-2.0, label=\"a\")\nb = Value(3.0, label=\"b\")\nc = a * b\nc.label = \"c\"\nd = a + b\nd.label = \"d\"\ne = d * c\ne.label = \"e\"\ne.backward()\ndraw(e)","key":"f11fl1HTq6"},{"type":"outputs","id":"6QxSLNiD1oNSHwOky7sii","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":42,"metadata":{},"data":{"image/svg+xml":{"content":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 2.43.0 (0)\n -->\n<!-- Title: %3 Pages: 1 -->\n<svg width=\"834pt\" height=\"100pt\"\n viewBox=\"0.00 0.00 834.00 100.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 96)\">\n<title>%3</title>\n<polygon fill=\"white\" stroke=\"transparent\" points=\"-4,4 -4,-96 830,-96 830,4 -4,4\"/>\n<!-- 140106808434256 -->\n<g id=\"node1\" class=\"node\">\n<title>140106808434256</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"2.5,-55.5 2.5,-91.5 191.5,-91.5 191.5,-55.5 2.5,-55.5\"/>\n<text text-anchor=\"middle\" x=\"14\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"25.5,-55.5 25.5,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"65.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 3.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"105.5,-55.5 105.5,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"148.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;8.0000</text>\n</g>\n<!-- 140106808428752+ -->\n<g id=\"node5\" class=\"node\">\n<title>140106808428752+</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"257\" cy=\"-73.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"257\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n</g>\n<!-- 140106808434256&#45;&gt;140106808428752+ -->\n<g id=\"edge4\" class=\"edge\">\n<title>140106808434256&#45;&gt;140106808428752+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M191.74,-73.5C201.55,-73.5 211.04,-73.5 219.59,-73.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"219.87,-77 229.87,-73.5 219.87,-70 219.87,-77\"/>\n</g>\n<!-- 140106808437712* -->\n<g id=\"node8\" class=\"node\">\n<title>140106808437712*</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"257\" cy=\"-18.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"257\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n</g>\n<!-- 140106808434256&#45;&gt;140106808437712* -->\n<g id=\"edge9\" class=\"edge\">\n<title>140106808434256&#45;&gt;140106808437712*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M166.84,-55.49C176.04,-52.69 185.3,-49.67 194,-46.5 204.51,-42.67 215.73,-37.84 225.7,-33.28\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"227.23,-36.43 234.81,-29.02 224.27,-30.09 227.23,-36.43\"/>\n</g>\n<!-- 140106814652112 -->\n<g id=\"node2\" class=\"node\">\n<title>140106814652112</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"636,-27.5 636,-63.5 826,-63.5 826,-27.5 636,-27.5\"/>\n<text text-anchor=\"middle\" x=\"647.5\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">e</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"659,-27.5 659,-63.5 \"/>\n<text text-anchor=\"middle\" x=\"701.5\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"744,-27.5 744,-63.5 \"/>\n<text text-anchor=\"middle\" x=\"785\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n</g>\n<!-- 140106814652112* -->\n<g id=\"node3\" class=\"node\">\n<title>140106814652112*</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"573\" cy=\"-45.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"573\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n</g>\n<!-- 140106814652112*&#45;&gt;140106814652112 -->\n<g id=\"edge1\" class=\"edge\">\n<title>140106814652112*&#45;&gt;140106814652112</title>\n<path fill=\"none\" stroke=\"black\" d=\"M600.11,-45.5C607.63,-45.5 616.32,-45.5 625.58,-45.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"625.81,-49 635.81,-45.5 625.81,-42 625.81,-49\"/>\n</g>\n<!-- 140106808428752 -->\n<g id=\"node4\" class=\"node\">\n<title>140106808428752</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"320.5,-55.5 320.5,-91.5 509.5,-91.5 509.5,-55.5 320.5,-55.5\"/>\n<text text-anchor=\"middle\" x=\"332\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">d</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"343.5,-55.5 343.5,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"383.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 1.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"423.5,-55.5 423.5,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"466.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;6.0000</text>\n</g>\n<!-- 140106808428752&#45;&gt;140106814652112* -->\n<g id=\"edge5\" class=\"edge\">\n<title>140106808428752&#45;&gt;140106814652112*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M509.9,-56.65C519.42,-54.94 528.62,-53.29 536.89,-51.8\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"537.59,-55.23 546.81,-50.02 536.35,-48.34 537.59,-55.23\"/>\n</g>\n<!-- 140106808428752+&#45;&gt;140106808428752 -->\n<g id=\"edge2\" class=\"edge\">\n<title>140106808428752+&#45;&gt;140106808428752</title>\n<path fill=\"none\" stroke=\"black\" d=\"M284.11,-73.5C291.84,-73.5 300.8,-73.5 310.35,-73.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"310.48,-77 320.48,-73.5 310.48,-70 310.48,-77\"/>\n</g>\n<!-- 140106808441744 -->\n<g id=\"node6\" class=\"node\">\n<title>140106808441744</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"0,-0.5 0,-36.5 194,-36.5 194,-0.5 0,-0.5\"/>\n<text text-anchor=\"middle\" x=\"11.5\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">a</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"23,-0.5 23,-36.5 \"/>\n<text text-anchor=\"middle\" x=\"65.5\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;2.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"108,-0.5 108,-36.5 \"/>\n<text text-anchor=\"middle\" x=\"151\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;3.0000</text>\n</g>\n<!-- 140106808441744&#45;&gt;140106808428752+ -->\n<g id=\"edge8\" class=\"edge\">\n<title>140106808441744&#45;&gt;140106808428752+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M163.94,-36.53C174.08,-39.65 184.37,-43.01 194,-46.5 204.27,-50.22 215.26,-54.8 225.09,-59.12\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"223.91,-62.43 234.47,-63.32 226.77,-56.04 223.91,-62.43\"/>\n</g>\n<!-- 140106808441744&#45;&gt;140106808437712* -->\n<g id=\"edge6\" class=\"edge\">\n<title>140106808441744&#45;&gt;140106808437712*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M194.01,-18.5C202.98,-18.5 211.65,-18.5 219.51,-18.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"219.7,-22 229.7,-18.5 219.7,-15 219.7,-22\"/>\n</g>\n<!-- 140106808437712 -->\n<g id=\"node7\" class=\"node\">\n<title>140106808437712</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"320,-0.5 320,-36.5 510,-36.5 510,-0.5 320,-0.5\"/>\n<text text-anchor=\"middle\" x=\"331.5\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">c</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"343,-0.5 343,-36.5 \"/>\n<text text-anchor=\"middle\" x=\"385.5\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"428,-0.5 428,-36.5 \"/>\n<text text-anchor=\"middle\" x=\"469\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n</g>\n<!-- 140106808437712&#45;&gt;140106814652112* -->\n<g id=\"edge7\" class=\"edge\">\n<title>140106808437712&#45;&gt;140106814652112*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M510.34,-34.83C519.62,-36.44 528.58,-37.99 536.66,-39.38\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"536.27,-42.87 546.72,-41.12 537.46,-35.97 536.27,-42.87\"/>\n</g>\n<!-- 140106808437712*&#45;&gt;140106808437712 -->\n<g id=\"edge3\" class=\"edge\">\n<title>140106808437712*&#45;&gt;140106808437712</title>\n<path fill=\"none\" stroke=\"black\" d=\"M284.11,-18.5C291.63,-18.5 300.32,-18.5 309.58,-18.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"309.81,-22 319.81,-18.5 309.81,-15 309.81,-22\"/>\n</g>\n</g>\n</svg>\n","content_type":"image/svg+xml"},"text/plain":{"content":"<graphviz.graphs.Digraph at 0x7f6d288c3f50>","content_type":"text/plain"}}},"children":[],"key":"r5YDzt6gS5"}],"key":"uOGW94E3cy"}],"key":"NLJcCoWl6J"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Nice. That was easy... right? Next up, just to prove that this process works more generally, let’s add a few more complex operations to our ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P4C4Lf0KWm"},{"type":"inlineCode","value":"Value","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T6h1MaogDX"},{"type":"text","value":" class. First, a power operation:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S8VV2oE25d"}],"key":"RZ3rHZQFB3"}],"key":"EXI7uhJd3L"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"class Value(Value):\n    def __pow__(self, other):\n        assert isinstance(\n            other, (int, float)\n        ), \"only supporting int/float powers for now\"\n        out = self.__class__(\n            data=self.data**other,\n            prev=(self,),\n            op=f\"**{other}\",\n        )\n\n        def _backward():\n            self.grad += other * (self.data ** (other - 1)) * out.grad\n\n        out._backward = _backward\n        return out","visibility":"show","key":"vZTfwaLm8G"},{"type":"outputs","id":"IVgEe-h6goBD3fzpvxFBt","children":[],"visibility":"show","key":"AGkatZ3OT1"}],"visibility":"show","key":"mKkZUttxFt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"a = Value(2.0)\nb = 3.0\nc = a**b\nc.grad = 1.0\nc._backward()\nassert a.grad == b * a.data ** (b - 1)","key":"OiNLDRp4kh"},{"type":"outputs","id":"3c9oUv1zt6WZ_j86oZFwh","children":[],"key":"ogLRZC6QU3"}],"key":"xuwBsqq8LZ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Also, a division operation:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QRjYbHSDdf"}],"key":"ESD0MgrY7T"}],"key":"UKuLwDRvjL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"class Value(Value):\n    def __truediv__(self, other):  # self / other\n        return self * other**-1","key":"XskfizjwHn"},{"type":"outputs","id":"wpa-6sNB0AbrajTZc8iJd","children":[],"key":"xIiSA68FlX"}],"key":"rvIEBkxpFX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"a = Value(2.0)\nb = Value(4.0)\nc = a / b\nassert c.data == (a * (1/b.data)).data == (a * b**-1).data\nc.grad = 1.0; c._backward()\nassert a.grad == 1 / b.data","key":"JK1fLlq4Jy"},{"type":"outputs","id":"2oYiO5gElg6XtVlERVSw1","children":[],"key":"CQDanuZADW"}],"key":"ZuihPNbT1F"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And last, but not least, an exponentiation operation:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rogBgQcOtf"}],"key":"PXIYvi73W0"}],"key":"zfc7fzBuN4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"class Value(Value):\n    def exp(self):\n        out = self.__class__(\n            data=math.exp(self.data),\n            prev=(self,),\n            op=\"exp\",\n        )\n\n        def _backward():\n            self.grad += out.data * out.grad\n\n        out._backward = _backward\n        return out","key":"P8N7i2KsFX"},{"type":"outputs","id":"Q1RiEbnaj5-McPoW2pg_g","children":[],"key":"WTyVlP45WE"}],"key":"jnFi2tgv4s"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"a = Value(2.0)\na_exp = a.exp()\na_exp.grad = 1.0; a_exp._backward()\nassert a.grad == a_exp.data","key":"FqT6FrE7EK"},{"type":"outputs","id":"tYOeHep3zfPGznCGycrL5","children":[],"key":"pwIYrg43ZZ"}],"key":"XvWLD5o9vy"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Using these newly defined operations, we can now explicitly define our own ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jl2Rgctzbo"},{"type":"link","url":"https://en.wikipedia.org/wiki/Hyperbolic_functions#Exponential_definitions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineCode","value":"tanh","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O9OwfPV1nA"},{"type":"text","value":" operation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z1vaEdydtW"}],"urlSource":"https://en.wikipedia.org/wiki/Hyperbolic_functions#Exponential_definitions","data":{"page":"Hyperbolic_functions#Exponential_definitions","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"oyTn0JG4IA"},{"type":"text","value":", expressed as a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KtFFMvXhRy"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"composite","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wWOsynJZmI"}],"key":"sirIy0k6Oz"},{"type":"text","value":" operation, consisting of a combination of operations, as follows:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ibwpzNgSIj"}],"key":"mlAiLCXFP8"}],"key":"SYC6Ic8Aam"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"class Value(Value):\n    def tanh(self):\n        e = (2 * self).exp()\n        return (e - 1) / (e + 1)","key":"S29W16v6xz"},{"type":"outputs","id":"G90tDdaGja5PDHe0puODP","children":[],"key":"lkXZxmm0dS"}],"key":"h9L8u7k55A"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"a = Value(2.0)\na_tanh = a.tanh()\na_tanh.backward()\nassert math.isclose(a.grad, (1 - a_tanh.data**2))","key":"QhaZsUTeK9"},{"type":"outputs","id":"BKfVU0fgxBDRyU77tSQhC","children":[],"key":"BOH19cAxej"}],"key":"xAzZKmBvAp"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Furthermore, reactivating the neuron, now  with the new ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mgp2YV2K9x"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"composite","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r10RtABYgf"}],"key":"RnhO1JOYh0"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q7kyYZqK62"},{"type":"inlineCode","value":"tanh","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GnQaS7siMM"},{"type":"text","value":", and doing ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"N5trv2EWVQ"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nhIEdVBqnS"}],"key":"JUJORNpBlb"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"drSoqC5oEn"}],"key":"W9fw9nl57b"}],"key":"YmtKNWYvyS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"activate_neuron()\no.backward()","key":"qdtOEWs5hO"},{"type":"outputs","id":"-hA3hvlZkIMlZpBzOHRnE","children":[],"key":"p0rB7n9xQh"}],"key":"rO8TwKOwJ7"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"yields...","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TlBUPHer2g"}],"key":"TTuZfMCqCj"}],"key":"AmUHPavsPN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"draw(o)","key":"YqBgJwmJzm"},{"type":"outputs","id":"NcrBgXt_U7mVi5Mkjvazs","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":52,"metadata":{},"data":{"image/svg+xml":{"content":"<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 2.43.0 (0)\n -->\n<!-- Title: %3 Pages: 1 -->\n<svg width=\"2944pt\" height=\"239pt\"\n viewBox=\"0.00 0.00 2944.00 239.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 235)\">\n<title>%3</title>\n<polygon fill=\"white\" stroke=\"transparent\" points=\"-4,4 -4,-235 2940,-235 2940,4 -4,4\"/>\n<!-- 140106808455184 -->\n<g id=\"node1\" class=\"node\">\n<title>140106808455184</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"2751,-54.5 2751,-90.5 2936,-90.5 2936,-54.5 2751,-54.5\"/>\n<text text-anchor=\"middle\" x=\"2762.5\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">o</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"2774,-54.5 2774,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"2814\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.7071</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"2854,-54.5 2854,-90.5 \"/>\n<text text-anchor=\"middle\" x=\"2895\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n</g>\n<!-- 140106808455184* -->\n<g id=\"node2\" class=\"node\">\n<title>140106808455184*</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"2688\" cy=\"-72.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"2688\" y=\"-68.8\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n</g>\n<!-- 140106808455184*&#45;&gt;140106808455184 -->\n<g id=\"edge1\" class=\"edge\">\n<title>140106808455184*&#45;&gt;140106808455184</title>\n<path fill=\"none\" stroke=\"black\" d=\"M2715.04,-72.5C2722.58,-72.5 2731.3,-72.5 2740.57,-72.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"2740.81,-76 2750.81,-72.5 2740.81,-69 2740.81,-76\"/>\n</g>\n<!-- 140106808454672 -->\n<g id=\"node3\" class=\"node\">\n<title>140106808454672</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"2225,-27.5 2225,-63.5 2407,-63.5 2407,-27.5 2225,-27.5\"/>\n<text text-anchor=\"middle\" x=\"2235\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\"> </text>\n<polyline fill=\"none\" stroke=\"black\" points=\"2245,-27.5 2245,-63.5 \"/>\n<text text-anchor=\"middle\" x=\"2285\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 4.8284</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"2325,-27.5 2325,-63.5 \"/>\n<text text-anchor=\"middle\" x=\"2366\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.1464</text>\n</g>\n<!-- 140106808454672&#45;&gt;140106808455184* -->\n<g id=\"edge20\" class=\"edge\">\n<title>140106808454672&#45;&gt;140106808455184*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M2407.04,-52.07C2485.41,-57.79 2594.98,-65.79 2650.96,-69.87\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"2650.87,-73.37 2661.1,-70.61 2651.38,-66.39 2650.87,-73.37\"/>\n</g>\n<!-- 140106808454672+ -->\n<g id=\"node4\" class=\"node\">\n<title>140106808454672+</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"1940\" cy=\"-45.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"1940\" y=\"-41.8\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n</g>\n<!-- 140106808454672+&#45;&gt;140106808454672 -->\n<g id=\"edge2\" class=\"edge\">\n<title>140106808454672+&#45;&gt;140106808454672</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1967,-45.5C2017.46,-45.5 2131.06,-45.5 2214.81,-45.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"2214.87,-49 2224.87,-45.5 2214.87,-42 2214.87,-49\"/>\n</g>\n<!-- 140106808454160 -->\n<g id=\"node5\" class=\"node\">\n<title>140106808454160</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"672,-111.5 672,-147.5 945,-147.5 945,-111.5 672,-111.5\"/>\n<text text-anchor=\"middle\" x=\"725\" y=\"-125.8\" font-family=\"Times,serif\" font-size=\"14.00\">x1*w1 + x2*w2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"778,-111.5 778,-147.5 \"/>\n<text text-anchor=\"middle\" x=\"820.5\" y=\"-125.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"863,-111.5 863,-147.5 \"/>\n<text text-anchor=\"middle\" x=\"904\" y=\"-125.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808454224+ -->\n<g id=\"node9\" class=\"node\">\n<title>140106808454224+</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"1008\" cy=\"-101.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"1008\" y=\"-97.8\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n</g>\n<!-- 140106808454160&#45;&gt;140106808454224+ -->\n<g id=\"edge25\" class=\"edge\">\n<title>140106808454160&#45;&gt;140106808454224+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M936.53,-111.49C949.09,-109.71 960.99,-108.02 971.3,-106.56\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"972.03,-109.99 981.44,-105.12 971.05,-103.06 972.03,-109.99\"/>\n</g>\n<!-- 140106808454160+ -->\n<g id=\"node6\" class=\"node\">\n<title>140106808454160+</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"609\" cy=\"-129.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"609\" y=\"-125.8\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n</g>\n<!-- 140106808454160+&#45;&gt;140106808454160 -->\n<g id=\"edge3\" class=\"edge\">\n<title>140106808454160+&#45;&gt;140106808454160</title>\n<path fill=\"none\" stroke=\"black\" d=\"M636.23,-129.5C643.7,-129.5 652.41,-129.5 661.87,-129.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"661.98,-133 671.98,-129.5 661.98,-126 661.98,-133\"/>\n</g>\n<!-- 140106808452560 -->\n<g id=\"node7\" class=\"node\">\n<title>140106808452560</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"2,-84.5 2,-120.5 198,-120.5 198,-84.5 2,-84.5\"/>\n<text text-anchor=\"middle\" x=\"17\" y=\"-98.8\" font-family=\"Times,serif\" font-size=\"14.00\">x1</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"32,-84.5 32,-120.5 \"/>\n<text text-anchor=\"middle\" x=\"72\" y=\"-98.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"112,-84.5 112,-120.5 \"/>\n<text text-anchor=\"middle\" x=\"155\" y=\"-98.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;1.5000</text>\n</g>\n<!-- 140106808446416* -->\n<g id=\"node26\" class=\"node\">\n<title>140106808446416*</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"263\" cy=\"-102.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"263\" y=\"-98.8\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n</g>\n<!-- 140106808452560&#45;&gt;140106808446416* -->\n<g id=\"edge18\" class=\"edge\">\n<title>140106808452560&#45;&gt;140106808446416*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M198.37,-102.5C208.05,-102.5 217.4,-102.5 225.8,-102.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"225.91,-106 235.91,-102.5 225.91,-99 225.91,-106\"/>\n</g>\n<!-- 140106808454224 -->\n<g id=\"node8\" class=\"node\">\n<title>140106808454224</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"1071,-83.5 1071,-119.5 1256,-119.5 1256,-83.5 1071,-83.5\"/>\n<text text-anchor=\"middle\" x=\"1082.5\" y=\"-97.8\" font-family=\"Times,serif\" font-size=\"14.00\">n</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1094,-83.5 1094,-119.5 \"/>\n<text text-anchor=\"middle\" x=\"1134\" y=\"-97.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.8814</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1174,-83.5 1174,-119.5 \"/>\n<text text-anchor=\"middle\" x=\"1215\" y=\"-97.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808454288* -->\n<g id=\"node15\" class=\"node\">\n<title>140106808454288*</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"1319\" cy=\"-73.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"1319\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n</g>\n<!-- 140106808454224&#45;&gt;140106808454288* -->\n<g id=\"edge28\" class=\"edge\">\n<title>140106808454224&#45;&gt;140106808454288*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1256.01,-84.81C1265.49,-83.08 1274.66,-81.41 1282.9,-79.9\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1283.6,-83.33 1292.81,-78.09 1282.35,-76.45 1283.6,-83.33\"/>\n</g>\n<!-- 140106808454224+&#45;&gt;140106808454224 -->\n<g id=\"edge4\" class=\"edge\">\n<title>140106808454224+&#45;&gt;140106808454224</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1035.04,-101.5C1042.58,-101.5 1051.3,-101.5 1060.57,-101.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1060.81,-105 1070.81,-101.5 1060.81,-98 1060.81,-105\"/>\n</g>\n<!-- 140106808454736 -->\n<g id=\"node10\" class=\"node\">\n<title>140106808454736</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"2003,-82.5 2003,-118.5 2189,-118.5 2189,-82.5 2003,-82.5\"/>\n<text text-anchor=\"middle\" x=\"2013\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\"> </text>\n<polyline fill=\"none\" stroke=\"black\" points=\"2023,-82.5 2023,-118.5 \"/>\n<text text-anchor=\"middle\" x=\"2063\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 6.8284</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"2103,-82.5 2103,-118.5 \"/>\n<text text-anchor=\"middle\" x=\"2146\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;0.1036</text>\n</g>\n<!-- 140106808454928**&#45;1 -->\n<g id=\"node21\" class=\"node\">\n<title>140106808454928**&#45;1</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"2316\" cy=\"-100.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"2316\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">**&#45;1</text>\n</g>\n<!-- 140106808454736&#45;&gt;140106808454928**&#45;1 -->\n<g id=\"edge27\" class=\"edge\">\n<title>140106808454736&#45;&gt;140106808454928**&#45;1</title>\n<path fill=\"none\" stroke=\"black\" d=\"M2189.14,-100.5C2220.72,-100.5 2254.24,-100.5 2278.74,-100.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"2278.98,-104 2288.98,-100.5 2278.98,-97 2278.98,-104\"/>\n</g>\n<!-- 140106808454736+ -->\n<g id=\"node11\" class=\"node\">\n<title>140106808454736+</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"1940\" cy=\"-100.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"1940\" y=\"-96.8\" font-family=\"Times,serif\" font-size=\"14.00\">+</text>\n</g>\n<!-- 140106808454736+&#45;&gt;140106808454736 -->\n<g id=\"edge5\" class=\"edge\">\n<title>140106808454736+&#45;&gt;140106808454736</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1967.12,-100.5C1974.62,-100.5 1983.29,-100.5 1992.5,-100.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1992.69,-104 2002.69,-100.5 1992.69,-97 1992.69,-104\"/>\n</g>\n<!-- 140106808454096 -->\n<g id=\"node12\" class=\"node\">\n<title>140106808454096</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"328.5,-139.5 328.5,-175.5 543.5,-175.5 543.5,-139.5 328.5,-139.5\"/>\n<text text-anchor=\"middle\" x=\"355\" y=\"-153.8\" font-family=\"Times,serif\" font-size=\"14.00\">x2*w2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"381.5,-139.5 381.5,-175.5 \"/>\n<text text-anchor=\"middle\" x=\"421.5\" y=\"-153.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"461.5,-139.5 461.5,-175.5 \"/>\n<text text-anchor=\"middle\" x=\"502.5\" y=\"-153.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808454096&#45;&gt;140106808454160+ -->\n<g id=\"edge22\" class=\"edge\">\n<title>140106808454096&#45;&gt;140106808454160+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M543.84,-140.01C554.01,-138.34 563.76,-136.74 572.44,-135.32\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"573.17,-138.75 582.47,-133.68 572.04,-131.84 573.17,-138.75\"/>\n</g>\n<!-- 140106808454096* -->\n<g id=\"node13\" class=\"node\">\n<title>140106808454096*</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"263\" cy=\"-157.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"263\" y=\"-153.8\" font-family=\"Times,serif\" font-size=\"14.00\">*</text>\n</g>\n<!-- 140106808454096*&#45;&gt;140106808454096 -->\n<g id=\"edge6\" class=\"edge\">\n<title>140106808454096*&#45;&gt;140106808454096</title>\n<path fill=\"none\" stroke=\"black\" d=\"M290.34,-157.5C298.51,-157.5 308.08,-157.5 318.36,-157.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"318.39,-161 328.39,-157.5 318.39,-154 318.39,-161\"/>\n</g>\n<!-- 140106808454288 -->\n<g id=\"node14\" class=\"node\">\n<title>140106808454288</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"1382,-55.5 1382,-91.5 1564,-91.5 1564,-55.5 1382,-55.5\"/>\n<text text-anchor=\"middle\" x=\"1392\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\"> </text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1402,-55.5 1402,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"1442\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 1.7627</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1482,-55.5 1482,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"1523\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.2500</text>\n</g>\n<!-- 140106808454480exp -->\n<g id=\"node23\" class=\"node\">\n<title>140106808454480exp</title>\n<ellipse fill=\"none\" stroke=\"black\" cx=\"1627\" cy=\"-73.5\" rx=\"27\" ry=\"18\"/>\n<text text-anchor=\"middle\" x=\"1627\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">exp</text>\n</g>\n<!-- 140106808454288&#45;&gt;140106808454480exp -->\n<g id=\"edge12\" class=\"edge\">\n<title>140106808454288&#45;&gt;140106808454480exp</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1564.18,-73.5C1573.14,-73.5 1581.83,-73.5 1589.73,-73.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1589.96,-77 1599.96,-73.5 1589.96,-70 1589.96,-77\"/>\n</g>\n<!-- 140106808454288*&#45;&gt;140106808454288 -->\n<g id=\"edge7\" class=\"edge\">\n<title>140106808454288*&#45;&gt;140106808454288</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1346.13,-73.5C1353.67,-73.5 1362.39,-73.5 1371.64,-73.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1371.87,-77 1381.87,-73.5 1371.87,-70 1371.87,-77\"/>\n</g>\n<!-- 140106808454800 -->\n<g id=\"node16\" class=\"node\">\n<title>140106808454800</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"1690.5,-110.5 1690.5,-146.5 1876.5,-146.5 1876.5,-110.5 1690.5,-110.5\"/>\n<text text-anchor=\"middle\" x=\"1700.5\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\"> </text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1710.5,-110.5 1710.5,-146.5 \"/>\n<text text-anchor=\"middle\" x=\"1750.5\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 1.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1790.5,-110.5 1790.5,-146.5 \"/>\n<text text-anchor=\"middle\" x=\"1833.5\" y=\"-124.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad &#45;0.1036</text>\n</g>\n<!-- 140106808454800&#45;&gt;140106808454736+ -->\n<g id=\"edge21\" class=\"edge\">\n<title>140106808454800&#45;&gt;140106808454736+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1876.6,-111.81C1886.15,-110.08 1895.37,-108.41 1903.68,-106.9\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1904.43,-110.32 1913.65,-105.09 1903.18,-103.43 1904.43,-110.32\"/>\n</g>\n<!-- 140106808454352 -->\n<g id=\"node17\" class=\"node\">\n<title>140106808454352</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"1072.5,-28.5 1072.5,-64.5 1254.5,-64.5 1254.5,-28.5 1072.5,-28.5\"/>\n<text text-anchor=\"middle\" x=\"1082.5\" y=\"-42.8\" font-family=\"Times,serif\" font-size=\"14.00\"> </text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1092.5,-28.5 1092.5,-64.5 \"/>\n<text text-anchor=\"middle\" x=\"1132.5\" y=\"-42.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 2.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1172.5,-28.5 1172.5,-64.5 \"/>\n<text text-anchor=\"middle\" x=\"1213.5\" y=\"-42.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.2203</text>\n</g>\n<!-- 140106808454352&#45;&gt;140106808454288* -->\n<g id=\"edge14\" class=\"edge\">\n<title>140106808454352&#45;&gt;140106808454288*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1254.68,-62.36C1264.61,-64.11 1274.23,-65.8 1282.84,-67.32\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1282.36,-70.78 1292.81,-69.07 1283.57,-63.89 1282.36,-70.78\"/>\n</g>\n<!-- 140106808453392 -->\n<g id=\"node18\" class=\"node\">\n<title>140106808453392</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"0,-29.5 0,-65.5 200,-65.5 200,-29.5 0,-29.5\"/>\n<text text-anchor=\"middle\" x=\"16.5\" y=\"-43.8\" font-family=\"Times,serif\" font-size=\"14.00\">w1</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"33,-29.5 33,-65.5 \"/>\n<text text-anchor=\"middle\" x=\"75.5\" y=\"-43.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;3.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"118,-29.5 118,-65.5 \"/>\n<text text-anchor=\"middle\" x=\"159\" y=\"-43.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 1.0000</text>\n</g>\n<!-- 140106808453392&#45;&gt;140106808446416* -->\n<g id=\"edge16\" class=\"edge\">\n<title>140106808453392&#45;&gt;140106808446416*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M172.53,-65.56C181.84,-68.33 191.2,-71.33 200,-74.5 210.53,-78.29 221.75,-83.1 231.72,-87.67\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"230.28,-90.86 240.82,-91.93 233.25,-84.52 230.28,-90.86\"/>\n</g>\n<!-- 140106808453904 -->\n<g id=\"node19\" class=\"node\">\n<title>140106808453904</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"4,-194.5 4,-230.5 196,-230.5 196,-194.5 4,-194.5\"/>\n<text text-anchor=\"middle\" x=\"19\" y=\"-208.8\" font-family=\"Times,serif\" font-size=\"14.00\">x2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"34,-194.5 34,-230.5 \"/>\n<text text-anchor=\"middle\" x=\"74\" y=\"-208.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"114,-194.5 114,-230.5 \"/>\n<text text-anchor=\"middle\" x=\"155\" y=\"-208.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808453904&#45;&gt;140106808454096* -->\n<g id=\"edge17\" class=\"edge\">\n<title>140106808453904&#45;&gt;140106808454096*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M169.28,-194.5C179.65,-191.39 190.16,-188.02 200,-184.5 210.28,-180.83 221.28,-176.26 231.11,-171.93\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"232.79,-175.01 240.48,-167.73 229.93,-168.63 232.79,-175.01\"/>\n</g>\n<!-- 140106808454928 -->\n<g id=\"node20\" class=\"node\">\n<title>140106808454928</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"2443,-80.5 2443,-116.5 2625,-116.5 2625,-80.5 2443,-80.5\"/>\n<text text-anchor=\"middle\" x=\"2453\" y=\"-94.8\" font-family=\"Times,serif\" font-size=\"14.00\"> </text>\n<polyline fill=\"none\" stroke=\"black\" points=\"2463,-80.5 2463,-116.5 \"/>\n<text text-anchor=\"middle\" x=\"2503\" y=\"-94.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 0.1464</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"2543,-80.5 2543,-116.5 \"/>\n<text text-anchor=\"middle\" x=\"2584\" y=\"-94.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 4.8284</text>\n</g>\n<!-- 140106808454928&#45;&gt;140106808455184* -->\n<g id=\"edge11\" class=\"edge\">\n<title>140106808454928&#45;&gt;140106808455184*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M2625.18,-83.08C2634.42,-81.49 2643.38,-79.96 2651.47,-78.58\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"2652.29,-81.99 2661.56,-76.85 2651.11,-75.09 2652.29,-81.99\"/>\n</g>\n<!-- 140106808454928**&#45;1&#45;&gt;140106808454928 -->\n<g id=\"edge8\" class=\"edge\">\n<title>140106808454928**&#45;1&#45;&gt;140106808454928</title>\n<path fill=\"none\" stroke=\"black\" d=\"M2343.05,-100.26C2365.53,-100.05 2399.48,-99.74 2432.5,-99.43\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"2432.74,-102.93 2442.7,-99.34 2432.67,-95.93 2432.74,-102.93\"/>\n</g>\n<!-- 140106808454480 -->\n<g id=\"node22\" class=\"node\">\n<title>140106808454480</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"1692.5,-55.5 1692.5,-91.5 1874.5,-91.5 1874.5,-55.5 1692.5,-55.5\"/>\n<text text-anchor=\"middle\" x=\"1702.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\"> </text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1712.5,-55.5 1712.5,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"1752.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 5.8284</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1792.5,-55.5 1792.5,-91.5 \"/>\n<text text-anchor=\"middle\" x=\"1833.5\" y=\"-69.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0429</text>\n</g>\n<!-- 140106808454480&#45;&gt;140106808454672+ -->\n<g id=\"edge19\" class=\"edge\">\n<title>140106808454480&#45;&gt;140106808454672+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1874.82,-57.13C1885.07,-55.27 1895.01,-53.47 1903.88,-51.87\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1904.54,-55.3 1913.75,-50.08 1903.29,-48.42 1904.54,-55.3\"/>\n</g>\n<!-- 140106808454480&#45;&gt;140106808454736+ -->\n<g id=\"edge15\" class=\"edge\">\n<title>140106808454480&#45;&gt;140106808454736+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1874.82,-89.28C1885.07,-91.08 1895.01,-92.81 1903.88,-94.36\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1903.3,-97.81 1913.75,-96.09 1904.5,-90.92 1903.3,-97.81\"/>\n</g>\n<!-- 140106808454480exp&#45;&gt;140106808454480 -->\n<g id=\"edge9\" class=\"edge\">\n<title>140106808454480exp&#45;&gt;140106808454480</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1654.21,-73.5C1662.34,-73.5 1671.85,-73.5 1681.94,-73.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1682.19,-77 1692.19,-73.5 1682.19,-70 1682.19,-77\"/>\n</g>\n<!-- 140106808453968 -->\n<g id=\"node24\" class=\"node\">\n<title>140106808453968</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"2.5,-139.5 2.5,-175.5 197.5,-175.5 197.5,-139.5 2.5,-139.5\"/>\n<text text-anchor=\"middle\" x=\"19\" y=\"-153.8\" font-family=\"Times,serif\" font-size=\"14.00\">w2</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"35.5,-139.5 35.5,-175.5 \"/>\n<text text-anchor=\"middle\" x=\"75.5\" y=\"-153.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 1.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"115.5,-139.5 115.5,-175.5 \"/>\n<text text-anchor=\"middle\" x=\"156.5\" y=\"-153.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.0000</text>\n</g>\n<!-- 140106808453968&#45;&gt;140106808454096* -->\n<g id=\"edge13\" class=\"edge\">\n<title>140106808453968&#45;&gt;140106808454096*</title>\n<path fill=\"none\" stroke=\"black\" d=\"M197.91,-157.5C207.65,-157.5 217.05,-157.5 225.52,-157.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"225.7,-161 235.7,-157.5 225.7,-154 225.7,-161\"/>\n</g>\n<!-- 140106808446416 -->\n<g id=\"node25\" class=\"node\">\n<title>140106808446416</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"326,-84.5 326,-120.5 546,-120.5 546,-84.5 326,-84.5\"/>\n<text text-anchor=\"middle\" x=\"352.5\" y=\"-98.8\" font-family=\"Times,serif\" font-size=\"14.00\">x1*w1</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"379,-84.5 379,-120.5 \"/>\n<text text-anchor=\"middle\" x=\"421.5\" y=\"-98.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;6.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"464,-84.5 464,-120.5 \"/>\n<text text-anchor=\"middle\" x=\"505\" y=\"-98.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808446416&#45;&gt;140106808454160+ -->\n<g id=\"edge26\" class=\"edge\">\n<title>140106808446416&#45;&gt;140106808454160+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M546.27,-119.75C555.64,-121.23 564.6,-122.65 572.65,-123.92\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"572.23,-127.4 582.65,-125.5 573.32,-120.48 572.23,-127.4\"/>\n</g>\n<!-- 140106808446416*&#45;&gt;140106808446416 -->\n<g id=\"edge10\" class=\"edge\">\n<title>140106808446416*&#45;&gt;140106808446416</title>\n<path fill=\"none\" stroke=\"black\" d=\"M290.34,-102.5C297.77,-102.5 306.37,-102.5 315.6,-102.5\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"315.84,-106 325.84,-102.5 315.84,-99 315.84,-106\"/>\n</g>\n<!-- 140106808454032 -->\n<g id=\"node27\" class=\"node\">\n<title>140106808454032</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"716,-56.5 716,-92.5 901,-92.5 901,-56.5 716,-56.5\"/>\n<text text-anchor=\"middle\" x=\"727.5\" y=\"-70.8\" font-family=\"Times,serif\" font-size=\"14.00\">b</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"739,-56.5 739,-92.5 \"/>\n<text text-anchor=\"middle\" x=\"779\" y=\"-70.8\" font-family=\"Times,serif\" font-size=\"14.00\">data 6.8814</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"819,-56.5 819,-92.5 \"/>\n<text text-anchor=\"middle\" x=\"860\" y=\"-70.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.5000</text>\n</g>\n<!-- 140106808454032&#45;&gt;140106808454224+ -->\n<g id=\"edge23\" class=\"edge\">\n<title>140106808454032&#45;&gt;140106808454224+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M901.02,-87.01C926,-90.43 951.59,-93.93 971.37,-96.63\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"971.05,-100.12 981.43,-98.01 972,-93.18 971.05,-100.12\"/>\n</g>\n<!-- 140106808454608 -->\n<g id=\"node28\" class=\"node\">\n<title>140106808454608</title>\n<polygon fill=\"none\" stroke=\"black\" points=\"1690,-0.5 1690,-36.5 1877,-36.5 1877,-0.5 1690,-0.5\"/>\n<text text-anchor=\"middle\" x=\"1700\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\"> </text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1710,-0.5 1710,-36.5 \"/>\n<text text-anchor=\"middle\" x=\"1752.5\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">data &#45;1.0000</text>\n<polyline fill=\"none\" stroke=\"black\" points=\"1795,-0.5 1795,-36.5 \"/>\n<text text-anchor=\"middle\" x=\"1836\" y=\"-14.8\" font-family=\"Times,serif\" font-size=\"14.00\">grad 0.1464</text>\n</g>\n<!-- 140106808454608&#45;&gt;140106808454672+ -->\n<g id=\"edge24\" class=\"edge\">\n<title>140106808454608&#45;&gt;140106808454672+</title>\n<path fill=\"none\" stroke=\"black\" d=\"M1877.05,-34.67C1886.34,-36.3 1895.33,-37.87 1903.44,-39.29\"/>\n<polygon fill=\"black\" stroke=\"black\" points=\"1903.1,-42.78 1913.55,-41.05 1904.3,-35.88 1903.1,-42.78\"/>\n</g>\n</g>\n</svg>\n","content_type":"image/svg+xml"},"text/plain":{"content":"<graphviz.graphs.Digraph at 0x7f6d288c7410>","content_type":"text/plain"}}},"children":[],"key":"YGESzAhhOg"}],"key":"eB7hhGcuAr"}],"key":"DsVQikEYSd"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"...the same gradients as before! In the end, what matters is being able to do a functional forward pass and backward pass (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Cq2OYzDakp"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PYjK8RCB9e"}],"key":"jlNnPrJdNA"},{"type":"text","value":") on the output of any of such operation we have defined, no matter how “composite” it is. If you apply the chain rule properly, as demonstrated, the design of the function and it’s complexity are totally up to you. As long as the backward processes are correct, properly, all is good.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UR1Fxp3y3e"}],"key":"T226AUZIou"}],"key":"gabHVpy1wt"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So now let’s do the exact same thing using a modern deep neural network library, like ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P9lQSnlWS2"},{"type":"link","url":"https://PyTorch.org/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"PyTorch","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xJlea9dBIV"}],"urlSource":"https://PyTorch.org/","key":"p1yjne41KH"},{"type":"text","value":", on which ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zdzSxM7oqM"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"micrograd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"trIeJvRuGr"}],"key":"QzVGVGhl1a"},{"type":"text","value":" is roughly modeled.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YnYxPYHCbU"}],"key":"xgC6iCRwOx"}],"visibility":"show","key":"jT8c4DuiDo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import torch","key":"Aq0DyeBW0Y"},{"type":"outputs","id":"W4EdFbfZ41YQ3jv0qTW1n","children":[],"key":"Y0ARfJVfcW"}],"key":"eCejVmCoFD"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In PyTorch, the equivalent of our ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zoQI0oNudD"},{"type":"inlineCode","value":"Value","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z1tERoVxc1"},{"type":"text","value":" object is the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VJcYkZ5s3d"},{"type":"inlineCode","value":"Tensor","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c9AXRD4sxq"},{"type":"text","value":" object. Tensors are just n-dimensional arrays of scalars. Examples:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"e7M7D4E1Jf"}],"key":"AbA2OM9jlR"}],"key":"lt4WJeFYTV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"torch.Tensor([2.0])  # 1x1 tensor\ntorch.Tensor([[1.0, 2.0, 3.0], [4.0, 5.0, 6.0]])  # 2x3 tensor","key":"R4edCyWHqi"},{"type":"outputs","id":"RUAKL7t3kw9jNLGFc5iZB","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":54,"metadata":{},"data":{"text/plain":{"content":"tensor([[1., 2., 3.],\n        [4., 5., 6.]])","content_type":"text/plain"}}},"children":[],"key":"Keen5M3cKU"}],"key":"JXBNNdb6hx"}],"key":"E1AmuUSOFj"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Like ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rifZQjbMay"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"micrograd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fZ5DMnp8ic"}],"key":"ZNUttD4ZQu"},{"type":"text","value":", PyTorch let’s us construct the mathematical expression of a neuron function on which we can perform ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gQRxtufKYj"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v7LzjodGBA"}],"key":"goM9SpdDeE"},{"type":"text","value":"!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"txMDRwePDx"}],"key":"nMY6tBWQUQ"}],"key":"QrXqQwgJA3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x1 = torch.tensor([2.0]).double().requires_grad_(True)\nx2 = torch.tensor([0.0]).double().requires_grad_(True)\nw1 = torch.tensor([-3.0]).double().requires_grad_(True)\nw2 = torch.tensor([1.0]).double().requires_grad_(True)\nb = torch.tensor([6.8813735870195432]).double().requires_grad_(True)\nn = x1 * w1 + x2 * w2 + b\no = torch.tanh(n)\nprint(o.data.item())\no.backward()\nprint(\"---\")\nprint(\"x2\", x2.grad.item())\nprint(\"w2\", w2.grad.item())\nprint(\"x1\", x1.grad.item())\nprint(\"w1\", w1.grad.item())","key":"c7MyAmG3rF"},{"type":"outputs","id":"b0L0DlZkIY9Yd2k3Rx2_B","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"0.7071066904050358\n---\nx2 0.5000001283844369\nw2 0.0\nx1 -1.5000003851533106\nw1 1.0000002567688737\n"},"children":[],"key":"FXhDGbFJGI"}],"key":"lbpJofPYaa"}],"key":"qIugVkh0qw"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineCode","value":"tensor()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o14CkUmiME"},{"type":"text","value":" makes a tensor, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qoGRbVMNeq"},{"type":"inlineCode","value":"double()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YuiNTI1xnu"},{"type":"text","value":" casts it to a double-precision data type (as Python also does, by default) and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JBgE8wL9rx"},{"type":"inlineCode","value":"requires_grad_()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zUS7u9pU27"},{"type":"text","value":" enables gradient calculation for that tensor. In PyTorch, one has to explicitly enable it, as gradient calculation is disabled by default for efficiency reasons. Above, we just use single-element scalar tensors. But the whole point of PyTorch is to work with multi-dimensional tensors that can be acted upon in parallel by many different operations. Nevertheless, what we have built very much agrees with the API of PyTorch! Let’s now construct the mathematical expression that constitutes a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oAIUFSyHIx"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ticXwh92uG"}],"key":"l1JtYodx2q"},{"type":"text","value":", piece by piece, specifically a 2-layer ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XZ0WW4wVfe"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"mlp","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xpOew2d1aR"}],"key":"cxqorzXfcI"},{"type":"text","value":". We’ll start out by writing up a neuron as we’ve implemented it so far, but making it subscribe to the PyTorch API model in how it designs its own ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eLGBko6f2T"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Eeph29iKE5"}],"key":"ltsJnkT6na"},{"type":"text","value":" modules.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xB4SU4LCyj"}],"key":"qHhVpWInR0"}],"key":"VOcggbsRoH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import random\n\n\nclass Neuron:\n    def __init__(self, nin):\n        self.w = [Value(random.uniform(-1, 1)) for _ in range(nin)]\n        self.b = Value(random.uniform(-1, 1))","key":"NITFib2EVc"},{"type":"outputs","id":"4G4yK1hSe6UFZYPFrl7zd","children":[],"key":"aLVLXZaC3m"}],"key":"JRBu0msCiN"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineCode","value":"w","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xDrwAZKag7"},{"type":"text","value":" is an array of values that represents the weights of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LkbULBnJkz"},{"type":"inlineCode","value":"nin","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NdZmQazYc3"},{"type":"text","value":" input neurons and the bias ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SKYJMsIfkH"},{"type":"inlineCode","value":"b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZWD5epOdGa"},{"type":"text","value":" of this neuron. Now, we are gonna implement the forward pass call: the sum of the products of each ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FIShTkG1og"},{"type":"inlineCode","value":"w","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EDc0K6NSI3"},{"type":"text","value":" and input ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tBqsbKZm6B"},{"type":"inlineCode","value":"x","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OGJFjtGx5X"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U6fINGkDq6"},{"type":"inlineCode","value":"b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LDDZWNpgOd"},{"type":"text","value":" (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"er4YH9kads"},{"type":"inlineMath","value":"\\sum_i w_i x_i + b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mo>∑</mo><mi>i</mi></msub><msub><mi>w</mi><mi>i</mi></msub><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">\\sum_i w_i x_i + b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0497em;vertical-align:-0.2997em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"JS5gzSc4Kf"},{"type":"text","value":") passed through a non-linear activation function (e.g. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V7234DXevV"},{"type":"inlineCode","value":"tanh","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cMlT9bp2j7"},{"type":"text","value":").","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dfipplzlUl"}],"key":"OfuO1ddtB3"}],"key":"ZHOvshiPJi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"class Neuron(Neuron):\n    # w * x + b\n    def __call__(self, x):\n        preact = sum((w * x for w, x in zip(self.w, x)), self.b)\n        out = preact.tanh()\n        return out","key":"bwpTgFzB5e"},{"type":"outputs","id":"_OW1g70OARMYTjsW_EVm-","children":[],"key":"JPdGTIP8Ks"}],"key":"Az4pb8PYYX"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here’s an example of passing two inputs ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Zv9nRF9cpi"},{"type":"inlineCode","value":"x","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BVSTaMavrn"},{"type":"text","value":" through the neuron:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NqJgmYD8c8"}],"key":"QLeA5Pso8c"}],"key":"ARdvaMNLN8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x = [2.0, 3.0]\nnin = len(x)\nn = Neuron(nin)\nn(x)","key":"q52zlakkfO"},{"type":"outputs","id":"2iYtdhXrJOY1J9oTl5rN-","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":58,"metadata":{},"data":{"text/plain":{"content":"Value(data='-0.43235771996736344')","content_type":"text/plain"}}},"children":[],"key":"vwHLRf8psw"}],"key":"l2GdmjO9ev"}],"key":"CB2DRIa7t1"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Having done so, let’s create a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qB7iBY7tu4"},{"type":"inlineCode","value":"Layer","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YdxEDbtuE7"},{"type":"text","value":" object that represents a layer composed of many neurons as in typical ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fp9Mzr4C8s"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QhHl6WdPqH"}],"key":"kz00oNZdsj"},{"type":"text","value":" fashion. It takes the number of input and output neurons (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z5omMYBOYI"},{"type":"inlineCode","value":"nin","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lURiLEZjUS"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Hm6uiR1tvQ"},{"type":"inlineCode","value":"nout","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tk7GYx2Emc"},{"type":"text","value":") as arguments.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M6gOVuf3ed"}],"key":"qh4j5UKa5c"}],"key":"Y08Zg4xMFU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"class Layer:\n    def __init__(self, nin, nout):\n        self.neurons = [Neuron(nin) for _ in range(nout)]\n\n    def __call__(self, x):\n        outs = [n(x) for n in self.neurons]\n        return outs[0] if len(outs) == 1 else outs","key":"QYFL7yTEzP"},{"type":"outputs","id":"9g6DOdNENOEs5E5iOmKez","children":[],"key":"Uc5wRj3io2"}],"key":"CPo3bJGj7S"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here’s an example of passing two inputs ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ScO7bLhLgm"},{"type":"inlineCode","value":"x","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UnktfMIzMc"},{"type":"text","value":" through a layer of neurons:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AqsLFTIdHp"}],"key":"tx1JVxmRIv"}],"key":"LgGMOS8Xlt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x = [2.0, 3.0]\nnin = len(x)\nnout = 3\nl = Layer(nin, nout)\nl(x)","key":"Je17meMuhL"},{"type":"outputs","id":"pB_MEV5BhZLTWngsMfJqL","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":60,"metadata":{},"data":{"text/plain":{"content":"[Value(data='0.43948525359013224'),\n Value(data='-0.9903943088037261'),\n Value(data='0.9985533287198426')]","content_type":"text/plain"}}},"children":[],"key":"fXdeGPWrcL"}],"key":"R7wMqMI3zh"}],"key":"lBWt8x3YfJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As expected, after passing in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qd56F8aVOt"},{"type":"inlineCode","value":"nin","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ys31WXjNrF"},{"type":"text","value":" input values, we get ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Q9MxwW8QOw"},{"type":"inlineCode","value":"nout","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m3fAqDdzzd"},{"type":"text","value":" output values. Finally, let’s implement an ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hWuYRGx7JE"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"mlp","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CLw94u2dlO"}],"key":"yN8zSnUi36"},{"type":"text","value":", in which layers basically feed into each other sequentially. First, we’ll define a constructor that creates a list of layers, each one initialized with the proper number of inputs and outputs, given an initial ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T421Aks3oG"},{"type":"inlineCode","value":"nin","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"I5jE27Luju"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xSYDd1BUlV"},{"type":"inlineCode","value":"nouts","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uZIfkMUFlp"},{"type":"text","value":" list. Then, a forward pass method that passes an initial input ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tq2ljzPnDq"},{"type":"inlineCode","value":"x","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qlBvQlfcuR"},{"type":"text","value":" through each of the layers, from first to last.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mJ9eg2YgB8"}],"key":"vacO0AWfGD"}],"key":"KQvFymKZLj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"class MLP:\n    def __init__(self, nin, nouts):\n        sz = [nin] + nouts\n        self.layers = [Layer(sz[i], sz[i + 1]) for i in range(len(nouts))]\n\n    def __call__(self, x):\n        for l in self.layers:\n            x = l(x)\n        return x","key":"BrzDd67mMS"},{"type":"outputs","id":"5tvMKQCe252uzA5bcgvLV","children":[],"key":"w4QoCmJd1X"}],"key":"Brhtqq3ouc"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here’s an example reconstructing the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aRq7bcReJf"},{"type":"link","url":"#MLP-example","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"mlp example","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ejEapiMI7B"}],"urlSource":"#MLP-example","key":"lDhHOxZnAq"},{"type":"text","value":" we saw previously. It has 3 input neurons, two hidden 4-neuron layers and a 1-neuron output layer, therefore:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FNNYZNKZL2"}],"key":"U4vC46GZzq"}],"key":"UJ57hKoB1Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mlp = MLP(3, [4, 4, 1])\nx = [2.0, 3.0, -1.0]\nmlp_out = mlp(x)\nmlp_out","key":"j8qJt7lAZE"},{"type":"outputs","id":"wCQ_D0-qcrv4Wc0KkGlq3","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":62,"metadata":{},"data":{"text/plain":{"content":"Value(data='0.8021316553902108')","content_type":"text/plain"}}},"children":[],"key":"oDo0PHExR8"}],"key":"G3IwtBoiJK"}],"key":"yJLdjP868y"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And if we draw our single ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c9YwwXMYgv"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"mlp","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XMRsefy95Y"}],"key":"LW5T9uUMUG"},{"type":"text","value":" output...","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rJjyRNJ27t"}],"key":"l8s7UbGGNM"}],"key":"x1a5cSnkVO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"draw(mlp_out)","key":"qMaOA0wDEz"},{"type":"outputs","id":"vXqMCm3wlQnj9Gb_CLLdX","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":63,"metadata":{},"data":{"image/svg+xml":{"content_type":"image/svg+xml","hash":"2a2aba0afbf0573bd34a1894b47309a8","path":"/build/2a2aba0afbf0573bd34a1894b47309a8.svg"},"text/plain":{"content":"<graphviz.graphs.Digraph at 0x7f6c61a39150>","content_type":"text/plain"}}},"children":[],"key":"wfJniznzd0"}],"key":"t4HRwyIv8a"}],"key":"Ua52XTNKIZ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Wow, that’s a big graph! Now obviously, no one sane enough would dare differentiate these expressions with pen and paper. But with ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"egj2VNaj8l"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"micrograd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U1wTnUlThN"}],"key":"pMP5CT0FMU"},{"type":"text","value":", you’ll be able ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PaIlvN6EUp"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dVkDDenuhw"}],"key":"A5ecpEBXdS"},{"type":"text","value":" all the way through this graph back into the leaf nodes, meaning the weights of our neurons (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nvz0Z9UPPo"},{"type":"inlineCode","value":"Neuron.w","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EbWkxRLXCB"},{"type":"text","value":"). To test it out, let’s define our own inputs dataset (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Rmjd5bbnYs"},{"type":"inlineCode","value":"xs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iFMyMetYBO"},{"type":"text","value":") to be fed into our ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"G8onYoAo1k"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"mlp","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lTLGjWkeWs"}],"key":"V1O4u6547H"},{"type":"text","value":", as well as their corresponding target values ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kf3OWPOe4C"},{"type":"inlineCode","value":"ys","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GMDWB9HvSY"},{"type":"text","value":". Basically, a simple binary classifier ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ma4jTsnMND"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o1He0dOJPN"}],"key":"WDKgw69NdK"},{"type":"text","value":", since input corresponds to either ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JaaU3wYqPJ"},{"type":"inlineCode","value":"1.0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MHm9vtTOYY"},{"type":"text","value":" or ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OIBXKUgH32"},{"type":"inlineCode","value":"-1.0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Jr5LpURXhF"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r7hdxnekbc"}],"key":"bMytv5FHXO"}],"key":"F5dJTSwhFE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"xs = [\n    [2.0, 3.0, -1.0],\n    [3.0, -1.0, 0.5],\n    [0.5, 1.0, 1.0],\n    [1.0, 1.0, -1.0],\n]\nys = [1.0, -1.0, -1.0, 1.0]  # desired targets","key":"uehR5Fgivp"},{"type":"outputs","id":"eqpgCluTqRHArd47QcIg1","children":[],"key":"nSslDtlvYu"}],"key":"sxgRXYuNuz"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Each one of the input vectors corresponds to each target value of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BLx6GkFaQL"},{"type":"inlineCode","value":"y","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IVHJZRENXX"},{"type":"text","value":". E.g. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cGBZtuHefu"},{"type":"inlineCode","value":"[2.0, 3.0, -1.0]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xKQ2WbBdZj"},{"type":"text","value":" corresponds to target ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lEqghBxqzB"},{"type":"inlineCode","value":"1.0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kN6BGmHzl5"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F5WVwDpBf6"},{"type":"inlineCode","value":"[3.0, -1.0, 0.5]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"It7KQ112Vq"},{"type":"text","value":" to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nxsyKEAv3L"},{"type":"inlineCode","value":"-1.0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uFcleq6EM4"},{"type":"text","value":", and so on. Now, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z0V6b2M288"},{"type":"inlineCode","value":"ys","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ovPpcgxvHm"},{"type":"text","value":" are the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"d1IHj9VK8g"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"desired","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jPS90Drrdv"}],"key":"eDoAbqiTTw"},{"type":"text","value":" values. Now, let’s pass ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JY1b4Rkfj4"},{"type":"inlineCode","value":"xs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xHOOoSJdaZ"},{"type":"text","value":" through our ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iHu6lSPCly"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"mlp","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BKYA1SImgt"}],"key":"kRJXEyyiXX"},{"type":"text","value":" and get the predicted values ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TJwzOdWSyX"},{"type":"inlineCode","value":"ypreds","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QoOonxQepS"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nnpMNnE9LK"}],"key":"mmVvPoVrT6"}],"key":"r7LeUBpLKY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def forward_pass_mlp(mlp):\n    return [mlp(x) for x in xs]\n\n\nypreds = forward_pass_mlp(mlp)\nypreds","key":"V1P3gdUAto"},{"type":"outputs","id":"9WA53254ZxbtoxKu7uHNW","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":65,"metadata":{},"data":{"text/plain":{"content":"[Value(data='0.8021316553902108'),\n Value(data='0.694914372587992'),\n Value(data='0.8630928931795546'),\n Value(data='0.9566959159578626')]","content_type":"text/plain"}}},"children":[],"key":"r8peY0T0tO"}],"key":"WpvpwSPd1p"}],"key":"SedAmpN9g0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As you can see, currently, our ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X7rLH5Nee1"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"mlp","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KDbfjE7Z7H"}],"key":"sd7nolbkP7"},{"type":"text","value":" outputs values (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ys9IXOdHCS"},{"type":"inlineCode","value":"ypreds","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Xmota9OuTf"},{"type":"text","value":") that are different from the desired target values we want (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ainthzcTOp"},{"type":"inlineCode","value":"ys","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bAYvrSeIkk"},{"type":"text","value":"). So, how do we make ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Hev8JbKsIT"},{"type":"inlineCode","value":"ypreds","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XSiAkx7jxA"},{"type":"text","value":" equal, or at least as close as possible, to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sJTEJs8J3Y"},{"type":"inlineCode","value":"ys","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vSqDhrvydV"},{"type":"text","value":"? Specifically, how do we tune the weights (aka, train our ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"k4YLrFMwAU"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dfmzZykxw7"}],"key":"hMeoJU7hmA"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ym9PzwFkKA"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RpgNkFS9pZ"}],"key":"g7iLjnSGf3"},{"type":"text","value":" them) in order to better predict the desired targets? The trick used in deep learning that helps us achieve this, is to calculate a single number that somehow measures how well the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LG4Wt9DWyn"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LfGH9rdoPv"}],"key":"LsjQNaYDlN"},{"type":"text","value":" is performing. This number is called the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KRKZ6gBrrS"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M8EODmfnjF"}],"key":"GAiInb1BMR"},{"type":"text","value":". Right now, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Sr4ldRlSBp"},{"type":"inlineCode","value":"ypreds","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FSFXJnXxHc"},{"type":"text","value":" is not close to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eIMhDrAxwF"},{"type":"inlineCode","value":"ys","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JlQbvqTteW"},{"type":"text","value":", so we are not perfoming very well, meaning that the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i4ucGnpxIF"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AvhFDuQBuV"}],"key":"jFKuyE9jGX"},{"type":"text","value":" value is high. Our goal is to minimize the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hOkgTasTW7"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XXkDppYVON"}],"key":"LfgPFtudAE"},{"type":"text","value":" value and, by doing so, bring ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"g1Pjg2WBUD"},{"type":"inlineCode","value":"ypreds","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ErfS6Avj1V"},{"type":"text","value":" closer to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YoxY9YKOJm"},{"type":"inlineCode","value":"ys","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"R26JedimYn"},{"type":"text","value":". One way to calculate the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YWMGkLXroh"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oMMCrmAOOu"}],"key":"mF2oc7zXFx"},{"type":"text","value":" value is through the mean squared error (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y8vIX67eL3"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"MSE","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ycBG0BQgHk"}],"key":"Zo4WseMHtH"},{"type":"text","value":") function. This function will iterate over pairs of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EQsq1n7Dlr"},{"type":"inlineCode","value":"ys","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gwzg8e2C14"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"guTLcDb8G2"},{"type":"inlineCode","value":"ypreds","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y4MtB3jlV1"},{"type":"text","value":" and sum the squares of their differences. The squared difference of two values (e.g. a prediction and target value) discards any negative signs and gives us a positive quantification that represents how those values differ: their ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"b9sxjYBTBd"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Rj0SINrtIX"}],"key":"wlMibukHC1"},{"type":"text","value":". If the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EtrbRLWKv4"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wdydrvk59C"}],"key":"FFH2y9K6Ni"},{"type":"text","value":" is zero, the two values do not differ and are equal. Whereas if the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ikMkKxrI7Y"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c3BtOi0Nk6"}],"key":"LjREHlGQlU"},{"type":"text","value":" is another, non-zero number, the two values are different and unequal. In general, the more two values differ, the greater their ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wcYU3WDGj4"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mObGqcR0wc"}],"key":"TFFgbAyCcJ"},{"type":"text","value":" will be. The less they differ, the lower their ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zFRqifeKEp"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wxQ534vJ2k"}],"key":"rUbhe6bquz"},{"type":"text","value":" will be. The final ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y7BSGEcESl"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"MSE","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l7tgQzk729"}],"key":"KpWuW1pe2k"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xm5sVYkQH0"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QaMmgQz8SR"}],"key":"QLjJiiAn3g"},{"type":"text","value":" of all such pairs will just be the sum of all the squared differences:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C8mHVABgLV"}],"key":"vOIq6ckSfO"}],"key":"YXyu34HNfn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def calc_loss(ypreds, ys):\n    return sum([(ypreds - y) ** 2 for ypreds, y in zip(ypreds, ys)])\n\n\nloss = calc_loss(ypreds, ys)","key":"HRCm6cYqjS"},{"type":"outputs","id":"H-952B3zM14AOpfa_9Z87","children":[],"key":"HrVfBFWGD8"}],"key":"UED3f6nieP"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we want to minimize the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dbGXJVskyZ"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GRdvVG6N8A"}],"key":"Fb0hUJ6tkt"},{"type":"text","value":", because if the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QjA53IOfGK"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VBm7AiwjkJ"}],"key":"kSnpB6S1hN"},{"type":"text","value":" is low, then every one of the predictions is equal to its target. The lowest the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZiecYZZu8O"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vwxTCfbDsP"}],"key":"kRlhhYDr7M"},{"type":"text","value":" value can be is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T6DwcmkG9K"},{"type":"inlineCode","value":"0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bSlx2HInBH"},{"type":"text","value":" (the ideal value). Whereas, the greater it is, the worse off the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GAwBhYOkKX"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zi85E1jm4k"}],"key":"Bc164zr2Bo"},{"type":"text","value":" is predicting. So, how do we minimize the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v9unVXuQxV"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yMofbIdFi5"}],"key":"g2Mtlm4BT1"},{"type":"text","value":"? First, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NFLszBDCSV"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NgHLs89tb9"}],"key":"wA3LHKCrAx"},{"type":"text","value":"!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iG2Kq11TjK"}],"key":"dNDJ205uSh"}],"key":"HKFSMRmJWQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"loss.backward()","key":"oxfIixzPTw"},{"type":"outputs","id":"fRgSAMVOuKPtBMbj1x6WJ","children":[],"key":"N1uzMcD1dE"}],"key":"wlc3DsDqBC"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"After a backward call, something magical happens! All gradients of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rlmb3HHrF9"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RPOVE3zzEi"}],"key":"YvsJYsrSRm"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GsbyFCogx8"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PyWti6RAEg"}],"key":"kWVo3XxXfV"},{"type":"text","value":" the weights of our ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Db8HKQhJRV"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"mlp","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"n7TFv5Kjms"}],"key":"HApbOjU1XR"},{"type":"text","value":" get  calculated. To see this with our eyes, let’s print out the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KCeAJ0TOmP"},{"type":"inlineCode","value":"grad","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QI1SJGvouE"},{"type":"text","value":" attribute of any of the weights, e.g.:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LVuHoofG3H"}],"key":"tjTYspJkSd"}],"key":"tHNhTJ9cbY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mlp.layers[0].neurons[0].w[0].grad","key":"Ym2dAetgeB"},{"type":"outputs","id":"NKblxO4bg0AkqPAKo3vNY","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":68,"metadata":{},"data":{"text/plain":{"content":"-0.15533830793163983","content_type":"text/plain"}}},"children":[],"key":"wrLtR6DsYY"}],"key":"pjR0m0WQjX"}],"key":"sf0hIvWpNM"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We see that because the gradient of this particular weight of this particular neuron of this particular layer of our ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OHEmgMOq5R"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RFw8tGMPO0"}],"key":"npwXillNve"},{"type":"text","value":" is negative, we infer that its influence on the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r7FNBib8fD"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VhGrV6gPdX"}],"key":"HLwo7UhnDY"},{"type":"text","value":" is also negative. Which means, that slightly increasing this particular weight, would make the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Wko4U5T2n5"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pDE6sWr4ja"}],"key":"YABvwiFYDf"},{"type":"text","value":" value go down. Now if we draw the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Wj7cEG00sE"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kOcoX3QQwK"}],"key":"XCj7EA9F5Q"},{"type":"text","value":"...","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eVMUtzOm9z"}],"key":"HG8XZyVT7x"}],"key":"TAKM7c8SpR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"draw(loss)","key":"kQkqtbJh76"},{"type":"outputs","id":"Vot-9rQPCXeHDXMTU1L5Z","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":69,"metadata":{},"data":{"image/svg+xml":{"content_type":"image/svg+xml","hash":"faa52fc128751c674c2234bb426bd44a","path":"/build/faa52fc128751c674c2234bb426bd44a.svg"},"text/plain":{"content":"<graphviz.graphs.Digraph at 0x7f6c61ac09d0>","content_type":"text/plain"}}},"children":[],"key":"BK42mp1BAo"}],"key":"c7yHeHAWGn"}],"key":"zPoiTnYgWh"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"we see that it’s massive! The reason is that the loss depends on all the values produced by forward passing all the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DSHxd2mWjq"},{"type":"inlineCode","value":"x","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S2Rfxp4Tdn"},{"type":"text","value":" values contained in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Gzv6ieUkAS"},{"type":"inlineCode","value":"xs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F8mTY8GFC2"},{"type":"text","value":" into the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"upM7LtQGRF"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"mlp","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TOut7cPpzn"}],"key":"FTTmEQHlYQ"},{"type":"text","value":". Now, although the gradients of all the values in the graph have been calculated, we only care about the gradients of the parameters we want to change, namely the weights and biases. So, our next steps are to gather those parameters and tune them by nudging them based on their gradient information. To do so, we first extend the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sCmno5UxlS"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"mlp","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sIZwNWKjvp"}],"key":"hmqp9E1xFZ"},{"type":"text","value":" component classes by implementing parameter getter methods:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kfGSPL9L7r"}],"key":"auLlof3hzT"}],"key":"fLl1pQea81"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"class Neuron(Neuron):\n    def parameters(self):\n        return self.w + [self.b]\n\n\nclass Layer(Layer):\n    def parameters(self):\n        return [p for neuron in self.neurons for p in neuron.parameters()]\n\n\nclass MLP(MLP):\n    def parameters(self):\n        return [p for layer in self.layers for p in layer.parameters()]","key":"HDNVrRZb7W"},{"type":"outputs","id":"gpPW4AGh0bMBYiJA32y0u","children":[],"key":"tZddr6erkt"}],"key":"AkOnm3eTzH"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"After getting our output and loss again (due to redefining the classes)...","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ekAsBdHgT5"}],"key":"TbSfbi8TUs"}],"key":"h307mCsOe1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mlp = MLP(3, [4, 4, 1])\nypreds = forward_pass_mlp(mlp)\nloss = calc_loss(ypreds, ys)\nloss.backward()","key":"XqMMNSaIu8"},{"type":"outputs","id":"7_Mv2eKzl9agMHEU4sUbX","children":[],"key":"XtCLp5IAmf"}],"key":"zi068IkPZz"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"we may inspect all the parameters...","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"atlUY3CKwW"}],"key":"aD7Dz9GKnH"}],"key":"Ao6Gv7X6lQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mlp_params = mlp.parameters()\nprint(mlp_params)\nprint(len(mlp_params))","key":"W04bxwNGtG"},{"type":"outputs","id":"kyxY2-AN-SkPjA671qqK6","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"[Value(data='-0.5891124237861678'), Value(data='0.28090981749146215'), Value(data='0.7547091264633694'), Value(data='-0.5146778088364283'), Value(data='0.8672995598598101'), Value(data='0.7406510232644734'), Value(data='0.5288406626421873'), Value(data='0.08447495239111946'), Value(data='-0.6563246126894655'), Value(data='0.3981255695120931'), Value(data='-0.012968303988030394'), Value(data='0.7542094002676307'), Value(data='0.0033286930198876963'), Value(data='0.2556304142635857'), Value(data='-0.9314080289080375'), Value(data='0.4054173907532759'), Value(data='0.774679311925067'), Value(data='-0.18811978158086262'), Value(data='0.7575932811823123'), Value(data='0.4477844375844444'), Value(data='0.39651768767863205'), Value(data='0.05901494877107494'), Value(data='0.8809980312429269'), Value(data='-0.7064254928263687'), Value(data='0.17787965036070652'), Value(data='0.9795480701510118'), Value(data='-0.345249225309854'), Value(data='0.5363299378699073'), Value(data='-0.34760846138944257'), Value(data='0.7486671457569554'), Value(data='0.7160267321114855'), Value(data='0.5698199508762045'), Value(data='-0.5563952037955955'), Value(data='-0.4432545915770989'), Value(data='-0.7637467843038042'), Value(data='0.46496054602256986'), Value(data='-0.8182517028250273'), Value(data='-0.6649446947755555'), Value(data='0.39870787529352847'), Value(data='-0.37824313155178624'), Value(data='-0.884314155961383')]\n41\n"},"children":[],"key":"YtxWfdKEl9"}],"key":"TgnPnpP6BP"}],"key":"wFh42KWYrb"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"and change them in a manner that decreases the loss. Before we optimize all of them though, let’s first optimize only one to see exactly how the process is done:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uhY37ofs0w"}],"key":"We6s2PBoBM"}],"key":"NOoYXjPEOP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mlp.layers[0].neurons[0].w[0].grad","key":"H83L53Akcl"},{"type":"outputs","id":"R8kDZkZbMrH8IiADf8uk8","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":73,"metadata":{},"data":{"text/plain":{"content":"0.34342225762161804","content_type":"text/plain"}}},"children":[],"key":"pp1P1du6Qw"}],"key":"g6XLsoBjMt"}],"key":"pBooeWvgY0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mlp.layers[0].neurons[0].w[0].data","key":"oBOPCXTLC4"},{"type":"outputs","id":"ZIMVT57HM2hQU1RorZjzh","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":74,"metadata":{},"data":{"text/plain":{"content":"-0.5891124237861678","content_type":"text/plain"}}},"children":[],"key":"anNaikHxj0"}],"key":"ZLb60YteJL"}],"key":"gPmwYfiwvW"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To understand how to optimize the parameters, we need to understand the relationship between ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hRMYzZtxRz"},{"type":"inlineCode","value":"grad","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JCGsaCCKqf"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bVHUIFIkqW"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RUIWjcExXJ"}],"key":"I6wLoL86aK"},{"type":"text","value":" through two distinct cases:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xqv1oEddUE"}],"key":"jpxDVwXaXo"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"A","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kEglJsCZT3"}],"key":"DdQwpaPZoP"},{"type":"text","value":". A ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WsOvIiep6d"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"parameter","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DDIORM7Dr1"}],"key":"fIBzRu3lwo"},{"type":"text","value":"’s positive ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"v3oqJUBzQM"},{"type":"inlineCode","value":"grad","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"xxYNLgDlgw"},{"type":"text","value":" (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Jee7KAxc5f"},{"type":"inlineCode","value":"> 0","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iHDRFmRqdN"},{"type":"text","value":") value tells us that:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fWf0GREk8c"}],"key":"BfJYk1AihM"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"(","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"EyukrCPaxE"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"d9duMSZJVW"}],"key":"BSGEi3RrtB"},{"type":"text","value":") ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Sv9XYcAOvq"},{"type":"emphasis","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"increasing","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"WAtS68uYm3"}],"key":"ItqZEa48mY"},{"type":"text","value":" that ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"TuTiOkNVd4"},{"type":"emphasis","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"parameter","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"lsCXRkQaae"}],"key":"DMRmXo35Se"},{"type":"text","value":" would ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"hjCFhmHNFR"},{"type":"emphasis","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"increase","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"t6WunRAdDd"}],"key":"NP3uzlEYDB"},{"type":"text","value":" the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"otR1ltIp8N"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"UQJjEyhmlW"}],"key":"GKbNp6CjUQ"}],"key":"NjXP4UbhjG"}],"key":"NvIN3ugX1O"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"(","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"eStRDC4F0R"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"2","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JkyQn5MYp2"}],"key":"B4CcFj01Ks"},{"type":"text","value":") ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WGDTAh81aB"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"decreasing","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"UY4ttJbs6X"}],"key":"woS72wNdEU"},{"type":"text","value":" that ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ou4ymZ1GKa"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"parameter","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"tWKI7M1lUP"}],"key":"aSojEzPRbR"},{"type":"text","value":" would ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xut5alnfmV"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"decrease","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yFdOoxdYbd"}],"key":"PYDpX6DT7h"},{"type":"text","value":" the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"n9AgmoziiF"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LzENtICkKR"}],"key":"oK7WIvNdOE"}],"key":"pzmh1aUwzi"}],"key":"XzyUWbXIZM"}],"key":"VORrQrU5oo"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"B","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ojGhkIbuyO"}],"key":"txyGG94qzy"},{"type":"text","value":". A ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"IY7IPOGGiV"},{"type":"emphasis","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"parameter","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"zZPCFMtFPj"}],"key":"UFa9zwu7zB"},{"type":"text","value":"’s negative ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"f0uj463nX3"},{"type":"inlineCode","value":"grad","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"q5NsLxeh4n"},{"type":"text","value":" (","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Ea3l1AsyuP"},{"type":"inlineCode","value":"< 0","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"HWoQVBl6oL"},{"type":"text","value":") value tells us that:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"tO6V5tBcnj"}],"key":"Nj3SlOMeEH"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"(","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"TdMM7JipVW"},{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"u4SpoC7Yee"}],"key":"qLCeF6Rpo3"},{"type":"text","value":") ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"nLPcnSEkND"},{"type":"emphasis","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"increasing","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"btEHFDAMDl"}],"key":"MUPcLLLr46"},{"type":"text","value":" that parameter would ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"R2QDupwbGU"},{"type":"emphasis","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"decrease","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ciS46kBLsc"}],"key":"GdglpLupW8"},{"type":"text","value":" the ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"LjxVB8NcXE"},{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Ad5xyaZjZS"}],"key":"eaOmndNguK"}],"key":"zOsQ9aV063"}],"key":"yQ0Zx5JQ1p"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"(","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Ca7XW2tc7X"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"2","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"P7mE5kjepO"}],"key":"nysLHzUqsn"},{"type":"text","value":") ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Zm4tUMvh4j"},{"type":"emphasis","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"decreasing","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"F1wxlIIEJg"}],"key":"AOGyYv2Vfr"},{"type":"text","value":" that parameter would ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"JOS2BYjcbI"},{"type":"emphasis","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"increase","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"aTrvtF6vBr"}],"key":"ORGNjuhED2"},{"type":"text","value":" the ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"u0zvgQKsk2"},{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"foRj59f2sC"}],"key":"xuk4tyGOpU"}],"key":"jaevYI9WWt"}],"key":"i4KA7AaNxU"}],"key":"sU9K0usFP7"}],"key":"o6gNYjv4nS"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Since, we only care about ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qRCdbCaQQU"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"decreasing","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VKkSjC7tL2"}],"key":"tSicrmPGMI"},{"type":"text","value":" the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gSdv3n9Nhg"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"soijW9lrE7"}],"key":"D5BOtqq7p5"},{"type":"text","value":" (since we want to minimize it), we only care about cases ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Dd9tXk3U4W"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xnzmjXPCRV"}],"key":"NLeG6w04Dj"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bPj1z0iayT"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"B1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PpAs9yzVqO"}],"key":"HqtpwZNAOk"},{"type":"text","value":". Therefore, we now know that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JrdbVIdfbS"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"decreasing","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PXVguZ1CiE"}],"key":"U2K73D7qaT"},{"type":"text","value":" the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XRrf8F1fCI"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WqmrrywXdt"}],"key":"Qkof4cTrXL"},{"type":"text","value":" depends on changing the weight by an amount whose sign is the opposite of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LeOGztoXz1"},{"type":"inlineCode","value":"grad","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pG2JU95l1X"},{"type":"text","value":" value. Since the opposite of a value is just its negation, we describe the general optimization step required to change each parameter as follows:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qzhPMo39iE"}],"key":"LYjWOuegAw"},{"type":"blockquote","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To decrease the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Y9EKzx3J0l"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"n8pLM9IKW0"}],"key":"FM6wmDtAvz"},{"type":"text","value":", change each parameter ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Q4ZRyEMZff"},{"type":"inlineCode","value":"p","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZD082uTy8j"},{"type":"text","value":" in the direction that is opposite the direction of the the gradient ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fo5pwrq7He"},{"type":"inlineCode","value":"grad","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"p2ceNVauRs"},{"type":"text","value":" of the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZsYzXrwb8e"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ineTkM7MT3"}],"key":"m147E1xXcn"},{"type":"text","value":" ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"G7sDuBhw9f"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dHqXMpBi3j"}],"key":"n8LtHWXhZo"},{"type":"text","value":" ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OguK2vkIDv"},{"type":"inlineCode","value":"p","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"o7Udn2Eksm"},{"type":"text","value":" (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lvuCmsAzQh"},{"type":"inlineMath","value":"\\dfrac{\\partial loss}{\\partial p}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>p</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial loss}{\\partial p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">p</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"PBFFa3KOK7"},{"type":"text","value":").","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YDLaT19biD"}],"key":"RCQjfIIoxz"}],"key":"OW9lOGreiz"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"This can be achieved by subtracting the product of the gradient and a small step size ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Bmkkx7N0KT"},{"type":"inlineMath","value":"\\alpha","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span>","key":"ypkcDTPGWE"},{"type":"text","value":" from the current parameter value:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"I3bqELXnZR"}],"key":"zOUBjfMWeO"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"inlineMath","value":"p = p - \\alpha\\dfrac{\\partial loss}{\\partial p}","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo>=</mo><mi>p</mi><mo>−</mo><mi>α</mi><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>p</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">p = p - \\alpha\\dfrac{\\partial loss}{\\partial p}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">p</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"gLgTqI7MgC"},{"type":"text","value":", where ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"j5VBNDIjqc"},{"type":"inlineMath","value":"α","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi></mrow><annotation encoding=\"application/x-tex\">α</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span>","key":"UW7tI98GGQ"},{"type":"text","value":" is a usually small positive number (e.g. ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"npIaPpg9hM"},{"type":"text","value":"0.001","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"HWUqyaKM0n"},{"type":"text","value":") called the learning rate, which determines how big of a step size is to be taken during the optimization step. Since we descend the gradient, we call this process gradient descent. Let’s now optimize one weight parameter with one step of gradient descent:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"QoPFROuZTB"}],"key":"eHd91kEmpL"}],"key":"Wa9BtUIet4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ypreds = forward_pass_mlp(mlp)\nloss = calc_loss(ypreds, ys)\n# zero out gradients (so they don't accummulate)\nfor p in mlp.parameters():\n    p.grad = 0.0\nloss.backward()\nmlp.layers[0].neurons[0].w[0].data += -0.001 * mlp.layers[0].neurons[0].w[0].grad\nypreds_after = forward_pass_mlp(mlp)\nloss_after = calc_loss(ypreds_after, ys)\nprint(f\"Loss before optimization step: {loss}\")\nprint(f\"Loss after optimization step: {loss_after}\")","key":"mH9VSYDLxs"},{"type":"outputs","id":"hu_DnT1kuxuIk2VoGHTfw","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Loss before optimization step: Value(data='6.606895868054532')\nLoss after optimization step: Value(data='6.6067779753029345')\n"},"children":[],"key":"L9XxaydPos"}],"key":"mijLZpz2KA"}],"key":"XFy9fpeG3f"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"See? Loss after the step is lower than before it. So, optimizing even one parameter with this procedure, decreases the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WF0DP9z1zm"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kfDgeaOgK1"}],"key":"fcv6lg7vVj"},{"type":"text","value":" of our ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x3N8ZnFUj6"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"mlp","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IOiWYsmPXZ"}],"key":"HmFYIf10HQ"},{"type":"text","value":"! But in order to decrease it even more, let alone minimize it, we must also optimize all of the parameters. How? Like this:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"crPUAsd2MB"}],"key":"WInLFbMfrG"}],"key":"uRwBbyAHqP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ypreds = forward_pass_mlp(mlp)\nloss = calc_loss(ypreds, ys)\n# zero gradients (so they don't accummulate)\nfor p in mlp.parameters():\n    p.grad = 0.0\nloss.backward()\nfor p in mlp.parameters():\n    p.data += -0.001 * p.grad\nypreds_after = [mlp(x) for x in xs]\nloss_after = sum([(ypreds - y) ** 2 for ypreds, y in zip(ypreds_after, ys)])\nprint(f\"Loss before optimization step: {loss}\")\nprint(f\"Loss after optimization step: {loss_after}\")\nprint([y.data for y in ypreds])\nprint([y.data for y in ypreds_after])\nprint(ys)","key":"C7XAApBWBX"},{"type":"outputs","id":"wkDOG7C8DGidspOUszwBN","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Loss before optimization step: Value(data='6.6067779753029345')\nLoss after optimization step: Value(data='6.56156718545472')\n[-0.7786370603743357, -0.41961729625360783, -0.9397577797813043, -0.7614638727095784]\n[-0.7716021275092538, -0.41675489429569573, -0.9388225451270673, -0.7547294814149134]\n[1.0, -1.0, -1.0, 1.0]\n"},"children":[],"key":"YXgWnl59Fb"}],"key":"TqHSzNJXse"}],"key":"uPjiXt1qBi"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Same thing happens: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cQTKsobHhZ"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tITEbPpILE"}],"key":"HC9Mm0Dyu6"},{"type":"text","value":" decreases! Most importantly, each time we re-run the optimization, the prediction values get even closer to the target values, which is our primary goal! In general, we must be careful with our step size. Too small of a step size will take many many steps to decrease the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rAT0OdaJaT"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oLhtFKqRbq"}],"key":"Pfz1k8AsNO"},{"type":"text","value":", whereas too big of a step size might be an ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ochsdoSeHH"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"overstep","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uk0XZlHKOV"}],"key":"F3iqvYlQnK"},{"type":"text","value":" that causes an increase instead of a decrease of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Q4qTB5YL5V"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"g5zoRYlbwT"}],"key":"jsxJMlImmM"},{"type":"text","value":". Sometimes, if the increase is too big, the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rA8KaBC3k3"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PC94OT9bIj"}],"key":"AKwBmrtkjN"},{"type":"text","value":" value explodes. Finding a step size that is just right can be a subtle art sometimes. You can play around with the step size, re-running the cells each time, to see its effect. All in all, we have been able to derive a set of parameters (weights and biases):","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZKp39uIwxe"}],"key":"A6vfp7JR9v"}],"key":"L3xTd2yOCu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mlp.parameters()","key":"BPBdkrlNij"},{"type":"outputs","id":"bPDibcKnKczfNKGUQzNk8","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":77,"metadata":{},"data":{"text/plain":{"content":"[Value(data='-0.5897989998671106'),\n Value(data='0.2803740639577263'),\n Value(data='0.7550020342196525'),\n Value(data='-0.5149260060116513'),\n Value(data='0.8673092472790822'),\n Value(data='0.7407064996722453'),\n Value(data='0.5287909012313932'),\n Value(data='0.08450678345753262'),\n Value(data='-0.6577188091598949'),\n Value(data='0.3963168801724268'),\n Value(data='-0.012013893833775947'),\n Value(data='0.7532520827391431'),\n Value(data='0.002588577562609616'),\n Value(data='0.2557082084784828'),\n Value(data='-0.931431643158572'),\n Value(data='0.40511915330400977'),\n Value(data='0.7764577716116262'),\n Value(data='-0.189860095784784'),\n Value(data='0.7563382171213389'),\n Value(data='0.44572918234887604'),\n Value(data='0.3945828727895028'),\n Value(data='0.05929905243207291'),\n Value(data='0.8807232529636616'),\n Value(data='-0.7066137541919688'),\n Value(data='0.17756069037644506'),\n Value(data='0.9792410059041483'),\n Value(data='-0.3452696799447055'),\n Value(data='0.5363447266323415'),\n Value(data='-0.34752650190640577'),\n Value(data='0.7487529046819845'),\n Value(data='0.7160476085724314'),\n Value(data='0.5696464123075088'),\n Value(data='-0.5562098813916081'),\n Value(data='-0.4436842004682603'),\n Value(data='-0.7640376420712507'),\n Value(data='0.4651341160686098'),\n Value(data='-0.8165050609850243'),\n Value(data='-0.6632768321623527'),\n Value(data='0.40059372617437855'),\n Value(data='-0.3808573235417481'),\n Value(data='-0.8824037909061284')]","content_type":"text/plain"}}},"children":[],"key":"qbUZNDVH5v"}],"key":"wSD8ik6fhi"}],"key":"yjZUNWW1Kb"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"that makes our network predict the target values. Basically, we have learned how to train a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OubhT4UdtN"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i6uN7j0eqA"}],"key":"wG8CL4auxk"},{"type":"text","value":"! But, let’s make it a bit more respectable by implementing a training loop.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"poUVHT1SM7"}],"key":"sCQ2ZJoVbc"}],"key":"nhuFyDSn3Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"for k in range(20):\n    # forward pass\n    ypreds = forward_pass_mlp(mlp)\n    loss = calc_loss(ypreds, ys)\n    # zero gradients (so they don't accummulate)\n    for p in mlp.parameters():\n        p.grad = 0.0\n    # backward pass\n    loss.backward()\n    # update\n    for p in mlp.parameters():\n        p.data += -0.05 * p.grad\n    print(k, loss.data)","key":"ZX7PBdCC25"},{"type":"outputs","id":"KgUUFJ_0Al43um7o2mCcK","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"0 6.56156718545472\n1 3.1886742323366386\n2 1.3032015611952863\n3 0.769939759300913\n4 0.5477680622174333\n5 0.4342573296227225\n6 0.3561670649634663\n7 0.2988718838759568\n8 0.255522186577933\n9 0.2218579442103602\n10 0.19512822582659206\n11 0.17349684405903604\n12 0.15570168219740943\n13 0.14085232054584612\n14 0.12830585626266888\n15 0.11758842447875281\n16 0.10834425517148419\n17 0.1003017900448846\n18 0.09325064258909059\n19 0.08702561304645334\n"},"children":[],"key":"YZLX6IKdpC"}],"key":"J2FKptTv1f"}],"key":"c4oTD61HdJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"After training, the prediction values should be significantly closer to target values:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lBrP4iR7rL"}],"key":"YR0fLzscze"}],"key":"LeMCxLIOVs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print([y.data for y in ypreds])\nprint(ys)","key":"Wct3fYNOIM"},{"type":"outputs","id":"OncTMPVoipH64-rKcLicj","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"[0.8563656958279531, -0.7991263758236825, -0.9425547459839091, 0.849186772421105]\n[1.0, -1.0, -1.0, 1.0]\n"},"children":[],"key":"KZ02xnToUd"}],"key":"jqNEvWw90i"}],"key":"qt80HzFLHf"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Training demo","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lBlSRZhjid"}],"identifier":"training-demo","label":"Training demo","html_id":"training-demo","implicit":true,"key":"LbtaxHSFEL"}],"key":"KlexLhVxMc"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Last but not least, let’s implement a small yet full demo of training an 2-layer ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yPeK49uSEc"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cjnyBdC8sL"}],"key":"DP0zvhkK67"},{"type":"text","value":" (MLP) binary classifier. This is achieved by initializing a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"e53lidTkQp"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"az2bNgp0tt"}],"key":"Wo4haVKgF0"},{"type":"text","value":" from micrograd.nn module, implementing a simple ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Hl1L5nYmQy"},{"type":"link","url":"https://en.wikipedia.org/wiki/Support_vector_machine","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"svm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RpvFWL3tum"}],"urlSource":"https://en.wikipedia.org/wiki/Support_vector_machine","data":{"page":"Support_vector_machine","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"xcuVhxqePy"},{"type":"text","value":" “max-margin” binary classification ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hVKaYsj2HY"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DiNofI4dHs"}],"key":"TMAIxB7M8P"},{"type":"text","value":" and using SGD for optimization. Try and figure out what is happening here by reading the code!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B6J4cKk7y7"}],"key":"sbpKufnXqM"}],"key":"cffyxuJSYF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.datasets import make_moons\n\n\nnp.random.seed(1337)\nrandom.seed(1337)\n\n# make up a dataset\nX_moons, y_moons = make_moons(n_samples=100, noise=0.1)\n\ny_moons = y_moons * 2 - 1  # make y be -1 or 1\n# visualize in 2D\nplt.figure(figsize=(5, 5))\nplt.scatter(X_moons[:, 0], X_moons[:, 1], c=y_moons, s=20, cmap=\"jet\");","key":"xE5f0MKem6"},{"type":"outputs","id":"a06dh0D1UAG5SY3fpSwI0","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/vnd.jupyter.widget-view+json":{"content":"{\"model_id\":\"a498b736b65c40a3a14cf85a64a9e6c1\",\"version_major\":2,\"version_minor\":0}","content_type":"application/vnd.jupyter.widget-view+json"},"image/png":{"content_type":"image/png","hash":"38a0c5da588cb4bfd7e8a1b0fff9ee99","path":"/build/38a0c5da588cb4bfd7e8a1b0fff9ee99.png"},"text/html":{"content_type":"text/html","hash":"bc8af280d2421a0e72b79a02e6eb3133","path":"/build/bc8af280d2421a0e72b79a02e6eb3133.html"},"text/plain":{"content":"Canvas(toolbar=Toolbar(toolitems=[('Home', 'Reset original view', 'home', 'home'), ('Back', 'Back to previous …","content_type":"text/plain"}}},"children":[],"key":"eTcCUYGU9V"}],"key":"yLXG0OiOyw"}],"key":"HDKmI4yKIi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from micrograd.nn import MLP\n\n# initialize a model\nmodel = MLP(2, [16, 16, 1])  # 2-layer neural network\nprint(model)\nprint(\"number of parameters\", len(model.parameters()))","key":"O2cjolDefR"},{"type":"outputs","id":"9NyE29soorqHL434bpWEh","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"MLP of [Layer of [ReLUNeuron(2), ReLUNeuron(2), ReLUNeuron(2), ReLUNeuron(2), ReLUNeuron(2), ReLUNeuron(2), ReLUNeuron(2), ReLUNeuron(2), ReLUNeuron(2), ReLUNeuron(2), ReLUNeuron(2), ReLUNeuron(2), ReLUNeuron(2), ReLUNeuron(2), ReLUNeuron(2), ReLUNeuron(2)], Layer of [ReLUNeuron(16), ReLUNeuron(16), ReLUNeuron(16), ReLUNeuron(16), ReLUNeuron(16), ReLUNeuron(16), ReLUNeuron(16), ReLUNeuron(16), ReLUNeuron(16), ReLUNeuron(16), ReLUNeuron(16), ReLUNeuron(16), ReLUNeuron(16), ReLUNeuron(16), ReLUNeuron(16), ReLUNeuron(16)], Layer of [LinearNeuron(16)]]\nnumber of parameters 337\n"},"children":[],"key":"kKmCW79Ij9"}],"key":"cF6Zz7Errz"}],"key":"rUukA6IyZt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from micrograd.engine import Value\n\n\n# loss function\ndef loss(batch_size=None):\n\n    # inline DataLoader :)\n    if batch_size is None:\n        Xb, yb = X_moons, y_moons\n    else:\n        ri = np.random.permutation(X_moons.shape[0])[:batch_size]\n        Xb, yb = X_moons[ri], y_moons[ri]\n    inputs = [list(map(Value, xrow)) for xrow in Xb]\n\n    # forward the model to get scores\n    scores = list(map(model, inputs))\n\n    # svm \"max-margin\" loss\n    losses = [(1 + -yi * scorei).relu() for yi, scorei in zip(yb, scores)]\n    data_loss = sum(losses) * (1.0 / len(losses))\n    # L2 regularization\n    alpha = 1e-4\n    reg_loss = alpha * sum((p * p for p in model.parameters()))\n    total_loss = data_loss + reg_loss\n\n    # also get accuracy\n    accuracy = [(yi > 0) == (scorei.data > 0) for yi, scorei in zip(yb, scores)]\n    return total_loss, sum(accuracy) / len(accuracy)\n\n\ntotal_loss, acc = loss()\nprint(total_loss, acc)","key":"fuD3vm2lik"},{"type":"outputs","id":"evC8EjqhNJeh9ZiU1LRjN","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Value(data=0.8958441028683222, grad=0) 0.5\n"},"children":[],"key":"MxsPJuSTDt"}],"key":"AvNdxz9ia8"}],"key":"lDEyUxtp53"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# optimization\nfor k in range(100):\n\n    # forward\n    total_loss, acc = loss()\n\n    # backward\n    model.zero_grad()\n    total_loss.backward()\n\n    # update (sgd)\n    learning_rate = 1.0 - 0.9 * k / 100\n    for p in model.parameters():\n        p.data -= learning_rate * p.grad\n\n    if k % 1 == 0:\n        print(f\"step {k} loss {total_loss.data}, accuracy {acc*100}%\")","key":"iJ97adqntX"},{"type":"outputs","id":"EG9uyySZQbFTyeViP2Gs6","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"step 0 loss 0.8958441028683222, accuracy 50.0%\nstep 1 loss 1.7235905336972022, accuracy 81.0%\nstep 2 loss 0.742900631385113, accuracy 77.0%\nstep 3 loss 0.7705641260584201, accuracy 82.0%\nstep 4 loss 0.36927933859765383, accuracy 84.0%\nstep 5 loss 0.313545481918522, accuracy 86.0%\nstep 6 loss 0.2814234349772434, accuracy 89.0%\nstep 7 loss 0.2688873331398391, accuracy 91.0%\nstep 8 loss 0.2567147286057417, accuracy 91.0%\nstep 9 loss 0.2704862551637922, accuracy 91.0%\nstep 10 loss 0.2450702385365804, accuracy 91.0%\nstep 11 loss 0.25099055297915035, accuracy 92.0%\nstep 12 loss 0.2156095185192295, accuracy 91.0%\nstep 13 loss 0.23090378446402726, accuracy 93.0%\nstep 14 loss 0.20152151227899445, accuracy 92.0%\nstep 15 loss 0.2257450627928222, accuracy 93.0%\nstep 16 loss 0.19447987596204108, accuracy 92.0%\nstep 17 loss 0.21089496199246363, accuracy 93.0%\nstep 18 loss 0.15983077356303602, accuracy 94.0%\nstep 19 loss 0.18453748746883916, accuracy 93.0%\nstep 20 loss 0.1897752285608764, accuracy 91.0%\nstep 21 loss 0.19072704042579644, accuracy 93.0%\nstep 22 loss 0.11733695088756486, accuracy 97.0%\nstep 23 loss 0.12173524408232453, accuracy 95.0%\nstep 24 loss 0.12615712612770452, accuracy 95.0%\nstep 25 loss 0.16049097780801674, accuracy 95.0%\nstep 26 loss 0.1874719770524581, accuracy 92.0%\nstep 27 loss 0.16741837891059402, accuracy 95.0%\nstep 28 loss 0.09586583491455397, accuracy 97.0%\nstep 29 loss 0.08778783707420913, accuracy 96.0%\nstep 30 loss 0.1173129756901185, accuracy 95.0%\nstep 31 loss 0.09340146460619832, accuracy 97.0%\nstep 32 loss 0.12454454903103453, accuracy 95.0%\nstep 33 loss 0.07984002652777268, accuracy 97.0%\nstep 34 loss 0.07727519232921673, accuracy 97.0%\nstep 35 loss 0.07661250143094474, accuracy 98.0%\nstep 36 loss 0.10610492379198366, accuracy 96.0%\nstep 37 loss 0.0906280842926597, accuracy 99.0%\nstep 38 loss 0.10671887043036926, accuracy 95.0%\nstep 39 loss 0.052256599219758455, accuracy 98.0%\nstep 40 loss 0.06016009895234463, accuracy 100.0%\nstep 41 loss 0.08596724533333938, accuracy 96.0%\nstep 42 loss 0.05112107943179595, accuracy 99.0%\nstep 43 loss 0.05240142401642826, accuracy 97.0%\nstep 44 loss 0.04530684179001569, accuracy 100.0%\nstep 45 loss 0.07211073370655094, accuracy 97.0%\nstep 46 loss 0.0333423865131023, accuracy 99.0%\nstep 47 loss 0.03143222795751125, accuracy 100.0%\nstep 48 loss 0.03658536747111507, accuracy 99.0%\nstep 49 loss 0.048291393823903, accuracy 99.0%\nstep 50 loss 0.09875114765619629, accuracy 96.0%\nstep 51 loss 0.05449063965875445, accuracy 99.0%\nstep 52 loss 0.03392679435708304, accuracy 100.0%\nstep 53 loss 0.05261517263568441, accuracy 97.0%\nstep 54 loss 0.03250295251424922, accuracy 99.0%\nstep 55 loss 0.028883273872078178, accuracy 100.0%\nstep 56 loss 0.0413915110402724, accuracy 98.0%\nstep 57 loss 0.018987407426128484, accuracy 100.0%\nstep 58 loss 0.02523833523883741, accuracy 100.0%\nstep 59 loss 0.020796565213418904, accuracy 100.0%\nstep 60 loss 0.032597111578102314, accuracy 99.0%\nstep 61 loss 0.017863351693480252, accuracy 100.0%\nstep 62 loss 0.023008717832211714, accuracy 100.0%\nstep 63 loss 0.02207932546358144, accuracy 100.0%\nstep 64 loss 0.029432917853529687, accuracy 99.0%\nstep 65 loss 0.016251514644091886, accuracy 100.0%\nstep 66 loss 0.028468534483264467, accuracy 99.0%\nstep 67 loss 0.013994365546208726, accuracy 100.0%\nstep 68 loss 0.015552344843651377, accuracy 100.0%\nstep 69 loss 0.03389119946160171, accuracy 99.0%\nstep 70 loss 0.014229870065926912, accuracy 100.0%\nstep 71 loss 0.013255281583285499, accuracy 100.0%\nstep 72 loss 0.012300277590022056, accuracy 100.0%\nstep 73 loss 0.012676052498355978, accuracy 100.0%\nstep 74 loss 0.02059381195595472, accuracy 100.0%\nstep 75 loss 0.01184539820536442, accuracy 100.0%\nstep 76 loss 0.01601269747288313, accuracy 100.0%\nstep 77 loss 0.025458360239222075, accuracy 100.0%\nstep 78 loss 0.014382930289661883, accuracy 100.0%\nstep 79 loss 0.011698962425817966, accuracy 100.0%\nstep 80 loss 0.012318500800515811, accuracy 100.0%\nstep 81 loss 0.014121117031464226, accuracy 100.0%\nstep 82 loss 0.01166459196244621, accuracy 100.0%\nstep 83 loss 0.011589314549188727, accuracy 100.0%\nstep 84 loss 0.010990299347735226, accuracy 100.0%\nstep 85 loss 0.01098922672069161, accuracy 100.0%\nstep 86 loss 0.010988193757655071, accuracy 100.0%\nstep 87 loss 0.010987200447388707, accuracy 100.0%\nstep 88 loss 0.010986246779084925, accuracy 100.0%\nstep 89 loss 0.010985332742365276, accuracy 100.0%\nstep 90 loss 0.010984458327280174, accuracy 100.0%\nstep 91 loss 0.010983623524308865, accuracy 100.0%\nstep 92 loss 0.010982828324359074, accuracy 100.0%\nstep 93 loss 0.010982072718767003, accuracy 100.0%\nstep 94 loss 0.010981356699297043, accuracy 100.0%\nstep 95 loss 0.010980680258141725, accuracy 100.0%\nstep 96 loss 0.010980043387921508, accuracy 100.0%\nstep 97 loss 0.010979446081684675, accuracy 100.0%\nstep 98 loss 0.010978888332907227, accuracy 100.0%\nstep 99 loss 0.010978370135492717, accuracy 100.0%\n"},"children":[],"key":"btgfP7WdlK"}],"key":"pZ5KxOFJyt"}],"key":"hZ15sXdme2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# visualize decision boundary\n\nh = 0.25\nx_min, x_max = X_moons[:, 0].min() - 1, X_moons[:, 0].max() + 1\ny_min, y_max = X_moons[:, 1].min() - 1, X_moons[:, 1].max() + 1\nxx, yy = np.meshgrid(np.arange(x_min, x_max, h), np.arange(y_min, y_max, h))\nXmesh = np.c_[xx.ravel(), yy.ravel()]\ninputs = [list(map(Value, xrow)) for xrow in Xmesh]\nscores = list(map(model, inputs))\nZ = np.array([s.data > 0 for s in scores])\nZ = Z.reshape(xx.shape)\n\nfig = plt.figure()\nplt.contourf(xx, yy, Z, cmap=plt.cm.Spectral, alpha=0.8)\nplt.scatter(X_moons[:, 0], X_moons[:, 1], c=y_moons, s=40, cmap=plt.cm.Spectral)\nplt.xlim(xx.min(), xx.max())\nplt.ylim(yy.min(), yy.max());","key":"ejAlh74Ypp"},{"type":"outputs","id":"J82AW9d1GPNpVZn8ChCM6","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/vnd.jupyter.widget-view+json":{"content":"{\"model_id\":\"4e3b3c67b2ff4b8c8ea10862d06fac9e\",\"version_major\":2,\"version_minor\":0}","content_type":"application/vnd.jupyter.widget-view+json"},"image/png":{"content_type":"image/png","hash":"5bbbcc37252c628e200d47a36f13b177","path":"/build/5bbbcc37252c628e200d47a36f13b177.png"},"text/html":{"content_type":"text/html","hash":"37e61a29faa4fd4657822e1ab675b05b","path":"/build/37e61a29faa4fd4657822e1ab675b05b.html"},"text/plain":{"content":"Canvas(toolbar=Toolbar(toolitems=[('Home', 'Reset original view', 'home', 'home'), ('Back', 'Back to previous …","content_type":"text/plain"}}},"children":[],"key":"gGgqXXDaqm"}],"key":"yxBYGU4kE3"}],"key":"k56WUeimao"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SbtnBOgkFQ"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"grPqOE1COq"}],"key":"m57LV0h8vN"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s now bring together and summarize what we have learned. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BAV9UXCOGl"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XVc3ylNLsQ"}],"key":"jqCk5eF4Bz"},{"type":"text","value":"s are functions that take the data as well as the weights and biases (parameters) as inputs to produce outputs. The outputs, or ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uDd7LwECeI"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"predictions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gmQngcK6Si"}],"key":"N0FBZxiXFW"},{"type":"text","value":", together with target values are then passed through a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PxXxZhhjNO"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oh2HRhNlbF"}],"key":"qyXoEiUMfl"},{"type":"text","value":" function that yields an error called the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"k56ma37Mmz"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JNybTJPCCR"}],"key":"dhqXES6GeV"},{"type":"text","value":" value that represents their distance, in terms of how close or far apart they are. We train ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MdqhN3UuD2"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"k3NENn5cgw"}],"key":"nRQXwjCNCu"},{"type":"text","value":"s by using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XhcY5GCHMp"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gIAEFRJjVn"}],"key":"AybumYRgoX"},{"type":"text","value":" to calculate the gradient of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AvVCbHJzEV"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RovqizWmB8"}],"key":"HY2bFgc6Up"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l8A0F0jGX6"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HNOvzxcCQE"}],"key":"RjnwhIRpcT"},{"type":"text","value":" the parameters. These gradients are used to then optimize those parameters using gradient descent in order to minimize the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oP7bSB7S3H"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PVZIVfvY9v"}],"key":"kI8h4L319M"},{"type":"text","value":". The end goal is for the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p2IneT9beV"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LpHU6nNwop"}],"key":"tnxGRRjYaj"},{"type":"text","value":" to perform a given task. Although relatively simple expressions, it turns out that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VFrpUCwY22"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bwhrFceuAZ"}],"key":"fTvjG6eLv0"},{"type":"text","value":"s can solve very complicated problems. Sometimes, if the problem is complex enough, and the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aoz3RTHwJ5"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SHHK03ftWS"}],"key":"Z27LhTkDtI"},{"type":"text","value":" big enough (> 100 billion parameters), fascinating proprties arise, as in the case of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RafRjFbIVY"},{"type":"link","url":"https://en.wikipedia.org/wiki/Generative_pre-trained_transformer","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"GPT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m6o5CkDztx"}],"urlSource":"https://en.wikipedia.org/wiki/Generative_pre-trained_transformer","data":{"page":"Generative_pre-trained_transformer","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"YKCmAn5vX5"},{"type":"text","value":", for example. This model, trained with large amounts of text from the internet can predict, given some words, the next words in a sequence.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iFONxvA64x"}],"key":"ew0wKl7rLU"}],"key":"R7zXUtWJpB"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Outro","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q9pDtN2wCU"}],"identifier":"outro","label":"Outro","html_id":"outro","implicit":true,"key":"o7FCSk9IdE"}],"key":"wjkF5Vb8mz"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This brings us to the end of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jQDjr1w5ao"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"micrograd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x8cml044T2"}],"key":"C1qpzhJRNR"},{"type":"text","value":" tutorial. I hope you enjoyed this tutorial and found it helpful! Next up, it’s time to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"upSqOin1R2"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"make more","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GUyOFVTpfZ"}],"key":"agnJ66kmzM"},{"type":"text","value":"!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CRTQ2JGD2p"}],"key":"amd1M67qql"}],"key":"UBlTeWJ1P2"}],"key":"MX59pXCBQW"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"microgra∇uate","url":"/","group":"microgra∇uate"},"next":{"title":"2. makemore (part 1): implementing a bigram character-level language model","url":"/micrograduate/makemore1","group":"microgra∇uate"}}},"domain":"http://localhost:3000"}