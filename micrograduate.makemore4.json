{"version":3,"kind":"Notebook","sha256":"9aafb4c4e9add42b75b826d843ebb00a3edea1d1078a0651b539113449e23260","slug":"micrograduate.makemore4","location":"/micrograduate/makemore4.ipynb","dependencies":[],"frontmatter":{"title":"5. makemore (part 4): becoming a backprop ninja","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"micrograduate-env","language":"python"},"github":"https://github.com/ckaraneen/micrograduate","copyright":"MIT License","source_url":"https://github.com/ckaraneen/micrograduate/blob/main/micrograduate/makemore4.ipynb","edit_url":"https://github.com/ckaraneen/micrograduate/edit/main/micrograduate/makemore4.ipynb","exports":[{"format":"ipynb","filename":"makemore4.ipynb","url":"/build/makemore4-193f5c309004be33d046a28f4681e359.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import sys\n\nIN_COLAB = \"google.colab\" in sys.modules\nif IN_COLAB:\n    print(\"Cloning repo...\")\n    !git clone --quiet https://github.com/ckaraneen/micrograduate.git > /dev/null\n    %cd micrograduate\n    print(\"Installing requirements...\")\n    !pip install --quiet uv\n    !uv pip install --system --quiet -r requirements.txt","key":"Ny8xNMCYVt"},{"type":"outputs","id":"WqegT4Wqb-DPaXtNXRC1C","children":[],"key":"PDSjzN7K8p"}],"key":"Y8N2gRH6km"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Intro","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"w57lcyK0bT"}],"identifier":"intro","label":"Intro","html_id":"intro","implicit":true,"key":"Pgy9zntH7t"}],"key":"K3pwj9utXv"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Hi everyone. So today we are once again continuing our implementation of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y35vyAVdxy"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"makemore","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XCxyYJ7KBN"}],"key":"cnOKAHgh7b"},{"type":"text","value":"!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"d5VjfqFvDJ"}],"key":"Tn7gpK8ipG"}],"key":"bEGnMffobc"},{"type":"block","kind":"notebook-content","children":[{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":1,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Bigram (one character predicts the next one with a lookup table of counts)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"n0fvacJaVL"}],"key":"QZE9BkKOnZ"}],"key":"FGNRwoTH69"},{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"MLP, following ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"TJte6Pg4t9"},{"type":"link","url":"https://doi.org/10.5555/944919.944966","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Bengio et al. 2003","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"JVa8Mv5yUY"}],"urlSource":"https://dl.acm.org/doi/10.5555/944919.944966","data":{"doi":"10.5555/944919.944966"},"internal":false,"protocol":"doi","key":"XDKCA2Anky"}],"key":"Ub0g4WVs3A"}],"key":"DbFkOl4v6O"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"RNN, following ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"luIP7AkkUt"},{"type":"link","url":"https://www.fit.vutbr.cz/research/groups/speech/publi/2010/mikolov_interspeech2010_IS100722.pdf","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Mikolov et al. 2010","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"H4FYKsuHqx"}],"urlSource":"https://www.fit.vutbr.cz/research/groups/speech/publi/2010/mikolov_interspeech2010_IS100722.pdf","key":"boIy37Ocgx"}],"key":"EHNn68VCvB"}],"key":"CUWOBH5OnK"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"LSTM, following ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"ZWZs1oUAHU"},{"type":"link","url":"https://arxiv.org/abs/1308.0850","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Graves et al. 2014","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"OAg7IxDFIq"}],"urlSource":"https://arxiv.org/abs/1308.0850","key":"XpshbnZHUF"}],"key":"SyqLgPvMer"}],"key":"dangcZsFA9"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"GRU, following ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"lGjwQCoRXP"},{"type":"link","url":"https://arxiv.org/abs/1409.1259","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Kyunghyun Cho et al. 2014","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yAWQa4xG7D"}],"urlSource":"https://arxiv.org/abs/1409.1259","key":"wejiTOgpXw"}],"key":"afx9Ecu2Ak"}],"key":"g8QyvU6ip6"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"CNN, following ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"vRnn9RvSE1"},{"type":"link","url":"https://arxiv.org/abs/1609.03499","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Oord et al., 2016","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"iLcoC5b0tZ"}],"urlSource":"https://arxiv.org/abs/1609.03499","key":"zs3EXcf3LI"}],"key":"dlSstKSNez"}],"key":"uZOJpg1LP3"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Transformer, following ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Tah5JvpazF"},{"type":"link","url":"https://arxiv.org/abs/1706.03762","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Vaswani et al. 2017","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"vA94kF9lPy"}],"urlSource":"https://arxiv.org/abs/1706.03762","key":"zc7RHqnwIx"}],"key":"eoxHljU0Mk"}],"key":"xQXYy8W0qZ"}],"key":"cIWyitR3bG"}],"key":"iiAZ49FlZL"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now so far, from the above list, we’ve come up to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p8U6wpOgIK"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"mlp","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DU0J0wu9B1"}],"key":"BlqnixpwYT"},{"type":"text","value":"s and our ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"I6b8wwZ4gd"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WRxRh3J3vs"}],"key":"RAehGFgtOq"},{"type":"text","value":" has looked like this:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"azUBzKAOTe"}],"key":"y5akWuE1wJ"}],"key":"SzqrQS1IVY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from IPython.display import Image, display\n\ndisplay(Image(filename=\"bengio2003nn.jpeg\"))","key":"VqXeQbcUd2"},{"type":"outputs","id":"FIFsUu2nK116tuExarT4G","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/jpeg":{"content_type":"image/jpeg","hash":"a21abcc7498c74c85d4a3cd5f51b3817","path":"/build/a21abcc7498c74c85d4a3cd5f51b3817.jpeg"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}},"children":[],"key":"oaq02YyUq2"}],"key":"ZLwlV5atv8"}],"key":"HBxWiDeCBI"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"and we have been implementing this over the last few lessons. Now, I’m sure everyone is very excited to go into recurrent neural networks (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OHjFnTHwBU"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"rnn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rmsjVfG1qq"}],"key":"xJBsS1k8n7"},{"type":"text","value":"s) and all of their variants and how they work and their diagrams look cool:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uEJg5fQbjc"}],"key":"xb97HMnEM5"}],"key":"DiTp0bwCf0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from IPython.display import Image, display\n\ndisplay(Image(filename=\"rnns.png\"))","key":"RIFe39PLl2"},{"type":"outputs","id":"SlZYCncyVPPBwiQ91zGzk","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bcb301c6b54731d2816708f0c7446edb","path":"/build/bcb301c6b54731d2816708f0c7446edb.png"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}},"children":[],"key":"hLjLn78Wrq"}],"key":"aYkplYwJ5u"}],"key":"ZZ6dKGxTRa"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"and such models are very exciting and interesting, and we’re going to get a better result. But unfortunately, I think we have to remain here for one more lecture. And the reason for that is we’ve already trained this ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wpqDH0VYmN"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"mlp","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"n9kHJasDsU"}],"key":"uVYGoSAJBG"},{"type":"text","value":" and we are getting pretty good loss and we have developed a pretty decent understanding of the architecture and how it works. But in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yBN7ZPZBFA"},{"type":"inlineCode","value":"train()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Dv9Yg8jKaK"},{"type":"text","value":", we are using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bUuVdBlY39"},{"type":"inlineCode","value":"loss.backward()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OQCiL4nky8"},{"type":"text","value":", a line of code that we should take an issue with if we want to have a holistic and intuitive understanding of how gradients are actually being calculated and what exactly is going on here. That is, we have been using PyTorch’s autograd and using it to calculate all of our gradients along the way. Here, what we will do is remove the use of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lqpKHQrPcp"},{"type":"inlineCode","value":"loss.backward()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RYpp8hBkoE"},{"type":"text","value":", and we will write our backward pass ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zfoieSOph7"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"manually","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ixoafHBYHE"}],"key":"MoJE2XzgJ3"},{"type":"text","value":", at the level of tensors.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i1rnBwsgXv"}],"key":"UGct8uIlOm"}],"key":"zUEsAaCKiN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i3wzNwrf2s"}],"key":"BmFvVjmcP5"},{"type":"text","value":" back in the day","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ISuGNeAhQv"}],"identifier":"backprop-back-in-the-day","label":"Backprop back in the day","html_id":"backprop-back-in-the-day","implicit":true,"key":"M4qiu7qR0H"}],"key":"olScfXB1sX"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This will prove to be a very useful exercise for the following reasons. Andrej has actually an entire blogpost on this topic: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r7cw2uAuzq"},{"type":"link","url":"https://karpathy.medium.com/yes-you-should-understand-backprop-e2f06eab496b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Yes you should understand ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X6E0H3tSA3"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xzOfrH2Mox"}],"key":"qBhO3lRdUp"}],"urlSource":"https://karpathy.medium.com/yes-you-should-understand-backprop-e2f06eab496b","key":"SD0SLKhEt0"},{"type":"text","value":", where he basically characterizes ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZUcbaY4toP"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Yr4kqfAsI8"}],"key":"GFzCkwztE4"},{"type":"text","value":" as a leaky abstraction. And what I mean by that is that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a8yqrMu2Qf"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Iz3N1HVqMH"}],"key":"CdgVYtQiJu"},{"type":"text","value":" doesn’t just make your ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aqvvlFUuln"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PebBJy3VBM"}],"key":"IEJNJWKXAW"},{"type":"text","value":"s just work ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qyIEhI07W9"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"magically","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GSQ0DOASb2"}],"key":"L0AT01iKbI"},{"type":"text","value":". It’s not the case that you can just stack up arbitrary lego blocks of differentiable functions and just cross your fingers, do ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uN50qsvQbs"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hFmk3cbx7V"}],"key":"wF3BeJvDhR"},{"type":"text","value":" and everything is great. Things don’t just work automatically. It is a leaky abstraction in the sense that you can shoot yourself in the foot if you do not understand its internals. It may magically not work or not work optimally. And you will need to understand how it works under the hood if you’re hoping to debug an issue with it and if you are hoping to address it in your ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pVTvv8y0tt"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TbZk2HIWuY"}],"key":"e2y2Ea4zaE"},{"type":"text","value":". So ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ED4D7rqxHY"},{"type":"link","url":"https://karpathy.medium.com/yes-you-should-understand-backprop-e2f06eab496b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"the blog post","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Mq1dMoo15C"}],"urlSource":"https://karpathy.medium.com/yes-you-should-understand-backprop-e2f06eab496b","key":"Z8dMwaesJj"},{"type":"text","value":" goes into some of those examples. So for example, we’ve already covered some of them already. For example, the flat tails of functions such as the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZSMh6RRYgy"},{"type":"inlineMath","value":"sigmoid","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>o</mi><mi>i</mi><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">sigmoid</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"G8LWFKxtJq"},{"type":"text","value":" or ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LeFn8rQKrO"},{"type":"inlineMath","value":"tanh","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">tanh</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">anh</span></span></span></span>","key":"Nh66lcXZq9"},{"type":"text","value":" and how you do not want to saturate them too much because your gradients will die:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pVNjQ0rzv7"}],"key":"TbO0FGhn0E"}],"key":"h0Wv9UxVwe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from IPython.display import Image, display\n\ndisplay(Image(filename=\"sigmoid_derivative.jpeg\"))","key":"rtqTVOYSTF"},{"type":"outputs","id":"bJC8ulSQlVPxovOCs4l1m","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/jpeg":{"content_type":"image/jpeg","hash":"4b286b8716ab87520bfd312276be82a9","path":"/build/4b286b8716ab87520bfd312276be82a9.jpeg"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}},"children":[],"key":"y6hsvDQO4Z"}],"key":"MYnHP72PMJ"}],"key":"ZyZApsfR9A"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"There’s the case of dead neurons, which we’ve already covered as well:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jmOxa3NTqw"}],"key":"czGxzxQp3d"}],"key":"HhF8raxpCb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from IPython.display import Image, display\n\ndisplay(Image(filename=\"relu_derivative.jpeg\"))","key":"zfX6OmVvx7"},{"type":"outputs","id":"WRhgNEiVriDHBLUDq_qxV","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/jpeg":{"content_type":"image/jpeg","hash":"0ef459baf0c45ed47b4c6fb3e07c0863","path":"/build/0ef459baf0c45ed47b4c6fb3e07c0863.jpeg"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}},"children":[],"key":"Oj5Ai2SHEi"}],"key":"y67AoMG3ZL"}],"key":"ZJHdNkqa17"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Also, the case of exploding or vanishing gradients in the case of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ivwYJuxvf6"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"rnn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZsNkeVqcZm"}],"key":"ovp4LX47He"},{"type":"text","value":"s, which we are about to cover:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TDwmt436Cn"}],"key":"Q5OfdDsUnj"}],"key":"X5WBI7aIoZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from IPython.display import Image, display\n\ndisplay(Image(filename=\"rnngradients.jpeg\"))","key":"MZ16WBaftE"},{"type":"outputs","id":"7IISWAwfq-4JVAuaz9eKL","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/jpeg":{"content_type":"image/jpeg","hash":"9f8f34f31466b14ea32d3d17e63e6931","path":"/build/9f8f34f31466b14ea32d3d17e63e6931.jpeg"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}},"children":[],"key":"uEOB7yaYOC"}],"key":"U0D4e9UChG"}],"key":"q1vNOx0IZM"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And then also you will often come across some examples in the wild:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MZEdHVRWVZ"}],"key":"FfN50OeDZF"}],"key":"syAsxbsI0B"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from IPython.display import Image, display\n\ndisplay(Image(filename=\"dqnbadclipping.jpeg\"))","key":"n1UtsLyxOJ"},{"type":"outputs","id":"ZMFD6exJpwqoJlZf3IDRc","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/jpeg":{"content_type":"image/jpeg","hash":"ae56329fda9cc4762854110ce64ce7f7","path":"/build/ae56329fda9cc4762854110ce64ce7f7.jpeg"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}},"children":[],"key":"yCycHlG0xC"}],"key":"EDCvBQ6t6v"}],"key":"qMxtf4xKLu"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This is a snippet that Andrej found in a random code base on the internet where they actually have like a very subtle but pretty-major bug in their implementation. And the bug points at the fact that the author of this code does not actually understand ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MlZxo3TPAC"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oeTgWpb1HB"}],"key":"JJ1bA3orAp"},{"type":"text","value":". So what they’re trying to do here is they’re trying to clip the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aw7SuEe9Up"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AL5ExoXRUz"}],"key":"MgRv0t64WL"},{"type":"text","value":" at a certain maximum value. But actually what they’re trying to do is they’re trying to clip the gradients to have a maximum value instead of trying to clip the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XmfLbXKy0S"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AZwRDTAjWv"}],"key":"BiiZb73E8L"},{"type":"text","value":" at a maximum value. And indirectly, they’re basically causing some of the outliers to be actually ignored. Because, when you clip the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TfZMmHnq1A"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pYotdiPuyk"}],"key":"Ul6hIwcxFv"},{"type":"text","value":" of an outlier, you are setting its gradient to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r4k0pc1G2q"},{"type":"text","value":"0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rohZwCfElu"},{"type":"text","value":". And so have a look through this and read through it. But there’s basically a bunch of subtle issues that you’re going to avoid if you actually know what you’re doing. And that’s why I don’t think it’s the case that because PyTorch or other frameworks offer autograd, it is okay for us to ignore how it works. Now, we’ve actually already covered autograd and we wrote ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A8oiw0f234"},{"type":"link","url":"#1.-micrograd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"micrograd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HGT447waOh"}],"key":"aVc9B7FQLa"}],"urlSource":"#1.-micrograd","key":"Fsv8EnDwwd"},{"type":"text","value":". But ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YuhcwoWj9d"},{"type":"link","url":"#1.-micrograd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"micrograd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UDZ1S9V6OB"}],"key":"fER2tWGeLc"}],"urlSource":"#1.-micrograd","key":"ueJXeAo826"},{"type":"text","value":" was an autograd engine only at the level of individual scalars. So the atoms were single individual numbers which I don’t think is enough. And I’d like us to basically think about ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Cbls3WsIcH"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qlT8Uvq8Fv"}],"key":"YTNyJGqYdF"},{"type":"text","value":" at the level of tensors as well. And so in a summary, I think it’s a good exercise. I think it is very, very valuable. You’re going to become better at debugging ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l9WnyJM0sF"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"agN8iRMWmo"}],"key":"AmKy08IADk"},{"type":"text","value":"s and making sure that you understand what you’re doing. It is going to make everything fully explicit. So you’re not going to be nervous about what is hidden away from you. Basically, we’re going to emerge stronger! So let’s get into it. A bit of a fun historical note here is that today, manually writing your backward pass by hand is not recommended and no one does it, except for the purposes of exercise and education. But about around ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nmUTEih87j"},{"type":"text","value":"10","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EGrUoDDvvN"},{"type":"text","value":"+ years ago in deep learning, this was fairly standard and in fact pervasive.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZqvLZuUdhe"}],"key":"CUAS5G5yUD"}],"key":"bZ2e1y4rHW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from IPython.display import Image, display\n\ndisplay(Image(filename=\"backwardmemelol.png\"))","key":"JI8yrkXoi9"},{"type":"outputs","id":"Y5kBGylOx0i_qvF7NblLB","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2dd075d2b68f3d715688a3eb11b30dfe","path":"/build/2dd075d2b68f3d715688a3eb11b30dfe.png"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}},"children":[],"key":"hYPeaxsYLL"}],"key":"z5fwLtRUkG"}],"key":"GuqPSWxLTN"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So at the time, everyone (including Andrej himself) used to write their backward pass manually, by hand. Now, it’s our turn too! Now of course everyone just calls ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"k5aQyKyo7r"},{"type":"inlineCode","value":"loss.backward()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"er3mfochKd"},{"type":"text","value":". But, we’ve lost something. I want to give you a few examples of this. So,  here’s a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lLoB5Xpnt2"},{"type":"text","value":"2006","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tmkUZKWVhI"},{"type":"text","value":" paper from Geoffrey Hinton and Ruslan Salakhutdinov in Science that was influential at the time: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IB4KL62gii"},{"type":"link","url":"https://www.cs.toronto.edu/~hinton/absps/science.pdf","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Reducing the Dimensionality of Data with Neural Networks","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vYbnr33OI0"}],"urlSource":"https://www.cs.toronto.edu/~hinton/absps/science.pdf","key":"Iq3kzzxbRs"},{"type":"text","value":". And this was training some architectures called restricted Boltzmann machines (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LVqVRI9HeR"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"rbm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QfbOvqRcCa"}],"key":"aeC5XUhMCd"},{"type":"text","value":"s). And basically, it’s an autoencoder trained here:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NJ7adBX7ZK"}],"key":"XJrVws0qZK"}],"key":"fdWN6bpb2c"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from IPython.display import Image, display\n\ndisplay(Image(filename=\"rbms.jpeg\"))","key":"uWAY2p59Ty"},{"type":"outputs","id":"oSBPA1T35_ApPgLhX3Gq1","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/jpeg":{"content_type":"image/jpeg","hash":"eaf5f8e7903784a7e5e212370df184f0","path":"/build/eaf5f8e7903784a7e5e212370df184f0.jpeg"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}},"children":[],"key":"jY3rUq7Yrk"}],"key":"j9ZRjo2vM6"}],"key":"jK2NLV5DF9"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And this is from roughly ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"quQotwwZMC"},{"type":"text","value":"2010","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"d1xkIV8iCb"},{"type":"text","value":", when Andrej had written a MATLAB library for training (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X4Tz4xWZ85"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"rbm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YzLCEGmROy"}],"key":"CvddiA6wZM"},{"type":"text","value":"s) called ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Lo8UrKTD0E"},{"type":"link","url":"https://code.google.com/archive/p/matrbm/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"matrbm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UGc2Td6BLa"}],"urlSource":"https://code.google.com/archive/p/matrbm/","key":"G8xaH0rcZH"},{"type":"text","value":". And this was at the time when Python was not used for deep learning as pervasively as it is now. It was all MATLAB, which was this scientific computing package that everyone would use:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hL3s2kaOnk"}],"key":"x9ILtRqlq6"}],"key":"WGNCr2tNdW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from IPython.display import Image, display\n\ndisplay(Image(filename=\"matlab.png\"))","key":"C0xfFFqrMm"},{"type":"outputs","id":"Auw4q7dFQHFDw7iolKkiP","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8fb132513a9c612d6decfeaf7587d60c","path":"/build/8fb132513a9c612d6decfeaf7587d60c.png"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}},"children":[],"key":"vRJ3nvsN3X"}],"key":"cNmbF38a1B"}],"key":"BKPoAxv67O"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So we would write MATLAB, which is barely a programming language as well. But it had a very convenient tensor class. And it was this computing environment and you would run here. It would all run on the CPU, of course. But you would have very nice plots to go with it and a built-in debugger. And it was pretty decent. Now, the code in the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dDUh4u14HN"},{"type":"text","value":"2010","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VLjMSiom91"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KvDu4tP4XB"},{"type":"link","url":"https://code.google.com/archive/p/matrbm/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"matrbm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aJQndrB8Tu"}],"urlSource":"https://code.google.com/archive/p/matrbm/","key":"IDLJdCF1YA"},{"type":"text","value":" package that written for fitting ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ens8s7mqkF"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"rbm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vwj8ttFnhm"}],"key":"MyOtQ0VVOd"},{"type":"text","value":"s to a large extent is recognizable. Let’s open up the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Rn87gDEqUb"},{"type":"link","url":"https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/matrbm/RBMLIB.zip","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineCode","value":"rbmFit.m","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lqGbX6EE76"},{"type":"text","value":" source code file","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Jbh3wo4hqs"}],"urlSource":"https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/matrbm/RBMLIB.zip","key":"kEwkoClvFo"},{"type":"text","value":" and see if we can get a rough idea of what is going on. Well first Andrej creates the data and the x, y batches:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AHDsJQluW2"}],"key":"yGXUBv7HDX"}],"key":"CLbRhuoZMI"},{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"MATLAB","value":"...\n%Create targets: 1-of-k encodings for each discrete label\nu= unique(y);\ntargets= zeros(N, nclasses);\nfor i=1:length(u)\n    targets(y==u(i),i)=1;\nend\n\n%Create batches\nnumbatches= ceil(N/batchsize);\ngroups= repmat(1:numbatches, 1, batchsize);\ngroups= groups(1:N);\ngroups = groups(randperm(N));\nfor i=1:numbatches\n    batchdata{i}= X(groups==i,:);\n    batchtargets{i}= targets(groups==i,:);\nend\n...","position":{"start":{"line":1,"column":1},"end":{"line":20,"column":1}},"key":"K8D3ZIn71t"}],"key":"MlVUJlsMpG"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"He’s initializing the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DQNKlzH3bU"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M3lniOVSu4"}],"key":"f3gVcacWjn"},{"type":"text","value":" so that it’s got weights as and biases just like we’re used to:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rMa29VXsjW"}],"key":"MmmEaPb9Wz"}],"key":"VdDVsSTX6A"},{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"MATLAB","value":"...\n%fit RBM\nnumcases=N;\nnumdims=d;\nnumclasses= length(u);\nW = 0.1*randn(numdims,numhid);\nc = zeros(1,numdims);\nb = zeros(1,numhid);\nWc = 0.1*randn(numclasses,numhid);\ncc = zeros(1,numclasses);\nph = zeros(numcases,numhid);\nnh = zeros(numcases,numhid);\nphstates = zeros(numcases,numhid);\nnhstates = zeros(numcases,numhid);\nnegdata = zeros(numcases,numdims);\nnegdatastates = zeros(numcases,numdims);\nWinc  = zeros(numdims,numhid);\nbinc = zeros(1,numhid);\ncinc = zeros(1,numdims);\nWcinc = zeros(numclasses,numhid);\nccinc = zeros(1,numclasses);\nWavg = W;\nbavg = b;\ncavg = c;\nWcavg = Wc;\nccavg = cc;\nt = 1;\nerrors=zeros(1,maxepoch);\n...","position":{"start":{"line":1,"column":1},"end":{"line":31,"column":1}},"key":"Ndprb31AZu"}],"key":"RbkduTaGBh"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And then this is the training loop where we actually do the forward pass:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"za41txWK4N"}],"key":"sTAlcN86Vo"}],"key":"PzSKvMYZRD"},{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"MATLAB","value":"...\nfor epoch = 1:maxepoch\n    \n\terrsum=0;\n    if (anneal)\n        penalty= oldpenalty - 0.9*epoch/maxepoch*oldpenalty;\n    end\n    \n    for batch = 1:numbatches\n\t\t[numcases numdims]=size(batchdata{batch});\n\t\tdata = batchdata{batch};\n\t\tclasses = batchtargets{batch};\n        \n        %go up\n        ph = logistic(data*W + classes*Wc + repmat(b,numcases,1));\n\t\tphstates = ph > rand(numcases,numhid);\n        if (isequal(method,'SML'))\n            if (epoch == 1 && batch == 1)\n                nhstates = phstates;\n            end\n        elseif (isequal(method,'CD'))\n            nhstates = phstates;\n        end\n...","position":{"start":{"line":1,"column":1},"end":{"line":26,"column":1}},"key":"TDMB8kqN77"}],"key":"jCzOMKapkW"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And then here, at this time, they didn’t even necessarily use back propagation to train ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hk0C9sPshV"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qITbwOVFXQ"}],"key":"BFtgb49JBH"},{"type":"text","value":"s. So this, in particular, implements a lot of the training that we’re doing. It implements contrastive divergence, which estimates a gradient:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NbbT5v4hyE"}],"key":"GOPv95CF6I"}],"key":"UbHrJH5oWD"},{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"MATLAB","value":"...\n        %go down\n\t\tnegdata = logistic(nhstates*W' + repmat(c,numcases,1));\n\t\tnegdatastates = negdata > rand(numcases,numdims);\n\t\tnegclasses = softmaxPmtk(nhstates*Wc' + repmat(cc,numcases,1));\n\t\tnegclassesstates = softmax_sample(negclasses);\n\t\t\n        %go up one more time\n\t\tnh = logistic(negdatastates*W + negclassesstates*Wc + ... \n            repmat(b,numcases,1));\n\t\tnhstates = nh > rand(numcases,numhid);\n...","position":{"start":{"line":1,"column":1},"end":{"line":14,"column":1}},"key":"rGcenS1Ztf"}],"key":"iJou6P4Ldj"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And then here, we take that gradient and use it for a parameter update along the lines that we’re used to:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rB9VNiYHAu"}],"key":"wh844OUFtK"}],"key":"SQMjzRJzSZ"},{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"MATLAB","value":"...\n        %update weights and biases\n        dW = (data'*ph - negdatastates'*nh);\n        dc = sum(data) - sum(negdatastates);\n        db = sum(ph) - sum(nh);\n        dWc = (classes'*ph - negclassesstates'*nh);\n        dcc = sum(classes) - sum(negclassesstates);\n\t\tWinc = momentum*Winc + eta*(dW/numcases - penalty*W);\n\t\tbinc = momentum*binc + eta*(db/numcases);\n\t\tcinc = momentum*cinc + eta*(dc/numcases);\n\t\tWcinc = momentum*Wcinc + eta*(dWc/numcases - penalty*Wc);\n\t\tccinc = momentum*ccinc + eta*(dcc/numcases);\n\t\tW = W + Winc;\n\t\tb = b + binc;\n\t\tc = c + cinc;\n\t\tWc = Wc + Wcinc;\n\t\tcc = cc + ccinc;\n\t\t\n        if (epoch > avgstart)\n            %apply averaging\n\t\t\tWavg = Wavg - (1/t)*(Wavg - W);\n\t\t\tcavg = cavg - (1/t)*(cavg - c);\n\t\t\tbavg = bavg - (1/t)*(bavg - b);\n\t\t\tWcavg = Wcavg - (1/t)*(Wcavg - Wc);\n\t\t\tccavg = ccavg - (1/t)*(ccavg - cc);\n\t\t\tt = t+1;\n\t\telse\n\t\t\tWavg = W;\n\t\t\tbavg = b;\n\t\t\tcavg = c;\n\t\t\tWcavg = Wc;\n\t\t\tccavg = cc;\n        end\n        \n        %accumulate reconstruction error\n        err= sum(sum( (data-negdata).^2 ));\n        errsum = err + errsum;\n    end\n...","position":{"start":{"line":1,"column":1},"end":{"line":41,"column":1}},"key":"mnQzUhAKBX"}],"key":"S31Ox71cCG"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"But you can see that basically people are meddling with these gradients directly and inline all by themselves. It wasn’t that common to use an autograd engine. Here’s one more example from Andrej’s paper from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xTcUBZItez"},{"type":"text","value":"2014","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nsi7LGZhPT"},{"type":"text","value":" called ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QJmKlwOBYI"},{"type":"link","url":"https://arxiv.org/abs/1406.5679","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Deep Fragment Embeddings for Bidirectional Image Sentence Mapping","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iZztrek9hW"}],"urlSource":"https://arxiv.org/abs/1406.5679","key":"Ikn1QaAQT9"},{"type":"text","value":". Here, what he was doing is he was aligning images and text:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LxOJ83JKC3"}],"key":"dfSRNt5AX1"}],"key":"pP6m2lLuZN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from IPython.display import Image, display\n\ndisplay(Image(filename=\"karpathy2014fig2.jpeg\"))","key":"Aduudq05SN"},{"type":"outputs","id":"pZif0lXrPo9MT9m-u5aLd","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/jpeg":{"content_type":"image/jpeg","hash":"1c7a960851c08ec4bd25dce76f948c48","path":"/build/1c7a960851c08ec4bd25dce76f948c48.jpeg"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}},"children":[],"key":"kDA7KNCeMi"}],"key":"NZHmUolVhi"}],"key":"QO6kq8wzbV"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And so it’s kind of like a clip if you’re familiar with it, but instead of working at the level of entire images and entire sentences, he was working on the level of individual objects and little pieces of sentences and he was embedding them calculating a clip-like ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EuFhleNR3G"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vvi3XEeggt"}],"key":"amTPa6O6oM"},{"type":"text","value":": the cost. Back in 2014, it was standard to implement not just the cost, but also the backward pass manually. Take a look at the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nF1Fb3vct8"},{"type":"inlineCode","value":"DeFragCost","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l15fh56iJA"},{"type":"text","value":" function from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ttBzsZCKjD"},{"type":"link","url":"https://cs.stanford.edu/people/karpathy/defrag/code.zip","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"the paper’s source code","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D8eCjHEDOf"}],"urlSource":"https://cs.stanford.edu/people/karpathy/defrag/code.zip","key":"cl8kexmLnx"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GdczzYlvOA"}],"key":"l9Ky1h5AEg"}],"key":"S2T62N9aT9"},{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"MATLAB","value":"function [cost_struct, grad, df_CNN] = DeFragCost(theta,decodeInfo,params, oWe,imgFeats,depTrees, rcnn_model)\n% returns cost, gradient, and gradient wrt image vectors which\n% can be forwarded to the CNN for finetuning outside of this\n\ndomil = getparam(params, 'domil', false);\nuseglobal = getparam(params, 'useglobal', true);\nuselocal = getparam(params, 'uselocal', true);\ngmargin = params.gmargin;\nlmargin = params.lmargin;\ngscale = params.gscale;\nlscale = params.lscale;\nthrglobalscore = params.thrglobalscore;\nsmoothnum = params.smoothnum;\nmaxaccum = params.maxaccum;\n\nfinetuneCNN = false;\ndf_CNN = 0;\n\n% unpack parameters\n[Wi2s, Wsem] = stack2param(theta, decodeInfo);\ncost = 0;\n\nN = length(depTrees); % number of samples\n\n% forward prop all image fragments and arrange them into a single large matrix\nimgVecsCell = cell(1, N);\nimgVecICell = cell(1, N);\nif finetuneCNN\n    % forward RCNN\n    imgVecs = andrej_forwardRCNN(imgFeats, rcnn_model, params);\n    for i=1:N\n        imgVecICell{i} = ones(size(imgFeats{i}.codes,1), 1)*i;\n    end\nelse\n    for i=1:N        \n        imgVecsCell{i} = imgFeats{i}.codes;\n    end\n    imgVecs = cat(1, imgVecsCell{:});\n    for i=1:N\n        imgVecICell{i} = ones(size(imgVecsCell{i},1), 1)*i;\n    end\nend\nimgVecI = cat(1, imgVecICell{:});\nallImgVecs = Wi2s * imgVecs'; % the mapped vectors are now columns\nNi = size(allImgVecs,2);\n\n% forward prop all sentences and arrange them\nsentVecsCell = cell(1, N);\nsentTriplesCell = cell(1, N);\nsentVecICell = cell(1, N);\nfor i = 1:N\n    [z, ts] = ForwardSent(depTrees{i},params,oWe,Wsem);\n    sentVecsCell{i} = z;\n    sentTriplesCell{i} = ts;\n    sentVecICell{i} = ones(size(z,2), 1)*i;\nend\nsentVecI = cat(1, sentVecICell{:});\nallSentVecs = cat(2, sentVecsCell{:});\nNs = size(allSentVecs, 2);\n\n% compute fragment scores\ndots = allImgVecs' * allSentVecs;\n\n% compute local objective\nif uselocal\n\n    MEQ = bsxfun(@eq, imgVecI, sentVecI'); % indicator array for what should be high and low\n    Y = -ones(size(MEQ));\n    Y(MEQ) = 1;\n\n    if domil\n\n        % miSVM formulation: we are minimizing over Y in the objective,\n        % what follows is a heuristic for it mentioned in miSVM paper.\n        fpos = dots .* MEQ - 9999  * (~MEQ); % simplifies things\n        Ypos = sign(fpos);\n\n        ixbad = find(~any(Ypos==1,1));\n        if ~isempty(ixbad)\n            [~, fmaxi] = max(fpos(:,ixbad), [], 1);\n            Ypos = Ypos + sparse(fmaxi, ixbad, 2, Ni, Ns); % flip from -1 to 1: add 2\n        end\n\n        Y(MEQ) = Ypos(MEQ); % augment Y in positive bags\n    end\n\n    % weighted fragment alignment objective\n    marg = max(0, lmargin - Y .* dots); % compute margins\n    W = zeros(Ni, Ns);\n    for i=1:Ns\n        ypos = Y(:,i)==1;\n        yneg = Y(:,i)==-1;\n        W(ypos, i) = 1/sum(ypos);\n        W(yneg, i) = 1/(sum(yneg));\n    end\n    wmarg = W .* marg;\n    lcost = lscale * sum(wmarg(:));\n    cost = cost + lcost;\nend\n\n% compute global objective\nif useglobal\n    \n    % forward scores in all regions\n    SG = zeros(N,N);\n    SGN = zeros(N,N); % the number of values (for mean)\n    accumsis = cell(N,N);\n    for i=1:N\n        for j=1:N\n            d = dots(imgVecI == i, sentVecI == j);\n            if thrglobalscore, d(d<0) = 0; end\n            if maxaccum\n                [sv, si] = max(d, [], 1); % score will be max (i.e. we're finding support of each fragment in image)\n                accumsis{i,j} = si; % remember switches for backprop\n                s = sum(sv);\n            else\n                s = sum(d(:)); % score is sum\n            end\n            nnorm = size(d,2); % number of sent fragments\n            nnorm = nnorm + smoothnum;\n            s = s/nnorm;\n            SG(i,j) = s;\n            SGN(i,j) = nnorm;\n        end\n    end\n    \n    % compute the cost\n    gcost = 0;\n    cdiffs = zeros(N,N);\n    rdiffs = zeros(N,N);\n    for i=1:N\n        % i is the pivot. It should have higher score than col and row\n        \n        % col term\n        cdiff = max(0, SG(:,i) - SG(i,i) + gmargin);\n        cdiff(i) = 0; % nvm score with self\n        cdiffs(:, i) = cdiff; % useful in backprop\n        \n        % row term\n        rdiff = max(0, SG(i,:) - SG(i,i) + gmargin);\n        rdiff(i) = 0;\n        rdiffs(i, :) = rdiff; % useful in backprop\n        \n        gcost = gcost + sum(cdiff) + sum(rdiff);\n    end\n    \n    gcost = gscale * gcost;\n    cost = cost + gcost;\nend\n\nltop = zeros(Ni, Ns);\n\nif uselocal\n    % backprop local objective\n    ltop = ltop - lscale * (marg > 0) .* Y .* W;\nend\n\nif useglobal\n    % backprop global objective\n    \n    % backprop margin\n    dsg = zeros(N,N);\n    for i=1:N\n        cd = cdiffs(:,i);\n        rd = rdiffs(i,:);\n        \n        % col term backprop\n        dsg(i,i) = dsg(i,i) - sum(cd > 0);\n        dsg(:,i) = dsg(:,i) + (cd > 0);\n        \n        % row term backprop\n        dsg(i,i) = dsg(i,i) - sum(rd > 0);\n        dsg(i,:) = dsg(i,:) + (rd > 0);\n    end\n    \n    % backprop into scores\n    ltopg = zeros(size(ltop));\n    for i=1:N\n        for j=1:N\n            \n            % backprop through the accumulation function\n            if maxaccum\n                % route the gradient along in each column. bit messy...\n                gradroute = dsg(i,j) / SGN(i,j);\n                mji = find(sentVecI == j);\n                mii = find(imgVecI == i);\n                accumsi = accumsis{i,j};\n                for q=1:length(mji)\n                    miy = mii(accumsi(q));\n                    mix = mji(q);\n                    if thrglobalscore\n                        if dots(miy,mix) > 0\n                            ltopg(miy, mix) = gradroute;\n                        end\n                    else\n                        ltopg(miy, mix) = gradroute;\n                    end\n                end\n            else\n                d = dots(imgVecI == i, sentVecI == j);\n                dd = ones(size(d)) * dsg(i,j) / SGN(i,j);\n                if thrglobalscore\n                    dd(d<0) = 0;\n                end\n                ltopg(imgVecI == i, sentVecI == j) = dd;\n            end\n        end\n    end\n    ltop = ltop + gscale * ltopg;\nend\n\n% backprop into fragment vectors\nallDeltasImg = allSentVecs * ltop';\nallDeltasSent = allImgVecs * ltop;\n\n% backprop image mapping\ndf_Wi2s = allDeltasImg * imgVecs;\n\nif finetuneCNN\n    % derivative wrt CNN data so that we can pass on gradient to RCNN\n    df_CNN = allDeltasImg' * Wi2s;\nend\n\n% backprop sentence mapping\ndf_Wsem = BackwardSents(depTrees,params,oWe,Wsem,sentVecsCell,allDeltasSent);\n\ncost_struct = struct();\ncost_struct.raw_cost = cost;\ncost_struct.reg_cost = params.regC/2 * sum(theta.^2);\ncost_struct.cost = cost_struct.raw_cost + cost_struct.reg_cost;\n\n%[grad,~] = param2stack(df_Wi2s, df_Wsem);\ngrad = [df_Wi2s(:); df_Wsem(:);]; % for speed hardcode param2stack\ngrad = grad + params.regC * theta; % regularization term gradient\nend","position":{"start":{"line":1,"column":1},"end":{"line":237,"column":1}},"key":"zslKLjZaKk"}],"key":"tkj9DS3XoS"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Around ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wVgXupS98u"},{"type":"text","value":"2014","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XaeMh0MLhW"},{"type":"text","value":" it was standard to implement not just the cost but also the backward pass manually. So there he calculates the image embeddings sentence embeddings, sentence embeddings, the scores and the loss function. And after the loss function is calculated, he backwards through the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aMyd1heZ4b"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kTgzOWGsi1"}],"key":"sE1VujDlqe"},{"type":"text","value":" and he appends a regularization term. So everything was done by hand manually, and you would just write out the backward pass. And then you would use a gradient checker to make sure that your numerical estimate of the gradient agrees with the one you calculated during ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Co7oee1ccv"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pYBkL7GGGT"}],"key":"kqSoVylFAb"},{"type":"text","value":". This was very standard for a long time. Today, of course, it is standard to use an autograd engine. But it was definitely useful, and I think people sort of understood how these ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"h1xSM3weNS"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Twk27wnEil"}],"key":"oejLHPNihP"},{"type":"text","value":"s work on a very intuitive level. Therefore, it’s still a good exercise.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xmehGOKvHC"}],"key":"TnOANJYRlG"}],"key":"d154Qurw5z"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Manually implementing a backward pass","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MlHf0oElvI"}],"identifier":"manually-implementing-a-backward-pass","label":"Manually implementing a backward pass","html_id":"manually-implementing-a-backward-pass","implicit":true,"key":"FVNGF1l0oM"}],"key":"a9UWUn56mZ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Okay, so just as a reminder that we’re going to keep everything the same from our previous lecture. So we’re still going to have a two-layer multi-layer perceptron with a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OXqvVeKwym"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"batchnorm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NFM3pkg1l9"}],"key":"aPrwDntaUU"},{"type":"text","value":" layer. So the forward pass will be basically identical to this lecture. But here, we’re going to get rid of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oplbczSAJt"},{"type":"inlineCode","value":"loss.backward()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jmQpsI2isL"},{"type":"text","value":". And instead, we’re going to write the backward pass manually. Apart from that, we’re going to keep everything the same. So the forward pass will be basically identical to the previous lesson, etc. We are simply just going to write the backward pass manually. Here’s the starter code for this lecture:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yN0YKhGckK"}],"key":"sWRSyd6UjE"}],"key":"UBZXCQtZ8V"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import random\nrandom.seed(42)\nimport torch\nimport torch.nn.functional as F\nimport matplotlib.pyplot as plt # for making figures\nif IN_COLAB:\n    %matplotlib inline\nelse:\n    %matplotlib ipympl\nSEED = 2147483647","key":"o9R08O31XM"},{"type":"outputs","id":"4zHv6VjaiZjnbKhoOZLpF","children":[],"key":"kZNEKWKaxJ"}],"key":"nus8mKvwIs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# read in all the words\nwords = open(\"names.txt\", \"r\").read().splitlines()\nprint(len(words))\nprint(max(len(w) for w in words))\nprint(words[:8])","key":"L8ex3K0wfR"},{"type":"outputs","id":"bJReOY0GxwzNE1L9lYKlP","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"32033\n15\n['emma', 'olivia', 'ava', 'isabella', 'sophia', 'charlotte', 'mia', 'amelia']\n"},"children":[],"key":"vOpG6WP0Wo"}],"key":"k770NRagJw"}],"key":"xFukGmpi1t"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# build the vocabulary of characters and mappings to/from integers\nchars = sorted(list(set(\"\".join(words))))\nctoi = {s: i + 1 for i, s in enumerate(chars)}\nctoi[\".\"] = 0\nitoc = {i: s for s, i in ctoi.items()}\nvocab_size = len(itoc)\nprint(itoc)\nprint(vocab_size)","key":"iJ7kFaDZj5"},{"type":"outputs","id":"g4Pu5GjMStzbd66mai2lp","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"{1: 'a', 2: 'b', 3: 'c', 4: 'd', 5: 'e', 6: 'f', 7: 'g', 8: 'h', 9: 'i', 10: 'j', 11: 'k', 12: 'l', 13: 'm', 14: 'n', 15: 'o', 16: 'p', 17: 'q', 18: 'r', 19: 's', 20: 't', 21: 'u', 22: 'v', 23: 'w', 24: 'x', 25: 'y', 26: 'z', 0: '.'}\n27\n"},"children":[],"key":"gHVNLGVCKf"}],"key":"ustnaQccVD"}],"key":"YAkBH14I63"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"block_size = 3\n\n\ndef build_dataset(words):\n    x, y = [], []\n    for w in words:\n        context = [0] * block_size\n        for ch in w + \".\":\n            ix = ctoi[ch]\n            x.append(context)\n            y.append(ix)\n            context = context[1:] + [ix]  # crop and append\n    x = torch.tensor(x)\n    y = torch.tensor(y)\n    print(x.shape, y.shape)\n    return x, y","key":"kQkdj9q9Ye"},{"type":"outputs","id":"kn-Vz-ibSo8o48r7nkiB5","children":[],"key":"O244GTc8pF"}],"key":"zplWGmCuAj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"random.shuffle(words)\nn1 = int(0.8 * len(words))\nn2 = int(0.9 * len(words))\nxtrain, ytrain = build_dataset(words[:n1])  # 80%\nxval, yval = build_dataset(words[n1:n2])  # 10%\nxtest, ytest = build_dataset(words[n2:])  # 10%","key":"zNk0so1WzU"},{"type":"outputs","id":"vLmH0CKxonv0oMKXgL6Lb","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"torch.Size([182625, 3]) torch.Size([182625])\ntorch.Size([22655, 3]) torch.Size([22655])\ntorch.Size([22866, 3]) torch.Size([22866])\n"},"children":[],"key":"Wvi4kzWl6b"}],"key":"zBLqKYs1Lf"}],"key":"HRQNSYw3FW"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, here, we’ll introduce a utility function that we’re going to use later to compare the gradients. So in particular, we are going to have the gradients that we estimate manually ourselves. And we’re going to have gradients that PyTorch calculates. And we’re going to be checking for correctness, assuming, of course, that PyTorch is correct.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Vlg0QDjJVS"}],"key":"kpazB9Ok4a"}],"key":"eAEz5pBQpD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# utility function we will use later when comparing manual gradients to PyTorch gradients\ndef cmp(s, dt, t):\n    ex = torch.all(dt == t.grad).item()\n    app = torch.allclose(dt, t.grad)\n    maxdiff = (dt - t.grad).abs().max().item()\n    print(\n        f\"{s:15s} | exact: {str(ex):5s} | approximate: {str(app):5s} | maxdiff: {maxdiff}\"\n    )","key":"Erb8yN1djk"},{"type":"outputs","id":"VOURvl1yd5mWrx_KGQsLN","children":[],"key":"xzyYYsTwEM"}],"key":"PB0FrwQ3Pl"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Then, here, we have an initialization function that we are quite used to, where we create all the parameters:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cWcjxP0dr8"}],"key":"KnNfI9jPs3"}],"key":"r7TEticqvM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def define_nn(\n    n_hidden=64,\n    n_embd=10,\n    w1_factor=5 / 3,\n    b1_factor=0.1,\n    w2_factor=0.1,\n    b2_factor=0.1,\n    bngain_factor=0.1,\n    bnbias_factor=0.1,\n):\n    global g, C, w1, b1, w2, b2, bngain, bnbias\n    g = torch.Generator().manual_seed(SEED)\n    C = torch.randn((vocab_size, n_embd), generator=g)\n    input_size = n_embd * block_size\n    output_size = vocab_size\n    # Layer 1\n    w1 = (\n        torch.randn((input_size, n_hidden), generator=g)\n        * w1_factor\n        / ((input_size) ** 0.5)\n    )\n    b1 = (\n        torch.randn(n_hidden, generator=g) * b1_factor\n    )  # using b1 just for fun, it's useless because of batchnorm layer\n    # Layer 2\n    w2 = torch.randn(n_hidden, vocab_size, generator=g) * w2_factor\n    b2 = torch.randn(vocab_size, generator=g) * b2_factor\n    # BatchNorm parameters\n    bngain = torch.ones((1, n_hidden)) * bngain_factor + 1.0\n    bnbias = torch.zeros((1, n_hidden)) * bnbias_factor\n    # Note: We are initializating many of these parameters in non-standard ways\n    # because sometimes initializating with e.g. all zeros could mask an incorrect\n    # implementation of the backward pass.\n    parameters = [C, w1, b1, w2, b2, bngain, bnbias]\n    print(sum(p.nelement() for p in parameters))\n    for p in parameters:\n        p.requires_grad = True\n    return parameters","key":"phNRaUtAjy"},{"type":"outputs","id":"sfouy6kvcDheXvusGdBzv","children":[],"key":"kJWcOcsenC"}],"key":"keHPBpZt3s"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, you will note that we changed the initialization a little bit to be small numbers. So normally you would set the biases to be all ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UHwNXysJd3"},{"type":"text","value":"0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oFDl1bHdIN"},{"type":"text","value":". Here, I’m setting them to be small random numbers. And I’m doing this because if your variables are all ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qAMSJb5cUx"},{"type":"text","value":"0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lIewolSJDA"},{"type":"text","value":", or initialized to exactly ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yrGU3MI4Sw"},{"type":"text","value":"0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BkvjXOyaSP"},{"type":"text","value":", sometimes what can happen is that can mask an incorrect implementation of a gradient. Because when everything is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UOXtXm6tmc"},{"type":"text","value":"0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fWI63ZVBu5"},{"type":"text","value":", it sort of like simplifies and gives you a much simpler expression of the gradient than you would otherwise get. And so by making it small numbers, we are trying to unmask those potential errors in these calculations. You might also notice that we are using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p4h9NWLxeR"},{"type":"inlineCode","value":"b1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ycYlgWuQie"},{"type":"text","value":" in the first layer. We are using a bias despite ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hnnogidhBs"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"batchnorm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OdQ2lEjcD1"}],"key":"NOlfVItKdV"},{"type":"text","value":" right afterwards. So this would typically not be what you’d do as we talked about the fact that you don’t need a bias. But we are doing this here just for fun, because we are going to have a gradient ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"e2bK4eS79h"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"drovqatHfP"}],"key":"Fzp378OF9f"},{"type":"text","value":" it and we can check that we are still calculating it correctly even though this bias is spurious.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ASkPrIQRsu"}],"key":"dwdL0a2RyG"}],"key":"krkBMs9Rd5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"batch_size = 32\n\n\ndef construct_minibatch():\n    ix = torch.randint(0, xtrain.shape[0], (batch_size,), generator=g)\n    xb, yb = xtrain[ix], ytrain[ix]\n    return xb, yb","key":"cQGKXa1dAQ"},{"type":"outputs","id":"xEzMmM8a2gcSqO-9eTNUo","children":[],"key":"xhiG7yk6BN"}],"key":"yUXhreYGs7"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So this function calculates a single batch. Then we will define a forward pass function:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JIqltCjQHB"}],"key":"ltwHGqi1sE"}],"key":"ZW3rMyPAEq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def forward(xb, yb):\n    emb = C[xb]  # embed the characters into vectors\n    embcat = emb.view(emb.shape[0], -1)  # concatenate the vectors\n    # Linear layer 1\n    hprebn = embcat @ w1 + b1  # hidden layer pre-activation\n    # BatchNorm layer\n    bnmeani = 1 / batch_size * hprebn.sum(0, keepdim=True)\n    bndiff = hprebn - bnmeani\n    bndiff2 = bndiff**2\n    bnvar = (\n        1 / (batch_size - 1) * (bndiff2).sum(0, keepdim=True)\n    )  # note: Bessel's correction (dividing by n-1, not n)\n    bnvar_inv = (bnvar + 1e-5) ** -0.5\n    bnraw = bndiff * bnvar_inv\n    hpreact = bngain * bnraw + bnbias\n    # Non-linearity\n    h = torch.tanh(hpreact)\n    # Linear layer 2\n    logits = h @ w2 + b2  # output layer\n    # cross entropy loss (same as F.cross_entropy(logits, Yb))\n    logit_maxes = logits.max(1, keepdim=True).values\n    norm_logits = logits - logit_maxes  # subtract max for numerical stability\n    counts = norm_logits.exp()\n    counts_sum = counts.sum(1, keepdims=True)\n    counts_sum_inv = counts_sum**-1\n    probs = counts * counts_sum_inv\n    logprobs = probs.log()\n    globals().update(locals())  # make variables defined so far globally-accessible\n    loss = -logprobs[range(batch_size), yb].mean()\n    intermediate_values = [\n        logprobs,\n        probs,\n        counts,\n        counts_sum,\n        counts_sum_inv,\n        norm_logits,\n        logit_maxes,\n        logits,\n        h,\n        hpreact,\n        bnraw,\n        bnvar_inv,\n        bnvar,\n        bndiff2,\n        bndiff,\n        hprebn,\n        bnmeani,\n        embcat,\n        emb,\n    ]\n    return intermediate_values, loss","key":"gJh4flLcbw"},{"type":"outputs","id":"zW5O2L714fC-_eqctCgKS","children":[],"key":"s6GAdQEEug"}],"key":"hiltAOuvYW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def backward(parameters, fp_intermed_values, loss):\n    # PyTorch backward pass\n    for p in parameters:\n        p.grad = None\n    for t in fp_intermed_values:\n        t.retain_grad()\n    loss.backward()","key":"Jg2PDFIBYq"},{"type":"outputs","id":"-hsUVIicoYJ5CAMIL7gMz","children":[],"key":"kjN9bghHLw"}],"key":"EjX0V3DWbF"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vSwotXyvrU"},{"type":"inlineCode","value":"forward()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wOzjZSAJIV"},{"type":"text","value":" is now significantly expanded compared to what we are used to. The reason our forward pass is longer is for two reasons. Number one, before we just had an ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C5GPuMeR12"},{"type":"inlineCode","value":"f.cross_entropy()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AqdgGLaIMu"},{"type":"text","value":", but here we are bringing back an explicit implementation of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pw7bvRLSpR"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cpJQuYamxD"}],"key":"lZYHxdZAb6"},{"type":"text","value":" function. And number two, we have broken up the implementation into manageable chunks, so we have a lot more intermediate tensors along the way in the forward pass. And that’s because we are about to go backwards and calculate the gradients in this ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"igAmC5YjUB"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oSLCG0aDkp"}],"key":"sjFWkqMZCH"},{"type":"text","value":", from the bottom (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eav6PXoffv"},{"type":"inlineCode","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gKjFRLBgjR"},{"type":"text","value":") to the top (..., ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mg6PaGPGTE"},{"type":"inlineCode","value":"emb","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"L0uPxSTMEn"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jEyGP3X7cp"},{"type":"inlineCode","value":"C","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NR8YTnki2a"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OAO05jfDIG"},{"type":"inlineCode","value":"xb","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ItuglYRnbQ"},{"type":"text","value":"). So we’re going to go upwards and just like we have for example the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JKYP4C7pDN"},{"type":"inlineCode","value":"logprobs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OeBmlGMnMD"},{"type":"text","value":" in this forward pass, in the backward pass we are going to have a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WJLDWKFF8k"},{"type":"inlineCode","value":"dlogprobs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u1G5VltaVg"},{"type":"text","value":" which is going to store the derivative of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WdR6R4mpS0"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cRZhyxaXrH"}],"key":"jU85Alr4Ne"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HKuvivLGg2"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xxXQy58KqQ"}],"key":"pG3XkvZ928"},{"type":"text","value":" the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MOyrA4VnX6"},{"type":"inlineCode","value":"logprobs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oAqGuYUlIt"},{"type":"text","value":" tensor (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SSQLQdXntJ"},{"type":"inlineMath","value":"\\dfrac{\\partial **loss**}{\\partial logprobs}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mo>∗</mo><mo>∗</mo><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>∗</mo><mo>∗</mo></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>p</mi><mi>r</mi><mi>o</mi><mi>b</mi><mi>s</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial **loss**}{\\partial logprobs}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">ro</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">∗</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">∗</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"An3cagS6S6"},{"type":"text","value":"). And so in our manual implementation of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"afhvmpKEQv"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xBRj0x72PI"}],"key":"crw6YWtupW"},{"type":"text","value":", we are going to be prepending ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cBqWhNtUMd"},{"type":"inlineCode","value":"d","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MuUOcVsTXr"},{"type":"text","value":" to every one of these tensors and calculating it along the way of this ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jUTdbpRU9F"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Yh7ehykNJX"}],"key":"iZmkAMfQ1z"},{"type":"text","value":". As an example, we have  a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hzOsJTQ08V"},{"type":"inlineCode","value":"bnraw","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T02pB0pKOt"},{"type":"text","value":" here, so we’re going to be calculating a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"h50kLYC3ib"},{"type":"inlineCode","value":"dbnraw","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nDJSbZDWxe"},{"type":"text","value":" (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bSW59fcPlF"},{"type":"inlineMath","value":"\\dfrac{\\partial **loss**}{\\partial bnraw}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mo>∗</mo><mo>∗</mo><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>∗</mo><mo>∗</mo></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>b</mi><mi>n</mi><mi>r</mi><mi>a</mi><mi>w</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial **loss**}{\\partial bnraw}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">bn</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">∗</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">∗</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"yTnSUSmlDl"},{"type":"text","value":"). Also, in the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Sz8SyaEaVm"},{"type":"inlineCode","value":"backward()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hO8VNTfHho"},{"type":"text","value":" function, before the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wZwH4cZ4bO"},{"type":"inlineCode","value":"loss.backward()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ViUZzPmC7B"},{"type":"text","value":" call, we are calling ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rBZnQvbY89"},{"type":"inlineCode","value":"t.retain_grad()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QOUqIiX2Ih"},{"type":"text","value":" and thus telling PyTorch that we want to retain the graph of all of these intermediate values. This is because:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iwOf2zsEl9"}],"key":"IuDZYb4zLR"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"in ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"X8w0YHWC7B"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"exercise 1","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"X2AfzzGisz"}],"key":"vudqEXxxsL"},{"type":"text","value":" (coming up) we are going to calculate the backward pass, so we’re going to calculate all these ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"OAUdiCpr27"},{"type":"inlineCode","value":"d","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"VUTFdMoOgO"},{"type":"text","value":" variables and use the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"RfnIFniT5T"},{"type":"inlineCode","value":"cmp","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"HJwQ0Fmt1R"},{"type":"text","value":" function we’ve introduced above to check our correctness ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"S0DHdB0ZfK"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"k34Su2Fm6m"}],"key":"q3nlyOaoK7"},{"type":"text","value":" what PyTorch is telling us. This is going to be exercise 1, where we will ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"GgVoLWCYif"},{"type":"strong","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"NfT01JwBRN"}],"key":"K5PaGvamuO"},{"type":"text","value":" through this entire graph (starting from the ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"cgY0q0DwDs"},{"type":"inlineCode","value":"loss","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"yociml5q70"},{"type":"text","value":" and going upward through the intermediate values). Then,","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"zf0ZpEk60Y"}],"key":"WC4PpK4FNu"}],"key":"yT30isktpe"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"in ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ljZ4kks4Ir"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"exercise 2","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"jPBO4zXDB7"}],"key":"janbgjKqAL"},{"type":"text","value":" we will fully break up the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nNwKpcGZ72"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hXGkqzmgM5"}],"key":"PcmwIhiI1g"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"g3lUhz5zgk"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aB9ZW937xp"}],"key":"RDyusIbYWZ"},{"type":"text","value":" through it manually in all the little atomic pieces that make it up. But then we’re going to collapse the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aHu7M24Bjj"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZI2XcbYRyb"}],"key":"etOosmtVPh"},{"type":"text","value":" into a single cross entropy call and instead we’re going to analytically derive using math and paper and pencil the gradient of the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UJv6X9K6Zd"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ps5MnKF3p5"}],"key":"oQpusH5oWe"},{"type":"text","value":" ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XnStoFe6Us"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eH7iBwDIIU"}],"key":"DG9iQqcR2u"},{"type":"text","value":" the logits and instead of ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NOKZdTZMma"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"K57YEHwz9X"}],"key":"u3sJQkhHTB"},{"type":"text","value":"ing through all of its little chunks, one at a time, we’re just going to analytically derive what that gradient is and we’re going to implement that, which is much more efficient as we’ll see in a bit. Next,","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"g7xuvV8fVP"}],"key":"CmHSCcGsG1"}],"key":"i6S2WwPDYI"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"for ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Xf1F1FjbcS"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"exercise 3","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"F5YDuGyNea"}],"key":"ESo3p03o5i"},{"type":"text","value":" we’re going to do the exact same thing for ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"RzPShVFeG0"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"batchnorm","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"KZTESJDH2z"}],"key":"rka6ylwt5n"},{"type":"text","value":". We’re going to use pen and paper and calculus to derive the gradient through the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"u4nCMUgNmo"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"batchnorm","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"S0TRv8EegB"}],"key":"GLUkDlBr9h"},{"type":"text","value":" layer. So we’re going to calculate the backward pass through the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"fLpEHqgHN7"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"batchnorm","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Lp75hrXrZY"}],"key":"YSqfYs5kRW"},{"type":"text","value":" layer in a much more efficient expression, instead of ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"bJGgFAXPAJ"},{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"gxHTscDFxj"}],"key":"KuQKOmtT9G"},{"type":"text","value":" through all of its little pieces independently. And then,","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"UbVOM6SSVc"}],"key":"lohCKFUUwr"}],"key":"On0xeVXBtk"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"in ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"nwcFFqSZCO"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"exercise 4","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"qXJrRYeLoC"}],"key":"xS7iMWRFI6"},{"type":"text","value":" we’re going to put it all together and this is the full code of training this two layer mlp and we’re going to basically insert our manual ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gjbZ88VQ8t"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Jf4IEJ1iOl"}],"key":"IFY4uxn6FK"},{"type":"text","value":" and we’re going to take out ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bzrFR8PemK"},{"type":"inlineCode","value":"loss.backward()","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"uSqXlfV8dH"},{"type":"text","value":" and you will basically see that we can get all the same results using fully our own code and the only thing we’re going to be using from PyTorch is ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Ca68aTI9rG"},{"type":"inlineCode","value":"torch.tensor","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"T44yt4cTUz"},{"type":"text","value":" to make the calculations efficient. But otherwise, you will understand fully what it means to forward and backward through the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"GHELJJjqgw"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"GUBlkYyTUH"}],"key":"c0K7bwou5p"},{"type":"text","value":" and train it and I think that’ll be awesome so let’s get to it.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"lFj3lbt6L7"}],"key":"dCH6kSWAh3"}],"key":"GjnT2q7QWY"}],"key":"nZCIGBBylm"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Okay, let’s now define our ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"f2pukdXclZ"},{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"bfSh2RoCQj"}],"key":"qiYMnlXtrt"},{"type":"text","value":" and do one forward and one backward pass on it:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"eE0NUyNats"}],"key":"dcm3f0TomL"}],"key":"PlBA9x8uwf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"parameters = define_nn()\nxb, yb = construct_minibatch()\nfp_intermed_values, loss = forward(xb, yb)\nbackward(parameters, fp_intermed_values, loss)","key":"wxqLblevUt"},{"type":"outputs","id":"j8U_k1WGmAo97g7o4AHWP","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"4137\n"},"children":[],"key":"UuT68EOXC3"}],"key":"NvuidDRLaa"}],"key":"OgAISdEj0N"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercise 1: implementing the backward pass","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tCscXL7SJe"}],"identifier":"exercise-1-implementing-the-backward-pass","label":"Exercise 1: implementing the backward pass","html_id":"exercise-1-implementing-the-backward-pass","implicit":true,"key":"wzUBuIVOvi"}],"key":"BR6pnZ65Dq"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lYg3MyIaen"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"exercise 1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VxqFi4aCIY"}],"key":"y1iC4ZVaKy"},{"type":"text","value":": implementing the backward pass:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qiUVpg7d9S"}],"key":"WLDE7Lx26C"}],"key":"vxWbl9cA5L"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We’ll start with ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LFmqYCmh6h"},{"type":"inlineCode","value":"dlogprobs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KQQeLvegW6"},{"type":"text","value":", which basically means we are going to start with calculating the gradient of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"njX4JWSau4"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pavgHiU4C0"}],"key":"VyYSchVxHx"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cQrRTNj5TR"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bTuiy6tNEe"}],"key":"S8Snd1iDUA"},{"type":"text","value":" all the elements of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KJkt3uZlfQ"},{"type":"inlineCode","value":"logprobs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sAbLol2ew2"},{"type":"text","value":" tensor: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"in3s7UXEVU"},{"type":"inlineMath","value":"\\dfrac{\\partial \\textbf{loss}}{\\partial \\textbf{logprobs}}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mtext mathvariant=\"bold\">loss</mtext></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mtext mathvariant=\"bold\">logprobs</mtext></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial \\textbf{loss}}{\\partial \\textbf{logprobs}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord text\"><span class=\"mord textbf\">logprobs</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord text\"><span class=\"mord textbf\">loss</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"mCBC7WTrUf"},{"type":"text","value":". So, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IkoglAmJjX"},{"type":"inlineCode","value":"dlogprobs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pBFdTiSXAL"},{"type":"text","value":" will have the same shape as ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WeKFMk99ZW"},{"type":"inlineCode","value":"logprobs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B70XFUg90H"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lQTpAWJHwv"}],"key":"rrPs8At7qg"}],"key":"wqORiJWhOE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"logprobs.shape","key":"haDKNByePu"},{"type":"outputs","id":"R7bp9JeOk_Yhop3YzjG1N","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":23,"metadata":{},"data":{"text/plain":{"content":"torch.Size([32, 27])","content_type":"text/plain"}}},"children":[],"key":"DE366ExwKO"}],"key":"BqT0pmKng0"}],"key":"a3qov12k7U"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, how does ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"igtvfAtFxK"},{"type":"inlineCode","value":"logprobs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qSwr59pKLm"},{"type":"text","value":" influence the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m7Xk5bisiT"},{"type":"inlineCode","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wpENekYiTu"},{"type":"text","value":"? Like this: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VaxH3Vv7OB"},{"type":"inlineCode","value":"-logprobs[range(batch_size), yb].mean()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IAdoUA9ACC"},{"type":"text","value":". Just as a reminder, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GtZyew6ybt"},{"type":"inlineCode","value":"yb","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"G8GL8AZdZw"},{"type":"text","value":" is only just an array of the correct indeces:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BZbRQvH1Em"}],"key":"SamZZaN95L"}],"key":"vwQN5uX8f6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"yb","key":"mlXpaPnHKs"},{"type":"outputs","id":"ZrAOiNSvNZ6rrWAJa2ogv","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/plain":{"content":"tensor([ 8, 14, 15, 22,  0, 19,  9, 14,  5,  1, 20,  3,  8, 14, 12,  0, 11,  0,\n        26,  9, 25,  0,  1,  1,  7, 18,  9,  3,  5,  9,  0, 18])","content_type":"text/plain"}}},"children":[],"key":"QmL7pXUZ5Z"}],"key":"efcSmUmtFQ"}],"key":"RBTjqlBUOm"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And so by doing ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LCQSfl1U9z"},{"type":"inlineCode","value":"logprobs[range(batch_size), yb]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gfPGhVMIxS"},{"type":"text","value":", what we are essentially doing is for each row ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tXJkVKYiyv"},{"type":"inlineCode","value":"i","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JTE416SsXs"},{"type":"text","value":" of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RP08yFshWO"},{"type":"inlineCode","value":"logprobs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jPXqrUhMBR"},{"type":"text","value":" tensor (of size ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p6OfrskS1J"},{"type":"inlineCode","value":"batch_size","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qDQQW1rrQv"},{"type":"text","value":"), we are plucking out the element at column index ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EBQYibQIRK"},{"type":"inlineCode","value":"yb[i]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zVl9FTeJzU"},{"type":"text","value":". For example, from row ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"n06az9Evot"},{"type":"inlineCode","value":"0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AyxhiV6uVp"},{"type":"text","value":" we would be getting the element from column ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eCDtfIEtXC"},{"type":"inlineCode","value":"yb[0] == 1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SgGp1EBJ2J"},{"type":"text","value":", from row ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dAyrBulyNM"},{"type":"inlineCode","value":"1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V2R8x4NM7x"},{"type":"text","value":" we would be getting the element from column ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TosvRFNLV6"},{"type":"inlineCode","value":"yb[1] == 12","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ocqx5boedU"},{"type":"text","value":", and so on. Therefore, the elements inside the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wUNIDimh9a"},{"type":"inlineCode","value":"logprobs[range(batch_size), yb]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LT1XdDBnMS"},{"type":"text","value":" could be alternatively calculated as such:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hxB69VtL2O"}],"key":"HFvFz4q2Tl"},{"type":"code","lang":"python","value":"logprobslist = [logprobs[i, yb[i]] for i in range(batch_size)]","position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"key":"vJnCgvwG4g"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Here is the proof by assertion that ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"InRNQm9Lr8"},{"type":"inlineCode","value":"logprobslist","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JdoiFme7Vm"},{"type":"text","value":" is the same as ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"HeXDbbUTMI"},{"type":"inlineCode","value":"logprobs","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Z8HGfWOCHv"},{"type":"text","value":":","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LnUbp22csa"}],"key":"mFRMMQYo0f"}],"key":"vxDz7RBE2h"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"logprobslist = [logprobs[i, yb[i]].item() for i in range(batch_size)]\nassert logprobs[range(batch_size), yb].tolist() == logprobslist","key":"MgFyuveupd"},{"type":"outputs","id":"jS34LStskVhZhG51hhKBS","children":[],"key":"ZnRbEsG3BS"}],"key":"UlE5uLtKPf"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So these elements get plucked out from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eHm3QQhltF"},{"type":"inlineCode","value":"logprobs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PYXRw6rWVK"},{"type":"text","value":" and then the negative of their mean becomes the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qCrZSNCzXp"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H35FCeMlhG"}],"key":"iIjKGDjynm"},{"type":"text","value":". It is always nice to work with simpler examples in order to understand the numerical form of derivatives. What’s going on here is once we’ve plucked out these examples, we’re taking the mean and then the negative (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F9oxiYiboD"},{"type":"inlineCode","value":"-logprobs[range(batch_size), yb].mean()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JOPhjSdj6V"},{"type":"text","value":"). So the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YfmqM5WCGu"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q6rK1CMnz2"}],"key":"t3Tv4BdoqQ"},{"type":"text","value":" basically, to write it in a simpler way, is the negative of the mean of e.g. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Idf33gBmvT"},{"type":"text","value":"3","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AdOvWhN5dp"},{"type":"text","value":" values:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OWbzwptp6H"}],"key":"U6aofEe28Y"}],"key":"ePKMDeAi4j"},{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"python","value":"loss = -(a + b + c) / 3\nloss = -a/3 - b/3 - c/3","position":{"start":{"line":1,"column":1},"end":{"line":4,"column":1}},"key":"wWrONWaD3i"}],"key":"NjH8s6XStm"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"That would be how we achieve the mean of three numbers ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PhETOG5q2V"},{"type":"inlineCode","value":"a","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vVadpztEFA"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q2pHdLSbgg"},{"type":"inlineCode","value":"b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W0gLhtD2bc"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U8TXm6EpRS"},{"type":"inlineCode","value":"c","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aRZo1OcBeL"},{"type":"text","value":" (although we actually have ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Vok0OWkn2i"},{"type":"text","value":"32","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pdd2wjVhKI"},{"type":"text","value":" numbers here). But therefore the derivative of this toy ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kpUy9VZTpc"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p1WVwTfeYZ"}],"key":"JcqsGLP60V"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YxCVEgQCbH"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bUprMzVN6W"}],"key":"jsa3Lsf5U0"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Q7S5ZBVy2U"},{"type":"inlineCode","value":"a","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DOXIEzIdBD"},{"type":"text","value":" would basically be just:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a3fGDvUbHc"}],"key":"Q9jQDachy7"}],"key":"F840JgNaQc"},{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"python","value":"dloss/da = -1/3","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"key":"czFnOE8b9q"}],"key":"pZ6yJfrfUf"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So you can see that if we don’t just have ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RPqIpoWbIU"},{"type":"text","value":"3","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KaUensvPIE"},{"type":"text","value":" numbers (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DPz3LBWaQs"},{"type":"inlineCode","value":"a","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MTaIOWeodZ"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sL83ELOWeG"},{"type":"inlineCode","value":"b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Usfq3r8m9s"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EbkoN7mRZ4"},{"type":"inlineCode","value":"c","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IbJLCgNQQu"},{"type":"text","value":"), but we have ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NW61Wm64y7"},{"type":"text","value":"32","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MRnjley6SL"},{"type":"text","value":" numbers, then ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q1Gt623NJf"},{"type":"inlineCode","value":"dloss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Fgzs8il3kF"},{"type":"text","value":" by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jGv1N2dPbP"},{"type":"inlineCode","value":"dk","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cdeXAUtv2P"},{"type":"text","value":" (where ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rnHxFY5wlu"},{"type":"inlineCode","value":"k","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kmPxw0DARk"},{"type":"text","value":" is every one of those ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vmYvwRChLA"},{"type":"text","value":"32","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o83qvp55ZW"},{"type":"text","value":" numbers) is going to be: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FhC6prNI2W"},{"type":"inlineMath","value":"1/32","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>32</mn></mrow><annotation encoding=\"application/x-tex\">1/32</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1/32</span></span></span></span>","key":"l4Zx4TDdmg"},{"type":"text","value":" or just ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iiWJoKRIyW"},{"type":"inlineMath","value":"\\frac{1}{batch\\_size}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mn>1</mn><mrow><mi>b</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\frac{1}{batch\\_size}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.4071em;vertical-align:-0.562em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">ba</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mathnormal mtight\">h</span><span class=\"mord mtight\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal mtight\">s</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">ze</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.562em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"uVLlH7eeQC"},{"type":"text","value":" more generally. Now, what about the other elements inside ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D160Xr8cy4"},{"type":"inlineCode","value":"logprobs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wv1tJ6k4LP"},{"type":"text","value":"? Remember, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AwXO0DogW6"},{"type":"inlineCode","value":"logprobs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MI9aZR7pyw"},{"type":"text","value":" is a large array with a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NeV9wY1Fae"},{"type":"inlineCode","value":"logprobs.shape","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nKjp9JNkbQ"},{"type":"text","value":" of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S0uS1LqRWk"},{"type":"inlineMath","value":"32 \\times 27","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>32</mn><mo>×</mo><mn>27</mn></mrow><annotation encoding=\"application/x-tex\">32 \\times 27</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">32</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">27</span></span></span></span>","key":"AvKrE9rTnd"},{"type":"text","value":" (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VhAzw2zJvz"},{"type":"text","value":"864","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rwNQdiyHkq"},{"type":"text","value":" numbers in total) and only:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UAL1K7S1Vg"}],"key":"by3UVtZ4Oj"}],"key":"LE6zvYYQvT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"logprobs[range(batch_size), yb].shape","key":"nCshaVbeHm"},{"type":"outputs","id":"t55aNTESghj7i3ESRUR_C","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/plain":{"content":"torch.Size([32])","content_type":"text/plain"}}},"children":[],"key":"vboEsnJeaB"}],"key":"KXna9CiP2t"}],"key":"laXOoFuznK"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"32","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V7w2xylbYw"},{"type":"text","value":" of these numbers participate in the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iEpj3qlSSB"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LzMasLSRIa"}],"key":"IaOYzPeJsa"},{"type":"text","value":" calculation. So, what about the derivative of all the other ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JTRRNaovOv"},{"type":"text","value":"832","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Kp19p4duUW"},{"type":"text","value":" numbers of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TmZ4tbKtLc"},{"type":"inlineCode","value":"logprobs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mmtrwtak3e"},{"type":"text","value":" tensor, meaning the rest of the elements that do not get plucked out? Well, their gradient intuitively is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Sl5ysbcG3p"},{"type":"text","value":"0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Cys3cS9mXI"},{"type":"text","value":". Simply because they do not participate in the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W10AujlRAo"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WEaR4qnxnZ"}],"key":"pGeq7ocGSp"},{"type":"text","value":" calculation. They are left out. So, since most of these numbers inside the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TzUYKGcccq"},{"type":"inlineCode","value":"logprobs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XFJINMOrqB"},{"type":"text","value":" tensor does not feed into the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xYq1MwWusx"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rFgGpMPV97"}],"key":"RmmeZBH1yp"},{"type":"text","value":", if we were to change these numbers, then the value of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OQk25WCFNn"},{"type":"inlineCode","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mlfBR5iCYY"},{"type":"text","value":" wouldn’t change. Which is the equivalent way of saying that the derivative of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TtNe1n6OjE"},{"type":"inlineCode","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LPTgFBsXMb"},{"type":"text","value":" ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TPbO4xhP9t"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KhFs4lxFng"}],"key":"SEW88XJ2ua"},{"type":"text","value":" them is zero. They don’t impact it. So here’s a way to implement this derivative then: we create a tensor of zeros exactly in the shape of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VfITZev8ez"},{"type":"inlineCode","value":"logprobs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OlniYZtHa5"},{"type":"text","value":" and then fill in the derivative value ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SKsL4xAInQ"},{"type":"inlineCode","value":"-1/batch_size","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LeCPbIZMcw"},{"type":"text","value":" inside exactly these indeces: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pCUipJIprP"},{"type":"inlineCode","value":"[range(batch_size), yb]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nUHZXfcUSA"},{"type":"text","value":". Therefore:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VgBfrxcPHh"}],"key":"b42ejIwNHi"}],"key":"IKVyRcdwx7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dlogprobs = torch.zeros_like(logprobs)\ndlogprobs[range(batch_size), yb] = -1.0 / batch_size","key":"uBAWL6Df5l"},{"type":"outputs","id":"Z9gHJnS6PtLSeY8vV-XnL","children":[],"key":"QA5SNFFxqQ"}],"key":"Low1LUVW03"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Then this is the candidate derivative for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Awje1bANAF"},{"type":"inlineCode","value":"dlogprobs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"do9Ud799o1"},{"type":"text","value":". Let’s call our assertion function to compare with the actual derivative computed by PyTorch and check whether our manually calculated derivative is correct:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TIveNZRFbl"}],"key":"MqQ9RV3XAo"}],"key":"kdcluiJZMe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cmp(\"logprobs\", dlogprobs, logprobs)","key":"bUpuOddFP0"},{"type":"outputs","id":"k3nuuBMrIVaDvEiQZwLq_","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"logprobs        | exact: True  | approximate: True  | maxdiff: 0.0\n"},"children":[],"key":"vzMMkCsgqT"}],"key":"ZUSeiLT4im"}],"key":"c5sCAowyPY"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Cool! So let’s look at the definition of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wVBq6kgQne"},{"type":"inlineCode","value":"cmp","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ObxN0ShnUZ"},{"type":"text","value":" function:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XQDzgIpJBQ"}],"key":"Czd9kFyTfk"},{"type":"code","lang":"python","value":"def cmp(s, dt, t):\n    ex = torch.all(dt == t.grad).item()\n    app = torch.allclose(dt, t.grad)\n    maxdiff = (dt - t.grad).abs().max().item()\n    print(f'{s:15s} | exact: {str(ex):5s} | approximate: {str(app):5s} | maxdiff: {maxdiff}')","position":{"start":{"line":3,"column":1},"end":{"line":9,"column":1}},"key":"kiFxZD3Hmn"}],"key":"KO3pZ79fkj"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What it does is that it basically receives the calculated value provided by us, which is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U1Q0lML0A5"},{"type":"inlineCode","value":"dt","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"auF2wHwFHP"},{"type":"text","value":" and then checks whether it is exactly equal to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WZH9h5lj1r"},{"type":"inlineCode","value":"t.grad","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XJr3jLBZ7A"},{"type":"text","value":" as calculated by PyTorch. This makes sure that all of the elements are ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EtGRhaW0Wz"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"exactly","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pMXEo61d4j"}],"key":"aZ5C8AkOm7"},{"type":"text","value":" equal. After that, it calculates for approximate equality because of floating point issues using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RsQL4PFITq"},{"type":"inlineCode","value":"torch.allclose","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Gzl6YWX0nV"},{"type":"text","value":" which has a little bit of a wiggle available because sometimes you can get very, very close. But if you use a slightly different calculation, because of floating point, you can’t get very, very close. Generally, because of floating point arithmetic, you can get a slightly different result. So this second call checks for an approximately equal result. And then it finds the maximum, basically the value that has the highest difference, and what is the difference, and the absolute value difference between those two. At the end it prints whether we have an exact equality, an approximate equality, and what is the largest difference. In our case, we have an exact equality. And so therefore, of course, we also have an approximate equality, and the maximum difference is exactly zero. So basically, our ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Pvskn2JcKj"},{"type":"inlineCode","value":"dlogprobs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s6xGcjyagc"},{"type":"text","value":" is exactly equal to what PyTorch calculated to be ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aFN5LF9CNh"},{"type":"inlineCode","value":"logprobs.grad","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IRkGPZWulk"},{"type":"text","value":" in its backpropagation. So far, we’re doing pretty well. Okay, so let’s now continue our manual ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dVUEHeLQxR"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Dk5EkA7aD7"}],"key":"of49ry1wBV"},{"type":"text","value":". We know that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wJieRt8gVx"},{"type":"inlineCode","value":"logprobs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XYMtBTuIgt"},{"type":"text","value":" depends on ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DI6c8g75O6"},{"type":"inlineCode","value":"probs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"APwLJGFk7h"},{"type":"text","value":" through a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Dqq3GZOJqQ"},{"type":"inlineCode","value":".log()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W7l2dss90I"},{"type":"text","value":" call. So a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pfQeBPbQfW"},{"type":"inlineCode","value":"log","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sVK1jUDvBW"},{"type":"text","value":" is applied to all the elements of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ohaxfitWuB"},{"type":"inlineCode","value":"probs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ioz34surDc"},{"type":"text","value":", element-wise. Now, if we want ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xCMnESm375"},{"type":"inlineCode","value":"dprobs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jEKRw6OGR7"},{"type":"text","value":": ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Hws88HEPH7"},{"type":"inlineMath","value":"\\dfrac{\\partial loss}{\\partial probs} = \\dfrac{\\partial loss}{\\partial logprobs}\\cdot\\dfrac{\\partial logprobs}{\\partial probs}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>p</mi><mi>r</mi><mi>o</mi><mi>b</mi><mi>s</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>p</mi><mi>r</mi><mi>o</mi><mi>b</mi><mi>s</mi></mrow></mfrac></mstyle><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>p</mi><mi>r</mi><mi>o</mi><mi>b</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>p</mi><mi>r</mi><mi>o</mi><mi>b</mi><mi>s</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial loss}{\\partial probs} = \\dfrac{\\partial loss}{\\partial logprobs}\\cdot\\dfrac{\\partial logprobs}{\\partial probs}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">ro</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">ro</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">ro</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">ro</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"PW8KbnVM4J"},{"type":"text","value":", then, well let’s ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NhZl12yoO7"},{"type":"link","url":"https://www.wolframalpha.com/input?i=d%2Fdx+log%28x%29","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"ask WolframAlpha what the derivative of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"N8fUQwnsv5"},{"type":"inlineCode","value":"log(x)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"d5pf3F51jF"},{"type":"text","value":" is w.r.t. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cuHKWPWK81"},{"type":"inlineCode","value":"x","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gf5f9rsGFD"}],"urlSource":"https://www.wolframalpha.com/input?i=d%2Fdx+log%28x%29","key":"OExVHQywYx"},{"type":"text","value":": ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"octBjhKO0S"},{"type":"inlineMath","value":"\\dfrac{d(log(x))}{dx} = \\dfrac{1}{x}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi>d</mi><mo stretchy=\"false\">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow><mrow><mi>d</mi><mi>x</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mn>1</mn><mi>x</mi></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{d(log(x))}{dx} = \\dfrac{1}{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.113em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">))</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"xFtC959l2i"},{"type":"text","value":". Therefore we write out the derivative and because we are doing ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GMzz3dDj6S"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MbFQGOnx2O"}],"key":"pRV4lyECVX"},{"type":"text","value":" and thus applying the chain rule, we want to chain it to the previous result:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t8IMus5jQr"}],"key":"lvQRAGV7Nj"}],"key":"bqf9tMS7Cd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dprobs = (1.0 / probs) * dlogprobs\ncmp(\"probs\", dprobs, probs)","key":"tGaz3jLJgI"},{"type":"outputs","id":"OyRWgYug11eliC15ULBFG","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"probs           | exact: True  | approximate: True  | maxdiff: 0.0\n"},"children":[],"key":"JoNL0JU8O7"}],"key":"tMKP4SOq18"}],"key":"AD6CIjKltU"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, notice what happens if your ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nkjRkWv3wG"},{"type":"inlineCode","value":"probs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O41MVQ5IF9"},{"type":"text","value":" is very very close to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XTkbl3Zbnt"},{"type":"text","value":"1.0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hcPeVytwCT"},{"type":"text","value":", that means that the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"w49wboTndl"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v71oLegeEL"}],"key":"NIypsfmG1h"},{"type":"text","value":" is predicting the character correctly, then ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kc31u9FOMn"},{"type":"inlineCode","value":"dprobs = (1.0 / 1.0) * dlogprobs = dlogprobs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MxjK9mVGmf"},{"type":"text","value":" and thus ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"npxzFWKbX3"},{"type":"inlineCode","value":"dlogprobs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oFSZyeR2GP"},{"type":"text","value":" just gets passed through. But if ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KgmtMOIUr3"},{"type":"inlineCode","value":"probs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DKzUYgFWqF"},{"type":"text","value":" are very low, then the fraction part that is multiplied by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O6Qk0pzEuI"},{"type":"inlineCode","value":"dlogprobs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HZ2QgtEoGi"},{"type":"text","value":" will be boosted instead of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RXDdsWeG6v"},{"type":"inlineCode","value":"dlogprobs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eCV6wLNN0l"},{"type":"text","value":". So what this line is doing intuitively is it is boosting the the gradient of the examples that have a very low probability currently assigned. Next up is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ho4XahWi0N"},{"type":"inlineCode","value":"counts_sum_inv","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sBH51T2Z8v"},{"type":"text","value":". So we want ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OjTcbRaTWn"},{"type":"inlineCode","value":"dcounts_sum_inv","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jTIwSBK5op"},{"type":"text","value":" (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YlJnCqxPmb"},{"type":"inlineMath","value":"\\dfrac{\\partial loss}{\\partial counts\\_sum\\_inv}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>u</mi><mi>m</mi><mi mathvariant=\"normal\">_</mi><mi>i</mi><mi>n</mi><mi>v</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial loss}{\\partial counts\\_sum\\_inv}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.3674em;vertical-align:-0.996em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">in</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.996em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"onmtGR3MD7"},{"type":"text","value":"). But let’s just pause for a moment and explain what is happening until the calculation of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sB6DB2uSI4"},{"type":"inlineCode","value":"counts_sum_inv","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YMWHOyxUbf"},{"type":"text","value":", in case all this is a bit confusing:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xTk6KWNCI2"}],"key":"nT6MGftwpi"}],"key":"lRsjrer2vg"},{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"python","value":"...\n# Linear layer 2\nlogits = h @ w2 + b2  # output layer\n# cross entropy loss (same as F.cross_entropy(logits, Yb))\nlogit_maxes = logits.max(1, keepdim=True).values\nnorm_logits = logits - logit_maxes # subtract max for numerical stability\ncounts = norm_logits.exp()\ncounts_sum = counts.sum(1, keepdims=True)\ncounts_sum_inv = counts_sum**-1\nprobs = counts * counts_sum_inv\n...","position":{"start":{"line":1,"column":1},"end":{"line":13,"column":1}},"key":"D9FKHJRupG"}],"key":"WwLiY3VrUQ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We have the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RDUer6nxQj"},{"type":"inlineCode","value":"logits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lPfyfbXKaw"},{"type":"text","value":" that come out of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y0P7sfaR3B"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C738OWEIYV"}],"key":"JnA09KHLmN"},{"type":"text","value":". Then we are finding the maximum in each row that we then subtract from the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FPdtk0T2Fi"},{"type":"inlineCode","value":"logits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OXR3qeZbZU"},{"type":"text","value":" for purposes of numerical stability. Then, because some of the logits may take on too large values we end up exponentiating (this is done just for safety, numerically). This exponentiation yields our ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cpjIUmwFxV"},{"type":"inlineCode","value":"counts","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vqlvhCyHuF"},{"type":"text","value":". And then, we take the sum of these ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nCh00Hl1P4"},{"type":"inlineCode","value":"counts","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RYCg50I9HB"},{"type":"text","value":". Using this ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mmDqXVXO92"},{"type":"inlineCode","value":"counts_sum","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V9Cu4QvTO1"},{"type":"text","value":", we normalize the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WfCfdaykX7"},{"type":"inlineCode","value":"counts","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aVyuKRyodq"},{"type":"text","value":" so that all of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IJASmD5LBV"},{"type":"inlineCode","value":"probs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"k42E3inK8T"},{"type":"text","value":" sum to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vbP8OCh7L5"},{"type":"text","value":"1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ylmbydXQBf"},{"type":"text","value":". But basically, all that’s happening here is we got the logits, we want to exponentiate all of them, and we want to normalize the counts to create our probabilities, it’s just that we have defined this set of intermediate calculations across multiple lines. Ok, so what should be ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QvIpjPrklA"},{"type":"inlineCode","value":"dcounts_sum_inv","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y2mmYDHLZs"},{"type":"text","value":"? Now, we actually have to be careful here because we have to scrutinize and be careful with the shapes. So, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LOZ3S4GwOR"},{"type":"inlineCode","value":"counts.shape","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yf14g0ixoK"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l6A90N5xkz"},{"type":"inlineCode","value":"counts_sum_inv.shape","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sFgpn8DCfB"},{"type":"text","value":" are different:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rvuO7kcKP5"}],"key":"I0NVYggaWK"}],"key":"lYZbQMGHvl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(counts.shape, counts_sum_inv.shape)\nassert counts.shape != counts_sum_inv.shape","key":"huWRKPIB7d"},{"type":"outputs","id":"C6r3O3H-8h00kAtoZn8z1","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"torch.Size([32, 27]) torch.Size([32, 1])\n"},"children":[],"key":"oST2cWXwt1"}],"key":"tTJSIKIgA6"}],"key":"aqMGIlC6dM"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So during the multiplication ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NTK4cW6bPC"},{"type":"inlineCode","value":"probs = counts * counts_sum_inv","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZgNC32O9e3"},{"type":"text","value":", there is an implicit broadcasting that PyTorch does. Because what it needs to do is take one column of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jbIQIkAzYY"},{"type":"inlineMath","value":"32 \\times 1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>32</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">32 \\times 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">32</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"tpYDCUwyDT"},{"type":"text","value":" that is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lJb5Sd3mTA"},{"type":"inlineCode","value":"counts_sum_inv","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yuDo8crwkf"},{"type":"text","value":" and replicate it horizontally ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nMXt4ui8Ij"},{"type":"text","value":"27","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IcG1PYY3wd"},{"type":"text","value":" times in order to align these two tensors so it can do an element-wise multiplication. Using a toy example, this is what this looks like:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gmNPKM5a20"}],"key":"wM5yfhi81u"}],"key":"KAtl2o3KRY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# c = a * b, but with tensors:\n# a[3x3] * b[3,1] --->\n# a11*b1 a12*b1 a13*b1\n# a21*b2 a22*b2 a23*b2\n# a31*b3 a32*b3 a33*b3\n# c[3x3]","key":"rH0QWn4c0w"},{"type":"outputs","id":"uuuv-5Q73aWsPD2x8gGX2","children":[],"key":"fyG5yovSbt"}],"key":"wbcmvHvbra"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this example, in order for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dJyHszDwVc"},{"type":"inlineMath","value":"a[3\\times3]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo stretchy=\"false\">[</mo><mn>3</mn><mo>×</mo><mn>3</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">a[3\\times3]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mopen\">[</span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">3</span><span class=\"mclose\">]</span></span></span></span>","key":"fT8jgbB6EF"},{"type":"text","value":" to multiply ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p9yqapUB95"},{"type":"inlineMath","value":"b[3\\times1]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi><mo stretchy=\"false\">[</mo><mn>3</mn><mo>×</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">b[3\\times1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mopen\">[</span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"N2NXpB75rN"},{"type":"text","value":", we have to replicate ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nzndXAfcHF"},{"type":"text","value":"3","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UMBLzmsfVX"},{"type":"text","value":" times the vertical column ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FknQYIpSKm"},{"type":"inlineMath","value":"[b1, b2, b3]^T","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>b</mi><mn>1</mn><mo separator=\"true\">,</mo><mi>b</mi><mn>2</mn><mo separator=\"true\">,</mo><mi>b</mi><mn>3</mn><msup><mo stretchy=\"false\">]</mo><mi>T</mi></msup></mrow><annotation encoding=\"application/x-tex\">[b1, b2, b3]^T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0913em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">b</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mord\">3</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span>","key":"fCvGI5wuX3"},{"type":"text","value":" horizontally. And then do the actual multiplication. And this is exactly what PyTorch does in this situation. Meaning, in order to do ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"I2yvWK132Z"},{"type":"inlineMath","value":"c = a \\cdot b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mi>a</mi><mo>⋅</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">c = a \\cdot b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"AdYyRomA6h"},{"type":"text","value":" (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yzo153TgO4"},{"type":"inlineMath","value":"c[3\\times3] = a[3\\times3] \\cdot b[3\\times1]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo stretchy=\"false\">[</mo><mn>3</mn><mo>×</mo><mn>3</mn><mo stretchy=\"false\">]</mo><mo>=</mo><mi>a</mi><mo stretchy=\"false\">[</mo><mn>3</mn><mo>×</mo><mn>3</mn><mo stretchy=\"false\">]</mo><mo>⋅</mo><mi>b</mi><mo stretchy=\"false\">[</mo><mn>3</mn><mo>×</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">c[3\\times3] = a[3\\times3] \\cdot b[3\\times1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mopen\">[</span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">3</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mopen\">[</span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">3</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mopen\">[</span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>","key":"yPYboDkKIK"},{"type":"text","value":") it:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p7Bkv7nsSt"}],"key":"Fel2ivSpKC"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"first replicates ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Vh3v1YpUPm"},{"type":"inlineMath","value":"b","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"v0te7zAVNh"},{"type":"text","value":" across the column dimension (","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Pq7KdrmOFC"},{"type":"text","value":"1","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"IRjBbEfNcu"},{"type":"text","value":"): ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"dBz9JbAivQ"},{"type":"inlineMath","value":"b \\rightarrow b\\_replicated","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi><mo>→</mo><mi>b</mi><mi mathvariant=\"normal\">_</mi><mi>r</mi><mi>e</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>c</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">b \\rightarrow b\\_replicated</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0044em;vertical-align:-0.31em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">re</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">pl</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"mRZMYBwBHI"},{"type":"text","value":" (","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"joSVKyxaK2"},{"type":"inlineMath","value":"b[3\\times1] \\rightarrow b[3\\times3]","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi><mo stretchy=\"false\">[</mo><mn>3</mn><mo>×</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo>→</mo><mi>b</mi><mo stretchy=\"false\">[</mo><mn>3</mn><mo>×</mo><mn>3</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">b[3\\times1] \\rightarrow b[3\\times3]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mopen\">[</span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mopen\">[</span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">3</span><span class=\"mclose\">]</span></span></span></span>","key":"oBuz9H9jXe"},{"type":"text","value":")","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"s0EnI4NqiE"}],"key":"szpx1Cq3EI"}],"key":"ZVDLxJibum"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"then it does the multiplication ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"w9krBotBPE"},{"type":"inlineMath","value":"c = a \\cdot b\\_replicated","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mi>a</mi><mo>⋅</mo><mi>b</mi><mi mathvariant=\"normal\">_</mi><mi>r</mi><mi>e</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>c</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">c = a \\cdot b\\_replicated</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0044em;vertical-align:-0.31em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">re</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">pl</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"HcsHs3qvYK"},{"type":"text","value":" (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nNvgvLb0JI"},{"type":"inlineMath","value":"c[3\\times3] = a[3\\times3] \\cdot b[3\\times3]","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo stretchy=\"false\">[</mo><mn>3</mn><mo>×</mo><mn>3</mn><mo stretchy=\"false\">]</mo><mo>=</mo><mi>a</mi><mo stretchy=\"false\">[</mo><mn>3</mn><mo>×</mo><mn>3</mn><mo stretchy=\"false\">]</mo><mo>⋅</mo><mi>b</mi><mo stretchy=\"false\">[</mo><mn>3</mn><mo>×</mo><mn>3</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">c[3\\times3] = a[3\\times3] \\cdot b[3\\times3]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mopen\">[</span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">3</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mopen\">[</span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">3</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mopen\">[</span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">3</span><span class=\"mclose\">]</span></span></span></span>","key":"JuIYNt9fym"},{"type":"text","value":")","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LQMe1BCpAc"}],"key":"PHlxiDzXy7"}],"key":"BxF5etL3YS"}],"key":"KHLgqzGWIY"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Therefore, if we wanted to find ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"L0fdK9pWOZ"},{"type":"inlineMath","value":"\\dfrac{\\partial c}{\\partial a}","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>a</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial c}{\\partial a}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">a</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"abRPFv3rCr"},{"type":"text","value":", then that would equal be ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"WKzd3iacYu"},{"type":"inlineMath","value":"a\\_replicated","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mi mathvariant=\"normal\">_</mi><mi>r</mi><mi>e</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>c</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">a\\_replicated</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0044em;vertical-align:-0.31em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">re</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">pl</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"YyHBMWCbop"},{"type":"text","value":" (and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XzF7iiwpIs"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"not","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"B7rJIbXXzV"}],"key":"akQdRzGBLW"},{"type":"text","value":" ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"oVbgYzRKbq"},{"type":"inlineMath","value":"a","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"mCu4Qg6jLb"},{"type":"text","value":"). What the replication operation means in terms of the computational graph is that ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"b9QaPpw3DD"},{"type":"inlineMath","value":"a","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"qQ7gQpGm6h"},{"type":"text","value":" in this case is being fed to multiple outputs. Thus, as we discussed in ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zVyhSXwehf"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"micrograd","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jel4o6zGkP"}],"key":"ZruSPvxWGf"},{"type":"text","value":" (lesson 1), during the backward pass, the correct thing to do in this case is to sum all the gradients that arrive at any one node  (i.e. ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zW74hoD4in"},{"type":"inlineMath","value":"a","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"LlcSJqlBJ0"},{"type":"text","value":"). So if a node is used multiple times, the gradients for all of its uses sum during ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"fOCwM2YZs1"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QQkFfeJUgU"}],"key":"MCdAbkbSWg"},{"type":"text","value":". This means that since e.g. ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"O8kUVYGTM1"},{"type":"inlineMath","value":"b1","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">b1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mord\">1</span></span></span></span>","key":"RS7F3z9oCU"},{"type":"text","value":" is used multiple times in each column of ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zYW3mzQbpc"},{"type":"inlineMath","value":"c","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span>","key":"ZPBOxFgGRd"},{"type":"text","value":", therefore the right thing to do here would be to sum horizontally across all the columns:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Um8unBtuZF"}],"key":"tPanJ0IyYd"},{"type":"code","lang":"python","value":"da = a_replicated = a.sum(1, keepdim=True)","position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"key":"ohTlsCXGgy"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Equivalently, ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"sVQmeCDopT"},{"type":"inlineCode","value":"probs = counts * counts_sum_inv","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"k3TdS9Dnkc"},{"type":"text","value":", is broken up into to operations as well:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"SfZUKOmvLm"}],"key":"TCKQ3grw0X"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"first, the replication: ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"HTT9jZaCTh"},{"type":"inlineMath","value":"counts\\_sum\\_inv \\rightarrow counts\\_sum\\_inv\\_replicated","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>u</mi><mi>m</mi><mi mathvariant=\"normal\">_</mi><mi>i</mi><mi>n</mi><mi>v</mi><mo>→</mo><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>u</mi><mi>m</mi><mi mathvariant=\"normal\">_</mi><mi>i</mi><mi>n</mi><mi>v</mi><mi mathvariant=\"normal\">_</mi><mi>r</mi><mi>e</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>c</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">counts\\_sum\\_inv \\rightarrow counts\\_sum\\_inv\\_replicated</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9695em;vertical-align:-0.31em;\"></span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">in</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0044em;vertical-align:-0.31em;\"></span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">in</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">re</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">pl</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"y7F2NXvn12"},{"type":"text","value":" (","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ueET4sSY8p"},{"type":"inlineMath","value":"counts\\_sum\\_inv[32\\times1] \\rightarrow counts\\_sum\\_inv[32\\times27]","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>u</mi><mi>m</mi><mi mathvariant=\"normal\">_</mi><mi>i</mi><mi>n</mi><mi>v</mi><mo stretchy=\"false\">[</mo><mn>32</mn><mo>×</mo><mn>1</mn><mo stretchy=\"false\">]</mo><mo>→</mo><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>u</mi><mi>m</mi><mi mathvariant=\"normal\">_</mi><mi>i</mi><mi>n</mi><mi>v</mi><mo stretchy=\"false\">[</mo><mn>32</mn><mo>×</mo><mn>27</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">counts\\_sum\\_inv[32\\times1] \\rightarrow counts\\_sum\\_inv[32\\times27]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.06em;vertical-align:-0.31em;\"></span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">in</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mopen\">[</span><span class=\"mord\">32</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.06em;vertical-align:-0.31em;\"></span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">in</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mopen\">[</span><span class=\"mord\">32</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">27</span><span class=\"mclose\">]</span></span></span></span>","key":"QfmlH98t1M"},{"type":"text","value":")","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"arlbOmpCYX"}],"key":"j6Y9OiSHAl"}],"key":"dPsv9NsMGS"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"then, the multiplication: ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"YPcc0sklOT"},{"type":"inlineMath","value":"probs = counts \\cdot counts\\_sum\\_inv\\_replicated","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>r</mi><mi>o</mi><mi>b</mi><mi>s</mi><mo>=</mo><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mo>⋅</mo><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>u</mi><mi>m</mi><mi mathvariant=\"normal\">_</mi><mi>i</mi><mi>n</mi><mi>v</mi><mi mathvariant=\"normal\">_</mi><mi>r</mi><mi>e</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>c</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>d</mi></mrow><annotation encoding=\"application/x-tex\">probs = counts \\cdot counts\\_sum\\_inv\\_replicated</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">ro</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0044em;vertical-align:-0.31em;\"></span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">in</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">re</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">pl</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">c</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">e</span><span class=\"mord mathnormal\">d</span></span></span></span>","key":"aQHvOSGl3j"},{"type":"text","value":" (","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"spwYI9vY39"},{"type":"inlineMath","value":"probs[32\\times27] = counts[32\\times27] \\cdot counts\\_sum\\_inv[32\\times27]","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>r</mi><mi>o</mi><mi>b</mi><mi>s</mi><mo stretchy=\"false\">[</mo><mn>32</mn><mo>×</mo><mn>27</mn><mo stretchy=\"false\">]</mo><mo>=</mo><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mo stretchy=\"false\">[</mo><mn>32</mn><mo>×</mo><mn>27</mn><mo stretchy=\"false\">]</mo><mo>⋅</mo><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>u</mi><mi>m</mi><mi mathvariant=\"normal\">_</mi><mi>i</mi><mi>n</mi><mi>v</mi><mo stretchy=\"false\">[</mo><mn>32</mn><mo>×</mo><mn>27</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">probs[32\\times27] = counts[32\\times27] \\cdot counts\\_sum\\_inv[32\\times27]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">ro</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">[</span><span class=\"mord\">32</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">27</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">[</span><span class=\"mord\">32</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">27</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.06em;vertical-align:-0.31em;\"></span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">in</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mopen\">[</span><span class=\"mord\">32</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">27</span><span class=\"mclose\">]</span></span></span></span>","key":"l2tZ6MUdfi"},{"type":"text","value":")","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"nBQPHl2Eho"}],"key":"enUo2hQzzZ"}],"key":"xUF9vOE08B"}],"key":"yi8vMymd6y"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"And therefore ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"qouMQqi7CZ"},{"type":"inlineCode","value":"dcounts_sum_inv","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"owT2mfYeNv"},{"type":"text","value":" (","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"qeraMOmCog"},{"type":"inlineMath","value":"\\dfrac{\\partial loss}{\\partial counts\\_sum\\_inv} = \\dfrac{\\partial loss}{\\partial probs} \\dfrac{\\partial probs}{\\partial counts\\_sum\\_inv}","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>u</mi><mi>m</mi><mi mathvariant=\"normal\">_</mi><mi>i</mi><mi>n</mi><mi>v</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>p</mi><mi>r</mi><mi>o</mi><mi>b</mi><mi>s</mi></mrow></mfrac></mstyle><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>p</mi><mi>r</mi><mi>o</mi><mi>b</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>u</mi><mi>m</mi><mi mathvariant=\"normal\">_</mi><mi>i</mi><mi>n</mi><mi>v</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial loss}{\\partial counts\\_sum\\_inv} = \\dfrac{\\partial loss}{\\partial probs} \\dfrac{\\partial probs}{\\partial counts\\_sum\\_inv}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.3674em;vertical-align:-0.996em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">in</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.996em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3674em;vertical-align:-0.996em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">ro</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">in</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">ro</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.996em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"KhzoRU3aeM"},{"type":"text","value":"):","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"NoJdf0RT0v"}],"key":"RFTyTxakNn"}],"key":"Dc0n9yHXjM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dcounts_sum_inv = (counts * dprobs).sum(\n    1, keepdim=True\n)  # multiply by `dprobs` because of chain rule and keepdim=True to keep the column dimension\nassert dcounts_sum_inv.shape == counts_sum_inv.shape  # shapes are equals\ncmp(\"counts_sum_inv\", dcounts_sum_inv, counts_sum_inv)","key":"LM02CWMzvE"},{"type":"outputs","id":"jiNgljIPsxAQ7lKSjyY2T","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"counts_sum_inv  | exact: True  | approximate: True  | maxdiff: 0.0\n"},"children":[],"key":"xrK5pHSTle"}],"key":"nZabqotGtD"}],"key":"y45QIIiBRs"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Again, this derivative is exactly correct. Let’s also ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ocs5rPtjfk"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m0VqJM5Iy9"}],"key":"priJ2baFJg"},{"type":"text","value":" into ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Xm1KoW0xnn"},{"type":"inlineCode","value":"counts","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aQoltAgPjg"},{"type":"text","value":". Similarly, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MqY11CQJPQ"},{"type":"inlineCode","value":"dcounts","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wg2D7D5Y3z"},{"type":"text","value":" is:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V89AZyKepN"}],"key":"XbXPbZXpJd"}],"key":"JkxaBY8tAW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dcounts = counts_sum_inv * dprobs\nassert dcounts.shape == counts.shape","key":"yIjdvc0bmy"},{"type":"outputs","id":"4J93LHEIT0khh2iTwJIFe","children":[],"key":"zW0CWH7Uzy"}],"key":"g1Q2ryfwt8"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"with no additional summation required here since there is a broadcasting going on that will yield a derivative with a shape that is equivalent to the shape of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K1alxOjaE5"},{"type":"inlineCode","value":"counts","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oj1RSNbigo"},{"type":"text","value":" tensor. But we can’t call ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xkUucxOfAK"},{"type":"inlineCode","value":"cmp","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BVVxFL3L8n"},{"type":"text","value":" and check the correctness of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sLrGvp6fwn"},{"type":"inlineCode","value":"dcounts","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UY5365AvMn"},{"type":"text","value":" just yet. The reason is that besides being used to calculate ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a7doBLdcwS"},{"type":"inlineCode","value":"probs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sAEvAp1F5L"},{"type":"text","value":", it is also being used in another branch to calculate ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eAkLmfIuZy"},{"type":"inlineCode","value":"counts_sum_inv","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zfFskGtEr9"},{"type":"text","value":". So, even though we have calculated the first contribution of it: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CXx7sLtqwf"},{"type":"inlineMath","value":"\\dfrac{\\partial loss}{\\partial probs}\\cdot\\dfrac{\\partial probs}{\\partial counts}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>p</mi><mi>r</mi><mi>o</mi><mi>b</mi><mi>s</mi></mrow></mfrac></mstyle><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>p</mi><mi>r</mi><mi>o</mi><mi>b</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial loss}{\\partial probs}\\cdot\\dfrac{\\partial probs}{\\partial counts}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">ro</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">ro</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"M7g4fldJtG"},{"type":"text","value":", we still have to calculate the second contribution of it: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i80xPqmTQb"},{"type":"inlineMath","value":"\\dfrac{\\partial loss}{\\partial counts\\_sum}\\cdot\\dfrac{\\partial counts\\_sum}{\\partial counts}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>u</mi><mi>m</mi></mrow></mfrac></mstyle><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>u</mi><mi>m</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial loss}{\\partial counts\\_sum}\\cdot\\dfrac{\\partial counts\\_sum}{\\partial counts}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.3674em;vertical-align:-0.996em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.996em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0804em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3944em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.7em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"ZoYANvJY6y"},{"type":"text","value":". To continue with this branch, we now want to calculate ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zT9sUvGWmv"},{"type":"inlineCode","value":"dcounts_sum","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XJ8JZqzX0h"},{"type":"text","value":": ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DIylZzJFFG"},{"type":"inlineMath","value":"\\dfrac{\\partial loss}{\\partial counts\\_sum} = \\dfrac{\\partial counts\\_sum\\_inv}{\\partial counts\\_sum}\\cdot\\dfrac{\\partial loss}{\\partial counts\\_sum\\_inv}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>u</mi><mi>m</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>u</mi><mi>m</mi><mi mathvariant=\"normal\">_</mi><mi>i</mi><mi>n</mi><mi>v</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>u</mi><mi>m</mi></mrow></mfrac></mstyle><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>u</mi><mi>m</mi><mi mathvariant=\"normal\">_</mi><mi>i</mi><mi>n</mi><mi>v</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial loss}{\\partial counts\\_sum} = \\dfrac{\\partial counts\\_sum\\_inv}{\\partial counts\\_sum}\\cdot\\dfrac{\\partial loss}{\\partial counts\\_sum\\_inv}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.3674em;vertical-align:-0.996em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.996em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3904em;vertical-align:-0.996em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3944em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.7em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">in</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.996em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3674em;vertical-align:-0.996em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">in</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.996em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"ecYcUOeYUB"},{"type":"text","value":". With the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YS42KKBhqC"},{"type":"link","url":"https://www.wolframalpha.com/input?i=d%2Fdx+x**-1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"help of WolframAlpha","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sOtqBS9oO6"}],"urlSource":"https://www.wolframalpha.com/input?i=d%2Fdx+x**-1","key":"QbyyzpbzC7"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Wo3aPPsioH"}],"key":"xM0vmyuZjW"}],"key":"fD6Nnq2oyg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dcounts_sum = (-(counts_sum**-2)) * dcounts_sum_inv\ncmp(\"counts_sum\", dcounts_sum, counts_sum)","key":"OGDnsYOfkv"},{"type":"outputs","id":"MYECMIJ0u5kC3_ffSWk4T","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"counts_sum      | exact: True  | approximate: True  | maxdiff: 0.0\n"},"children":[],"key":"kbK2ZLNMsa"}],"key":"bA1ON2LBNw"}],"key":"yzCnaKozII"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Cool. Next, moving along, we want to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MGmOsqOB9u"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"beu5T0v2Ih"}],"key":"cw0YfuT9Oo"},{"type":"text","value":" through the preceding operation: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hacophfVtL"},{"type":"inlineCode","value":"counts_sum = counts.sum(1, keepdims=True)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q0QFyVhznx"},{"type":"text","value":". This means we want to now calculate the additional ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xupNulfvoG"},{"type":"inlineCode","value":"dcounts","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kQ1VJCQsVS"},{"type":"text","value":" component: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T5N76vPZiL"},{"type":"inlineMath","value":"\\dfrac{\\partial loss}{\\partial counts} = \\dfrac{\\partial loss}{\\partial counts\\_sum}\\cdot\\dfrac{\\partial counts \\_sum}{\\partial counts}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>u</mi><mi>m</mi></mrow></mfrac></mstyle><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>u</mi><mi>m</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial loss}{\\partial counts} = \\dfrac{\\partial loss}{\\partial counts\\_sum}\\cdot\\dfrac{\\partial counts \\_sum}{\\partial counts}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3674em;vertical-align:-0.996em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.996em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0804em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3944em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.7em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"NUWaBzFJZT"},{"type":"text","value":". If we remember from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bHLtX2D3OC"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"micrograd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Wo2dLQvm6w"}],"key":"tjM4f11nGD"},{"type":"text","value":", the sum operation basically acts just like a router, allowing the gradient (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LNkAjPqY8W"},{"type":"inlineCode","value":"dcounts_sum","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YfqznKN6zc"},{"type":"text","value":", in our case) to distribute equally to all the input during the backward flow. In other words, to use a toy example:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XnUzOz8OJY"}],"key":"x0s66BrLtj"}],"key":"o2cnQYNvG0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# b = sum(a), but with tensors:\n# b[3,1] = a[3x3].sum(1) --->\n# a11 a12 a13 ---> b1 (= a11 + a12 + a13)\n# a21 a22 a23 ---> b2 (= a21 + a22 + a23)\n# a31 a32 a33 ---> b3 (= a31 + a32 + a33)","key":"htOKa6lERa"},{"type":"outputs","id":"6Iky7E6AxCX6P80xVhPuV","children":[],"key":"oSgN9Nj6bd"}],"key":"UkEdLR9oUD"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Therefore considering that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hfYf81bHUQ"},{"type":"inlineMath","value":"a","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"OqoHLMlkEY"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wOYxYpPzDY"},{"type":"inlineMath","value":"b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"vUmuTs3fI5"},{"type":"text","value":" are multi-dimensional tensors: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kYbpom9o4h"},{"type":"inlineMath","value":"\\dfrac{\\partial b_{3\\times1}}{\\partial a_{3\\times3}} = \\dfrac{\\partial{\\sum a_{3\\times3}}}{\\partial a_{3\\times3}} = \\dfrac{\\partial \\textbf{1}_{3\\times3}^T a_{3\\times3}}{\\partial a_{3\\times3}} = \\textbf{1}_{3\\times3}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>b</mi><mrow><mn>3</mn><mo>×</mo><mn>1</mn></mrow></msub></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>a</mi><mrow><mn>3</mn><mo>×</mo><mn>3</mn></mrow></msub></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mrow><mo>∑</mo><msub><mi>a</mi><mrow><mn>3</mn><mo>×</mo><mn>3</mn></mrow></msub></mrow></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>a</mi><mrow><mn>3</mn><mo>×</mo><mn>3</mn></mrow></msub></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msubsup><mtext mathvariant=\"bold\">1</mtext><mrow><mn>3</mn><mo>×</mo><mn>3</mn></mrow><mi>T</mi></msubsup><msub><mi>a</mi><mrow><mn>3</mn><mo>×</mo><mn>3</mn></mrow></msub></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>a</mi><mrow><mn>3</mn><mo>×</mo><mn>3</mn></mrow></msub></mrow></mfrac></mstyle><mo>=</mo><msub><mtext mathvariant=\"bold\">1</mtext><mrow><mn>3</mn><mo>×</mo><mn>3</mn></mrow></msub></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial b_{3\\times1}}{\\partial a_{3\\times3}} = \\dfrac{\\partial{\\sum a_{3\\times3}}}{\\partial a_{3\\times3}} = \\dfrac{\\partial \\textbf{1}_{3\\times3}^T a_{3\\times3}}{\\partial a_{3\\times3}} = \\textbf{1}_{3\\times3}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2658em;vertical-align:-0.8943em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span><span class=\"mbin mtight\">×</span><span class=\"mord mtight\">3</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span><span class=\"mbin mtight\">×</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8943em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3213em;vertical-align:-0.8943em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span><span class=\"mbin mtight\">×</span><span class=\"mord mtight\">3</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span><span class=\"mbin mtight\">×</span><span class=\"mord mtight\">3</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8943em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4653em;vertical-align:-0.8943em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.571em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span><span class=\"mbin mtight\">×</span><span class=\"mord mtight\">3</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.6953em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord textbf\">1</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8757em;\"><span style=\"top:-2.453em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span><span class=\"mbin mtight\">×</span><span class=\"mord mtight\">3</span></span></span></span><span style=\"top:-3.0973em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3053em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span><span class=\"mbin mtight\">×</span><span class=\"mord mtight\">3</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8943em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8528em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord textbf\">1</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span><span class=\"mbin mtight\">×</span><span class=\"mord mtight\">3</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span></span>","key":"sXHOQLxAdt"},{"type":"text","value":". Therefore, similarly, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O71cG5bBmF"},{"type":"inlineMath","value":"\\dfrac{\\partial counts\\_sum}{\\partial counts} = \\textbf{1}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>u</mi><mi>m</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle><mo>=</mo><mtext mathvariant=\"bold\">1</mtext></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial counts\\_sum}{\\partial counts} = \\textbf{1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0804em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3944em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.7em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord text\"><span class=\"mord textbf\">1</span></span></span></span></span>","key":"vB5Jxqz2FP"},{"type":"text","value":", where the matrix ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZDEPUr4SR6"},{"type":"inlineMath","value":"\\textbf{1}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext mathvariant=\"bold\">1</mtext></mrow><annotation encoding=\"application/x-tex\">\\textbf{1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord text\"><span class=\"mord textbf\">1</span></span></span></span></span>","key":"NKgxnW3ixL"},{"type":"text","value":" has the shape of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f2eI2oTOlg"},{"type":"inlineCode","value":"counts","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y9rRtdBasc"},{"type":"text","value":". Therefore, we can now add the calculated second component ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hst1PNfCBJ"},{"type":"inlineMath","value":"\\dfrac{\\partial counts\\_sum}{\\partial counts}\\dfrac{\\partial loss}{\\partial counts\\_sum}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>u</mi><mi>m</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>u</mi><mi>m</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial counts\\_sum}{\\partial counts}\\dfrac{\\partial loss}{\\partial counts\\_sum}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.3904em;vertical-align:-0.996em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3944em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.7em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.996em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"qUYYS5PCQH"},{"type":"text","value":" to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yEKb5JIhjD"},{"type":"inlineCode","value":"dcounts","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sk8l9TMcvq"},{"type":"text","value":". And since there is no extra component that makes up ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Go4pukXajS"},{"type":"inlineCode","value":"dcounts","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rx7iEOwNhJ"},{"type":"text","value":" we can do:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ay5BigdsZr"}],"key":"hbIZ3nipsp"}],"key":"Pt9J6Q9B02"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dcounts += torch.ones_like(counts) * dcounts_sum","key":"P1ivbaNJRb"},{"type":"outputs","id":"PgsG3AoTgIIZXYZTuMtiF","children":[],"key":"a1pJ6lWF6S"}],"key":"FTiHu1FPBZ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And now ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JkYfK7hoqP"},{"type":"inlineCode","value":"dcounts","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i6cShUoXhH"},{"type":"text","value":" is equal to: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F5zwD0Bzyc"},{"type":"inlineMath","value":"\\dfrac{\\partial loss}{\\partial counts} = \\dfrac{\\partial loss}{\\partial probs}\\cdot\\dfrac{\\partial probs}{\\partial counts} + \\dfrac{\\partial loss}{\\partial counts\\_sum}\\cdot\\dfrac{\\partial counts\\_sum}{\\partial counts}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>p</mi><mi>r</mi><mi>o</mi><mi>b</mi><mi>s</mi></mrow></mfrac></mstyle><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>p</mi><mi>r</mi><mi>o</mi><mi>b</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle><mo>+</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>u</mi><mi>m</mi></mrow></mfrac></mstyle><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>u</mi><mi>m</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial loss}{\\partial counts} = \\dfrac{\\partial loss}{\\partial probs}\\cdot\\dfrac{\\partial probs}{\\partial counts} + \\dfrac{\\partial loss}{\\partial counts\\_sum}\\cdot\\dfrac{\\partial counts\\_sum}{\\partial counts}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">ro</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">ro</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3674em;vertical-align:-0.996em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.996em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0804em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3944em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.7em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"a5TfZcfYMH"},{"type":"text","value":". And now, we can check for correctness:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xq4BLN4ry0"}],"key":"pibmh1UhZo"}],"key":"gYAdKCJnw1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cmp(\"counts\", dcounts, counts)","key":"O1NLa7MZrZ"},{"type":"outputs","id":"8xp8pNZxI9HeOUIWm7567","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"counts          | exact: True  | approximate: True  | maxdiff: 0.0\n"},"children":[],"key":"LPSputPgky"}],"key":"G7NzD3mKB1"}],"key":"UIyIrDYOFA"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Awesome! The match is exact, which of course means that once again we have correctly calculated the gradient of yet-another node, and our smooth manual ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j72JxDlm5K"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sTPYkrTgIm"}],"key":"rQ9lJsYenk"},{"type":"text","value":"ing journey continues! So hopefully we should be getting a hang of this now. Now, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"N8BF8ZOKVh"},{"type":"inlineCode","value":"dnorm_logits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LKdId8Ud0c"},{"type":"text","value":" is easy:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pE8tq3ho7a"}],"key":"WGMrBiquwA"}],"key":"fESl4mBeDZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dnorm_logits = counts * dcounts\ncmp(\"norm_logits\", dnorm_logits, norm_logits)","key":"wHem64Qw2Z"},{"type":"outputs","id":"0oxnASrHj4obgLLTA7eZF","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"norm_logits     | exact: True  | approximate: True  | maxdiff: 0.0\n"},"children":[],"key":"WZeJANJs4Z"}],"key":"IuhBUR6UTS"}],"key":"ttUtJpyuxu"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"since ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hUxSyW0QbU"},{"type":"inlineMath","value":"\\dfrac{\\partial loss}{\\partial norm\\_logits} = \\dfrac{\\partial counts}{\\partial norm\\_logits}\\cdot\\dfrac{\\partial loss}{\\partial counts} = \\dfrac{\\partial e^{norm\\_logits}}{\\partial norm\\_logits}\\cdot\\dfrac{\\partial loss}{\\partial counts} = e^{norm\\_logits}\\cdot\\dfrac{\\partial loss}{\\partial counts} = counts\\cdot\\dfrac{\\partial loss}{\\partial counts}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi mathvariant=\"normal\">_</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi mathvariant=\"normal\">_</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msup><mi>e</mi><mrow><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi mathvariant=\"normal\">_</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi>s</mi></mrow></msup></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi mathvariant=\"normal\">_</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle><mo>=</mo><msup><mi>e</mi><mrow><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi mathvariant=\"normal\">_</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi>s</mi></mrow></msup><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle><mo>=</mo><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial loss}{\\partial norm\\_logits} = \\dfrac{\\partial counts}{\\partial norm\\_logits}\\cdot\\dfrac{\\partial loss}{\\partial counts} = \\dfrac{\\partial e^{norm\\_logits}}{\\partial norm\\_logits}\\cdot\\dfrac{\\partial loss}{\\partial counts} = e^{norm\\_logits}\\cdot\\dfrac{\\partial loss}{\\partial counts} = counts\\cdot\\dfrac{\\partial loss}{\\partial counts}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.3674em;vertical-align:-0.996em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span><span class=\"mord mathnormal\">m</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.996em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3674em;vertical-align:-0.996em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span><span class=\"mord mathnormal\">m</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.996em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.5221em;vertical-align:-0.996em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5261em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span><span class=\"mord mathnormal\">m</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">or</span><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mtight\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">s</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.996em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">or</span><span class=\"mord mathnormal mtight\">m</span><span class=\"mord mtight\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal mtight\">o</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mord mathnormal mtight\">t</span><span class=\"mord mathnormal mtight\">s</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">co</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"Tp70xrtX53"},{"type":"text","value":". Let’s continue. Next up is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"E1d5bZR0Og"},{"type":"inlineCode","value":"norm_logits = logits - logit_maxes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zL5KIfpXYu"},{"type":"text","value":". So now we care about finding ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yFcUcTUWZO"},{"type":"inlineCode","value":"dlogits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AcB8BeyVbL"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qJXqBKr4OW"},{"type":"inlineCode","value":"dlogit_maxes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZfwdOedQ0a"},{"type":"text","value":". We have to be careful here again as the shapes are not the same:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Lu9niAe5iJ"}],"key":"DZNDLTCfss"}],"key":"w1J96Rnfrh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"norm_logits.shape, logits.shape, logit_maxes.shape","key":"sgvBYrL7Yx"},{"type":"outputs","id":"bZTRILisA7r8I8ZVHKoxQ","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/plain":{"content":"(torch.Size([32, 27]), torch.Size([32, 27]), torch.Size([32, 1]))","content_type":"text/plain"}}},"children":[],"key":"oIr449RWKS"}],"key":"PSSPl6AuFQ"}],"key":"zaJVVcXyNr"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This means that when the subtraction happens there is going to be an implicit broadcasting happening:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UB4yNuEGCE"}],"key":"pRPqRjqBHX"}],"key":"En4668O8hg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# c = a - b, but with tensors: a[3x3], b[3x1], c[3x3]\n# c11 c12 c13 = a11 a12 a13   b1\n# c21 c22 c23 = a21 a22 a23 - b2\n# c31 c32 c33 = a31 a32 a33   b3\n\n# so e.g. c32 = a32 - b3","key":"VNU0zy9z5B"},{"type":"outputs","id":"oPjqkN3EOmMSmRSO_S5uy","children":[],"key":"NB1RA6vjAM"}],"key":"DOQqBQFoJB"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"For calculating ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RchMcsRUZd"},{"type":"inlineCode","value":"dlogits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OUBYcLXCxI"},{"type":"text","value":" we care about finding the (first) component ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a1nr0ptcJ9"},{"type":"inlineMath","value":"\\dfrac{\\partial norm\\_logits}{\\partial logits}\\dfrac{\\partial loss}{\\partial norm\\_logits} = \\dfrac{\\partial loss}{\\partial norm\\_logits}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi mathvariant=\"normal\">_</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi mathvariant=\"normal\">_</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi mathvariant=\"normal\">_</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial norm\\_logits}{\\partial logits}\\dfrac{\\partial loss}{\\partial norm\\_logits} = \\dfrac{\\partial loss}{\\partial norm\\_logits}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.3904em;vertical-align:-0.996em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3944em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.7em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span><span class=\"mord mathnormal\">m</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span><span class=\"mord mathnormal\">m</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.996em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3674em;vertical-align:-0.996em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span><span class=\"mord mathnormal\">m</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.996em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"FjSxvkgeTb"},{"type":"text","value":". And therefore:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JFXHA7sw5A"}],"key":"cFYCL84r5L"}],"key":"OdHUvnnYSY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dlogits = dnorm_logits.clone()","key":"vDFo9kwEDk"},{"type":"outputs","id":"FRaiIJKVvDRuQf9P-8wap","children":[],"key":"vM4VtzJ0pV"}],"key":"ipCFc08qkU"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now, like for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qKg3eP2SKB"},{"type":"inlineCode","value":"dcounts","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dfJnIeJXcH"},{"type":"text","value":" previously, we cannot yet check for the correctness of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LnwogtCwu0"},{"type":"inlineCode","value":"dlogits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"L2EPhzcI8X"},{"type":"text","value":" because there is still a second component that should be added to the first one to make up the complete ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r21g9tkNsu"},{"type":"inlineCode","value":"dlogits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pPrPcBnhQo"},{"type":"text","value":" gradient ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GwfTHVQPX1"},{"type":"inlineMath","value":"\\dfrac{\\partial loss}{\\partial logits}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial loss}{\\partial logits}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"WLKGRXvezW"},{"type":"text","value":". Before we calculate that let’s first find ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ngfQqiUYrf"},{"type":"inlineCode","value":"dlogit_maxes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H2XeGxDVvk"},{"type":"text","value":": ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"grbKgt0YQT"},{"type":"inlineMath","value":"\\dfrac{\\partial loss}{\\partial logit\\_maxes} = \\dfrac{\\partial norm\\_logits}{\\partial logit\\_maxes}\\dfrac{\\partial loss}{\\partial norm\\_logits} = -\\dfrac{\\partial loss}{\\partial norm\\_logits}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi mathvariant=\"normal\">_</mi><mi>m</mi><mi>a</mi><mi>x</mi><mi>e</mi><mi>s</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi mathvariant=\"normal\">_</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi mathvariant=\"normal\">_</mi><mi>m</mi><mi>a</mi><mi>x</mi><mi>e</mi><mi>s</mi></mrow></mfrac></mstyle><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi mathvariant=\"normal\">_</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle><mo>=</mo><mo>−</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi><mi mathvariant=\"normal\">_</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial loss}{\\partial logit\\_maxes} = \\dfrac{\\partial norm\\_logits}{\\partial logit\\_maxes}\\dfrac{\\partial loss}{\\partial norm\\_logits} = -\\dfrac{\\partial loss}{\\partial norm\\_logits}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.3674em;vertical-align:-0.996em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">es</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.996em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3904em;vertical-align:-0.996em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3944em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">es</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.7em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span><span class=\"mord mathnormal\">m</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.996em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span><span class=\"mord mathnormal\">m</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.996em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3674em;vertical-align:-0.996em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">or</span><span class=\"mord mathnormal\">m</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.996em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"sNSAynOIg7"},{"type":"text","value":", which essentially means: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O1BHDAYhYv"},{"type":"inlineCode","value":"dlogit_maxes = -dnorm_logits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VDSQSU6F7k"},{"type":"text","value":". Now remember, because we are dealing with tensors and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Sl7fimqQOM"},{"type":"inlineCode","value":"logit_maxes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oaiXUlrn6B"},{"type":"text","value":" has a shape of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MNRXIFIv6s"},{"type":"inlineMath","value":"32\\times1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>32</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">32\\times1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">32</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"AGZV0H9TvF"},{"type":"text","value":", that means that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MeHG0V7gUF"},{"type":"inlineCode","value":"-dnorm_logits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zZfeeAmyzT"},{"type":"text","value":", whose shape is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cAk6Xz43JI"},{"type":"inlineMath","value":"32\\times27","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>32</mn><mo>×</mo><mn>27</mn></mrow><annotation encoding=\"application/x-tex\">32\\times27</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">32</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">27</span></span></span></span>","key":"LOBmsyCuBm"},{"type":"text","value":", must be summed along the column axis in order for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CHUBKdeZZ3"},{"type":"inlineCode","value":"dlogits_maxes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"h4AkeJ13jt"},{"type":"text","value":" to become a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iczfPL53cA"},{"type":"inlineMath","value":"32\\times1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>32</mn><mo>×</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">32\\times1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">32</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"WA76gzivUK"},{"type":"text","value":" tensor (the same shape as ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J06Pb6rdNB"},{"type":"inlineCode","value":"logit_maxes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fhEBfnGy85"},{"type":"text","value":"). Therefore:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rO1XtHACiS"}],"key":"ubY60WFWI6"}],"key":"X1l3crtGWz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dlogit_maxes = (-dnorm_logits).sum(1, keepdim=True)\ncmp(\"logit_maxes\", dlogit_maxes, logit_maxes)","key":"oceT0iq1A4"},{"type":"outputs","id":"ZOap-zY8cg-1q-vb5XS3r","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"logit_maxes     | exact: True  | approximate: True  | maxdiff: 0.0\n"},"children":[],"key":"Vabp9OLd7l"}],"key":"k2CgptxyY4"}],"key":"zM5h0hyZcz"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Next up is: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NNknjTwR4U"},{"type":"inlineCode","value":"logit_maxes = logits.max(1, keepdim=True).values","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GK2URR27WX"},{"type":"text","value":". Now, this is the line out of which we will find the second derivative component of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JTyDcujtwL"},{"type":"inlineCode","value":"dlogits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ab6BjliRgL"},{"type":"text","value":": ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yqFUMlDi0O"},{"type":"inlineMath","value":"\\dfrac{\\partial logit\\_maxes}{\\partial logits}\\cdot\\dfrac{\\partial loss}{\\partial logit\\_maxes}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi mathvariant=\"normal\">_</mi><mi>m</mi><mi>a</mi><mi>x</mi><mi>e</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi mathvariant=\"normal\">_</mi><mi>m</mi><mi>a</mi><mi>x</mi><mi>e</mi><mi>s</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial logit\\_maxes}{\\partial logits}\\cdot\\dfrac{\\partial loss}{\\partial logit\\_maxes}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2749em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3944em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.7em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">es</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3674em;vertical-align:-0.996em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">es</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.996em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"gd3UblS8vH"},{"type":"text","value":". But what is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"utkIIUcPra"},{"type":"inlineMath","value":"\\dfrac{\\partial logit\\_maxes}{\\partial logits}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi mathvariant=\"normal\">_</mi><mi>m</mi><mi>a</mi><mi>x</mi><mi>e</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial logit\\_maxes}{\\partial logits}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2749em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3944em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.7em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">es</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"D5DcZnPlTD"},{"type":"text","value":" lossin this case? Before we answer this question, let’s pause here briefly and look at these ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Pnb5pUIg6j"},{"type":"inlineCode","value":"logit_maxes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YRdhzcqypZ"},{"type":"text","value":", and especially their gradients. We’ve talked previously in the previous lesson that the only reason we’re doing this is for the numerical stability of the softmax that we are implementing here. And we talked about how if you take these ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JkkgPsfQvB"},{"type":"inlineCode","value":"logits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l6HqslJdb6"},{"type":"text","value":" for any one of these examples, so one row of this logits tensor, if you add or subtract any value equally to all the elements, then the value of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bNaUth4zXv"},{"type":"inlineCode","value":"probs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"htbTGdgwB7"},{"type":"text","value":" will be unchanged. You’re not changing the softmax. The only thing that this is doing is it’s making sure that the subsequent ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iyPEQV4t10"},{"type":"inlineCode","value":"exp()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dxiCoSEjwx"},{"type":"text","value":" operation doesn’t overflow. And the reason we’re using a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c1JEajPCbS"},{"type":"inlineCode","value":"max","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yO6DiIZOZG"},{"type":"text","value":" is because then we are guaranteed that each row of logits, the highest number, is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ml2AlZR6b1"},{"type":"text","value":"0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xekqnLiLPN"},{"type":"text","value":". Basically, that has repercussions. If it is the case that changing ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yb03rpcOb5"},{"type":"inlineCode","value":"logit_maxes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tzUetkfnXm"},{"type":"text","value":" does not change the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s93BcyAz6k"},{"type":"inlineCode","value":"probs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yOT2uZItvN"},{"type":"text","value":", and therefore does not change the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fqV16HckrL"},{"type":"inlineCode","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HOxSb7Upjs"},{"type":"text","value":", then the gradient on ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o7wzy0C5OV"},{"type":"inlineCode","value":"logit_maxes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mam2wJAdmf"},{"type":"text","value":" should be ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l6fZ68gSTD"},{"type":"text","value":"0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iLi6ana2q5"},{"type":"text","value":". Are they?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LNCZFMmYWz"}],"key":"XfKSsu3xJK"}],"key":"vLSKCcxHXy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dlogit_maxes","key":"KwLVpX2NQk"},{"type":"outputs","id":"77UWwDkyUrpucJY9smAdT","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":43,"metadata":{},"data":{"text/plain":{"content":"tensor([[-4.6566e-09],\n        [-9.3132e-10],\n        [-1.8626e-09],\n        [-4.6566e-09],\n        [-9.3132e-10],\n        [-1.6298e-09],\n        [-3.7253e-09],\n        [-4.6566e-09],\n        [-5.5879e-09],\n        [-1.8626e-09],\n        [ 1.3970e-09],\n        [-9.3132e-10],\n        [ 3.4925e-09],\n        [-1.1642e-09],\n        [ 2.3283e-10],\n        [ 6.2864e-09],\n        [ 0.0000e+00],\n        [-6.9849e-10],\n        [ 5.3551e-09],\n        [ 1.1642e-09],\n        [ 0.0000e+00],\n        [-2.0955e-09],\n        [ 6.7521e-09],\n        [ 9.3132e-10],\n        [ 1.8626e-09],\n        [ 9.3132e-10],\n        [-3.7253e-09],\n        [-9.3132e-10],\n        [ 4.6566e-09],\n        [ 4.6566e-10],\n        [-2.3283e-09],\n        [ 3.0268e-09]], grad_fn=<SumBackward1>)","content_type":"text/plain"}}},"children":[],"key":"mTiBfOvP34"}],"key":"khlWKwHR7a"}],"key":"E9I31Zai2M"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Not exactly. But regardless, these are very very tiny floating point numbers that are close to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SQwJagkyX2"},{"type":"text","value":"0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bEh9eEjOyk"},{"type":"text","value":". And so this is telling us that the values of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hMWtyWvmwj"},{"type":"inlineCode","value":"logit_maxes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zHL0Z4u29U"},{"type":"text","value":" are not impacting the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kVbps2lI5x"},{"type":"inlineCode","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JeAvG0SyUo"},{"type":"text","value":", as they should not. It feels kind of weird to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iTR35RoN9v"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fJWE5jCWri"}],"key":"ulMlImkpZq"},{"type":"text","value":" through this branch, honestly, because if you have any implementation of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BwhKcXJFjr"},{"type":"inlineCode","value":"f.cross_entropy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T4oJhGklQw"},{"type":"text","value":" in PyTorch, and you block together all of these elements, and you’re not doing ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GnVy1RSHco"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lyMuTVBWT8"}],"key":"caOwitMyco"},{"type":"text","value":" piece by piece, then you would probably assume that the derivative through here is exactly ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JdePUwVn7v"},{"type":"text","value":"0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DI3aYaoqDv"},{"type":"text","value":". So you would be sort of skipping this branch. Because it’s only done for numerical stability. But it’s interesting to see that even if you break up everything into the full atoms, and you still do the computation as you’d like ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OKkGRNQMZM"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WOwNeEF4lx"}],"key":"plfox42BhI"},{"type":"text","value":" numerical stability, the correct thing happens. And you still get very, very small gradients here. Basically reflecting the fact that the values of these do not matter ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xleu21CV04"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"byVvEHFtte"}],"key":"mSKQ9JNxuX"},{"type":"text","value":" the final ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gIh7JEty4o"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T05h7TFJ3A"}],"key":"B5dnkwRe0D"},{"type":"text","value":". Okay, so let’s now continue ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TSLKTUJw4n"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kcIO2lXXKv"}],"key":"ltt1j9Ykem"},{"type":"text","value":" through this line here. We’ve just calculated the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u8LnrYb1s7"},{"type":"inlineCode","value":"logit_maxes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dQt9aIJNkU"},{"type":"text","value":", and now we want to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wU4PAt6rFx"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tCEHSfPu66"}],"key":"tq1rMWE6Tr"},{"type":"text","value":" into ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ux05u7EvAp"},{"type":"inlineCode","value":"logits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eTXtnjXoks"},{"type":"text","value":" through this second branch. Here we took the max along all the rows and then looked at its values ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QkRnBA8AaM"},{"type":"inlineCode","value":"logits.max(1, keepdim=True).values","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vgS9hjWrXw"},{"type":"text","value":". In PyTorch, max returns both the max values but also the indices of those values:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"smnuF4pGID"}],"key":"NuGBeMkjQx"}],"key":"DYJQ3ThZiD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"logits.max(1, keepdim=True)","key":"Zw4pnlXD6M"},{"type":"outputs","id":"Y36yB2z4qM_Xpcir7Hebg","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":44,"metadata":{},"data":{"text/plain":{"content":"torch.return_types.max(\nvalues=tensor([[1.0230],\n        [0.8773],\n        [1.2418],\n        [0.6361],\n        [1.7365],\n        [0.9537],\n        [0.8150],\n        [1.4842],\n        [1.0861],\n        [1.1175],\n        [1.7868],\n        [2.0955],\n        [1.1189],\n        [0.9202],\n        [0.5922],\n        [0.8290],\n        [0.9719],\n        [0.7808],\n        [1.1189],\n        [0.8777],\n        [0.8088],\n        [1.0604],\n        [1.1189],\n        [1.2769],\n        [1.6185],\n        [1.0034],\n        [1.2943],\n        [1.0409],\n        [1.0030],\n        [0.7977],\n        [1.1389],\n        [0.9284]], grad_fn=<MaxBackward0>),\nindices=tensor([[ 1],\n        [ 2],\n        [19],\n        [15],\n        [15],\n        [25],\n        [16],\n        [ 3],\n        [19],\n        [ 8],\n        [15],\n        [ 3],\n        [22],\n        [18],\n        [ 7],\n        [ 5],\n        [ 2],\n        [ 1],\n        [22],\n        [19],\n        [15],\n        [19],\n        [22],\n        [22],\n        [23],\n        [ 5],\n        [22],\n        [20],\n        [24],\n        [ 8],\n        [24],\n        [13]]))","content_type":"text/plain"}}},"children":[],"key":"KUnLOJLlta"}],"key":"ksRx1mMEI9"}],"key":"q3JHJdTPTb"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Although we just keep the values, in the backward pass, it is extremely useful to know about where those maximum values occured. And these indices will help us with the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oTKfdcjGwr"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KvZXe7BrDa"}],"key":"eSDPEdyGAk"},{"type":"text","value":". Again, we ask, what is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pOyelIoKzM"},{"type":"inlineMath","value":"\\dfrac{\\partial logit\\_maxes}{\\partial logits}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi mathvariant=\"normal\">_</mi><mi>m</mi><mi>a</mi><mi>x</mi><mi>e</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi>s</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial logit\\_maxes}{\\partial logits}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2749em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3944em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.7em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span><span class=\"mord mathnormal\">es</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"OS8TCjibmS"},{"type":"text","value":" in this case? We have the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tpQDmmwATH"},{"type":"inlineCode","value":"logits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tUrb3UxnC8"},{"type":"text","value":" whose shape is:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qCVvv48a69"}],"key":"oxgILq9PLS"}],"key":"rBx8LXbOze"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"logits.shape","key":"QABfMnc3sY"},{"type":"outputs","id":"FvGYRGGmwEQQjJezy0mui","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":45,"metadata":{},"data":{"text/plain":{"content":"torch.Size([32, 27])","content_type":"text/plain"}}},"children":[],"key":"JkVSUzK4Eq"}],"key":"mIPTu9XgeR"}],"key":"u1hjFxHrx0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"and in each row we find the maximum value. And then that value gets plucked out into ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RehRG6sNOS"},{"type":"inlineCode","value":"logit_maxes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sn9nmWwbbU"},{"type":"text","value":". And so intuitively, the derivative we are looking for (that is flowing through) ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"amTT3OhUxL"},{"type":"text","value":"1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ahFSX4W0tA"},{"type":"text","value":" (for the appropriate entry that was plucked out) times ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bH3GCI3h0B"},{"type":"inlineCode","value":"dlogit_maxes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oVNuvlsLtK"},{"type":"text","value":". So if you think about it, what we want here is we need to take the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cO98iRSIe5"},{"type":"inlineCode","value":"dlogit_maxes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"g8w6bE0PnB"},{"type":"text","value":" tensor and scatter it into the correct positions in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AHxNEZstMv"},{"type":"inlineCode","value":"logits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y5SH2EEq2G"},{"type":"text","value":", meaning the indices of the max values. One way to do this is create a tensor with ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UNi8Hw4ZOK"},{"type":"inlineMath","value":"1s","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">1s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"ypaHz0SlG3"},{"type":"text","value":" at the indices we care about and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J3nAH14yne"},{"type":"inlineMath","value":"0s","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">0s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"Y7N8E2zXex"},{"type":"text","value":" elsewhere and multiply this tensor by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iWXOU1Lg4r"},{"type":"inlineCode","value":"dlogit_maxes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uFl5sBf2u0"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LG4115A3PP"}],"key":"a1TX3bP5HF"}],"key":"DOrmxDk6Ur"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ones_maxes_indeces = F.one_hot(logits.max(1).indices, num_classes=logits.shape[1])\nplt.imshow(ones_maxes_indeces)\nplt.show();","key":"F62gUHJpaw"},{"type":"outputs","id":"JRL_cFrTHqmR7N_b8sgAG","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/vnd.jupyter.widget-view+json":{"content":"{\"model_id\":\"3859a73b4fce4c36a28ae95aaeecc886\",\"version_major\":2,\"version_minor\":0}","content_type":"application/vnd.jupyter.widget-view+json"},"image/png":{"content_type":"image/png","hash":"d3357e203cbcb406871f00b87870c4a7","path":"/build/d3357e203cbcb406871f00b87870c4a7.png"},"text/html":{"content":"\n            <div style=\"display: inline-block;\">\n                <div class=\"jupyter-widgets widget-label\" style=\"text-align: center;\">\n                    Figure\n                </div>\n                <img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAoAAAAHgCAYAAAA10dzkAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjAsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvlHJYcgAAAAlwSFlzAAAPYQAAD2EBqD+naQAAHxRJREFUeJzt3X9s1Pd9+PGX+eEraexjhmDjYZiTNKEtgUo0OFZaRouHIVIEgUpJWmkkQqmamWhgdamomqRolTwlUstaUfLPFjapJF2kEpRoJUpJMYpmmMKEaLbV32AxQQR2ViR8wRnGiT/fP/rNfesFEghnH/b78ZA+Knf3uevr0w9unvncnd8VWZZlAQBAMiaVewAAAMaWAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASMyUcg8Al2t4eDhOnToVVVVVUVFRUe5xAEomy7J45513or6+PiZNcm2G0ScAGTdOnToVDQ0N5R4DYNScPHky5syZU+4xSIAAZExt3749nnrqqejt7Y1FixbFT37yk1iyZMllPbeqqioiIr4Ud8WUmHpZz9n9f35z2bPdc8ttl70vQCm9F0PxWvxz8f/nYLQJQMbMz3/+82hvb4+nn346mpqaYtu2bdHa2hrd3d0xa9asj33+B2/7TompMaXi8gKwuury30q53NcEKLns9//h4y2MFR80YMz88Ic/jIceeigefPDB+NznPhdPP/10XHfddfH3f//35R4NAJIiABkTFy5ciMOHD0dLS0vxvkmTJkVLS0t0dXVd9DmDg4NRKBRGbADA1ROAjInf/e538f7770dtbe2I+2tra6O3t/eiz+no6Ih8Pl/cfAEEAEpDAHLN2rJlS/T39xe3kydPlnskAJgQfAmEMTFz5syYPHly9PX1jbi/r68v6urqLvqcXC4XuVxuLMYDgKS4AsiYqKysjMWLF8e+ffuK9w0PD8e+ffuiubm5jJMBQHpcAWTMtLe3x/r16+OLX/xiLFmyJLZt2xYDAwPx4IMPlns0AEiKAGTM3HvvvfHf//3f8fjjj0dvb2984QtfiL17937oiyEAwOiqyLIsK/cQcDkKhULk8/lYFqtH5Zc2v3zqyBXt31r/hZLPAKTpvWwo9see6O/vj+rq6nKPQwJ8BhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDHWAob/x9JuMNKVLI/o5wfGF1cAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABJjLWCAUXQl6+lGXFtr6l5LswCl5QogAEBiBCAAQGIEIABAYgQgAEBiBCAAQGIEIABAYgQgAEBiBCAAQGIEIABAYgQgAEBiBCAAQGIEIABAYgQgAEBiBCAAQGIEIABAYgQgAEBiBCAAQGIEIABAYgQgAEBiBCAAQGIEIABAYgQgAEBippR7AICJrLX+C+UegRJ6+dSRy97Xueda5gogAEBiBCBj5vvf/35UVFSM2ObPn1/usQAgOd4CZkx9/vOfj1/96lfF21Om+CsIAGPNP30ZU1OmTIm6urpyjwEASfMWMGPqzTffjPr6+rjxxhvjG9/4Rpw4ceKS+w4ODkahUBixAQBXTwAyZpqammLnzp2xd+/e2LFjRxw/fjy+/OUvxzvvvHPR/Ts6OiKfzxe3hoaGMZ4YACamiizLsnIPQZrOnj0b8+bNix/+8IexYcOGDz0+ODgYg4ODxduFQiEaGhpiWayOKRVTx3JUgIgYvV8D8142FPtjT/T390d1dfWVDwZXyGcAKZvp06fHLbfcEseOHbvo47lcLnK53BhPBQATn7eAKZtz585FT09PzJ49u9yjAEBSBCBj5tvf/nZ0dnbGf/3Xf8W//Mu/xD333BOTJ0+O+++/v9yjAUBSvAXMmHnrrbfi/vvvjzNnzsQNN9wQX/rSl+LgwYNxww03lHs0uGZYauza5n9zJgoByJh57rnnyj0CABDeAgYASI4ABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIyl4OATsmYro8HfFWAsuAIIAJAYAQgAkBgBCACQGAEIAJAYAQgAkBgBCACQGAEIAJAYAQgAkBgBCACQGAEIAJAYS8HBJ2TJLiY6yx3CxOUKIABAYgQgAEBiBCAAQGIEIABAYgQgAEBiBCAAQGIEIABAYgQgAEBiBCAAQGIEIABAYgQgAEBirAUMXNKVrAUbYT3Yicb5hInLFUAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxFgLGLgka8FePespA9ciVwApiQMHDsTdd98d9fX1UVFRES+88MKIx7Msi8cffzxmz54d06ZNi5aWlnjzzTfLMywAJE4AUhIDAwOxaNGi2L59+0Uff/LJJ+PHP/5xPP3003Ho0KH49Kc/Ha2trXH+/PkxnhQA8BYwJbFq1apYtWrVRR/Lsiy2bdsW3/ve92L16tUREfGP//iPUVtbGy+88ELcd999YzkqACTPFUBG3fHjx6O3tzdaWlqK9+Xz+Whqaoqurq4yTgYAaXIFkFHX29sbERG1tbUj7q+trS0+djGDg4MxODhYvF0oFEZnQABIjCuAXLM6Ojoin88Xt4aGhnKPBAATggBk1NXV1UVERF9f34j7+/r6io9dzJYtW6K/v7+4nTx5clTnBIBUCEBGXWNjY9TV1cW+ffuK9xUKhTh06FA0Nzdf8nm5XC6qq6tHbADA1fMZQEri3LlzcezYseLt48ePx5EjR6Kmpibmzp0bmzZtih/84Afxmc98JhobG+Oxxx6L+vr6WLNmTfmGBoBECUBK4vXXX4+vfOUrxdvt7e0REbF+/frYuXNnPProozEwMBDf/OY34+zZs/GlL30p9u7dG5/61KfKNTIAJKsiy7Ks3EPA5SgUCpHP52NZrI4pFVPLPc4VLfFleS/go7yXDcX+2BP9/f0+7sKY8BlAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMRMKfcAMF5Z3xfGxpWsux3hZxMuhyuAAACJEYAAAIkRgAAAiRGAAACJEYAAAIkRgAAAiRGAAACJEYAAAIkRgAAAiRGAAACJsRQcQCLG65Jq18ocMJG4AggAkBgBCACQGAEIAJAYAQgAkBgBCACQGAEIAJAYAQgAkBgBCACQGAEIAJAYAQgAkBgBCACQGGsBQ2KuZD1Ya7BOLM4n8AFXAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEmMpOLgGjeZybZYDA8AVQACAxAhASuLAgQNx9913R319fVRUVMQLL7ww4vEHHnggKioqRmwrV64sz7AAkDgBSEkMDAzEokWLYvv27ZfcZ+XKlXH69Oni9uyzz47hhADAB3wGkJJYtWpVrFq16iP3yeVyUVdXN0YTAQCX4gogY2b//v0xa9asuPXWW+Phhx+OM2fOlHskAEiSK4CMiZUrV8batWujsbExenp64rvf/W6sWrUqurq6YvLkyRd9zuDgYAwODhZvFwqFsRoXACY0AciYuO+++4p/vu2222LhwoVx0003xf79+2P58uUXfU5HR0ds3bp1rEYEgGR4C5iyuPHGG2PmzJlx7NixS+6zZcuW6O/vL24nT54cwwkBYOJyBZCyeOutt+LMmTMxe/bsS+6Ty+Uil8uN4VQAkAYBSEmcO3duxNW848ePx5EjR6KmpiZqampi69atsW7duqirq4uenp549NFH4+abb47W1tYyTg0AaRKAlMTrr78eX/nKV4q329vbIyJi/fr1sWPHjjh69Gj8wz/8Q5w9ezbq6+tjxYoV8dd//deu8AFAGVRkWZaVewi4HIVCIfL5fCyL1TGlYmrJX/9K1t+NsKYuUDrvZUOxP/ZEf39/VFdXl3scEuBLIAAAiRGAAACJEYAAAIkRgAAAiRGAAACJEYAAAIkRgAAAiRGAAACJEYAAAIkRgAAAiRGAAACJmVLuAWA0Xcn6vtb2BSAVrgACACRGAAIAJEYAAgAkRgACACRGAAIAJEYAAgAkRgACACRGAAIAJEYAAgAkRgACACTGUnBMaJZ3g/HvSpZ0jPBzD5fDFUAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxFgLGICLupI1eEdz/V1r+0LpuQIIAJAYAQgAkBgBCACQGAEIAJAYAQgAkBgBCACQGAEIAJAYAQgAkBgBCACQGAEIAJAYS8EBjKIrWU4t4tpa9uxamgUoLVcAAQASIwApiY6Ojrj99tujqqoqZs2aFWvWrInu7u4R+5w/fz7a2tpixowZcf3118e6deuir6+vTBMDQLoEICXR2dkZbW1tcfDgwXjllVdiaGgoVqxYEQMDA8V9Nm/eHC+++GI8//zz0dnZGadOnYq1a9eWcWoASJPPAFISe/fuHXF7586dMWvWrDh8+HAsXbo0+vv74+/+7u9i165d8dWvfjUiIp555pn47Gc/GwcPHow77rijHGMDQJJcAWRU9Pf3R0RETU1NREQcPnw4hoaGoqWlpbjP/PnzY+7cudHV1XXR1xgcHIxCoTBiAwCungCk5IaHh2PTpk1x5513xoIFCyIiore3NyorK2P69Okj9q2trY3e3t6Lvk5HR0fk8/ni1tDQMNqjA0ASBCAl19bWFm+88UY899xzV/U6W7Zsif7+/uJ28uTJEk0IAGnzGUBKauPGjfHSSy/FgQMHYs6cOcX76+rq4sKFC3H27NkRVwH7+vqirq7uoq+Vy+Uil8uN9sgAkBxXACmJLMti48aNsXv37nj11VejsbFxxOOLFy+OqVOnxr59+4r3dXd3x4kTJ6K5uXmsxwWApLkCSEm0tbXFrl27Ys+ePVFVVVX8XF8+n49p06ZFPp+PDRs2RHt7e9TU1ER1dXU88sgj0dzc7BvAADDGBCAlsWPHjoiIWLZs2Yj7n3nmmXjggQciIuJHP/pRTJo0KdatWxeDg4PR2toaP/3pT8d4UgCgIsuyrNxDwOUoFAqRz+djWayOKRVTyz0OTHhXso6xdYOvznvZUOyPPdHf3x/V1dXlHocE+AwgAEBiBCAAQGIEIABAYgQgAEBiBCAAQGIEIABAYgQgAEBiBCAAQGIEIABAYgQgAEBirAUMwEVdK8u7XcmSdBHXztxwLXMFEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMVPKPQAAfJTW+i9c0f4vnzoyaq8NE4UrgAAAiRGAAACJEYAAAIkRgAAAiRGAAACJEYAAAIkRgAAAiRGAAACJEYAAAIkRgAAAiRGAAACJsRYwXIOsZQqfnJ8J+HiuAAIAJEYAUhIdHR1x++23R1VVVcyaNSvWrFkT3d3dI/ZZtmxZVFRUjNi+9a1vlWliAEiXAKQkOjs7o62tLQ4ePBivvPJKDA0NxYoVK2JgYGDEfg899FCcPn26uD355JNlmhgA0uUzgJTE3r17R9zeuXNnzJo1Kw4fPhxLly4t3n/ddddFXV3dWI8HAPwBVwAZFf39/RERUVNTM+L+n/3sZzFz5sxYsGBBbNmyJd59991Lvsbg4GAUCoURGwBw9VwBpOSGh4dj06ZNceedd8aCBQuK93/961+PefPmRX19fRw9ejS+853vRHd3d/ziF7+46Ot0dHTE1q1bx2psAEhGRZZlWbmHYGJ5+OGH45e//GW89tprMWfOnEvu9+qrr8by5cvj2LFjcdNNN33o8cHBwRgcHCzeLhQK0dDQEMtidUypmDoqs18r/BoYSMt72VDsjz3R398f1dXV5R6HBLgCSElt3LgxXnrppThw4MBHxl9ERFNTU0TEJQMwl8tFLpcblTkBIGUCkJLIsiweeeSR2L17d+zfvz8aGxs/9jlHjhyJiIjZs2eP8nQAwB8SgJREW1tb7Nq1K/bs2RNVVVXR29sbERH5fD6mTZsWPT09sWvXrrjrrrtixowZcfTo0di8eXMsXbo0Fi5cWObpASAtApCS2LFjR0T8/pc9/6FnnnkmHnjggaisrIxf/epXsW3bthgYGIiGhoZYt25dfO973yvDtACQNgFISXzcd4kaGhqis7NzjKYZ/3yxA/6/K/lSVISfH7gcfg8gAEBiBCAAQGIEIABAYgQgAEBiBCAAQGIEIABAYgQgAEBiBCAAQGIEIABAYgQgAEBiLAUHwFUbzeXaLO0GpecKIABAYgQgAEBiBCAAQGIEIABAYgQgAEBiBCAAQGIEIABAYgQgAEBiBCAAQGIEIABAYgQgAEBirAUMwFUbr+v1juYaxnAtcwUQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxloIDLskyWUx0/s6SKlcAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABJjLWDgkqyTykRnvWtS5QogJbFjx45YuHBhVFdXR3V1dTQ3N8cvf/nL4uPnz5+Ptra2mDFjRlx//fWxbt266OvrK+PEAJAuAUhJzJkzJ/7mb/4mDh8+HK+//np89atfjdWrV8e///u/R0TE5s2b48UXX4znn38+Ojs749SpU7F27doyTw0AaarIsiwr9xBMTDU1NfHUU0/F1772tbjhhhti165d8bWvfS0iIn7729/GZz/72ejq6oo77rjjsl6vUChEPp+PZbE6plRMHc3RgURcK28Bv5cNxf7YE/39/VFdXT0q/x3wh1wBpOTef//9eO6552JgYCCam5vj8OHDMTQ0FC0tLcV95s+fH3Pnzo2urq4yTgoAafIlEErmN7/5TTQ3N8f58+fj+uuvj927d8fnPve5OHLkSFRWVsb06dNH7F9bWxu9vb2XfL3BwcEYHBws3i4UCqM1OgAkxRVASubWW2+NI0eOxKFDh+Lhhx+O9evXx3/8x3984tfr6OiIfD5f3BoaGko4LQCkSwBSMpWVlXHzzTfH4sWLo6OjIxYtWhR/+7d/G3V1dXHhwoU4e/bsiP37+vqirq7ukq+3ZcuW6O/vL24nT54c5SMAgDQIQEbN8PBwDA4OxuLFi2Pq1Kmxb9++4mPd3d1x4sSJaG5uvuTzc7lc8dfKfLABAFfPZwApiS1btsSqVati7ty58c4778SuXbti//798fLLL0c+n48NGzZEe3t71NTURHV1dTzyyCPR3Nx82d8ABgBKRwBSEm+//Xb8+Z//eZw+fTry+XwsXLgwXn755fizP/uziIj40Y9+FJMmTYp169bF4OBgtLa2xk9/+tMyTw0AafJ7ABk3/B5ARsu18rvgSJffA8hY8xlAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDEWAuYceODVQvfi6EICxhSQoV3hq9o//eyoVGahFS9F7//O2V1VsaKtYAZN956661oaGgo9xgAo+bkyZMxZ86cco9BAgQg48bw8HCcOnUqqqqqoqKionh/oVCIhoaGOHny5IReRD2F40zhGCMc50RTiuPMsizeeeedqK+vj0mTfDqL0ectYMaNSZMmfeS/GVdXV0/of8h8IIXjTOEYIxznRHO1x5nP50s4DXw0/5oBAJAYAQgAkBgByLiXy+XiiSeeiFwuV+5RRlUKx5nCMUY4zokmleNkYvElEACAxLgCCACQGAEIAJAYAQgAkBgBCACQGAHIuLZ9+/b4kz/5k/jUpz4VTU1N8a//+q/lHqmkvv/970dFRcWIbf78+eUe66odOHAg7r777qivr4+Kiop44YUXRjyeZVk8/vjjMXv27Jg2bVq0tLTEm2++WZ5hr8LHHecDDzzwofO7cuXK8gz7CXV0dMTtt98eVVVVMWvWrFizZk10d3eP2Of8+fPR1tYWM2bMiOuvvz7WrVsXfX19ZZr4k7mc41y2bNmHzue3vvWtMk0MH00AMm79/Oc/j/b29njiiSfi3/7t32LRokXR2toab7/9drlHK6nPf/7zcfr06eL22muvlXukqzYwMBCLFi2K7du3X/TxJ598Mn784x/H008/HYcOHYpPf/rT0draGufPnx/jSa/Oxx1nRMTKlStHnN9nn312DCe8ep2dndHW1hYHDx6MV155JYaGhmLFihUxMDBQ3Gfz5s3x4osvxvPPPx+dnZ1x6tSpWLt2bRmnvnKXc5wREQ899NCI8/nkk0+WaWL4GBmMU0uWLMna2tqKt99///2svr4+6+joKONUpfXEE09kixYtKvcYoyoist27dxdvDw8PZ3V1ddlTTz1VvO/s2bNZLpfLnn322TJMWBr/+zizLMvWr1+frV69uizzjJa33347i4iss7Mzy7Lfn7upU6dmzz//fHGf//zP/8wiIuvq6irXmFftfx9nlmXZn/7pn2Z/+Zd/Wb6h4Aq4Asi4dOHChTh8+HC0tLQU75s0aVK0tLREV1dXGScrvTfffDPq6+vjxhtvjG984xtx4sSJco80qo4fPx69vb0jzm0+n4+mpqYJd24jIvbv3x+zZs2KW2+9NR5++OE4c+ZMuUe6Kv39/RERUVNTExERhw8fjqGhoRHnc/78+TF37txxfT7/93F+4Gc/+1nMnDkzFixYEFu2bIl33323HOPBx5pS7gHgk/jd734X77//ftTW1o64v7a2Nn7729+WaarSa2pqip07d8att94ap0+fjq1bt8aXv/zleOONN6Kqqqrc442K3t7eiIiLntsPHpsoVq5cGWvXro3Gxsbo6emJ7373u7Fq1aro6uqKyZMnl3u8KzY8PBybNm2KO++8MxYsWBARvz+flZWVMX369BH7jufzebHjjIj4+te/HvPmzYv6+vo4evRofOc734nu7u74xS9+UcZp4eIEIFzDVq1aVfzzwoULo6mpKebNmxf/9E//FBs2bCjjZJTCfffdV/zzbbfdFgsXLoybbrop9u/fH8uXLy/jZJ9MW1tbvPHGGxPic6of5VLH+c1vfrP459tuuy1mz54dy5cvj56enrjpppvGekz4SN4CZlyaOXNmTJ48+UPfJOzr64u6uroyTTX6pk+fHrfcckscO3as3KOMmg/OX2rnNiLixhtvjJkzZ47L87tx48Z46aWX4te//nXMmTOneH9dXV1cuHAhzp49O2L/8Xo+L3WcF9PU1BQRMS7PJxOfAGRcqqysjMWLF8e+ffuK9w0PD8e+ffuiubm5jJONrnPnzkVPT0/Mnj273KOMmsbGxqirqxtxbguFQhw6dGhCn9uIiLfeeivOnDkzrs5vlmWxcePG2L17d7z66qvR2Ng44vHFixfH1KlTR5zP7u7uOHHixLg6nx93nBdz5MiRiIhxdT5Jh7eAGbfa29tj/fr18cUvfjGWLFkS27Zti4GBgXjwwQfLPVrJfPvb346777475s2bF6dOnYonnngiJk+eHPfff3+5R7sq586dG3FV5Pjx43HkyJGoqamJuXPnxqZNm+IHP/hBfOYzn4nGxsZ47LHHor6+PtasWVO+oT+BjzrOmpqa2Lp1a6xbty7q6uqip6cnHn300bj55pujtbW1jFNfmba2tti1a1fs2bMnqqqqip/ry+fzMW3atMjn87Fhw4Zob2+PmpqaqK6ujkceeSSam5vjjjvuKPP0l+/jjrOnpyd27doVd911V8yYMSOOHj0amzdvjqVLl8bChQvLPD1cRLm/hgxX4yc/+Uk2d+7crLKyMluyZEl28ODBco9UUvfee282e/bsrLKyMvvjP/7j7N57782OHTtW7rGu2q9//essIj60rV+/Psuy3/8qmMceeyyrra3Ncrlctnz58qy7u7u8Q38CH3Wc7777brZixYrshhtuyKZOnZrNmzcve+ihh7Le3t5yj31FLnZ8EZE988wzxX3+53/+J/uLv/iL7I/+6I+y6667Lrvnnnuy06dPl2/oT+DjjvPEiRPZ0qVLs5qamiyXy2U333xz9ld/9VdZf39/eQeHS6jIsiwby+AEAKC8fAYQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAx/xf9aU2sZuRRcgAAAABJRU5ErkJggg==' width=640.0/>\n            </div>\n        ","content_type":"text/html"},"text/plain":{"content":"Canvas(toolbar=Toolbar(toolitems=[('Home', 'Reset original view', 'home', 'home'), ('Back', 'Back to previous …","content_type":"text/plain"}}},"children":[],"key":"gM7g3kj7EC"}],"key":"uTJiUXdVoB"}],"key":"bbHW8Kgg75"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This is basically what we want. And array of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WqKsqjutAw"},{"type":"inlineMath","value":"1s","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">1s</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"q15WS3WzYN"},{"type":"text","value":" at one position (the index where the maxes came from) in each row of our ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"E2rtv7NyQR"},{"type":"inlineCode","value":"logits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H6IQxdJNxj"},{"type":"text","value":" tensor. Therefore, let’s now add the second derivative component to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dSXxKHCWtp"},{"type":"inlineCode","value":"dlogits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DBXQFfiqVX"},{"type":"text","value":" and check for correctness.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y12dFGEpFi"}],"key":"H4yqnBI1j7"}],"key":"Ag1C50O25e"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dlogits += ones_maxes_indeces * dlogit_maxes\ncmp(\"logits\", dlogits, logits)","key":"Lh4GaVAZ6N"},{"type":"outputs","id":"UWH9hfrJ9cMl8w78lybvT","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"logits          | exact: True  | approximate: True  | maxdiff: 0.0\n"},"children":[],"key":"nAhoYPBkTI"}],"key":"Tprco0C1BG"}],"key":"Lk5el39svk"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Next up: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fSuibFRGK4"},{"type":"inlineCode","value":"logits = h @ w2 + b2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jwPZVT1rz4"},{"type":"text","value":". Let’s look at the shapes of all the intermediate tensors:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rEZGOfRlFz"}],"key":"VEOdKHN9v5"}],"key":"l2E7XOPCKO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"logits.shape, h.shape, w2.shape, b2.shape","key":"ViAfQw12R9"},{"type":"outputs","id":"rH5bGYlqqymgjrvz4h2Ri","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":48,"metadata":{},"data":{"text/plain":{"content":"(torch.Size([32, 27]),\n torch.Size([32, 64]),\n torch.Size([64, 27]),\n torch.Size([27]))","content_type":"text/plain"}}},"children":[],"key":"hpmpwCHAuO"}],"key":"PSTSyAbyw9"}],"key":"Zgu5HIMdy5"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now let’s see the shape of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zIgwdskPym"},{"type":"inlineCode","value":"h @ w2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ADNYMFsQLg"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WQ3Ep5zW4o"}],"key":"sB0QUXwFM0"}],"key":"EzELUS1ypT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"(h @ w2).shape","key":"xt59LnPoI8"},{"type":"outputs","id":"Dl55GoJvZZ_Mu3We90ACY","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":49,"metadata":{},"data":{"text/plain":{"content":"torch.Size([32, 27])","content_type":"text/plain"}}},"children":[],"key":"pfuFIOtgqS"}],"key":"BCRb5GuMhl"}],"key":"yT9L58e2RQ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This tells us that since the shape of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HiCYgeiHqK"},{"type":"inlineCode","value":"b2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dosyo45thP"},{"type":"text","value":" is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CiaP8MDjnF"},{"type":"text","value":"27","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hblzgXHJ9X"},{"type":"text","value":", the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A8QwZA0WEC"},{"type":"inlineCode","value":"h @ w2 + b2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hmeLFxgC9Y"},{"type":"text","value":" will first broadcast the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K3Ydr5H80v"},{"type":"inlineCode","value":"b2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OlTrMAW09d"},{"type":"text","value":" tensor into a shape of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dCWJQAMaHk"},{"type":"inlineMath","value":"1\\times27","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>×</mo><mn>27</mn></mrow><annotation encoding=\"application/x-tex\">1\\times27</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">27</span></span></span></span>","key":"yfUzO6Mw6C"},{"type":"text","value":" and then it will be replicated vertically along the columns (across the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WnPNMAR7da"},{"type":"text","value":"0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fdYWdt9YdY"},{"type":"text","value":" dimension) in order to give rise to a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Xcs9FpwPhs"},{"type":"inlineCode","value":"b2_replicated","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hBpXBjy9cI"},{"type":"text","value":" with a shape of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"btVH5OtsMs"},{"type":"inlineMath","value":"32\\times27","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>32</mn><mo>×</mo><mn>27</mn></mrow><annotation encoding=\"application/x-tex\">32\\times27</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">32</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">27</span></span></span></span>","key":"giIVaA0nsp"},{"type":"text","value":". But the question now is how do we ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PpW1MOppni"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FvPcL1dFV0"}],"key":"VdbB1fxyLR"},{"type":"text","value":" from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fN2sIIyTvi"},{"type":"inlineCode","value":"logits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gNJnEigmjH"},{"type":"text","value":" to the hidden states ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cwlOfl4nZ9"},{"type":"inlineCode","value":"h","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ECGQBRHWpL"},{"type":"text","value":", the weight matrix ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RkkcqolgDz"},{"type":"inlineCode","value":"w2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OzqJtukht7"},{"type":"text","value":" and the bias matrix ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"somFoltArb"},{"type":"inlineCode","value":"b2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z71tAnaTRg"},{"type":"text","value":"? Now you might think that we need to go to some matrix calculus textbook and look up the derivative for matrix multiplication. But actually first principles suffice here to derive this yourself on a piece of paper. Specifically, what works great in these types of situations is to find a specific small example that you then fully write out and then in the process of analyzing how that individual small example works out, you will understand a broader pattern and you’ll be able to generalize and write out the full general formula for how derivatives flow in an expression like this one. So let’s try that out:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fFbxKuu2Kj"}],"key":"IPtcOkiW6R"}],"key":"vgT1pAohYh"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"$d = a \\cdot b + c\\","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A3IsO4q6Ya"}],"key":"Gkw8LhONEp"},{"type":"math","value":"\\begin{bmatrix}\nd_{11} & d_{12} \\\\\nd_{21} & d_{22}\n\\end{bmatrix}","tight":true,"position":{"start":{"line":2,"column":1},"end":{"line":4,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>d</mi><mn>11</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>d</mi><mn>12</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>d</mi><mn>21</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>d</mi><mn>22</mn></msub></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\nd_{11} &amp; d_{12} \\\\\nd_{21} &amp; d_{22}\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">21</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">22</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span></span>","enumerator":"1","key":"IRlJQWkkYc"},{"type":"math","value":"\\begin{bmatrix}\na_{11} & a_{12} \\\\\na_{21} & a_{22}\n\\end{bmatrix}","tight":true,"position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>a</mi><mn>11</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>a</mi><mn>12</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>a</mi><mn>21</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>a</mi><mn>22</mn></msub></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\na_{11} &amp; a_{12} \\\\\na_{21} &amp; a_{22}\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">21</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">22</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span></span>","enumerator":"2","key":"rCgCJuTpmN"},{"type":"math","value":"\\begin{bmatrix}\nb_{11} & b_{12} \\\\\nb_{21} & b_{22}\n\\end{bmatrix}","tight":true,"position":{"start":{"line":10,"column":1},"end":{"line":12,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>b</mi><mn>11</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>b</mi><mn>12</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>b</mi><mn>21</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>b</mi><mn>22</mn></msub></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\nb_{11} &amp; b_{12} \\\\\nb_{21} &amp; b_{22}\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">21</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">22</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span></span>","enumerator":"3","key":"knhICw4MC0"},{"type":"math","value":"\\begin{bmatrix}\nc_{1} & c_{2}\n\\end{bmatrix}","tight":true,"position":{"start":{"line":14,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>2</mn></msub></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\nc_{1} &amp; c_{2}\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.35em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.85em;\"><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.85em;\"><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">]</span></span></span></span></span></span></span>","enumerator":"4","key":"q0jQ3J3tRL"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"d_{11} = a_{11}b_{11} + a_{12}b_{21} + c_1 \\\nd_{12} = a_{11}b_{12} + a_{12}b_{22} + c_2 \\\nd_{21} = a_{21}b_{11} + a_{22}b_{21} + c_1 \\\nd_{22} = a_{21}b_{12} + a_{22}b_{22} + c_2\n$","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"ZtoKne2uJV"}],"key":"HyPxGwLq61"}],"key":"RxisxVOZf5"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"where\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MjACNZvOI5"},{"type":"inlineMath","value":"\\begin{bmatrix}\nc_{1} & c_{2}\n\\end{bmatrix}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>2</mn></msub></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\nc_{1} &amp; c_{2}\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2em;vertical-align:-0.35em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.85em;\"><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.85em;\"><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">]</span></span></span></span></span></span>","key":"Q3eMgBkG4R"},{"type":"text","value":"\ngets implicitly replicated vertically into a\n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UkfWC0T7Mh"},{"type":"inlineMath","value":"\\begin{bmatrix}\nc_{1} & c_{2} \\\\\nc_{1} & c_{2}\n\\end{bmatrix}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>c</mi><mn>2</mn></msub></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\nc_{1} &amp; c_{2} \\\\\nc_{1} &amp; c_{2}\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span>","key":"esok0qKfkT"},{"type":"text","value":"\nin order for the addition to be a valid one. This is something that PyTorch also does. So as we know ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WKndHpGV8J"},{"type":"inlineCode","value":"dlogits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"chqlA5jkS1"},{"type":"text","value":", by analogy, assume we also know ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ofyTB4P4gC"},{"type":"inlineCode","value":"dd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XkGRnMm6qG"},{"type":"text","value":". And since we are looking for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M1FHrwmzwD"},{"type":"inlineCode","value":"dh","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tpM5TyNqXk"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CxjfmbKyND"},{"type":"inlineCode","value":"dw2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sCbLcF5m4s"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r0c1zX5IBa"},{"type":"inlineCode","value":"db2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xLh7U4CSAF"},{"type":"text","value":", in this simple example, by analogy, we are looking for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZQoO9slQGu"},{"type":"inlineCode","value":"da","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cjYOsiwcbi"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ye3PhFYmiy"},{"type":"inlineCode","value":"db","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D0yvXZS5tz"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iQG1sklKBh"},{"type":"inlineCode","value":"dc","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IML71wcrfB"},{"type":"text","value":". Let’s write them out by hand:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ir13jMFC94"}],"key":"QHWMk6pOh2"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"$\n\\dfrac{\\partial L}{\\partial a} =","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"jLnQKviVQM"}],"key":"pIu2fp3N0N"}],"key":"NBDDCEOYRC"}],"key":"rWOW68Iq4N"},{"type":"math","value":"\\begin{bmatrix}\n\\dfrac{\\partial L}{\\partial a_{11}} & \\dfrac{\\partial L}{\\partial a_{12}} \\\\\n\\dfrac{\\partial L}{\\partial a_{21}} & \\dfrac{\\partial L}{\\partial a_{22}}\n\\end{bmatrix}","tight":true,"position":{"start":{"line":13,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>a</mi><mn>11</mn></msub></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>a</mi><mn>12</mn></msub></mrow></mfrac></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>a</mi><mn>21</mn></msub></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>a</mi><mn>22</mn></msub></mrow></mfrac></mstyle></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\n\\dfrac{\\partial L}{\\partial a_{11}} &amp; \\dfrac{\\partial L}{\\partial a_{12}} \\\\\n\\dfrac{\\partial L}{\\partial a_{21}} &amp; \\dfrac{\\partial L}{\\partial a_{22}}\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.4149em;vertical-align:-1.9574em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.35em;\"><span style=\"top:-1.95em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-3.097em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.616em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V616 H319z M319 0 H403 V616 H319z'/></svg></span></span><span style=\"top:-4.35em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.85em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.4574em;\"><span style=\"top:-4.4574em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">21</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.9574em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.4574em;\"><span style=\"top:-4.4574em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">22</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.9574em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.35em;\"><span style=\"top:-1.95em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-3.097em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.616em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V616 H263z M263 0 H347 V616 H263z'/></svg></span></span><span style=\"top:-4.35em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.85em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"5","key":"pDp2VAF7Id"},{"type":"math","value":"\\begin{bmatrix}\n\\dfrac{\\partial L}{\\partial d_{11}}b_{11} + \\dfrac{\\partial L}{\\partial d_{12}}b_{12} & \\dfrac{\\partial L}{\\partial d_{11}}b_{21} + \\dfrac{\\partial L}{\\partial d_{12}}b_{22} \\\\\n\\dfrac{\\partial L}{\\partial d_{21}}b_{11} + \\dfrac{\\partial L}{\\partial d_{22}}b_{12} & \\dfrac{\\partial L}{\\partial d_{21}}b_{21} + \\dfrac{\\partial L}{\\partial d_{22}}b_{12}\n\\end{bmatrix}","tight":true,"position":{"start":{"line":17,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>11</mn></msub></mrow></mfrac></mstyle><msub><mi>b</mi><mn>11</mn></msub><mo>+</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>12</mn></msub></mrow></mfrac></mstyle><msub><mi>b</mi><mn>12</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>11</mn></msub></mrow></mfrac></mstyle><msub><mi>b</mi><mn>21</mn></msub><mo>+</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>12</mn></msub></mrow></mfrac></mstyle><msub><mi>b</mi><mn>22</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>21</mn></msub></mrow></mfrac></mstyle><msub><mi>b</mi><mn>11</mn></msub><mo>+</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>22</mn></msub></mrow></mfrac></mstyle><msub><mi>b</mi><mn>12</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>21</mn></msub></mrow></mfrac></mstyle><msub><mi>b</mi><mn>21</mn></msub><mo>+</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>22</mn></msub></mrow></mfrac></mstyle><msub><mi>b</mi><mn>12</mn></msub></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\n\\dfrac{\\partial L}{\\partial d_{11}}b_{11} + \\dfrac{\\partial L}{\\partial d_{12}}b_{12} &amp; \\dfrac{\\partial L}{\\partial d_{11}}b_{21} + \\dfrac{\\partial L}{\\partial d_{12}}b_{22} \\\\\n\\dfrac{\\partial L}{\\partial d_{21}}b_{11} + \\dfrac{\\partial L}{\\partial d_{22}}b_{12} &amp; \\dfrac{\\partial L}{\\partial d_{21}}b_{21} + \\dfrac{\\partial L}{\\partial d_{22}}b_{12}\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.4149em;vertical-align:-1.9574em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.35em;\"><span style=\"top:-1.95em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-3.097em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.616em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V616 H319z M319 0 H403 V616 H319z'/></svg></span></span><span style=\"top:-4.35em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.85em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.4574em;\"><span style=\"top:-4.4574em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">21</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">22</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.9574em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.4574em;\"><span style=\"top:-4.4574em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">21</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">22</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">21</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">21</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">22</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.9574em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.35em;\"><span style=\"top:-1.95em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-3.097em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.616em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V616 H263z M263 0 H347 V616 H263z'/></svg></span></span><span style=\"top:-4.35em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.85em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"6","key":"re7siqdjq1"},{"type":"math","value":"\\begin{bmatrix}\n\\dfrac{\\partial L}{\\partial d_{11}} & \\dfrac{\\partial L}{\\partial d_{12}} \\\\\n\\dfrac{\\partial L}{\\partial d_{21}} & \\dfrac{\\partial L}{\\partial d_{22}}\n\\end{bmatrix}","tight":true,"position":{"start":{"line":21,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>11</mn></msub></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>12</mn></msub></mrow></mfrac></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>21</mn></msub></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>22</mn></msub></mrow></mfrac></mstyle></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\n\\dfrac{\\partial L}{\\partial d_{11}} &amp; \\dfrac{\\partial L}{\\partial d_{12}} \\\\\n\\dfrac{\\partial L}{\\partial d_{21}} &amp; \\dfrac{\\partial L}{\\partial d_{22}}\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.4149em;vertical-align:-1.9574em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.35em;\"><span style=\"top:-1.95em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-3.097em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.616em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V616 H319z M319 0 H403 V616 H319z'/></svg></span></span><span style=\"top:-4.35em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.85em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.4574em;\"><span style=\"top:-4.4574em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">21</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.9574em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.4574em;\"><span style=\"top:-4.4574em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">22</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.9574em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.35em;\"><span style=\"top:-1.95em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-3.097em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.616em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V616 H263z M263 0 H347 V616 H263z'/></svg></span></span><span style=\"top:-4.35em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.85em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"7","key":"CamNkh3a4R"},{"type":"math","value":"\\begin{bmatrix}\nb_{11} & b_{21} \\\\\nb_{12} & b_{22}\n\\end{bmatrix}","tight":true,"position":{"start":{"line":25,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>b</mi><mn>11</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>b</mi><mn>21</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>b</mi><mn>12</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>b</mi><mn>22</mn></msub></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\nb_{11} &amp; b_{21} \\\\\nb_{12} &amp; b_{22}\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">21</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">22</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span></span>","enumerator":"8","key":"KkGrxWsNIh"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"\\dfrac{\\partial L}{\\partial d} \\cdot b^T\n$","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"iOETa0owtK"}],"key":"LkL4slTv7h"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"$\\dfrac{\\partial L}{\\partial b} =","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"GTubRoq7ot"}],"key":"B1y3PHcNaX"}],"key":"YRY3hMSuHk"}],"key":"hFDsW8JVvX"},{"type":"math","value":"\\begin{bmatrix}\n\\dfrac{\\partial L}{\\partial b_{11}} & \\dfrac{\\partial L}{\\partial b_{12}} \\\\\n\\dfrac{\\partial L}{\\partial b_{21}} & \\dfrac{\\partial L}{\\partial b_{22}}\n\\end{bmatrix}","tight":true,"position":{"start":{"line":33,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>b</mi><mn>11</mn></msub></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>b</mi><mn>12</mn></msub></mrow></mfrac></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>b</mi><mn>21</mn></msub></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>b</mi><mn>22</mn></msub></mrow></mfrac></mstyle></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\n\\dfrac{\\partial L}{\\partial b_{11}} &amp; \\dfrac{\\partial L}{\\partial b_{12}} \\\\\n\\dfrac{\\partial L}{\\partial b_{21}} &amp; \\dfrac{\\partial L}{\\partial b_{22}}\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.4149em;vertical-align:-1.9574em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.35em;\"><span style=\"top:-1.95em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-3.097em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.616em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V616 H319z M319 0 H403 V616 H319z'/></svg></span></span><span style=\"top:-4.35em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.85em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.4574em;\"><span style=\"top:-4.4574em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">21</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.9574em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.4574em;\"><span style=\"top:-4.4574em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">22</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.9574em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.35em;\"><span style=\"top:-1.95em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-3.097em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.616em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V616 H263z M263 0 H347 V616 H263z'/></svg></span></span><span style=\"top:-4.35em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.85em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"9","key":"XLEAsqU7r1"},{"type":"math","value":"\\begin{bmatrix}\na_{11}\\dfrac{\\partial L}{\\partial d_{11}} + a_{21}\\dfrac{\\partial L}{\\partial d_{21}} & a_{11}\\dfrac{\\partial L}{\\partial d_{12}} + a_{21}\\dfrac{\\partial L}{\\partial d_{22}} \\\\\na_{12}\\dfrac{\\partial L}{\\partial d_{11}} + a_{22}\\dfrac{\\partial L}{\\partial d_{21}} & a_{12}\\dfrac{\\partial L}{\\partial d_{12}} + a_{22}\\dfrac{\\partial L}{\\partial d_{22}}\n\\end{bmatrix}","tight":true,"position":{"start":{"line":37,"column":1},"end":{"line":39,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mi>a</mi><mn>11</mn></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>11</mn></msub></mrow></mfrac></mstyle><mo>+</mo><msub><mi>a</mi><mn>21</mn></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>21</mn></msub></mrow></mfrac></mstyle></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mi>a</mi><mn>11</mn></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>12</mn></msub></mrow></mfrac></mstyle><mo>+</mo><msub><mi>a</mi><mn>21</mn></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>22</mn></msub></mrow></mfrac></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mi>a</mi><mn>12</mn></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>11</mn></msub></mrow></mfrac></mstyle><mo>+</mo><msub><mi>a</mi><mn>22</mn></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>21</mn></msub></mrow></mfrac></mstyle></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><msub><mi>a</mi><mn>12</mn></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>12</mn></msub></mrow></mfrac></mstyle><mo>+</mo><msub><mi>a</mi><mn>22</mn></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>22</mn></msub></mrow></mfrac></mstyle></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\na_{11}\\dfrac{\\partial L}{\\partial d_{11}} + a_{21}\\dfrac{\\partial L}{\\partial d_{21}} &amp; a_{11}\\dfrac{\\partial L}{\\partial d_{12}} + a_{21}\\dfrac{\\partial L}{\\partial d_{22}} \\\\\na_{12}\\dfrac{\\partial L}{\\partial d_{11}} + a_{22}\\dfrac{\\partial L}{\\partial d_{21}} &amp; a_{12}\\dfrac{\\partial L}{\\partial d_{12}} + a_{22}\\dfrac{\\partial L}{\\partial d_{22}}\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.4149em;vertical-align:-1.9574em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.35em;\"><span style=\"top:-1.95em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-3.097em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.616em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V616 H319z M319 0 H403 V616 H319z'/></svg></span></span><span style=\"top:-4.35em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.85em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.4574em;\"><span style=\"top:-4.4574em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">21</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">21</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">22</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">21</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.9574em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.4574em;\"><span style=\"top:-4.4574em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">21</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">22</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">22</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">22</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.9574em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.35em;\"><span style=\"top:-1.95em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-3.097em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.616em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V616 H263z M263 0 H347 V616 H263z'/></svg></span></span><span style=\"top:-4.35em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.85em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"10","key":"ssOpGast3K"},{"type":"math","value":"\\begin{bmatrix}\na_{11} & a_{21} \\\\\na_{12} & a_{22}\n\\end{bmatrix}","tight":true,"position":{"start":{"line":41,"column":1},"end":{"line":43,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>a</mi><mn>11</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>a</mi><mn>21</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>a</mi><mn>12</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><msub><mi>a</mi><mn>22</mn></msub></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\na_{11} &amp; a_{21} \\\\\na_{12} &amp; a_{22}\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.45em;\"><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">21</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">22</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.95em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span></span>","enumerator":"11","key":"W4a74zZPwo"},{"type":"math","value":"\\begin{bmatrix}\n\\dfrac{\\partial L}{\\partial d_{11}} & \\dfrac{\\partial L}{\\partial d_{12}} \\\\\n\\dfrac{\\partial L}{\\partial d_{21}} & \\dfrac{\\partial L}{\\partial d_{22}}\n\\end{bmatrix}","tight":true,"position":{"start":{"line":45,"column":1},"end":{"line":47,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>11</mn></msub></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>12</mn></msub></mrow></mfrac></mstyle></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>21</mn></msub></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>22</mn></msub></mrow></mfrac></mstyle></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\n\\dfrac{\\partial L}{\\partial d_{11}} &amp; \\dfrac{\\partial L}{\\partial d_{12}} \\\\\n\\dfrac{\\partial L}{\\partial d_{21}} &amp; \\dfrac{\\partial L}{\\partial d_{22}}\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.4149em;vertical-align:-1.9574em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.35em;\"><span style=\"top:-1.95em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-3.097em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.616em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V616 H319z M319 0 H403 V616 H319z'/></svg></span></span><span style=\"top:-4.35em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.85em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.4574em;\"><span style=\"top:-4.4574em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">21</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.9574em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.4574em;\"><span style=\"top:-4.4574em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-2.25em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">22</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.9574em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.35em;\"><span style=\"top:-1.95em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-3.097em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span style=\"height:0.616em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='0.616em' style='width:0.6667em' viewBox='0 0 666.67 616' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V616 H263z M263 0 H347 V616 H263z'/></svg></span></span><span style=\"top:-4.35em;\"><span class=\"pstrut\" style=\"height:3.155em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.85em;\"><span></span></span></span></span></span></span></span></span></span></span></span>","enumerator":"12","key":"Eq8G3de5bE"},{"type":"paragraph","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"a^T \\cdot \\dfrac{\\partial L}{\\partial d}$","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"EaVReVzFyN"}],"key":"WMhhybRKQ6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"$\\dfrac{\\partial L}{\\partial c} =","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"uRtoK7Js3r"}],"key":"InkQrG6NuU"}],"key":"InjZfCkdOf"}],"key":"hNy6bGGHce"},{"type":"math","value":"\\begin{bmatrix}\n\\dfrac{\\partial L}{\\partial c_{1}} & \\dfrac{\\partial L}{\\partial c_{2}}\n\\end{bmatrix}","tight":true,"position":{"start":{"line":51,"column":1},"end":{"line":52,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>c</mi><mn>1</mn></msub></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>c</mi><mn>2</mn></msub></mrow></mfrac></mstyle></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\n\\dfrac{\\partial L}{\\partial c_{1}} &amp; \\dfrac{\\partial L}{\\partial c_{2}}\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3537em;\"><span style=\"top:-3.3537em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8537em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3537em;\"><span style=\"top:-3.3537em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8537em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span></span>","enumerator":"13","key":"GFTahugYdO"},{"type":"math","value":"\\begin{bmatrix}\n\\dfrac{\\partial L}{\\partial c_{1}} & \\dfrac{\\partial L}{\\partial c_{2}} \\\\\n\\end{bmatrix}","tight":true,"position":{"start":{"line":54,"column":1},"end":{"line":55,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>c</mi><mn>1</mn></msub></mrow></mfrac></mstyle></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>c</mi><mn>2</mn></msub></mrow></mfrac></mstyle></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\n\\dfrac{\\partial L}{\\partial c_{1}} &amp; \\dfrac{\\partial L}{\\partial c_{2}} \\\\\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3537em;\"><span style=\"top:-3.3537em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8537em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3537em;\"><span style=\"top:-3.3537em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8537em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span></span>","enumerator":"14","key":"zb8s2K7ufk"},{"type":"math","value":"\\begin{bmatrix}\n1\\dfrac{\\partial L}{\\partial d_{11}} + 1\\dfrac{\\partial L}{\\partial d_{21}} & 1\\dfrac{\\partial L}{\\partial d_{12}} + 1\\dfrac{\\partial L}{\\partial d_{22}}\n\\end{bmatrix}","tight":true,"position":{"start":{"line":57,"column":1},"end":{"line":58,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mn>1</mn><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>11</mn></msub></mrow></mfrac></mstyle><mo>+</mo><mn>1</mn><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>21</mn></msub></mrow></mfrac></mstyle></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mn>1</mn><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>12</mn></msub></mrow></mfrac></mstyle><mo>+</mo><mn>1</mn><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>d</mi><mn>22</mn></msub></mrow></mfrac></mstyle></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\n1\\dfrac{\\partial L}{\\partial d_{11}} + 1\\dfrac{\\partial L}{\\partial d_{21}} &amp; 1\\dfrac{\\partial L}{\\partial d_{12}} + 1\\dfrac{\\partial L}{\\partial d_{22}}\n\\end{bmatrix}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3537em;\"><span style=\"top:-3.3537em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">21</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8537em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3537em;\"><span style=\"top:-3.3537em;\"><span class=\"pstrut\" style=\"height:3.3714em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">22</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8537em;\"><span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span></span>","enumerator":"15","key":"pLU8JSzQe9"},{"type":"paragraph","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"text","value":"(\\dfrac{\\partial L}{\\partial d}).sum(0)$","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"cmlMllci9j"}],"key":"vxChtiyXi4"}],"key":"UFd74k0n7U"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"After calculating these derivatives, long story short, the backward pass of a matrix multiply is a matrix multiply. Therefore, just like we had ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o9LoYP6Isd"},{"type":"inlineCode","value":"d = a * b + c","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ynxtkaeSC4"},{"type":"text","value":" (scalar case), so does ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RpjzCNcZOp"},{"type":"inlineCode","value":"d = a @ b + c","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kwcOKClHcy"},{"type":"text","value":" (matrix case) lead us to something very very similar but now with a matrix multiplication instead of a scalar multiplication. In both cases: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RgObi524IZ"},{"type":"inlineCode","value":"da = dd @ b.T","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ptva84J1oL"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jVoRzcOmk0"},{"type":"inlineCode","value":"db = a.T @ dd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ufCscE1pR8"},{"type":"text","value":" we have matrix multiplication with both ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nPzSOcHmqE"},{"type":"inlineCode","value":"dd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Kj7i9fsPPV"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dMO4IIIQGW"},{"type":"inlineCode","value":"da","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nX2C6sSyrJ"},{"type":"text","value":" or ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"d22qTeefMb"},{"type":"inlineCode","value":"db","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qOMh8tIhWj"},{"type":"text","value":" terms involved, whereas ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ouYS6m4C0N"},{"type":"inlineCode","value":"dc","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Eb8oY1J9PX"},{"type":"text","value":" is simply a sum: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IF06vAF6Rj"},{"type":"inlineCode","value":"dc = dd.sum(0)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zGjXd6hdv9"},{"type":"text","value":". Now here’s a dirty little secret: you don’t need to remember the formulas we just derived for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Q1X2aonpG3"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ExHJY5JOyB"}],"key":"p28yTnteLO"},{"type":"text","value":"agating through matrix multiplication. You can ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EdHdTMM2TA"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pXzqyXvs1v"}],"key":"eaeycfpbwz"},{"type":"text","value":" through these expressions just fine. And the reason this works is because the dimensions have to work out. Let’s see an example. Consider ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KED10GIAVj"},{"type":"inlineCode","value":"h @ w2 + b2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TcP68OxqLp"},{"type":"text","value":". What is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pxNPdRuRa9"},{"type":"inlineCode","value":"dh","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ToFOWId1rN"},{"type":"text","value":"? The shape of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CpDWhjUdGS"},{"type":"inlineCode","value":"dh","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"veTLxf2psz"},{"type":"text","value":" must be the same as the shape of h:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wzggk6H2KV"}],"key":"dl23PQ0G7A"}],"key":"HMVjIt9MOr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"h.shape","key":"aW0Vgts1t8"},{"type":"outputs","id":"y7ddLo4KJU1eNLk_8Kojs","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":50,"metadata":{},"data":{"text/plain":{"content":"torch.Size([32, 64])","content_type":"text/plain"}}},"children":[],"key":"CtY9lKBWrf"}],"key":"p8nfecXCM6"}],"key":"r6xERhfbL0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And then the other piece of information we now know is that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JMKiUPEsy1"},{"type":"inlineCode","value":"dh","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Rq1lF3M2qG"},{"type":"text","value":" must be some kind of matrix multiplication of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UpaiSb94ok"},{"type":"inlineCode","value":"dlogits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jw0EoB3quN"},{"type":"text","value":" with ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JTqonekO7W"},{"type":"inlineCode","value":"w2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qbxvSLwpG6"},{"type":"text","value":". Let’s see the shapes:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Rb6yNmbYjY"}],"key":"KZHEQa6ZpK"}],"key":"yPKMZZfdS9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dlogits.shape, h.shape, w2.shape, b2.shape","key":"MgiL5fktYp"},{"type":"outputs","id":"VymQe6AiQ27c7qYuovPKU","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":51,"metadata":{},"data":{"text/plain":{"content":"(torch.Size([32, 27]),\n torch.Size([32, 64]),\n torch.Size([64, 27]),\n torch.Size([27]))","content_type":"text/plain"}}},"children":[],"key":"m2VI9Qudzs"}],"key":"wsrIEa2H1r"}],"key":"rE4Cmq8XWD"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So since ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zo5gMF6c9a"},{"type":"inlineCode","value":"dlogits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Hvq84OwqNK"},{"type":"text","value":" is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XinmUHJUtR"},{"type":"inlineMath","value":"32\\times27","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>32</mn><mo>×</mo><mn>27</mn></mrow><annotation encoding=\"application/x-tex\">32\\times27</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">32</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">27</span></span></span></span>","key":"OzMkpT2gVx"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MFJ2W3WD6H"},{"type":"inlineCode","value":"w2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hxxpeWb9s3"},{"type":"text","value":" is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vAI19nIOT6"},{"type":"inlineMath","value":"64\\times27","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>64</mn><mo>×</mo><mn>27</mn></mrow><annotation encoding=\"application/x-tex\">64\\times27</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">64</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">27</span></span></span></span>","key":"XBZoudlYbW"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tkqfzZeyG9"},{"type":"inlineCode","value":"h","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UyLiNibL67"},{"type":"text","value":" is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pw06YnToo6"},{"type":"inlineMath","value":"32\\times64","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>32</mn><mo>×</mo><mn>64</mn></mrow><annotation encoding=\"application/x-tex\">32\\times64</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">32</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">64</span></span></span></span>","key":"BOo46GiYCl"},{"type":"text","value":" there is only a single way to make the shape work out in this case. Namely, the only way to achieve ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bIsPIHT1kp"},{"type":"inlineCode","value":"dh","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o6H3ylsocn"},{"type":"text","value":" with size ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rL5F81xnR0"},{"type":"inlineMath","value":"32\\times64","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>32</mn><mo>×</mo><mn>64</mn></mrow><annotation encoding=\"application/x-tex\">32\\times64</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">32</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">64</span></span></span></span>","key":"UtC1rOz79p"},{"type":"text","value":" (the size of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Q8Gy1tg7u7"},{"type":"inlineCode","value":"h","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Oi6OAMhsao"},{"type":"text","value":") is to matrix multiply ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V8gMiIpqRC"},{"type":"inlineCode","value":"dlogits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ksJKJMVJ68"},{"type":"text","value":" with the transpose of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DnKb3KAvmM"},{"type":"inlineCode","value":"w2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gO6XP6mhKA"},{"type":"text","value":" (in order to make the dimensions work out):","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"G3JgM1vMTo"}],"key":"rh9ppuu0Qf"}],"key":"j6BZE2lFHX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dh = dlogits @ w2.T","key":"PLGZOMhwS2"},{"type":"outputs","id":"Krr0asrxvmXwkTY1kDt2O","children":[],"key":"BIdV2L0hyg"}],"key":"RYdZBAq9R7"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And it is the only way to make these to matrix multiply those two pieces to make the shapes work out. And that turns out to be the correct formula, since, by analogy, as we saw in our simple example: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YXzpgNuz85"},{"type":"inlineCode","value":"da = dd @ b.T","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oevzyjwm5r"},{"type":"text","value":". So there’s no real need to remember these formulas. Similarly, knowing that each parameter derivative must end up with the target shape of the parameter:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JqrJ7wjrJ8"}],"key":"BdEcTt9E5V"}],"key":"NZHBYNP4IP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dw2 = h.T @ dlogits  # 64x32 @ 32x27 -> 64x27\ndb2 = dlogits.sum(0, keepdim=True)  # 32x27 -> 27","key":"VmRdPlvvPs"},{"type":"outputs","id":"Ky6xyOV1srrFCsJW-5Nxq","children":[],"key":"qd5BcD1pw5"}],"key":"IHxC5Ctj5Y"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So that’s the intuitive, hacky way of findings matrix parameter derivatives. Let’s check if we got ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"idJXbOb7Bc"},{"type":"inlineCode","value":"dh","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"b5vbwz4816"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CA4WWf3vz6"},{"type":"inlineCode","value":"dw2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qiR8LpJrWc"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WzpebOWMPs"},{"type":"inlineCode","value":"db2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UAq0xQm6lF"},{"type":"text","value":" correct:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jhX3Q5R5YJ"}],"key":"YODyoBsaI5"}],"key":"LxgDkQmbnV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cmp(\"h\", dh, h)\ncmp(\"w2\", dw2, w2)\ncmp(\"b2\", db2, b2)","key":"Zv48THQW6w"},{"type":"outputs","id":"iQdamsDjP426PZy6DeZXN","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"h               | exact: True  | approximate: True  | maxdiff: 0.0\nw2              | exact: True  | approximate: True  | maxdiff: 0.0\nb2              | exact: True  | approximate: True  | maxdiff: 0.0\n"},"children":[],"key":"nhlgHD8KQD"}],"key":"VImbghsOxU"}],"key":"rd7yR5Js8t"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exactly! Nice. We have ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H8BbYI7idO"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VSQ4QWknOe"}],"key":"f3XrDQSncy"},{"type":"text","value":"ed through a linear layer. Woohoo! Next up for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"apwjfZLW8v"},{"type":"inlineCode","value":"h = torch.tanh(hpreact)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tqvsKYOeEk"},{"type":"text","value":", we already have ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GjPe68lByZ"},{"type":"inlineCode","value":"dh","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JqAs2BYAs4"},{"type":"text","value":" and we now need to backpropagate through ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CUfBzg6uIB"},{"type":"inlineCode","value":"tanh","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VMa7eu2dLt"},{"type":"text","value":" into ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DvY63wEEHq"},{"type":"inlineCode","value":"hpreact","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WSkk9BirtO"},{"type":"text","value":", which means we are looking for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bLLFy3VUd5"},{"type":"inlineCode","value":"dhpreact","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FLvEc58svl"},{"type":"text","value":". If you remember, we have already done something similar in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lSsSecIj9q"},{"type":"link","url":"#1.-micrograd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"micrograd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XfmJNTWFZB"}],"key":"Qn9XMDaQzI"}],"urlSource":"#1.-micrograd","key":"GXCyIHM3Nm"},{"type":"text","value":" and we remember that ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uZ9vfyMQqR"},{"type":"link","url":"https://en.wikipedia.org/wiki/Hyperbolic_functions#Derivatives","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineMath","value":"tanh","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">tanh</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">anh</span></span></span></span>","key":"HCHfxFHugm"},{"type":"text","value":" has a very simple derivative","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fsrhXGgR3n"}],"urlSource":"https://en.wikipedia.org/wiki/Hyperbolic_functions#Derivatives","data":{"page":"Hyperbolic_functions#Derivatives","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"jPtr7BDsW9"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SjvmYvYe2q"}],"key":"etrGFsr7Ka"}],"key":"rgKGQnX0k3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dhpreact = (1.0 - h**2) * dh\ncmp(\"hpreact\", dhpreact, hpreact)","key":"i6g9q6SoAW"},{"type":"outputs","id":"KpUvuqvq6_rJnODPW39W0","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"hpreact         | exact: False | approximate: True  | maxdiff: 4.656612873077393e-10\n"},"children":[],"key":"CD0zkK4qAI"}],"key":"Kwt6HFWqMR"}],"key":"ysyjn1wNF3"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here, we notice that there only an approximate (and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZDAm3MNSbM"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"not","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VkhEftcjxo"}],"key":"OJzO9MMOkb"},{"type":"text","value":" an exact) equality between the the PyTorch gradient values and our own. This can be attributed to tiny floating point imprecision or perhaps a bug that has to do with specific library versions. Since the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cbsoFZRoPB"},{"type":"inlineCode","value":"maxdiff","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iH1s730LeT"},{"type":"text","value":" is negligible, we can ignore the slight difference and safely assume that they are indeed exactly equal and make the assignment (in order to avoid any potential accumulation of slight differences and further exact inequalities):","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Vl0ZLYfiOo"}],"key":"dY5aoJTXW2"}],"key":"hJZzxGGVxY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dhpreact = hpreact.grad\ncmp(\"hpreact\", dhpreact, hpreact)","key":"yYI0FVhzB0"},{"type":"outputs","id":"rAUgAH_1XL9W2D7ol2cOX","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"hpreact         | exact: True  | approximate: True  | maxdiff: 0.0\n"},"children":[],"key":"YO2VDjoJpG"}],"key":"KNpKhKvO2Z"}],"key":"ip4KJC8XSY"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Okay, next up we have ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Mow2dVSEfn"},{"type":"inlineCode","value":"dhpreact","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HPKwsXxRDx"},{"type":"text","value":" and now we want to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"owFCKowZZ8"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DzOdRbfPP7"}],"key":"RPP6YA4yIO"},{"type":"text","value":" through the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UF15FZmSzR"},{"type":"inlineCode","value":"bngain","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HBfVCf8bFe"},{"type":"text","value":", the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iDxBej2Y1K"},{"type":"inlineCode","value":"bnraw","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Cig1TGuhS8"},{"type":"text","value":" and the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QNaYjOAT1s"},{"type":"inlineCode","value":"bnbias","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rddlrwQZFu"},{"type":"text","value":" (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P9nIlY0cXP"},{"type":"inlineCode","value":"hpreact = bngain * bnraw + bnbias","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zhHaveN6pv"},{"type":"text","value":"). So here these are the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"R5D2wvEIOC"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"batchnorm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IEdc9pSV9r"}],"key":"qWSXEFVbNd"},{"type":"text","value":" parameters: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZiT0kN2vph"},{"type":"inlineCode","value":"bngain","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tEdjg1dRkV"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WxkBvWExRF"},{"type":"inlineCode","value":"bnbias","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U1E3bsxmNj"},{"type":"text","value":"  that take the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"I8uxgeavgG"},{"type":"inlineCode","value":"bnraw","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QuW8xPrllx"},{"type":"text","value":" that is exact unit Gaussian and they scale it and shift it. Here, we have a multiplication (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XypRhU80MO"},{"type":"inlineCode","value":"*","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OgWtXj20sK"},{"type":"text","value":"), but it’s worth noting that this multiply is very very different from the matrix multiply ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mc2L9z75u9"},{"type":"inlineCode","value":"@","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uHdEcwaxNB"},{"type":"text","value":" (e.g. in the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yU6stY3Lex"},{"type":"inlineCode","value":"logits = h @ w2 + b2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Mb50OUJdYq"},{"type":"text","value":" we saw previously). matrix multiply means dot products between rows and columns of the involved matrices (e.g. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NYTb49cXMc"},{"type":"inlineCode","value":"h","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OdMnvVQzGv"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pCKM8XE3wY"},{"type":"inlineCode","value":"w2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z24GffBwNI"},{"type":"text","value":"). Whereas, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ixSedjloXQ"},{"type":"inlineCode","value":"*","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"En7YrqRj1s"},{"type":"text","value":" is an element wise multiply so things are quite a bit simpler. Yet, still, we do have to be careful with some of the broadcasting happening in this line of code though: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KxlT2EsXEL"},{"type":"inlineCode","value":"hpreact = bngain * bnraw + bnbias","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bFHIT8Z2l8"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KWepGGTcWZ"}],"key":"Yshnd9Zja7"}],"key":"DmZwPSbxON"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"hpreact.shape, bngain.shape, bnraw.shape, bnbias.shape","key":"Uv2dAAKANC"},{"type":"outputs","id":"GF4NZ-tX4yZYhO9WBnHkl","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":57,"metadata":{},"data":{"text/plain":{"content":"(torch.Size([32, 64]),\n torch.Size([1, 64]),\n torch.Size([32, 64]),\n torch.Size([1, 64]))","content_type":"text/plain"}}},"children":[],"key":"u5T616dvHb"}],"key":"efMmrQTMrC"}],"key":"SsZq5yM5uJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"You see how ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u2OQYYFG3N"},{"type":"inlineCode","value":"bngain","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YKK45q8462"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FLwFEWPDtu"},{"type":"inlineCode","value":"bnbias","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fjDubFSLY5"},{"type":"text","value":" are ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B6pPIYyTz2"},{"type":"inlineMath","value":"1\\times64","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>×</mo><mn>64</mn></mrow><annotation encoding=\"application/x-tex\">1\\times64</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">64</span></span></span></span>","key":"uN4zeJaghc"},{"type":"text","value":" but ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IS3ovt3i4I"},{"type":"inlineCode","value":"hpreact","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VnyXCOwDH4"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pLaCmEimgP"},{"type":"inlineCode","value":"bnraw","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ADjk37MutG"},{"type":"text","value":" are ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uQ2b5QsC3T"},{"type":"inlineMath","value":"32\\times64","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>32</mn><mo>×</mo><mn>64</mn></mrow><annotation encoding=\"application/x-tex\">32\\times64</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">32</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">64</span></span></span></span>","key":"CF7Ci6hvHW"},{"type":"text","value":". We have to be careful with that and make sure that all the shapes work out fine and that the broadcasting is correctly ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HrySTzgFec"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"I86qdHVVsB"}],"key":"U0GdOOICbP"},{"type":"text","value":"agated. Let’s start with calculating ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jxWMaeR3Ou"},{"type":"inlineCode","value":"dbngain","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aPiuDs0oGZ"},{"type":"text","value":". Using the chain rule:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fRoW6ELo3y"}],"key":"LIFKyDic0H"}],"key":"oKGlADpeRZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dbngain = bnraw * dhpreact","key":"hpiEz299X1"},{"type":"outputs","id":"QNqxc84ml3Q-QkmOzipZG","children":[],"key":"luje880OwP"}],"key":"yNSzEGB9pV"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"But this is incorrect. We have to be careful, since ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CwsImNCisb"},{"type":"inlineCode","value":"bngain","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JVdBIXClKj"},{"type":"text","value":" is of size ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OqPe5DoCuq"},{"type":"inlineMath","value":"1\\times64","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>×</mo><mn>64</mn></mrow><annotation encoding=\"application/x-tex\">1\\times64</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">64</span></span></span></span>","key":"XG3chAAi6i"},{"type":"text","value":", which is the size ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y8A1Bu7lpY"},{"type":"inlineCode","value":"dbngain","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t0vIz68H5v"},{"type":"text","value":" has to have. However, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qWEHWP8Lbe"},{"type":"inlineCode","value":"bnraw * dhpreact","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ETd1XYElH1"},{"type":"text","value":" has a size of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WrurSRHSUK"},{"type":"inlineMath","value":"32x64","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>32</mn><mi>x</mi><mn>64</mn></mrow><annotation encoding=\"application/x-tex\">32x64</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">32</span><span class=\"mord mathnormal\">x</span><span class=\"mord\">64</span></span></span></span>","key":"VIRcYLmmRz"},{"type":"text","value":". So the correct thing to do in this case of course is to sum across the examples/rows dimension while being careful to keep the number of dimensions the same:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nWos4w6ygD"}],"key":"JaJidKq8kq"}],"key":"nzCDqFczj7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dbngain = (bnraw * dhpreact).sum(0, keepdim=True)","key":"y2oKCqSd6S"},{"type":"outputs","id":"JCLbPoZc4o47S96NDIN6w","children":[],"key":"uOEcVasJzH"}],"key":"swPZqxIvkz"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And now the dimensions are correct! Similarly:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bVQMWkV9kS"}],"key":"TD4MFGjYMp"}],"key":"XoyxRo9Gm5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dbnraw = bngain * dhpreact  # replication occurs automatically, no summing required\ndbnbias = dhpreact.sum(0, keepdim=True)  # sum to reduce the batch size dimension","key":"wQYvAw4xFV"},{"type":"outputs","id":"9NxQjAIEuwRqz3Li5aH_F","children":[],"key":"dGUTOEtN7j"}],"key":"oj6yc3Lmom"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Let’s check for correctness:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DncbEosHOt"}],"key":"UUqEOKgLbl"}],"key":"r6JxgQ6dz6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cmp(\"bngain\", dbngain, bngain)\ncmp(\"bnraw\", dbnraw, bnraw)\ncmp(\"bnbias\", dbnbias, bnbias)","key":"aiKO3vQIQc"},{"type":"outputs","id":"bIlDfR-lkZ-HcIFaBAjEk","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"bngain          | exact: True  | approximate: True  | maxdiff: 0.0\nbnraw           | exact: True  | approximate: True  | maxdiff: 0.0\nbnbias          | exact: True  | approximate: True  | maxdiff: 0.0\n"},"children":[],"key":"YdhCLnC0DA"}],"key":"yB71ODowAZ"}],"key":"T1T6UPQY1v"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Awesome! Now we get to the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QL1bXxZKXC"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"batchnorm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Rz3ruvoLH9"}],"key":"m9580gMpKs"},{"type":"text","value":" layer. We see how here ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uToM2YSqir"},{"type":"inlineCode","value":"bngain","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fH3dakUNmO"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bX7HqpmiUM"},{"type":"inlineCode","value":"bnbias","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TsUlhIkoQA"},{"type":"text","value":" are parameters, so the backpropagation ends. But ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TKGyeiKUXm"},{"type":"inlineCode","value":"bnraw = bndiff * bnvar_inv","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VQcbmJFTNw"},{"type":"text","value":" is the output of the standardization:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MYzxyaJKx7"}],"key":"owffDRbZmI"},{"type":"code","lang":"python","value":"bnmeani = 1 / batch_size * hprebn.sum(0, keepdim=True)\nbndiff = hprebn - bnmeani\nbndiff2 = bndiff**2\nbnvar = 1/(batch_size - 1) * (bndiff2).sum(0, keepdim=True) # note: Bessel's correction (dividing by n-1, not n)\nbnvar_inv = (bnvar + 1e-5)**-0.5\nbnraw = bndiff * bnvar_inv","position":{"start":{"line":3,"column":1},"end":{"line":10,"column":1}},"key":"Rla4Xk5kf4"}],"key":"Pm967q5MDi"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"with an equivalence to the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QW3u1HBaDp"},{"type":"link","url":"https://arxiv.org/abs/1502.03167","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"batchnorm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DkIfaDfLsT"}],"key":"lJQrdOyOOX"},{"type":"text","value":" paper","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KZR8PSCLoP"}],"urlSource":"https://arxiv.org/abs/1502.03167","key":"kKnyA0dEQU"},{"type":"text","value":" assignments:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZZhVxRsTbv"}],"key":"AOKbJctvHQ"}],"key":"tZKSJUUlpS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from IPython.display import Image, display\n\ndisplay(Image(filename=\"batchnorm_algorithm1.png\"))","key":"cPb1gNaPML"},{"type":"outputs","id":"HYIpmQpu6miy0FDI-wh0K","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6ecabca641096f0ba608ebabb87d481d","path":"/build/6ecabca641096f0ba608ebabb87d481d.png"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}},"children":[],"key":"uW6UYWtA4h"}],"key":"B67Tz7vJZk"}],"key":"w9Z3gfgjB7"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So, next up, on the line ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p0SZfAVnHz"},{"type":"inlineCode","value":"bnraw = bndiff * bnvar_inv","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kdAVoJYtIZ"},{"type":"text","value":" we have to backpropagate into ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KJGaTu8HPM"},{"type":"inlineCode","value":"bndiff","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i5LpuNqqf6"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HjQx6odwnS"},{"type":"inlineCode","value":"bnvar_inv","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EvefrEVNhD"},{"type":"text","value":", having already calculated ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P5TeMuJryM"},{"type":"inlineCode","value":"dbnraw","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WELrnniapK"},{"type":"text","value":". Let’s see the shapes:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OzrjgJZNik"}],"key":"dv3KNLFQ0i"}],"key":"QzN5UWhVvg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"bnraw.shape, bndiff.shape, bnvar_inv.shape","key":"urdKcrJUGw"},{"type":"outputs","id":"BDNjKUDRjtYpfzcVIfArJ","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":63,"metadata":{},"data":{"text/plain":{"content":"(torch.Size([32, 64]), torch.Size([32, 64]), torch.Size([1, 64]))","content_type":"text/plain"}}},"children":[],"key":"aTz3C8jt7F"}],"key":"WeTWdMXQ62"}],"key":"qAESysVx86"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can infer that there is broadcasting of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pL5MQ6aAtZ"},{"type":"inlineCode","value":"bnvar_inv","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LzgtD5jB4Y"},{"type":"text","value":" happening here that we have to be careful with. Other than that, this is just an element-wise multiplication. By now we should be pretty comfortable with that. Therefore:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TQ1YB6saLQ"}],"key":"tEucru8Qbz"}],"key":"tc5U8ZSZEE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dbndiff = bnvar_inv * dbnraw\n# we sum since dbnvar_inv must have the same shape as `bnvar_inv`\ndbnvar_inv = (bndiff * dbnraw).sum(0, keepdim=True)","key":"SJ5zDoKcuF"},{"type":"outputs","id":"vdOCJJUlQ7QEInO36_h_q","children":[],"key":"Mbrob4ujS3"}],"key":"ZmWsHyDkTy"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Are these correct? Let’s see.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NdjPAYpowq"}],"key":"kdJKuwvEHZ"}],"key":"XN1GlR5Dwf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cmp(\"bnvar_inv\", dbnvar_inv, bnvar_inv)\ncmp(\"bndiff\", dbndiff, bndiff)","key":"bVeHXzIoEc"},{"type":"outputs","id":"EASZaoZFJol1Uamfn0Ex1","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"bnvar_inv       | exact: True  | approximate: True  | maxdiff: 0.0\nbndiff          | exact: False | approximate: False | maxdiff: 0.0011080320691689849\n"},"children":[],"key":"OcsNph12CL"}],"key":"BNRtwPlRHt"}],"key":"kWNF80UWHM"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineCode","value":"dbnvar_inv","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QGCXmEAOT5"},{"type":"text","value":" is correct. But, oh no! ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Wx1CS6njLy"},{"type":"inlineCode","value":"dbndiff","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PdrOe5nAv2"},{"type":"text","value":" isn’t... Well, this is actually expected, because we are not yet done with ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KR0qvTx0r0"},{"type":"inlineCode","value":"bndiff","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cdzlRW5zi0"},{"type":"text","value":", since it not only contributes to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TlFD3cpCqP"},{"type":"inlineCode","value":"bnraw","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VXIDnvWs9Q"},{"type":"text","value":" but also indirectly to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wHh0oInplT"},{"type":"inlineCode","value":"bnvar_inv","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QgXjRn7jmf"},{"type":"text","value":" (through ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i8rRUXDFQD"},{"type":"inlineCode","value":"bndiff2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VKI05q4quE"},{"type":"text","value":" and so on). So basically, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JiM9LCWYsB"},{"type":"inlineCode","value":"bndiff","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OOhYsc3al5"},{"type":"text","value":" branches out into two branches of which we have only ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Lo7a78NHz6"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z4OzaVTZ22"}],"key":"hjpBTz97mq"},{"type":"text","value":"agated through one of them. So we have to continue our ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UsKXHOzjWX"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"elu4cPvYig"}],"key":"Kw2GVYS08u"},{"type":"text","value":" until we get to the second branch of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i02zvLwSSJ"},{"type":"inlineCode","value":"bndiff","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aEKVJTUigq"},{"type":"text","value":", where we can calculate and add the second partial derivative component to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s4fyEW1COT"},{"type":"inlineCode","value":"dbndiff","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PzbC75kXsW"},{"type":"text","value":" using a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wAjGyrZwLE"},{"type":"inlineCode","value":"+=","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Chdx5W5CGO"},{"type":"text","value":" (like we have done before for previous variables). Let’s do so! Next up is: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DZdasD0r7v"},{"type":"inlineCode","value":"bnvar_inv = (bnvar + 1e-5)**-0.5","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YtTjdzbThY"},{"type":"text","value":". ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aRNYn03lE5"},{"type":"link","url":"https://www.wolframalpha.com/input?i=dx%5En%2Fdx","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This is just","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wCKrToJDCC"}],"urlSource":"https://www.wolframalpha.com/input?i=dx%5En%2Fdx","key":"bflzEbpw0m"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FxZdfpNF5Q"}],"key":"W8UtS1oqof"}],"key":"ywIRicvNWP"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"dbnvar = (-0.5 * ((bnvar + 1e-5) ** -1.5) * 1) * dbnvar_inv\ncmp(\"bnvar\", dbnvar, bnvar)","visibility":"show","key":"gmQsAnm0fE"},{"type":"outputs","id":"EjZSDH4U3Wgybwi-6JdTL","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"bnvar           | exact: True  | approximate: True  | maxdiff: 0.0\n"},"children":[],"key":"CIhjdCwlaX"}],"visibility":"show","key":"HbgeoubSfe"}],"visibility":"show","key":"eBR7VEHsoW"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"which is the correct result! Now before we move on here, let’s talk a bit about Bessel’s correction from: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uZUPBoKl02"},{"type":"inlineCode","value":"bnvar = 1/(batch_size - 1) * (bndiff2).sum(0, keepdim=True) # note: Bessel's correction (dividing by n-1, not n)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LV6VCmZBED"},{"type":"text","value":". You’ll notice that dividing by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZZL182NU9a"},{"type":"inlineCode","value":"n-1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tzZoP47vzQ"},{"type":"text","value":" instead of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ic2xwrF7eb"},{"type":"inlineCode","value":"n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MekkDYvT84"},{"type":"text","value":" is a departure from the paper (where ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xZV98bm3p3"},{"type":"inlineCode","value":"m","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iItzHlmicp"},{"type":"text","value":" == ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QHCLGyODgA"},{"type":"inlineCode","value":"n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WAR2fotjgR"},{"type":"text","value":" == ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mk7OYWIXpK"},{"type":"inlineCode","value":"batch_size","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jf1lgPht6t"},{"type":"text","value":"). So it turns out that there are two ways of estimating variance of an array. One is the biased estimate, which is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YIvKvmYt47"},{"type":"inlineCode","value":"1/n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kyzWP5FLpK"},{"type":"text","value":" and the other one is the unbiased estimate which is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u5yvfeoVxk"},{"type":"inlineCode","value":"1/n-1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"epy2159LNK"},{"type":"text","value":". Now confusingly in the paper it’s not very clearly described and also it’s a detail that kind of matters. They essentially use the biased version at training time but later when they are talking about the inference, they are mentioning that when they do the inference they are using the unbiased estimate (which is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mrptMFcOoJ"},{"type":"inlineCode","value":"1/n-1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cwi3MQXI5i"},{"type":"text","value":" version) to calibrate the running mean and the running variance basically. And so they actually introduce a train test mismatch where in training they use the biased version and in test time they use the unbiased version. This of course is very confusing. You can read more about the Bessel’s correction: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uvC4aklT3x"},{"type":"link","url":"https://mathcenter.oxford.emory.edu/site/math117/besselCorrection/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"https://​mathcenter​.oxford​.emory​.edu​/site​/math117​/besselCorrection/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uFXwGJx3IJ"}],"urlSource":"https://mathcenter.oxford.emory.edu/site/math117/besselCorrection/","key":"W1iObjTwsR"},{"type":"text","value":" and why dividing by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tOxfzJqGGQ"},{"type":"inlineCode","value":"n-1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yT3iXas9ey"},{"type":"text","value":" gives you a better estimate of the variance in the case where you have population sizes or samples from a population that are very small. And that is indeed the case for us because we are dealing with mini-matches and these mini-matches are a small sample of a larger population which is the entire training set. And it turns out that if you just estimate it using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B1y6LichK5"},{"type":"inlineCode","value":"1/n","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"udGVEiXpJR"},{"type":"text","value":" that actually almost always underestimates the variance and it is a biased estimator and it is advised that you use the unbiased version and divide by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fFPSq8gQju"},{"type":"inlineCode","value":"n-1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wFbO7eRkAE"},{"type":"text","value":". The documentation of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DXHOPawOj4"},{"type":"link","url":"https://pytorch.org/docs/stable/generated/torch.var.html","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineCode","value":"torch.var","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nIzlMjxl4y"}],"urlSource":"https://pytorch.org/docs/stable/generated/torch.var.html","key":"octQ6ZbJ4G"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fv5vnLh5Yy"},{"type":"link","url":"https://pytorch.org/docs/stable/generated/torch.nn.BatchNorm1d.html","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineCode","value":"torch.nn.BatchNorm1d","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AdONukHTM7"}],"urlSource":"https://pytorch.org/docs/stable/generated/torch.nn.BatchNorm1d.html","key":"NpUbaq2YOK"},{"type":"text","value":" are less confusing. So, long story short, since PyTorch uses Bessel’s correction, we will too. Ok, so let’s now ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AnVWezCjyd"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LGPAMd01N5"}],"key":"qQIsWSKBwA"},{"type":"text","value":" through the next line: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yhe3lWIJpc"},{"type":"inlineCode","value":"bnvar = 1/(batch_size - 1) * (bndiff2).sum(0, keepdim=True)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"efWLS2HZ7O"},{"type":"text","value":". As you might have realized until now, it is good practice to scrutinize the shapes first.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"REkV5Q9ClD"}],"key":"pjpH2Z8xrJ"}],"key":"OkriPgUFfE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"bnvar.shape, bndiff2.shape","key":"BNXa3fmKRO"},{"type":"outputs","id":"4tTJPNhQLFxWuwVa7ZoP4","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":67,"metadata":{},"data":{"text/plain":{"content":"(torch.Size([1, 64]), torch.Size([32, 64]))","content_type":"text/plain"}}},"children":[],"key":"NadduOpt5h"}],"key":"UUi8WNWTU1"}],"key":"RbuLRPtOxH"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Therefore the sum operation in this line is squashing the first dimension ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WdyT7PaO9K"},{"type":"text","value":"32","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UfQZVzP510"},{"type":"text","value":" into ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pVzNAMvNWP"},{"type":"text","value":"1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y3BtmyVLPn"},{"type":"text","value":". This hints to us that will be some kind of replication or broadcasting in the backward pass. And maybe you’re noticing a pattern here: everytime you have a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kMEspWSQq0"},{"type":"inlineCode","value":"sum","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XAP7WS6Uym"},{"type":"text","value":" in the forward pass, that turns into a replication or broadcasting in the backward pass along the same dimension. And conversely, when we have a replication or broadcasting in the forward pass, that indicates a variable reuse and so in the backward pass that turns into a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RnsmICAY8i"},{"type":"inlineCode","value":"sum","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ib380PqYRP"},{"type":"text","value":" over the exact same dimension. And so we are noticing a duality, where these two operations are kind of like the opposites of each other in the forward and the backward pass. Now, usually once we have understood the shapes, the next thing to look at is a toy example in order to roughly understand how the variable dependencies go in the mathematical formula. In the line we are interested in we have an array (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"h13yxQiNUv"},{"type":"inlineCode","value":"bndiff2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ba8EiXVc2m"},{"type":"text","value":") on which we are summing vertically over the columns (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kvKbbofB3o"},{"type":"inlineCode","value":"(bndiff2).sum(0, keepdim=True)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cAMPPgSxNX"},{"type":"text","value":") and that we are scaling (by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yhTAGOaSfB"},{"type":"inlineCode","value":"1/(batch_size - 1)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XKauDNDzNh"},{"type":"text","value":"). So if we have a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HBsYKtwuzh"},{"type":"inlineMath","value":"2\\times2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding=\"application/x-tex\">2\\times2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span></span></span></span>","key":"QNm1ostSpy"},{"type":"text","value":" matrix ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bKXkn2Oinv"},{"type":"inlineMath","value":"a","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"g5DjXyE828"},{"type":"text","value":" that we then sum over the columns and then scale, we would get:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FZRNwEqYhc"}],"key":"gW3Wbt7zWj"}],"key":"e8voBfrOlC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# a11 a12\n# a21 a22\n# -> \n# b1 b2, where:\n# b1 = 1/(n-1)*(a11 + a21)\n# b2 = 1/(n-1)*(a12 + a22)","key":"uWXzBfqFNh"},{"type":"outputs","id":"q2G8teu5vtqxS9wVOhFXg","children":[],"key":"KUHPUBicI9"}],"key":"KOKazO53PP"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Looking at this simple example, what we want basically is we want to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xNHngy49pY"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backpro","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W581skAUoE"}],"key":"uMkq0CykKs"},{"type":"text","value":" the derivative of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M2Z1E80nUG"},{"type":"inlineCode","value":"b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"h5haBk9CdR"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gZSVn3VkJo"},{"type":"inlineCode","value":"db1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pn8udxMtDO"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LkuXoKmq9k"},{"type":"inlineCode","value":"db2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MC2ignxN1T"},{"type":"text","value":" into all the elements of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ivv12aOp08"},{"type":"inlineCode","value":"a","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aOEH5SAHkM"},{"type":"text","value":". And so it’s clear that, by just differentiating in your head, the local derivatives of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KNGZCzsiK5"},{"type":"inlineCode","value":"b","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kBwgcKTn9y"},{"type":"text","value":" are simply ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CEHeEyTkyR"},{"type":"inlineCode","value":"(1/(n-1))*1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BADops5Imh"},{"type":"text","value":" for each one of these elements of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jjqb53EgVF"},{"type":"inlineCode","value":"a","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bal0N9TqYX"},{"type":"text","value":". Basically, each local derivative will flow through each column of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Trw349OQyc"},{"type":"inlineCode","value":"a","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KnAXJqK0Tg"},{"type":"text","value":" and be scaled by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YQSQ67o2qx"},{"type":"inlineCode","value":"1/(n-1)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Yz31sianCG"},{"type":"text","value":". Therefore, intuitively:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZjBMAtASxg"}],"key":"GvgIM4eO2W"}],"key":"jMdQICt4jS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# basically a large array of ones the size of bndiff2 times dbnvar (chain rule), scaled\ndbndiff2 = (1 / (batch_size - 1)) * torch.ones_like(bndiff2) * dbnvar","key":"bTkO13VXfi"},{"type":"outputs","id":"ty6kpuo4yVyCXJtmj2OPn","children":[],"key":"dYi9FXOtVa"}],"key":"Wx1Dg2WrTg"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Notice here how we are multiplying a scaled ones array of shape ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y63j3fcXWL"},{"type":"inlineMath","value":"32x64","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>32</mn><mi>x</mi><mn>64</mn></mrow><annotation encoding=\"application/x-tex\">32x64</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">32</span><span class=\"mord mathnormal\">x</span><span class=\"mord\">64</span></span></span></span>","key":"HHeTAxY0w0"},{"type":"text","value":" with ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iJRgKExEJQ"},{"type":"inlineCode","value":"dbnvar","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rv3Z2Cszav"},{"type":"text","value":", an array of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"e26DIrMBO8"},{"type":"inlineMath","value":"1\\times64","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>×</mo><mn>64</mn></mrow><annotation encoding=\"application/x-tex\">1\\times64</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">64</span></span></span></span>","key":"lUNNX6lTi6"},{"type":"text","value":". Basically we are just letting PyTorch do the replication, so that we end up with a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mNtc579hxO"},{"type":"inlineCode","value":"dbndiff2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GJAJ94ndFB"},{"type":"text","value":" array of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Hid6zBKs6Z"},{"type":"inlineMath","value":"32\\times64","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>32</mn><mo>×</mo><mn>64</mn></mrow><annotation encoding=\"application/x-tex\">32\\times64</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">32</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">64</span></span></span></span>","key":"yQXsiJw285"},{"type":"text","value":" (same size as ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cLmje5xBUY"},{"type":"inlineCode","value":"bndiff2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hYJ7z3L3RN"},{"type":"text","value":"). And indeed we see that this derivative is correct:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tPMCMwOxZs"}],"key":"NOGCZhbVnk"}],"key":"pGAiEQSYin"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"cmp(\"bndiff2\", dbndiff2, bndiff2)","key":"dGxTiUmZHM"},{"type":"outputs","id":"cmiPz5X4PSWZMb93U1wLs","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"bndiff2         | exact: True  | approximate: True  | maxdiff: 0.0\n"},"children":[],"key":"YLUDdV4VTz"}],"key":"PeV4IDyQbr"}],"key":"yWt2lfcDCp"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Next up, let’s differentiate here: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PXxCyuL47w"},{"type":"inlineCode","value":"bndiff2 = bndiff**2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rypEJVGJrn"},{"type":"text","value":" into ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x42wNxx9LQ"},{"type":"inlineCode","value":"bndiff","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PGuBSIyCv1"},{"type":"text","value":". This is a simple one, but don’t forget the addition assignment, as this will now be adding the second partial derivative component to the first one we already calculated before. So this completes the backpropagation through the second branch of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hAu8jHK0mt"},{"type":"inlineCode","value":"bndiff","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hmJn64RYue"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dJuPt5jC7P"}],"key":"DLCwQE2HBK"}],"key":"rndUawl8sj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dbndiff += (2 * bndiff) * dbndiff2\ncmp(\"bndiff\", dbndiff, bndiff)","key":"YXG2xd2JUx"},{"type":"outputs","id":"LKPBdrrbPRGiJtfUKMorM","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"bndiff          | exact: True  | approximate: True  | maxdiff: 0.0\n"},"children":[],"key":"HP5uDMQdwQ"}],"key":"nlymJmuk14"}],"key":"QAnpFwBzol"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As you can see now, the derivative of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mzkGR44vXU"},{"type":"inlineCode","value":"bndiff","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FatHFp0ohL"},{"type":"text","value":" is now exact and correct. That’s comforting! Next up: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xtuixAleRp"},{"type":"inlineCode","value":"bndiff = hprebn - bnmeani","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vea3R1v1a5"},{"type":"text","value":". Let’s check the shapes:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Os4u3U5Xtv"}],"key":"gDa3OEGGUg"}],"key":"pDeNosWedL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"bndiff.shape, hprebn.shape, bnmeani.shape","key":"yYlkT4smdY"},{"type":"outputs","id":"jUJZjR8Xt6zrPMPTO1Hnw","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":72,"metadata":{},"data":{"text/plain":{"content":"(torch.Size([32, 64]), torch.Size([32, 64]), torch.Size([1, 64]))","content_type":"text/plain"}}},"children":[],"key":"d7UUIgFmXk"}],"key":"jFQuKiWBz8"}],"key":"zYhGDmE3es"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Therefore, the minus sign here (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mEfuRalf0K"},{"type":"inlineMath","value":"-","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>−</mo></mrow><annotation encoding=\"application/x-tex\">-</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span></span></span></span>","key":"P3pPgUEC4Y"},{"type":"text","value":") is actually doing broadcasting. Let’s be careful about that as this hints us to the duality we previously mentioned. A broadcasting in the forward pass means variable reuse and therefore translates to a sum operation in the backward pass. Let’s find the derivatives:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ADmdcd0E4z"}],"key":"NKL3PHwxhC"}],"key":"JB3x8amfJT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dhprebn = 1 * dbndiff\ndbnmeani = (-1 * dbndiff).sum(0, keepdim=True)\ncmp(\"hprebn\", dhprebn, hprebn)\ncmp(\"bnmeani\", dbnmeani, bnmeani)","key":"oRHFfZCx8M"},{"type":"outputs","id":"becBc9tz8dJ6eOfoX6thB","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"hprebn          | exact: False | approximate: False | maxdiff: 0.001130998833104968\nbnmeani         | exact: True  | approximate: True  | maxdiff: 0.0\n"},"children":[],"key":"Qnoq7Z0qBB"}],"key":"ZbZt7WGyX4"}],"key":"IF9dowKRSL"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FNJuUN3J9w"},{"type":"inlineCode","value":"dhprebn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oa7ws54WRw"},{"type":"text","value":" is wrong... Damn! Haha, well, don’t sweat it. This is supposed to be wrong! Can you guess why? Like happened for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ED3JVnB2ts"},{"type":"inlineCode","value":"bndiff","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EfHCSR2eMs"},{"type":"text","value":", this is also not the only branch we have to backpropagate to for calculating ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"G7K38NFfdj"},{"type":"inlineCode","value":"dhprebn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K2DoMOQRi6"},{"type":"text","value":", since ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HVq7ZOOPrE"},{"type":"inlineCode","value":"bnmeani","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SW6EURlH08"},{"type":"text","value":" also depends on ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JfPLiunqmm"},{"type":"inlineCode","value":"hprebn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VvfyJGtwqn"},{"type":"text","value":". Therefore, there will be a second derivative component coming from this second branch. So we are not done yet. This we will find now since the next line is: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"N8ZVn62U0E"},{"type":"inlineCode","value":"bnmeani = 1 / batch_size * hprebn.sum(0, keepdim=True)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IshUtutJoz"},{"type":"text","value":". Now here again we have to be careful since there is a sum along dimension ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Xb9hFyDl6V"},{"type":"text","value":"0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yyoHK1vB90"},{"type":"text","value":" so this will turn into broadcasting in the backward pass. So, similarly to the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gLelQYS5lg"},{"type":"inlineCode","value":"bnvar","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hJaayvGZPC"},{"type":"text","value":" line and the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DJCwWlISbF"},{"type":"inlineCode","value":"dbndiff2","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B7uWTJ61ns"},{"type":"text","value":" calculation:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PUNZxOI4QD"}],"key":"ZLEVV6NNiQ"}],"key":"Se5PuihvPp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dhprebn += (1.0 / batch_size) * torch.ones_like(hprebn) * dbnmeani\ncmp(\"hprebn\", dhprebn, hprebn)","key":"tOxn3y1ANl"},{"type":"outputs","id":"axxkt8RIj1PrxhKQ2A81a","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"hprebn          | exact: True  | approximate: True  | maxdiff: 0.0\n"},"children":[],"key":"mc8U7PT6Nm"}],"key":"MmKleaEGHm"}],"key":"opEnvPl8ND"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Awesome! So that completes the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Il9T3LZD9g"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Eao5Ni2mwr"}],"key":"TMYvYJbXpm"},{"type":"text","value":" of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UEIzWZAOaf"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"batchnorm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jd49Zzpv8C"}],"key":"MJD6O1cp6h"},{"type":"text","value":" layer. Next up we will ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OEavfyHFJU"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uKSXBnvrWC"}],"key":"xLgwHxwPsb"},{"type":"text","value":"agate through the linear layer: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"do2mgsGnff"},{"type":"inlineCode","value":"hprebn = embcat @ w1 + b1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JuxJx2rcS5"},{"type":"text","value":". Like we have already mentioned, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H9RyAWaOsK"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wehLs7yghf"}],"key":"O2RZfJU8Rj"},{"type":"text","value":"agating through linear layers is pretty easy. So let’s inspect the shapes and begin.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZevA9xWpV1"}],"key":"BSxEViwWz7"}],"key":"jJOe1tPNfg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"hprebn.shape, embcat.shape, w1.shape, b1.shape","key":"q8Ksxt0AdE"},{"type":"outputs","id":"NOEpR59ThHTcdwqhRrCHf","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":75,"metadata":{},"data":{"text/plain":{"content":"(torch.Size([32, 64]),\n torch.Size([32, 30]),\n torch.Size([30, 64]),\n torch.Size([64]))","content_type":"text/plain"}}},"children":[],"key":"hbPJM108mf"}],"key":"gPancVoS0C"}],"key":"f0KGLaEgtm"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we find ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ekL2gaTgIi"},{"type":"inlineCode","value":"dembcat","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Hef4PYw8XY"},{"type":"text","value":" to be ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"N2cXC62bKk"},{"type":"inlineMath","value":"32x30","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>32</mn><mi>x</mi><mn>30</mn></mrow><annotation encoding=\"application/x-tex\">32x30</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">32</span><span class=\"mord mathnormal\">x</span><span class=\"mord\">30</span></span></span></span>","key":"CEm6h7xyBj"},{"type":"text","value":". We need to take ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TfpFrUXSAE"},{"type":"inlineCode","value":"w1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AnNQNnKaxU"},{"type":"text","value":" of size ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lErJiD9uTl"},{"type":"inlineMath","value":"30x64","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>30</mn><mi>x</mi><mn>64</mn></mrow><annotation encoding=\"application/x-tex\">30x64</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">30</span><span class=\"mord mathnormal\">x</span><span class=\"mord\">64</span></span></span></span>","key":"UI4Rn2qcHG"},{"type":"text","value":" (the tensor that is matrix-multiplied by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rjPEUO4O38"},{"type":"inlineCode","value":"embcat","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RlZjABV1a7"},{"type":"text","value":") and matrix-multiply it with ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MmZhTuXYe2"},{"type":"inlineCode","value":"dhprebn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aPY5lN051T"},{"type":"text","value":" (think chain rule). Therefore, we need to do:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rpdGw770Ao"}],"key":"exA6oftvtJ"}],"key":"kcYJyhWFqT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dembcat = dhprebn @ w1.T\ncmp(\"embcat\", dembcat, embcat)","key":"a3TdS7VOZ7"},{"type":"outputs","id":"FJ_F2a9-YUYA6jo4-AIG-","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"embcat          | exact: True  | approximate: True  | maxdiff: 0.0\n"},"children":[],"key":"nDFrg00y4H"}],"key":"B9MQVDA0C5"}],"key":"khTfv1GWjV"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And similarly for the remaining variables:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lvLNkVc4bO"}],"key":"Tu239KbBY8"}],"key":"o8LVAzl5SS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dw1 = embcat.T @ dhprebn\ndb1 = (1 * dhprebn).sum(0)\ncmp(\"w1\", dw1, w1)\ncmp(\"b1\", db1, b1)","key":"YqD0Z9d2IC"},{"type":"outputs","id":"BikujF46u3bKfI7moVU_a","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"w1              | exact: True  | approximate: True  | maxdiff: 0.0\nb1              | exact: True  | approximate: True  | maxdiff: 0.0\n"},"children":[],"key":"Ijw8a4ToLT"}],"key":"PCnkjB5taP"}],"key":"RHJSmjkogk"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Cool, everything is correct! Moving onto ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PhIXNuglR7"},{"type":"inlineCode","value":"embcat = emb.view(emb.shape[0], -1)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GYnba97Eh5"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IPE8jNx1ZL"}],"key":"UzrJtJKxR0"}],"key":"iIFcgFVstx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"embcat.shape, emb.shape","key":"uCSzfwDQ5w"},{"type":"outputs","id":"5kOwS6m84k-Xx-E_hPb0G","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":78,"metadata":{},"data":{"text/plain":{"content":"(torch.Size([32, 30]), torch.Size([32, 3, 10]))","content_type":"text/plain"}}},"children":[],"key":"jh91wVvxWC"}],"key":"feM27yQXx5"}],"key":"tXY5Db28H9"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As you can see, the view operation squashes the last two dimensions of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bFrImg4maK"},{"type":"inlineCode","value":"emb","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MChicjKqoL"},{"type":"text","value":" tensor (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KOfPFMcNml"},{"type":"inlineCode","value":"3","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pLfRB7yBpf"},{"type":"text","value":", ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SgNrzCf2Hu"},{"type":"inlineCode","value":"10","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bzMsQFpmkQ"},{"type":"text","value":") into one dimension (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aIscx2PVse"},{"type":"inlineCode","value":"30","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZYxmBlp9LM"},{"type":"text","value":"). So here we are dealing with a concatenation of dimensions in the forward pass, therefore we want to undo that in the backward pass. We can do this again using the view operation:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YrmMP5QYhz"}],"key":"hph4mepWlW"}],"key":"nTON4JelMb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"demb = dembcat.view(emb.shape)\ncmp(\"emb\", demb, emb)","key":"up3EsR3ZxU"},{"type":"outputs","id":"FRyKqjX9ajSchI4gv6vwh","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"emb             | exact: True  | approximate: True  | maxdiff: 0.0\n"},"children":[],"key":"RMPZAKOGyO"}],"key":"J9zqwY1lKs"}],"key":"ltd456K8fn"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Simple, right? Now the only operation that is left to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qbRSKuIZM5"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zQvg2fKKHy"}],"key":"PZTVnm9P9T"},{"type":"text","value":" into is the initial indexing operation: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nmc4dzjFhL"},{"type":"inlineCode","value":"emb = C[xb]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lMEZs8p7DY"},{"type":"text","value":". Let’s look at the shapes:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iJn5ZWoG9Q"}],"key":"ckj9YGOYDh"}],"key":"hIVHhQNJwI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"emb.shape, C.shape, xb.shape","key":"n1TQ4qZClr"},{"type":"outputs","id":"lIngW4sETIZHZ34tYRdI5","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":80,"metadata":{},"data":{"text/plain":{"content":"(torch.Size([32, 3, 10]), torch.Size([27, 10]), torch.Size([32, 3]))","content_type":"text/plain"}}},"children":[],"key":"yrznBRDiT4"}],"key":"IAC1s1iUb0"}],"key":"cC2lxYuzaJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So what is happening in this indexing operation? ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"asxBO6CTOi"},{"type":"inlineCode","value":"xb","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s7raEzsXJQ"},{"type":"text","value":" (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J1sRPx2SS5"},{"type":"text","value":"32","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zFkIfR9YYK"},{"type":"text","value":" examples, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"My6gPGkcHc"},{"type":"text","value":"3","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mXtySryfSR"},{"type":"text","value":" character indeces per example) is being used to index the lookup table ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bMVfquZp4g"},{"type":"inlineCode","value":"C","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tD4AGarzxC"},{"type":"text","value":" (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jUOIDgearh"},{"type":"text","value":"27","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IDjy4vVJC5"},{"type":"text","value":" possible character indeces, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PrPzZkMpuN"},{"type":"text","value":"10","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cI0f2kEpl8"},{"type":"text","value":" embedding dimensions per character index) to yield ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"G6EK7Fw7DH"},{"type":"inlineCode","value":"emb","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VFWvykseqr"},{"type":"text","value":" (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JJVvFpDGvG"},{"type":"text","value":"32","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KKu0SQ8n8I"},{"type":"text","value":" examples, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UekDrarPCy"},{"type":"text","value":"3","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f2LoLs4skN"},{"type":"text","value":" character indeces per example, ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JYEHAB97w0"},{"type":"text","value":"10","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aBFozBekuc"},{"type":"text","value":" embedding dimensions per character index). In other words, by indexing ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZwC0xZlMwb"},{"type":"inlineCode","value":"C","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i92UxrmVgq"},{"type":"text","value":" using ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W0CX1yZjAm"},{"type":"inlineCode","value":"xb","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JT64RtTW6q"},{"type":"text","value":" we are using each integer in ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yRz7wJRI3Y"},{"type":"inlineCode","value":"xb","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DnVbgVGg0L"},{"type":"text","value":" to specify which row of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hDyItK9hhb"},{"type":"inlineCode","value":"C","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kBgE7sabrY"},{"type":"text","value":" we want to pluck out. This indexing operation yields an embeddings tensor ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"G17DLmOuxE"},{"type":"inlineCode","value":"emb","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CQNhvLIv7y"},{"type":"text","value":" of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i3yV6KhpYz"},{"type":"text","value":"32","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kpmIhdBx5M"},{"type":"text","value":" examples (same as the indexing tensor ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kK5z0SPu5x"},{"type":"inlineCode","value":"xb","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qTjVwbmw7O"},{"type":"text","value":"), ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tOoKTbk5fN"},{"type":"text","value":"3","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yCIeKMLuhB"},{"type":"text","value":" plucked-out character rows per example (from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zxQjhPqsMS"},{"type":"inlineCode","value":"C","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"K9gFJguExN"},{"type":"text","value":"), each of which contains ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mdT2XYWyVP"},{"type":"text","value":"10","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Bue7WpsA2c"},{"type":"text","value":" embedding dimesions. So now, for each one of these plucked-out rows we have their gradients ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p48sro1P2G"},{"type":"inlineCode","value":"demb","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ftVxT3EVZn"},{"type":"text","value":" (arranged in a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cduuIQ77dx"},{"type":"inlineMath","value":"32\\times3\\times10","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>32</mn><mo>×</mo><mn>3</mn><mo>×</mo><mn>10</mn></mrow><annotation encoding=\"application/x-tex\">32\\times3\\times10</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">32</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">10</span></span></span></span>","key":"abJW1aul3N"},{"type":"text","value":" tensor). All we have to do now is to route this gradients backwards through this indexing operation. So first we need to find the specific rows of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"d5LAeKTnfD"},{"type":"inlineCode","value":"C","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ySO2S3QeOA"},{"type":"text","value":" that every one of these ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rO4CZNeuxE"},{"type":"text","value":"10","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X7LDF1FCJu"},{"type":"text","value":"-dimensional embeddings comes from. And then, into the corresponding ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rKdUm826QQ"},{"type":"inlineCode","value":"dC","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YDo4rA9Wfy"},{"type":"text","value":" row indices we need to deposit the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Sb5ziJCwt0"},{"type":"inlineCode","value":"demb","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XgFmvlCynq"},{"type":"text","value":" gradients. Basically we need to undo the indexing. And of course, if any of these rows of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m5wi17TYxP"},{"type":"inlineCode","value":"C","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J0vDnWvbnI"},{"type":"text","value":" was used multiple times, then we have to remember that the gradients that arrive there have to add (accumulate through an addition operation). The PyTorch operation that will help us do this is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"peA4XmQacn"},{"type":"link","url":"https://pytorch.org/docs/stable/generated/torch.Tensor.index_add_.html","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineCode","value":"index_add_","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"L7hxOY8jZd"}],"urlSource":"https://pytorch.org/docs/stable/generated/torch.Tensor.index_add_.html","key":"SgclNyHJOR"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LDdUGTT8zj"}],"key":"RGDqcRZiaZ"}],"key":"hk52ZEL1or"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Define `dC` tensor (same size as `C`)\ndC = torch.zeros_like(C)\n# Plucked-out `C` row indices tensor\nindices = xb.flatten()  # shape: 32 * 3 = 96, range of index values: 0-26\n# `demb` derivative values tensor\nvalues = demb.view(-1, 10)  # shape: (32 * 3)x10 = 96x10\n# Add `demb` values to specific indices\ndC.index_add_(0, indices, values)\ncmp(\"C\", dC, C)","key":"iRvSC8DaAf"},{"type":"outputs","id":"xQcjn4idyN9AE70H_jgRE","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"C               | exact: True  | approximate: True  | maxdiff: 0.0\n"},"children":[],"key":"RIcCq8hBpp"}],"key":"nivzwFXUym"}],"key":"Irs48jBULy"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Make sure to take some time to understand what we just did. Here’s a bare-minimum example (produced by ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zgZZfsunZu"},{"type":"link","url":"https://chat.openai.com/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineCode","value":"ChatGPT","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mz6cVeJIZL"}],"urlSource":"https://chat.openai.com/","key":"cmBxFP8MB5"},{"type":"text","value":") of what the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PI0GKoQr88"},{"type":"inlineCode","value":"index_add_","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RaeOT1s3KL"},{"type":"text","value":" operation does exactly, in case you’re confused:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qMWIJz5f5k"}],"key":"yEgNULsjSm"}],"key":"lCi7DgPSEP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"base_tensor = torch.zeros(5)  # tensor to add values into\nprint(\"Base tensor before index_add_ operation:\", base_tensor)\nindices = torch.tensor([0, 1, 3])  # indices where we want to add values\nvalues = torch.tensor([1.0, 2.0, 3.0])  # values to add at those indices\nbase_tensor.index_add_(0, indices, values)  # add values at specified indices\nprint(\"Base tensor after index_add_ operation:\", base_tensor)","key":"SyaVhhDMAZ"},{"type":"outputs","id":"p1zfri6AUCDsXUlF_Uyq_","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Base tensor before index_add_ operation: tensor([0., 0., 0., 0., 0.])\nBase tensor after index_add_ operation: tensor([1., 2., 0., 3., 0.])\n"},"children":[],"key":"zg3xFgiEKZ"}],"key":"jTQcf4pz26"}],"key":"KLqTPJQKyN"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What remains now is... Well, nothing. Yey :D! We have backpropagated through this entire beast. This was our first exercise. Let’s clearly write out all the gradients we manually calculated, along with their correctness calls:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ztDIuplpBh"}],"key":"QSsZ4dao92"}],"key":"l0oYpmoW6X"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Exercise 1: backprop through the whole thing manually,\n# backpropagating through exactly all of the variables\n# as they are defined in the forward pass above, one by one\n\ndlogprobs = torch.zeros_like(logprobs)\ndlogprobs[range(batch_size), yb] = -1.0 / batch_size\ndprobs = (1.0 / probs) * dlogprobs\ndcounts_sum_inv = (counts * dprobs).sum(1, keepdim=True)\ndcounts = counts_sum_inv * dprobs\ndcounts_sum = (-(counts_sum**-2)) * dcounts_sum_inv\ndcounts += torch.ones_like(counts) * dcounts_sum\ndnorm_logits = counts * dcounts\ndlogits = dnorm_logits.clone()\ndlogit_maxes = (-dnorm_logits).sum(1, keepdim=True)\ndlogits += F.one_hot(logits.max(1).indices, num_classes=logits.shape[1]) * dlogit_maxes\ndh = dlogits @ w2.T\ndw2 = h.T @ dlogits\ndb2 = dlogits.sum(0)\n# FIXME: PyTorch version-specific precision issue\ndhpreact = hpreact.grad  # correct: dhpreact = (1.0 - h**2) * dh\ndbngain = (bnraw * dhpreact).sum(0, keepdim=True)\ndbnraw = bngain * dhpreact\ndbnbias = dhpreact.sum(0, keepdim=True)\ndbndiff = bnvar_inv * dbnraw\ndbnvar_inv = (bndiff * dbnraw).sum(0, keepdim=True)\ndbnvar = (-0.5 * (bnvar + 1e-5) ** -1.5) * dbnvar_inv\ndbndiff2 = (1.0 / (batch_size - 1)) * torch.ones_like(bndiff2) * dbnvar\ndbndiff += (2 * bndiff) * dbndiff2\ndhprebn = dbndiff.clone()\ndbnmeani = (-dbndiff).sum(0)\ndhprebn += 1.0 / batch_size * (torch.ones_like(hprebn) * dbnmeani)\ndembcat = dhprebn @ w1.T\ndw1 = embcat.T @ dhprebn\ndb1 = dhprebn.sum(0)\ndemb = dembcat.view(emb.shape)\ndC = torch.zeros_like(C)\ndC.index_add_(0, xb.flatten(), demb.view(-1, 10))\n\ncmp(\"logprobs\", dlogprobs, logprobs)\ncmp(\"probs\", dprobs, probs)\ncmp(\"counts_sum_inv\", dcounts_sum_inv, counts_sum_inv)\ncmp(\"counts_sum\", dcounts_sum, counts_sum)\ncmp(\"counts\", dcounts, counts)\ncmp(\"norm_logits\", dnorm_logits, norm_logits)\ncmp(\"logit_maxes\", dlogit_maxes, logit_maxes)\ncmp(\"logits\", dlogits, logits)\ncmp(\"h\", dh, h)\ncmp(\"w2\", dw2, w2)\ncmp(\"b2\", db2, b2)\ncmp(\"hpreact\", dhpreact, hpreact)\ncmp(\"bngain\", dbngain, bngain)\ncmp(\"bnbias\", dbnbias, bnbias)\ncmp(\"bnraw\", dbnraw, bnraw)\ncmp(\"bnvar_inv\", dbnvar_inv, bnvar_inv)\ncmp(\"bnvar\", dbnvar, bnvar)\ncmp(\"bndiff2\", dbndiff2, bndiff2)\ncmp(\"bndiff\", dbndiff, bndiff)\ncmp(\"bnmeani\", dbnmeani, bnmeani)\ncmp(\"hprebn\", dhprebn, hprebn)\ncmp(\"embcat\", dembcat, embcat)\ncmp(\"w1\", dw1, w1)\ncmp(\"b1\", db1, b1)\ncmp(\"emb\", demb, emb)\ncmp(\"C\", dC, C)","key":"ZR8vSRD8RW"},{"type":"outputs","id":"h_vYvbMmfrFwQdTfJBk5e","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"logprobs        | exact: True  | approximate: True  | maxdiff: 0.0\nprobs           | exact: True  | approximate: True  | maxdiff: 0.0\ncounts_sum_inv  | exact: True  | approximate: True  | maxdiff: 0.0\ncounts_sum      | exact: True  | approximate: True  | maxdiff: 0.0\ncounts          | exact: True  | approximate: True  | maxdiff: 0.0\nnorm_logits     | exact: True  | approximate: True  | maxdiff: 0.0\nlogit_maxes     | exact: True  | approximate: True  | maxdiff: 0.0\nlogits          | exact: True  | approximate: True  | maxdiff: 0.0\nh               | exact: True  | approximate: True  | maxdiff: 0.0\nw2              | exact: True  | approximate: True  | maxdiff: 0.0\nb2              | exact: True  | approximate: True  | maxdiff: 0.0\nhpreact         | exact: True  | approximate: True  | maxdiff: 0.0\nbngain          | exact: True  | approximate: True  | maxdiff: 0.0\nbnbias          | exact: True  | approximate: True  | maxdiff: 0.0\nbnraw           | exact: True  | approximate: True  | maxdiff: 0.0\nbnvar_inv       | exact: True  | approximate: True  | maxdiff: 0.0\nbnvar           | exact: True  | approximate: True  | maxdiff: 0.0\nbndiff2         | exact: True  | approximate: True  | maxdiff: 0.0\nbndiff          | exact: True  | approximate: True  | maxdiff: 0.0\nbnmeani         | exact: True  | approximate: True  | maxdiff: 0.0\nhprebn          | exact: True  | approximate: True  | maxdiff: 0.0\nembcat          | exact: True  | approximate: True  | maxdiff: 0.0\nw1              | exact: True  | approximate: True  | maxdiff: 0.0\nb1              | exact: True  | approximate: True  | maxdiff: 0.0\nemb             | exact: True  | approximate: True  | maxdiff: 0.0\nC               | exact: True  | approximate: True  | maxdiff: 0.0\n"},"children":[],"key":"jBmZTSLIg2"}],"key":"lZ88SzGBsH"}],"key":"vtL5gkZo3K"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercise 2: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JdHaiN5PMS"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kC6Ase3CaL"}],"key":"NetSUW7T77"},{"type":"text","value":" through cross_entropy but all in one go","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hrd9OI7ok9"}],"identifier":"exercise-2-backprop-through-cross-entropy-but-all-in-one-go","label":"Exercise 2: backprop through cross_entropy but all in one go","html_id":"exercise-2-backprop-through-cross-entropy-but-all-in-one-go","implicit":true,"key":"Wqii0WDh3o"}],"key":"SUv8BRDrFO"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Now we come to exercise 2. It basically turns out that in this first exercise we were doing way too much work. We were ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LnKXLnNnKk"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wLjWdDuFd3"}],"key":"i9V4mvNt5v"},{"type":"text","value":"agating way too much and it was all good practice and so on but it’s not what you would do in practice.\nThe reason for that is, for example at some point we separated out a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JXeI9fx5nb"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ac8QMkaEii"}],"key":"x7D8bbhdXq"},{"type":"text","value":" calculation over multiple lines and broke it up all to its smallest atomic pieces and we ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TkDe99j9UI"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qdjaRdU0Zp"}],"key":"f9PV7bruUT"},{"type":"text","value":"agated through all of those individually. But it turns out that if you just look at the mathematical expression for the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jbP0dflo5Q"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DS0NIfAgdK"}],"key":"zsPE4dwc5Y"},{"type":"text","value":" then actually you can do the differentiation on pen and paper and a lot of terms cancel and simplify and the mathematical expression you end up with is significantly shorter and easier to implement than ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dP0qLCIsAL"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ekEYa21DsH"}],"key":"mI2LXPEbtK"},{"type":"text","value":"agating through all the little pieces of everything you’ve done. So before we had this complicated forward pass going from logits to the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EpxUA17arU"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lMFQofvdFc"}],"key":"jHtweF49l0"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UXLtXtExST"}],"key":"XT1dXvCfV1"}],"key":"oYKgCOILDU"},{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"python","value":"# cross entropy loss (same as F.cross_entropy(logits, Yb))\nlogit_maxes = logits.max(1, keepdim=True).values\nnorm_logits = logits - logit_maxes # subtract max for numerical stability\ncounts = norm_logits.exp()\ncounts_sum = counts.sum(1, keepdims=True)\ncounts_sum_inv = counts_sum**-1\nprobs = counts * counts_sum_inv\nlogprobs = probs.log()\nloss = -logprobs[range(batch_size), yb].mean()","position":{"start":{"line":1,"column":1},"end":{"line":11,"column":1}},"key":"AOrlCOUHYq"}],"key":"vhteFd7mzx"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"But in PyTorch everything can just be glued together into a single call at that cross entropy. You just pass in logits and the labels and you get the exact same ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SPRnakExtN"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vUibq9GrSm"}],"key":"teARbZyCqK"},{"type":"text","value":" as we verify here:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V7WzFztUmO"}],"key":"Gp3OFNSJcj"}],"key":"Y4CU7qDNiV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Exercise 2: backprop through cross_entropy but all in one go\n# to complete this challenge look at the mathematical expression of the loss,\n# take the derivative, simplify the expression, and just write it out\n\nloss_fast = F.cross_entropy(logits, yb)\nprint(loss_fast.item(), \"diff:\", (loss_fast - loss).item())","key":"vVMRsQ3Z9W"},{"type":"outputs","id":"DC5NqhGgEI4p0N26-teP1","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"3.348198175430298 diff: 0.0\n"},"children":[],"key":"drq0TU5lEJ"}],"key":"jppl8eBwpO"}],"key":"IXKxcVNZO0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So our previous ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hSHUTjjeMP"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jRrrPFoqtt"}],"key":"H2TlgtP4iU"},{"type":"text","value":" and the fast ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J9wcBeTzHk"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gBrxw2VBzT"}],"key":"FZGCGOMZbB"},{"type":"text","value":" coming from the chunk of operations as a single mathematical expression is much faster than the whole forward pass we did previously. It’s also much much faster in the backward pass. And the reason for that is if you just look at the mathematical form of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LwQiFxi52J"},{"type":"inlineCode","value":"F.cross_entropy(logits, yb)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QT4cIomVxq"},{"type":"text","value":" and differentiate again you will end up with a very small and short expression. So that’s what we want to do here. In a single operation or in a single go or like very quickly, we want to go directly into ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KHx6LngPnB"},{"type":"inlineCode","value":"dlogits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YLoFHyiMMm"},{"type":"text","value":" and we need to implement ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Iv2nokSZtb"},{"type":"inlineCode","value":"dlogits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i6A42KCeZx"},{"type":"text","value":" as a function of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"alRkiX3xCX"},{"type":"inlineCode","value":"logits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WSOelxZgwr"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rszPRhqNJI"},{"type":"inlineCode","value":"yb","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vuv6ZuNxMU"},{"type":"text","value":". But it will be significantly shorter that going through all these intermediate operations to get to it:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yW6R12t5CB"}],"key":"Vfg8gVp9dJ"}],"key":"JcHXeAtPxg"},{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"python","value":"dlogprobs = torch.zeros_like(logprobs)\ndlogprobs[range(batch_size), yb] = -1.0 / batch_size\ndprobs = (1.0 / probs) * dlogprobs\ndcounts_sum_inv = (counts * dprobs).sum(1, keepdim=True)\ndcounts = counts_sum_inv * dprobs\ndcounts_sum = (-counts_sum**-2) * dcounts_sum_inv\ndcounts += torch.ones_like(counts) * dcounts_sum\ndnorm_logits = counts * dcounts\ndlogits = dnorm_logits.clone()\ndlogit_maxes = (-dnorm_logits).sum(1, keepdim=True)\ndlogits += F.one_hot(logits.max(1).indices, num_classes=logits.shape[1]) * dlogit_maxes","position":{"start":{"line":1,"column":1},"end":{"line":13,"column":1}},"key":"ottCSBJ7Ki"}],"key":"XsWQscffPu"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Basically all of this above work can be skipped in a much much simpler mathematical expression that we will now implement. Let’s give it a shot. The question we are asking is: what is the mathematical expression of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JRWWUbS5io"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hTmDcppRqn"}],"key":"eO1jrNjBqk"},{"type":"text","value":"? Once, we have the answer we can differentiate ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jURqYAiIcy"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"w.r.t","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W6G5j6I3pB"}],"key":"ciAFegetnu"},{"type":"text","value":" the logits. Here’s what’s happening: inputs go through the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wpg72FsgB2"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yHWdktvmVt"}],"key":"e5N6WSEM2H"},{"type":"text","value":" which yields logits. If these are passed through a softmax, we get the probabilities:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EJL7TFIWGC"}],"key":"y0ADzCRFv4"}],"key":"oLzlfZ5ukb"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineMath","value":"x \\rightarrow nn \\rightarrow logits \\rightarrow softmax \\rightarrow probs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>→</mo><mi>n</mi><mi>n</mi><mo>→</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>t</mi><mi>s</mi><mo>→</mo><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo>→</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>b</mi><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">x \\rightarrow nn \\rightarrow logits \\rightarrow softmax \\rightarrow probs</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">nn</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">s</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">so</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">ma</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">ro</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">s</span></span></span></span>","key":"jP5PHzmeyp"}],"key":"JajUKAbLcJ"}],"key":"t4azNXFEPe"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Then, we are using the indentity ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qtL9QeNFVO"},{"type":"inlineCode","value":"y","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jwHwwkRQLV"},{"type":"text","value":" of the correct next character to pluck out a row of probabilities ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jWWIV6d9ff"},{"type":"inlineCode","value":"probs[y]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ggpMFTDYW2"},{"type":"text","value":" and then take the negative log to get the negative log probability: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dHsm3Y6yC8"},{"type":"inlineCode","value":"-log(probs[y])","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KTCfw4lxJ6"},{"type":"text","value":". And then we average up all the negative log probabilities to get our ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uWTRJrkecQ"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YAkhk1vIE0"}],"key":"A6uZYuULPC"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"riIyteqLTM"}],"key":"W431kJRCeC"}],"key":"PcSCv3sBD1"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineMath","value":"probs[y] \\rightarrow -log(probs[y]) \\rightarrow average\\ \\textbf{loss}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mi>r</mi><mi>o</mi><mi>b</mi><mi>s</mi><mo stretchy=\"false\">[</mo><mi>y</mi><mo stretchy=\"false\">]</mo><mo>→</mo><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=\"false\">(</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>b</mi><mi>s</mi><mo stretchy=\"false\">[</mo><mi>y</mi><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo><mo>→</mo><mi>a</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>a</mi><mi>g</mi><mi>e</mi><mtext> </mtext><mtext mathvariant=\"bold\">loss</mtext></mrow><annotation encoding=\"application/x-tex\">probs[y] \\rightarrow -log(probs[y]) \\rightarrow average\\ \\textbf{loss}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">ro</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mord mathnormal\">ro</span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">s</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">])</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">→</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">er</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">e</span><span class=\"mspace\"> </span><span class=\"mord text\"><span class=\"mord textbf\">loss</span></span></span></span></span>","key":"iYIig03Gkq"}],"key":"IrTzfGc9Oh"}],"key":"G0hBmN2hML"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Basically, given a logit vector ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gIXmWfXh3X"},{"type":"inlineMath","value":"l","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi></mrow><annotation encoding=\"application/x-tex\">l</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span></span></span></span>","key":"bLJs093a2e"},{"type":"text","value":", a softmax/probability vector ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U1t7f0KjvC"},{"type":"inlineMath","value":"P","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span>","key":"VqGC3zIZTL"},{"type":"text","value":" and a target label ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aqSbNdsQAO"},{"type":"inlineMath","value":"y","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"yLgMiaYHTp"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uNUm8j655i"}],"key":"g258jzoHiE"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"inlineMath","value":"loss = -\\log \\mathbf{P}_y = -\\log \\left(\\frac{e^{l_y}}{\\sum_j e^{l_j}}\\right)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><msub><mi mathvariant=\"bold\">P</mi><mi>y</mi></msub><mo>=</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mfrac><msup><mi>e</mi><msub><mi>l</mi><mi>y</mi></msub></msup><mrow><msub><mo>∑</mo><mi>j</mi></msub><msup><mi>e</mi><msub><mi>l</mi><mi>j</mi></msub></msup></mrow></mfrac><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">loss = -\\log \\mathbf{P}_y = -\\log \\left(\\frac{e^{l_y}}{\\sum_j e^{l_j}}\\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9805em;vertical-align:-0.2861em;\"></span><span class=\"mord\">−</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"mord\">−</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0429em;\"><span style=\"top:-2.5128em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mop op-symbol small-op mtight\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1496em;\"><span style=\"top:-2.1786em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4603em;\"><span></span></span></span></span></span></span><span class=\"mspace mtight\" style=\"margin-right:0.1952em;\"></span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9675em;\"><span style=\"top:-2.9714em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3448em;margin-left:-0.0197em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.6595em;\"></span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5092em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.927em;\"><span style=\"top:-2.931em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2306em;\"><span style=\"top:-2.3em;margin-left:-0.0197em;margin-right:0.1em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3944em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8095em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span></span></span></span>","key":"PEeD9HrJe7"}],"key":"D5KAdlzl5D"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"And we are basically interested in:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yD4klofNfb"}],"key":"TA7OwqFu1P"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"inlineMath","value":"\\nabla_{l_i} loss = \\dfrac{\\partial loss}{\\partial l_i} = \\dfrac{\\partial}{\\partial l_i} \\left[-\\log \\left(\\dfrac{e^{l_y}}{\\sum_j e^{l_j}}\\right)\\right]","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">∇</mi><msub><mi>l</mi><mi>i</mi></msub></msub><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>l</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mi mathvariant=\"normal\">∂</mi><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>l</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mrow><mo fence=\"true\">[</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mrow><mo fence=\"true\">(</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><msup><mi>e</mi><msub><mi>l</mi><mi>y</mi></msub></msup><mrow><msub><mo>∑</mo><mi>j</mi></msub><msup><mi>e</mi><msub><mi>l</mi><mi>j</mi></msub></msup></mrow></mfrac></mstyle><mo fence=\"true\">)</mo></mrow><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\nabla_{l_i} loss = \\dfrac{\\partial loss}{\\partial l_i} = \\dfrac{\\partial}{\\partial l_i} \\left[-\\log \\left(\\dfrac{e^{l_y}}{\\sum_j e^{l_j}}\\right)\\right]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9445em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord\">∇</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2074em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">[</span></span><span class=\"mord\">−</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5261em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7912em;\"><span style=\"top:-3.0051em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1218em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">)</span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">]</span></span></span></span></span></span>","key":"JUGq2Nu1VU"}],"key":"Rlkx3EfcSv"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"inlineMath","value":"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = -\\dfrac{\\sum_j e^{l_j}}{e^{l_y}} \\dfrac{\\partial}{\\partial l_i} \\left(\\dfrac{e^{l_y}}{\\sum_j e^{l_j}}\\right)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>            </mtext><mo>=</mo><mo>−</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><msub><mo>∑</mo><mi>j</mi></msub><msup><mi>e</mi><msub><mi>l</mi><mi>j</mi></msub></msup></mrow><msup><mi>e</mi><msub><mi>l</mi><mi>y</mi></msub></msup></mfrac></mstyle><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mi mathvariant=\"normal\">∂</mi><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>l</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mrow><mo fence=\"true\">(</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><msup><mi>e</mi><msub><mi>l</mi><mi>y</mi></msub></msup><mrow><msub><mo>∑</mo><mi>j</mi></msub><msup><mi>e</mi><msub><mi>l</mi><mi>j</mi></msub></msup></mrow></mfrac></mstyle><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = -\\dfrac{\\sum_j e^{l_j}}{e^{l_y}} \\dfrac{\\partial}{\\partial l_i} \\left(\\dfrac{e^{l_y}}{\\sum_j e^{l_j}}\\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6749em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7912em;\"><span style=\"top:-3.0051em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.8258em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5261em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7912em;\"><span style=\"top:-3.0051em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1218em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">)</span></span></span></span></span></span>","key":"T0AkEz3u6P"},{"type":"text","value":" (using ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"BER2FNjZMN"},{"type":"inlineMath","value":"\\dfrac{d\\log x}{dx} = \\dfrac{1}{x}","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi>d</mi><mi>log</mi><mo>⁡</mo><mi>x</mi></mrow><mrow><mi>d</mi><mi>x</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mn>1</mn><mi>x</mi></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{d\\log x}{dx} = \\dfrac{1}{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"BK7NPHTjtj"},{"type":"text","value":")","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"IaZrc6fial"}],"key":"zahzqFcPxV"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"inlineMath","value":"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = -\\dfrac{\\sum_j e^{l_j}}{e^{l_y}} \\dfrac{\\partial}{\\partial l_i} \\left(e^{l_y} \\dfrac{1}{\\sum_j e^{l_j}}\\right)","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>            </mtext><mo>=</mo><mo>−</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><msub><mo>∑</mo><mi>j</mi></msub><msup><mi>e</mi><msub><mi>l</mi><mi>j</mi></msub></msup></mrow><msup><mi>e</mi><msub><mi>l</mi><mi>y</mi></msub></msup></mfrac></mstyle><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mi mathvariant=\"normal\">∂</mi><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>l</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mrow><mo fence=\"true\">(</mo><msup><mi>e</mi><msub><mi>l</mi><mi>y</mi></msub></msup><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mn>1</mn><mrow><msub><mo>∑</mo><mi>j</mi></msub><msup><mi>e</mi><msub><mi>l</mi><mi>j</mi></msub></msup></mrow></mfrac></mstyle><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = -\\dfrac{\\sum_j e^{l_j}}{e^{l_y}} \\dfrac{\\partial}{\\partial l_i} \\left(e^{l_y} \\dfrac{1}{\\sum_j e^{l_j}}\\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6749em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7912em;\"><span style=\"top:-3.0051em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.8258em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">(</span></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7912em;\"><span style=\"top:-3.0051em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1218em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">)</span></span></span></span></span></span>","key":"MRrXHUg2vv"}],"key":"YPFVbj2sLL"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"if","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"z5geCoXiEu"}],"key":"AANQH3KGSE"},{"type":"text","value":" ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"tfhbFLUqVP"},{"type":"inlineMath","value":"i \\neq y","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo mathvariant=\"normal\">≠</mo><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">i \\neq y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\"><span class=\"mrel\"><span class=\"mord vbox\"><span class=\"thinbox\"><span class=\"rlap\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"inner\"><span class=\"mord\"><span class=\"mrel\"></span></span></span><span class=\"fix\"></span></span></span></span></span><span class=\"mrel\">=</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"Hd8ve8atNX"},{"type":"text","value":":","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"XnxdMy5V2F"}],"key":"Plikaglhva"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"inlineMath","value":"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = -\\dfrac{\\sum_j e^{l_j}}{e^{l_y}} \\left(\\dfrac{\\partial e^{l_y}}{\\partial l_i} \\cdot \\dfrac{1}{\\sum_j e^{l_j}} +e^{l_y} \\cdot \\dfrac{\\partial}{\\partial l_i} (\\dfrac{1}{\\sum_j e^{l_j}}) \\right)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>            </mtext><mo>=</mo><mo>−</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><msub><mo>∑</mo><mi>j</mi></msub><msup><mi>e</mi><msub><mi>l</mi><mi>j</mi></msub></msup></mrow><msup><mi>e</mi><msub><mi>l</mi><mi>y</mi></msub></msup></mfrac></mstyle><mrow><mo fence=\"true\">(</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msup><mi>e</mi><msub><mi>l</mi><mi>y</mi></msub></msup></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>l</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mn>1</mn><mrow><msub><mo>∑</mo><mi>j</mi></msub><msup><mi>e</mi><msub><mi>l</mi><mi>j</mi></msub></msup></mrow></mfrac></mstyle><mo>+</mo><msup><mi>e</mi><msub><mi>l</mi><mi>y</mi></msub></msup><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mi mathvariant=\"normal\">∂</mi><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>l</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mo stretchy=\"false\">(</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mn>1</mn><mrow><msub><mo>∑</mo><mi>j</mi></msub><msup><mi>e</mi><msub><mi>l</mi><mi>j</mi></msub></msup></mrow></mfrac></mstyle><mo stretchy=\"false\">)</mo><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = -\\dfrac{\\sum_j e^{l_j}}{e^{l_y}} \\left(\\dfrac{\\partial e^{l_y}}{\\partial l_i} \\cdot \\dfrac{1}{\\sum_j e^{l_j}} +e^{l_y} \\cdot \\dfrac{\\partial}{\\partial l_i} (\\dfrac{1}{\\sum_j e^{l_j}}) \\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6749em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7912em;\"><span style=\"top:-3.0051em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.8258em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5261em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7912em;\"><span style=\"top:-3.0051em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1218em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7912em;\"><span style=\"top:-3.0051em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1218em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">)</span></span></span></span></span></span>","key":"gvFfqPYNyr"}],"key":"AI74HdbiTr"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"inlineMath","value":"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = -\\dfrac{\\sum_j e^{l_j}}{e^{l_y}} \\left(0 \\cdot \\dfrac{1}{\\sum_j e^{l_j}} +e^{l_y} \\cdot \\dfrac{\\partial}{\\partial l_i} (\\dfrac{1}{\\sum_j e^{l_j}}) \\right)","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>            </mtext><mo>=</mo><mo>−</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><msub><mo>∑</mo><mi>j</mi></msub><msup><mi>e</mi><msub><mi>l</mi><mi>j</mi></msub></msup></mrow><msup><mi>e</mi><msub><mi>l</mi><mi>y</mi></msub></msup></mfrac></mstyle><mrow><mo fence=\"true\">(</mo><mn>0</mn><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mn>1</mn><mrow><msub><mo>∑</mo><mi>j</mi></msub><msup><mi>e</mi><msub><mi>l</mi><mi>j</mi></msub></msup></mrow></mfrac></mstyle><mo>+</mo><msup><mi>e</mi><msub><mi>l</mi><mi>y</mi></msub></msup><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mi mathvariant=\"normal\">∂</mi><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>l</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mo stretchy=\"false\">(</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mn>1</mn><mrow><msub><mo>∑</mo><mi>j</mi></msub><msup><mi>e</mi><msub><mi>l</mi><mi>j</mi></msub></msup></mrow></mfrac></mstyle><mo stretchy=\"false\">)</mo><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = -\\dfrac{\\sum_j e^{l_j}}{e^{l_y}} \\left(0 \\cdot \\dfrac{1}{\\sum_j e^{l_j}} +e^{l_y} \\cdot \\dfrac{\\partial}{\\partial l_i} (\\dfrac{1}{\\sum_j e^{l_j}}) \\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6749em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7912em;\"><span style=\"top:-3.0051em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.8258em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">(</span></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7912em;\"><span style=\"top:-3.0051em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1218em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7912em;\"><span style=\"top:-3.0051em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1218em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">)</span></span></span></span></span></span>","key":"HITRdQMN8U"}],"key":"gUCKeGp2tZ"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"inlineMath","value":"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = -\\dfrac{\\sum_j e^{l_j}}{e^{l_y}} \\left(-\\dfrac{e^{l_y} e^{l_i}}{(\\sum_j e^{l_j})^2} \\right)","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>            </mtext><mo>=</mo><mo>−</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><msub><mo>∑</mo><mi>j</mi></msub><msup><mi>e</mi><msub><mi>l</mi><mi>j</mi></msub></msup></mrow><msup><mi>e</mi><msub><mi>l</mi><mi>y</mi></msub></msup></mfrac></mstyle><mrow><mo fence=\"true\">(</mo><mo>−</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><msup><mi>e</mi><msub><mi>l</mi><mi>y</mi></msub></msup><msup><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub></msup></mrow><mrow><mo stretchy=\"false\">(</mo><msub><mo>∑</mo><mi>j</mi></msub><msup><mi>e</mi><msub><mi>l</mi><mi>j</mi></msub></msup><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></mfrac></mstyle><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = -\\dfrac{\\sum_j e^{l_j}}{e^{l_y}} \\left(-\\dfrac{e^{l_y} e^{l_i}}{(\\sum_j e^{l_j})^2} \\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6749em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7912em;\"><span style=\"top:-3.0051em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.8258em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">(</span></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5261em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7912em;\"><span style=\"top:-3.0051em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1218em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">)</span></span></span></span></span></span>","key":"kgv95QbTAB"}],"key":"cp2gbuO1sI"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"inlineMath","value":"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = \\dfrac{e^{l_i}}{\\sum_j e^{l_j}}","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>            </mtext><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><msup><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub></msup><mrow><msub><mo>∑</mo><mi>j</mi></msub><msup><mi>e</mi><msub><mi>l</mi><mi>j</mi></msub></msup></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = \\dfrac{e^{l_i}}{\\sum_j e^{l_j}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.6479em;vertical-align:-1.1218em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5261em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7912em;\"><span style=\"top:-3.0051em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1218em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"QJxYu2EtcP"}],"key":"tZJBKlPeDA"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"inlineMath","value":"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = P_i","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>            </mtext><mo>=</mo><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = P_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"gKLKR1nrf6"}],"key":"quli2G9Z5T"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"strong","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"if","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"WtRHx5WXoJ"}],"key":"CxalgAV38Y"},{"type":"text","value":" ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"Q6ZKk7gEEg"},{"type":"inlineMath","value":"i = y","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mo>=</mo><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">i = y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6595em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"JZwVkRR3Lk"},{"type":"text","value":":","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"hTkMyBZmuI"}],"key":"OZMw0KpgNa"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"inlineMath","value":"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = -\\dfrac{\\sum_j e^{l_j}}{e^{l_y}} \\left[\\dfrac{\\partial e^{l_y}}{\\partial l_i} \\cdot \\dfrac{1}{\\sum_j e^{l_j}} +e^{l_y} \\cdot \\dfrac{\\partial}{\\partial l_i} (\\dfrac{1}{\\sum_j e^{l_j}}) \\right]","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>            </mtext><mo>=</mo><mo>−</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><msub><mo>∑</mo><mi>j</mi></msub><msup><mi>e</mi><msub><mi>l</mi><mi>j</mi></msub></msup></mrow><msup><mi>e</mi><msub><mi>l</mi><mi>y</mi></msub></msup></mfrac></mstyle><mrow><mo fence=\"true\">[</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msup><mi>e</mi><msub><mi>l</mi><mi>y</mi></msub></msup></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>l</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mn>1</mn><mrow><msub><mo>∑</mo><mi>j</mi></msub><msup><mi>e</mi><msub><mi>l</mi><mi>j</mi></msub></msup></mrow></mfrac></mstyle><mo>+</mo><msup><mi>e</mi><msub><mi>l</mi><mi>y</mi></msub></msup><mo>⋅</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mi mathvariant=\"normal\">∂</mi><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>l</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mo stretchy=\"false\">(</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mn>1</mn><mrow><msub><mo>∑</mo><mi>j</mi></msub><msup><mi>e</mi><msub><mi>l</mi><mi>j</mi></msub></msup></mrow></mfrac></mstyle><mo stretchy=\"false\">)</mo><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = -\\dfrac{\\sum_j e^{l_j}}{e^{l_y}} \\left[\\dfrac{\\partial e^{l_y}}{\\partial l_i} \\cdot \\dfrac{1}{\\sum_j e^{l_j}} +e^{l_y} \\cdot \\dfrac{\\partial}{\\partial l_i} (\\dfrac{1}{\\sum_j e^{l_j}}) \\right]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6749em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7912em;\"><span style=\"top:-3.0051em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.8258em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">[</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5261em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7912em;\"><span style=\"top:-3.0051em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1218em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7912em;\"><span style=\"top:-3.0051em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1218em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">)</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">]</span></span></span></span></span></span>","key":"gEtRG13rDU"}],"key":"QBAXWBfobX"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"inlineMath","value":"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = -\\dfrac{\\sum_j e^{l_j}}{e^{l_y}} \\left[\\dfrac{e^{l_y}}{\\sum_j e^{l_j}} - \\dfrac{e^{l_y} e^{l_i}}{(\\sum_j e^{l_j})^2} \\right]","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>            </mtext><mo>=</mo><mo>−</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><msub><mo>∑</mo><mi>j</mi></msub><msup><mi>e</mi><msub><mi>l</mi><mi>j</mi></msub></msup></mrow><msup><mi>e</mi><msub><mi>l</mi><mi>y</mi></msub></msup></mfrac></mstyle><mrow><mo fence=\"true\">[</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><msup><mi>e</mi><msub><mi>l</mi><mi>y</mi></msub></msup><mrow><msub><mo>∑</mo><mi>j</mi></msub><msup><mi>e</mi><msub><mi>l</mi><mi>j</mi></msub></msup></mrow></mfrac></mstyle><mo>−</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><msup><mi>e</mi><msub><mi>l</mi><mi>y</mi></msub></msup><msup><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub></msup></mrow><mrow><mo stretchy=\"false\">(</mo><msub><mo>∑</mo><mi>j</mi></msub><msup><mi>e</mi><msub><mi>l</mi><mi>j</mi></msub></msup><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></mfrac></mstyle><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = -\\dfrac{\\sum_j e^{l_j}}{e^{l_y}} \\left[\\dfrac{e^{l_y}}{\\sum_j e^{l_j}} - \\dfrac{e^{l_y} e^{l_i}}{(\\sum_j e^{l_j})^2} \\right]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3em;vertical-align:-1.25em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6749em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7912em;\"><span style=\"top:-3.0051em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.8258em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">[</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5261em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7912em;\"><span style=\"top:-3.0051em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1218em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5261em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7912em;\"><span style=\"top:-3.0051em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1645em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1218em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">]</span></span></span></span></span></span>","key":"ZGv0m2V8pT"}],"key":"PDySPXdv8x"},{"type":"paragraph","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"inlineMath","value":"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = -1 + \\dfrac{e^{l_i}}{\\sum_j e^{l_j}}","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>            </mtext><mo>=</mo><mo>−</mo><mn>1</mn><mo>+</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><msup><mi>e</mi><msub><mi>l</mi><mi>i</mi></msub></msup><mrow><msub><mo>∑</mo><mi>j</mi></msub><msup><mi>e</mi><msub><mi>l</mi><mi>j</mi></msub></msup></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = -1 + \\dfrac{e^{l_i}}{\\sum_j e^{l_j}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.6479em;vertical-align:-1.1218em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5261em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7912em;\"><span style=\"top:-3.0051em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2819em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1218em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"gTz5t54GTY"}],"key":"iFGWDt4BHY"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"inlineMath","value":"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = P_i - 1","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>            </mtext><mo>=</mo><msub><mi>P</mi><mi>i</mi></msub><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = P_i - 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"I7fL0gTRt3"}],"key":"Gckp7AufsE"}],"key":"fyp8DA7lUx"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Sweet! By separating the casing of whether the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HpPa3DieM1"},{"type":"inlineMath","value":"ith","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>i</mi><mi>t</mi><mi>h</mi></mrow><annotation encoding=\"application/x-tex\">ith</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">h</span></span></span></span>","key":"Qz1jFee1PW"},{"type":"text","value":" index of the logits is equal or not equal to the label ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mg9UABUAm9"},{"type":"inlineMath","value":"y","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"n6YgwjVCFd"},{"type":"text","value":", and using basic rules of calculus such as the product rule and the power rule, we have derived the mathematical expression for the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ll45SpuhvV"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bq940fKb9X"}],"key":"fckYaSZNXc"},{"type":"text","value":" analytically. What we found is that for the first case we get ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UZQSPeYwda"},{"type":"inlineMath","value":"P_i","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">P_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"lmwZrmrBT6"},{"type":"text","value":" and for the other case ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QBqBeKWNZ8"},{"type":"inlineMath","value":"P_i - 1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">P_i - 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"KMQA30tJOy"},{"type":"text","value":". And that is the form that the gradient ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wNeIXHb4nA"},{"type":"inlineMath","value":"\\nabla_{l_i} loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi mathvariant=\"normal\">∇</mi><msub><mi>l</mi><mi>i</mi></msub></msub><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi></mrow><annotation encoding=\"application/x-tex\">\\nabla_{l_i} loss</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9445em;vertical-align:-0.2501em;\"></span><span class=\"mord\"><span class=\"mord\">∇</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3281em;\"><span style=\"top:-2.357em;margin-left:-0.0197em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span></span></span></span>","key":"PINBEw8FlX"},{"type":"text","value":" takes analytically. Now it’s time to implement it. Keep in mind, that we derived the analytical ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fvpdzAZCYk"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x9gIPkVnuR"}],"key":"nmf1xdQRAm"},{"type":"text","value":" only for a single example, but here we will be working with batches of examples. Thus the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qV2elYAm8Q"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CPxgGMTDJ7"}],"key":"a0iHafyJFi"},{"type":"text","value":" for a batch will be the average ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EXIIF5Itqb"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X2Zx8hRMVv"}],"key":"AKnt4XjTXc"},{"type":"text","value":" over all the examples, meaning the sum of all the individual losses per example, divided by the number of examples. And so we have to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EJtpJEhtQE"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bKgz8hSmr9"}],"key":"XN6wFkzt3h"},{"type":"text","value":"agate through that operation as well and be careful with it:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vUSDypE5u4"}],"key":"HfaxHTfQ0j"}],"key":"K1DCBWB4A1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# backward pass\ndlogits = F.softmax(logits, 1)  # apply softmax along the rows\ndlogits[\n    range(batch_size), yb\n] -= 1  # at the correct/target positions (where i == y) subtract 1\ndlogits /= batch_size  # divide by batch_size since the loss is also (during averaging across examples)\ncmp(\"logits\", dlogits, logits)  # we can only get approximate correctness ~6e-9","key":"oJ7zsF08X3"},{"type":"outputs","id":"DFyzhXzftMaNwyZEYR9cc","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"logits          | exact: False | approximate: True  | maxdiff: 6.05359673500061e-09\n"},"children":[],"key":"IfF2mvca8A"}],"key":"uHSq6N2A4a"}],"key":"HU3YiIKdmu"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As you can see, we get an approximately-correct but not an exactly-correct answer, with a slight deviation of ~","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gDK1ZqT5tz"},{"type":"inlineCode","value":"6e-9","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uSkRrmvc12"},{"type":"text","value":". This is due to floating point wonkiness, but this is basically the correct answer, approximately. Now, before we move on to the next exercise, let’s pause for a little bit in order to gain an intuitive sense of what ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m3XhLiQihj"},{"type":"inlineCode","value":"dlogits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iSHMwWMnfh"},{"type":"text","value":" is, because it has a beautiful and surprisingly simple explanation honestly.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Mv7QZeTV35"}],"key":"zdWya0KbPr"}],"key":"jft4vaCvhq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.imshow(dlogits.detach(), cmap=\"gray\")\nplt.show();","key":"WVCTrffAHz"},{"type":"outputs","id":"YsrGNobiSJh-zcjleJdNF","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"application/vnd.jupyter.widget-view+json":{"content":"{\"model_id\":\"3859a73b4fce4c36a28ae95aaeecc886\",\"version_major\":2,\"version_minor\":0}","content_type":"application/vnd.jupyter.widget-view+json"},"image/png":{"content_type":"image/png","hash":"03efd2dd251f2d28181bc81e65483bc8","path":"/build/03efd2dd251f2d28181bc81e65483bc8.png"},"text/html":{"content":"\n            <div style=\"display: inline-block;\">\n                <div class=\"jupyter-widgets widget-label\" style=\"text-align: center;\">\n                    Figure 1\n                </div>\n                <img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAoAAAAHgCAYAAAA10dzkAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjAsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvlHJYcgAAAAlwSFlzAAAPYQAAD2EBqD+naQAAK6hJREFUeJzt3X9s3XW9P/BXt7Vdt7WdBbZu7ocDlKls8wZkLipflV3GvCEiM/FXcochGL2FXFi8mhkVyTXZDSbK1SD8cy/cmzj1kggGkovRKSPmbty4e3fnROY252XcrUNn1nbd1nbr+f5xQ3OrAz4v+uNQ3o9HchJ6+uqb1+dH2+c+5/TzaqjVarUAAKAY0+rdAAAAk0sABAAojAAIAFAYARAAoDACIABAYQRAAIDCCIAAAIURAAEACiMAAgAURgAEACiMAAgAUBgBEACgMAIgAEBhBEAAgMIIgAAAhREAAQAKIwACABRGAAQAKIwACABQGAEQAKAwAiAAQGEEQACAwgiAAACFEQABAAojAAIAFEYABAAojAAIAFAYARAAoDACIABAYQRAAIDCCIAAAIURAAEACiMAAgAURgAEACiMAAgAUBgBEACgMAIgAEBhBEAAgMIIgAAAhREAAQAKIwACABRGAAQAKIwACABQGAEQAKAwAiAAQGEEQACAwgiAAACFEQABAAojAAIAFEYABAAojAAIAFAYARAAoDACIABAYQRAAIDCCIAAAIURAAEACjOj3g1AVcPDw3HkyJFobW2NhoaGercDMG5qtVr09fXFwoULY9o012aYeAIgU8aRI0di8eLF9W4DYMIcPnw4Fi1aVO82KIAAyKS6995746tf/Wp0d3fHqlWr4pvf/GZcddVVlb62tbU1IiL+8z//c+S/X8706dMr99bT01O5NiKiqampcu3g4GBq7ba2tsq1fX19qbUzVxdWrFiRWvsXv/hFqv7VciV3eHg4VZ/pe2hoKNtOZdkrRbVaLVXf0tJSuTa7DzPfE9nzZNasWZVrz507l1p7YGCgcm1mf588eTLe9a53Vf7ZBmMlADJpvve978WmTZvi/vvvj9WrV8c999wT69ati3379sW8efNe9utf+CXQ2to6IQEw+wtsIgPgRP4SyISG7C/ebN8C4J/KhIbM+Z1dO0IAPJ/M9312f0e8er4neO3zRgMmzde+9rW45ZZb4hOf+ES85S1vifvvvz9mzZoV//iP/1jv1gCgKAIgk2JwcDB27doVa9euHXlu2rRpsXbt2tixY8d5v2ZgYCB6e3tHPQCAsRMAmRS///3v49y5czF//vxRz8+fPz+6u7vP+zVbtmyJ9vb2kYc/AAGA8SEA8qq1efPm6OnpGXkcPny43i0BwGuCPwJhUlx44YUxffr0OHbs2Kjnjx07Fp2dnef9mubm5mhubp6M9gCgKK4AMimampriiiuuiG3bto08Nzw8HNu2bYs1a9bUsTMAKI8rgEyaTZs2xcaNG+PKK6+Mq666Ku65557o7++PT3ziE/VuDQCKIgAyaT784Q/H7373u/jSl74U3d3d8ba3vS0ef/zxP/nDEABgYjXUXsmdKqEOent7o729PZ5++unKNxzO3PQ4c9PbiIjTp09Xrp3IaRATeSPb7A2sszexbWxsTNVPlLNnz6bqly9fXrn217/+dWrtzPGcyBtYR0TMmFH9GkF2H2Zkf03Nnj27cm3m+zgid/PtzLHs6+uLVatWRU9PT2oSELxS3gMIAFAYARAAoDACIABAYQRAAIDCCIAAAIURAAEACiMAAgAURgAEACiMAAgAUBgBEACgMGYBM+UMDg5WHlGWGX2VHQmVGU+VGUkXkRuRlhntlpUdjzcwMJCqz4yay4zgisjt88zIs4iIX/3qV5Vrly1bllo7Mzou23d2pNrrXve6yrX9/f2ptTPHPjvCbiLPq8zIu8w5mN1GGCtXAAEACiMAAgAURgAEACiMAAgAUBgBEACgMAIgAEBhBEAAgMIIgAAAhREAAQAKIwACABRGAAQAKIxZwEw506dPrzy/c3h4uPK62Zm6mRmi2TmfmZm62bUz82Cza2f2d0Rulu25c+dSa2dkZzXPnDmzcu3//M//pNbOzKTO7u9sfU9PT+Xa7BzozD6/7LLLUms/88wzlWuz53jm50Tmey07kxjGyhVAAIDCCIAAAIURAAEACiMAAgAURgAEACiMAAgAUBgBEACgMAIgAEBhBEAAgMIIgAAAhTEKjilnxYoVlWsPHDhQufbs2bOpPjL12RFcmXFT2bWHhoYq17a0tKTWzox2i8iNyspuZ2a0VvbYZ8aHLVq0KLX2b37zm8q12fGFWZl92NjYmFo7cx5mRrtF5M6rbN+Dg4MTtjZMJlcAAQAKIwACABRGAAQAKIwACABQGAEQAKAwAiAAQGEEQACAwgiAAACFEQABAAojAAIAFEYABAAojFnATDm/+MUvorW1ddzXzc7tnDZt4v79dPr06cq1mbm0Ebn5vgMDA6m1J3LmcVaml+wM40z9c889l1o7M8c2M5c2In98li9fXrk2M3c7IjdnOFMbkdsv2X3Y3t5euTbzfQyTzRVAAIDCCIBMmi9/+cvR0NAw6pG5wgAAjA8vATOp3vrWt8aPf/zjkY+zL70BAGPnty+TasaMGdHZ2VnvNgCgaF4CZlLt378/Fi5cGBdffHF8/OMfj2efffZFawcGBqK3t3fUAwAYOwGQSbN69ep48MEH4/HHH4/77rsvDh06FO9+97ujr6/vvPVbtmyJ9vb2kcfixYsnuWMAeG1qqGXuOQDj6MSJE7F06dL42te+FjfffPOffH5gYGDUbUh6e3tj8eLFbgPzR7K3gcnceuXVdBuY7O06JvI2I5lz5ezZs6m1M/s8e+xfTbeByZjI28BkTdRtYPr6+uKtb31r9PT0RFtb2ytpDVK8B5C6mTt3brzpTW960V8czc3N0dzcPMldAcBrn5eAqZuTJ0/GwYMHY8GCBfVuBQCKIgAyaT7zmc/E9u3b47e//W3827/9W3zwgx+M6dOnx0c/+tF6twYARfESMJPmueeei49+9KNx/PjxuOiii+Jd73pX7Ny5My666KLUOo2NjZXfg3Xq1KnK62Zfbu7v769cm30PU+atuZnRbhG594Fl3xd5ySWXpOqffvrpyrXZe0ZmtjP7nrFM/Zw5c1Jrz5w5s3JtdtRY9j2dBw8erFybfX9h9tzKyLw3MntevdgfrY21j3PnzqX6gLESAJk03/3ud+vdAgAQXgIGACiOAAgAUBgBEACgMAIgAEBhBEAAgMIIgAAAhREAAQAKIwACABRGAAQAKIwACABQGKPgmHLOnTtXeW5mZs5ndq7q/PnzK9f+7ne/S63d1NRUufbMmTOptTOzaTOzlCMi9u7dm6rPzEg+e/Zsau3MHNbsPOXXv/71lWsPHDiQWnsiZfZJRO5cOXnyZLadyoaGhlL1mfMqO4M3MzM803f22MBYuQIIAFAYARAAoDACIABAYQRAAIDCCIAAAIURAAEACiMAAgAURgAEACiMAAgAUBgBEACgMEbBMeU0NDRMyNik4eHhVP0f/vCHyrXZcVPLly+vXHvo0KHU2pl9l90nmRFcWdm1p02r/u/bgYGB1Nr79++vXDuRI74yow4jJnacXtbMmTMr19ZqtdTamb4z50lEbmRk9vjAZHIFEACgMAIgAEBhBEAAgMIIgAAAhREAAQAKIwACABRGAAQAKIwACABQGAEQAKAwAiAAQGEEQACAwhhUyJQzNDQUQ0NDlWovvvjiyutmZ+pW7SEiorGxMbV2ZtZspo+IiMHBwcq17e3tqbXPnDmTqu/v769cm92HGRM5szU7TzczIzc72ze7D3t6eirXzpo1K7V2X19f5dqWlpbU2qdOnapcm50xndmHmeOTnRcOY+UKIABAYQRAAIDCCIAAAIURAAEACiMAAgAURgAEACiMAAgAUBgBEACgMAIgAEBhBEAAgMIIgAAAhTELmClneHg4hoeHK9X++te/rrzutGm5fw9lZohW7fcFtVqtcm12hmimPjOvNWJi92F2OzMzdTPzkSNyfS9YsCC19rFjxyrXZvd3dhZwZqbu0qVLU2vv3bu3cu3JkydTa2eOT3ZWc+Z7ObN2tg8YK1cAGRdPPvlkXH/99bFw4cJoaGiIRx55ZNTna7VafOlLX4oFCxZES0tLrF27Nvbv31+fZgGgcAIg46K/vz9WrVoV995773k/f/fdd8c3vvGNuP/+++Opp56K2bNnx7p16+LMmTOT3CkA4CVgxsX69etj/fr15/1crVaLe+65J77whS/EBz7wgYiI+Od//ueYP39+PPLII/GRj3xkMlsFgOK5AsiEO3ToUHR3d8fatWtHnmtvb4/Vq1fHjh076tgZAJTJFUAmXHd3d0REzJ8/f9Tz8+fPH/nc+QwMDMTAwMDIx729vRPTIAAUxhVAXrW2bNkS7e3tI4/FixfXuyUAeE0QAJlwnZ2dEfGnt7c4duzYyOfOZ/PmzdHT0zPyOHz48IT2CQClEACZcMuWLYvOzs7Ytm3byHO9vb3x1FNPxZo1a17065qbm6OtrW3UAwAYO+8BZFycPHkyDhw4MPLxoUOHYvfu3dHR0RFLliyJ22+/Pb7yla/EG9/4xli2bFl88YtfjIULF8YNN9xQv6YBoFACIOPi5z//ebz3ve8d+XjTpk0REbFx48Z48MEH47Of/Wz09/fHJz/5yThx4kS8613viscffzw1rQEAGB8NtczMKaij3t7eaG9vj927d0dra2ulr8mMysqOa/uLv/iLyrWPPvpoau1Zs2ZVrs2MvYrIjT3L/njI7sPMeLeJHJWVXfvs2bMT1EnueM6Ykfs3/NDQUKq+paWlcm322Gfqs/s7s1+y4/Qy3xOZ77W+vr74sz/7s+jp6fF2FyaF9wACABRGAAQAKIwACABQGAEQAKAwAiAAQGEEQACAwgiAAACFEQABAAojAAIAFEYABAAojAAIAFCY3CBJeBWo1WqV53FmZojOnDkz1cdjjz1WuTY7r/f06dOVa9vb21NrZ2aZvvnNb06tvW/fvlR9ZhZwdu5tRnaObWZ+bFNTU2rt5ubmyrWZWbOvpJeBgYHKtY2Njam1M173utel6o8fP165NjsLODM3OvN9n/0ZAWPlCiAAQGEEQACAwgiAAACFEQABAAojAAIAFEYABAAojAAIAFAYARAAoDACIABAYQRAAIDCGAXHlNPQ0FB5HFNmvNJEjoTKjDyLiGhtba1ce/LkydTamV5++ctfptbOyhyfzAi7iNxovzNnzqTWvvzyyyvX7t+/P7X2qVOnKtdmzsGIiNmzZ6fqe3p6KtdmR5llxsz94Q9/SK09kWPpsvu8quzPHxgrZxwAQGEEQACAwgiAAACFEQABAAojAAIAFEYABAAojAAIAFAYARAAoDACIABAYQRAAIDCCIAAAIUxC5gpp6mpKZqamirVDg0NVV53cHAw1Udm1uzp06dTa2frM2bNmlW5NjvDOCszVzU7K/UNb3hD5dp9+/al1n766acr12bOwYjczOPMORiRnxvd3NxcuTZ7rmTWzu7DjIk8xydyXjiMlSuAAACFEQABAAojAAIAFEYABAAojAAIAFAYARAAoDACIABAYQRAAIDCCIAAAIURAAEACmMUHFPOqlWrKo9Y+u1vf1t53ewouMy4tsxIqIiI2bNnV67Njvc6c+ZM5dps3zNmTNyPlGwvv/nNbyrXnjp1KrX29OnTK9dmR3xVHXMYkTuWEREtLS2p+sx+aWxsTK2d2S/ZMYCZEXnZ45P5OTE8PFy5NjMCEMaDK4AAAIURABkXTz75ZFx//fWxcOHCaGhoiEceeWTU52+66aZoaGgY9bjuuuvq0ywAFE4AZFz09/fHqlWr4t57733Rmuuuuy6OHj068vjOd74ziR0CAC/wHkDGxfr162P9+vUvWdPc3BydnZ2T1BEA8GJcAWTSPPHEEzFv3ry47LLL4tOf/nQcP3683i0BQJFcAWRSXHfddXHjjTfGsmXL4uDBg/H5z38+1q9fHzt27HjRv6gcGBiIgYGBkY97e3snq10AeE0TAJkUH/nIR0b+e8WKFbFy5cq45JJL4oknnohrrrnmvF+zZcuWuOuuuyarRQAohpeAqYuLL744Lrzwwjhw4MCL1mzevDl6enpGHocPH57EDgHgtcsVQOriueeei+PHj8eCBQtetKa5uTmam5snsSsAKIMAyLg4efLkqKt5hw4dit27d0dHR0d0dHTEXXfdFRs2bIjOzs44ePBgfPazn41LL7001q1bV8euAaBMAiDj4uc//3m8973vHfl406ZNERGxcePGuO+++2LPnj3xT//0T3HixIlYuHBhXHvttfG3f/u3rvABQB001AwgZIro7e2N9vb22LNnT7S2tlb6mszp3dbWluonMws4Mzs2Ijef9P/+pXQVmbmqE/3jITP3dsmSJam1M3OgszOMM8czuw/7+/tT9RnZmbqZ/XL27NnU2pk5uZnaiNzM46GhodTamX2SOU/6+vpi+fLl0dPTk/5ZBK+EPwIBACiMAAgAUBgBEACgMAIgAEBhBEAAgMIIgAAAhREAAQAKIwACABRGAAQAKIwACABQGAEQAKAwuQGY8Cpw5ZVXRkNDQ6Xaw4cPV143M9s3KztvNDM/tuq+eMHs2bMr12bn0mZntjY2Nlau3b9/f2rtzDzl7BzbTN+ZPrImcsZ0RO7cys48bm5urlyb/f4ZHBysXJv9/snIzF7OzmmGsXLGAQAURgAEACiMAAgAUBgBEACgMAIgAEBhBEAAgMIIgAAAhREAAQAKIwACABRGAAQAKIxRcEw5Tz31VLS2tlaq7enpqbzuzJkzU30MDAxUrp3IkV3t7e2ptU+dOlW5NrtPsqPGTp48Wbk2M34tKzvCLjNqrKmpKbX2rFmzJqSPiPx5mBnBlt3OzD6fO3duau3jx49Xrs2OYMuMDVy2bFnl2uwoPRgrVwABAAojAAIAFEYABAAojAAIAFAYARAAoDACIABAYQRAAIDCCIAAAIURAAEACiMAAgAURgAEACiMWcBMOdOmTas8vzMzXzM7xzYjO2+0oaGhcm2270wv2Vmzl156aap+//79lWuz+zAz9zY7h/X06dOVazOzYyNyxzM7wzi7D9va2irXZvZJRG6fZ2ZGR+RmWGePT2afZ87vvr6+WLVqVaoXGAtXAAEACiMAAgAURgAEACiMAAgAUBgBEACgMAIgAEBhBEAAgMIIgAAAhREAAQAKIwACABTGKDimnObm5mhubq5Ue+rUqcrrZseBNTY2Vq6dyJFd2RFcmbUz49QiIvbt25eqb2lpqVw7MDCQWjvT+5kzZ1JrNzU1Va6teq6+oK+vr3JtZmRgRH4UXObcyo4NzPSSHdeWkT3H3/KWt1SufeaZZyasDxgrVwABAAojADIutmzZEm9/+9ujtbU15s2bFzfccMOfXA06c+ZMdHV1xQUXXBBz5syJDRs2xLFjx+rUMQCUSwBkXGzfvj26urpi586d8aMf/SiGhobi2muvjf7+/pGaO+64Ix599NF46KGHYvv27XHkyJG48cYb69g1AJTJewAZF48//viojx988MGYN29e7Nq1K66++uro6emJf/iHf4itW7fG+973voiIeOCBB+LNb35z7Ny5M97xjnfUo20AKJIrgEyInp6eiIjo6OiIiIhdu3bF0NBQrF27dqRm+fLlsWTJktixY8d51xgYGIje3t5RDwBg7ARAxt3w8HDcfvvt8c53vjMuv/zyiIjo7u6OpqammDt37qja+fPnR3d393nX2bJlS7S3t488Fi9ePNGtA0ARBEDGXVdXV+zduze++93vjmmdzZs3R09Pz8jj8OHD49QhAJTNewAZV7feems89thj8eSTT8aiRYtGnu/s7IzBwcE4ceLEqKuAx44di87OzvOulbnfHwBQnSuAjItarRa33nprPPzww/GTn/wkli1bNurzV1xxRTQ2Nsa2bdtGntu3b188++yzsWbNmsluFwCK5gog46Krqyu2bt0aP/jBD6K1tXXkfX3t7e3R0tIS7e3tcfPNN8emTZuio6Mj2tra4rbbbos1a9b4C2AAmGQCIOPivvvui4iI97znPaOef+CBB+Kmm26KiIivf/3rMW3atNiwYUMMDAzEunXr4lvf+tYkdwoANNSyA1ChTnp7e6O9vT2am5srz0D97//+78rrZ2eZZgwNDaXqZ86cWbl2ImfkZmewZmceZ97jmd2HGdmZuhM5tzWznTNm5P4Nnz2ef/xX+y/lD3/4Q2rtzCztbN+Z45M99plfmZm1+/r6YsWKFdHT0xNtbW2pnuCV8B5AAIDCCIAAAIURAAEACiMAAgAURgAEACiMAAgAUBgBEACgMAIgAEBhBEAAgMIIgAAAhTELmCln586d0draWql2/vz5ldc9fPhwqo/MCLbs6LBTp05Vrm1vb5+wtTMj6SIizp07l6rP7MPM6LCs7Ai7zNjApqam1Npz5syZkD4i8vuwp6encm32XMns846OjtTax48fr1w7bVruOkh2dFxVprIy2VwBBAAojAAIAFAYARAAoDACIABAYQRAAIDCCIAAAIURAAEACiMAAgAURgAEACiMAAgAUBgBEACgMGYBM+U0NzdHc3NzpdrM3M6hoaFUH5nZnVX7fcGZM2cq1549eza1dmYGa6aPiIgZM3I/UrL1GZnjk53vmpmpO1GzYyPys4Cz+ztzrmTmOkfk9kt2hnFmvm92hnFmn2dmY2fnaMNYuQIIAFAYARAAoDACIABAYQRAAIDCCIAAAIURAAEACiMAAgAURgAEACiMAAgAUBgBEACgMEbBMeWcO3eu8tik559/vvK6vb29qT4yI6SyI9VaWloq154+fTq19hvf+MbKtfv370+tnR1nNXfu3Mq1x48fT609ffr0yrXZcXpNTU2Va7Pj2rIj1TImcnRcdh9mRsF1d3en1l62bFnl2qNHj6bWnqgRkNljA2PlCiAAQGEEQACAwgiAAACFEQABAAojAAIAFEYABAAojAAIAFAYARAAoDACIABAYQRAAIDCCIAAAIUxC5gpp7m5ufKMzZMnT1ZeNzPjMyI3u3PatNy/tTIzWDMzbyMiDh48WLk2u08y810jIk6cOFG5NjNXNSK3z7N9Z+beDg8Pp9ZubGysXJudvbxy5cpU/X/9139Vrs2eh5lzq7W1NbX2sWPHKtdm9ndEru/MDPDsvHAYK1cAAQAKIwAyLrZs2RJvf/vbo7W1NebNmxc33HBD7Nu3b1TNe97znmhoaBj1+NSnPlWnjgGgXAIg42L79u3R1dUVO3fujB/96EcxNDQU1157bfT394+qu+WWW+Lo0aMjj7vvvrtOHQNAubwHkHHx+OOPj/r4wQcfjHnz5sWuXbvi6quvHnl+1qxZ0dnZOdntAQD/hyuATIienp6IiOjo6Bj1/Le//e248MIL4/LLL4/NmzfHqVOnXnSNgYGB6O3tHfUAAMbOFUDG3fDwcNx+++3xzne+My6//PKR5z/2sY/F0qVLY+HChbFnz5743Oc+F/v27Yvvf//7511ny5Ytcdddd01W2wBQDAGQcdfV1RV79+6Nn/3sZ6Oe/+QnPzny3ytWrIgFCxbENddcEwcPHoxLLrnkT9bZvHlzbNq0aeTj3t7eWLx48cQ1DgCFEAAZV7feems89thj8eSTT8aiRYtesnb16tUREXHgwIHzBsDM/f4AgOoEQMZFrVaL2267LR5++OF44oknYtmyZS/7Nbt3746IiAULFkxwdwDA/yUAMi66urpi69at8YMf/CBaW1uju7s7IiLa29ujpaUlDh48GFu3bo33v//9ccEFF8SePXvijjvuiKuvvjo9nQAAGBsBkHFx3333RcT/3uz5/3rggQfipptuiqampvjxj38c99xzT/T398fixYtjw4YN8YUvfKEO3QJA2QRAxsXLzcdcvHhxbN++fVz+X0NDQzE0NFSpNjO3MzsPNjPjtampKbV25pY37e3tqbX/+ObcLyU7C3j58uWp+r1791auzcxHjsgdz4mceZw9rzLnSnZ+7C9/+ctUfab37FzizOzgtra21NpHjx6tXJs9r7LbCa9W7gMIAFAYARAAoDACIABAYQRAAIDCCIAAAIURAAEACiMAAgAURgAEACiMAAgAUBgBEACgMEbBMeWcPXs2zp49W6k2M8qqsbEx1ceSJUsq1x46dCi1dqbvzGi3iNwIu2nTcv9G3L9/f6p+cHCwcm3VY/6CzHZmx7Vlxphlz6vMdmbXzhoYGKhce8EFF6TWPn78+ITURuSOfdWxki/IjI7LHJ9sHzBWrgACABRGAAQAKIwACABQGAEQAKAwAiAAQGEEQACAwgiAAACFEQABAAojAAIAFEYABAAojAAIAFAYs4CZcmbOnBkzZ86sVJuZr5mZexoRceDAgVR9xooVKyrX/upXv0qtnZnvm5nVG5GbkRuRm5V67ty51NqZ+lqtllo7U5+ZSxsR0dLSUrk2Owc6s3ZE7vunp6cntXbmXMken9mzZ1euzc5TPnHiROXazDmY/V6DsXIFEACgMAIgAEBhBEAAgMIIgAAAhREAAQAKIwACABRGAAQAKIwACABQGAEQAKAwAiAAQGGMgmPKOX36dMyYUe3UzYyQqrrmK5EdkbZnz57KtU1NTam1z5w5U7m2ra0ttfbrX//6VP3+/fsr1zY0NKTWzsgen8x51dzcnFr71KlTqfqM7LixzD7PjBiMiDh79mzl2uzxyezD7Pf9rFmzKtdmtnEif/7A+bgCCABQGAEQAKAwAiAAQGEEQACAwgiAAACFEQABAAojAAIAFEYABAAojAAIAFAYARAAoDACIABAYQwfZMq58sorK88o/c1vflN53aGhoVQfLS0tE7Z2Zr7vwMBAau3MHNv+/v7U2vv27UvVZ+bHZuaqRuS2M1MbEXHu3LlUfcZEzjzOrp2dM52R2YeZ+dUREa2trZVrs3OGe3p6Ktdm9vdEnlNwPq4AMi7uu+++WLlyZbS1tUVbW1usWbMm/vVf/3Xk82fOnImurq644IILYs6cObFhw4Y4duxYHTsGgHIJgIyLRYsWxd/93d/Frl274uc//3m8733viw984APxy1/+MiIi7rjjjnj00UfjoYceiu3bt8eRI0fixhtvrHPXAFCmhlr2tQ+oqKOjI7761a/Ghz70objoooti69at8aEPfSgiIp555pl485vfHDt27Ih3vOMdldbr7e2N9vb2mDFjxmv+JeDMS0fDw8OptTP12R8P2foZM6q/C2UiXwLOvBQdkXu5rrGxMbV2RnZ/Z1/uzNZnDA4OVq7NnuNz5sypXPtqeQm4r68vVq1aFT09PdHW1pbqCV4JVwAZd+fOnYvvfve70d/fH2vWrIldu3bF0NBQrF27dqRm+fLlsWTJktixY0cdOwWAMvkjEMbNL37xi1izZk2cOXMm5syZEw8//HC85S1vid27d0dTU1PMnTt3VP38+fOju7v7RdcbGBgY9QcOvb29E9U6ABTFFUDGzWWXXRa7d++Op556Kj796U/Hxo0b4+mnn37F623ZsiXa29tHHosXLx7HbgGgXAIg46apqSkuvfTSuOKKK2LLli2xatWq+Pu///vo7OyMwcHBOHHixKj6Y8eORWdn54uut3nz5ujp6Rl5HD58eIK3AADKIAAyYYaHh2NgYCCuuOKKaGxsjG3bto18bt++ffHss8/GmjVrXvTrm5ubR24r88IDABg77wFkXGzevDnWr18fS5Ysib6+vti6dWs88cQT8cMf/jDa29vj5ptvjk2bNkVHR0e0tbXFbbfdFmvWrKn8F8AAwPgRABkXzz//fPzlX/5lHD16NNrb22PlypXxwx/+MP78z/88IiK+/vWvx7Rp02LDhg0xMDAQ69ati29961t17hoAyuQ+gEwZL9wH8Omnn6486ilz/73Mff0icmPSsi9fZ9bOjpDK3PMue/+17D7M3AsuK3MPttmzZ6fWPn36dOXa7I/YzPHJrn3ppZem6l+4kXsVs2bNSq196tSpyrXZ45MZHfdquXdlX19fvO1tb3MfQCaN9wACABRGAAQAKIwACABQGAEQAKAwAiAAQGEEQACAwgiAAACFEQABAAojAAIAFEYABAAojFnATBkvjGw6efJk5a/JjILLjG2KyI1ry4wly679ahoFl92Hr5ZRcNntnKqj4LL1fX19lWuz52FmFFz2+EzFUXAv/FwznZXJYhYwU8Zzzz0XixcvrncbABPm8OHDsWjRonq3QQEEQKaM4eHhOHLkSLS2to66utPb2xuLFy+Ow4cPv6aHqJewnSVsY4TtfK0Zj+2s1WrR19cXCxcuTF0FhlfKS8BMGdOmTXvJfxm3tbW9pn/JvKCE7SxhGyNs52vNWLezvb19HLuBl+afGQAAhREAAQAKIwAy5TU3N8edd94Zzc3N9W5lQpWwnSVsY4TtfK0pZTt5bfFHIAAAhXEFEACgMAIgAEBhBEAAgMIIgAAAhREAmdLuvffeeMMb3hAzZ86M1atXx7//+7/Xu6Vx9eUvfzkaGhpGPZYvX17vtsbsySefjOuvvz4WLlwYDQ0N8cgjj4z6fK1Wiy996UuxYMGCaGlpibVr18b+/fvr0+wYvNx23nTTTX9yfK+77rr6NPsKbdmyJd7+9rdHa2trzJs3L2644YbYt2/fqJozZ85EV1dXXHDBBTFnzpzYsGFDHDt2rE4dvzJVtvM973nPnxzPT33qU3XqGF6aAMiU9b3vfS82bdoUd955Z/zHf/xHrFq1KtatWxfPP/98vVsbV29961vj6NGjI4+f/exn9W5pzPr7+2PVqlVx7733nvfzd999d3zjG9+I+++/P5566qmYPXt2rFu3Ls6cOTPJnY7Ny21nRMR111036vh+5zvfmcQOx2779u3R1dUVO3fujB/96EcxNDQU1157bfT394/U3HHHHfHoo4/GQw89FNu3b48jR47EjTfeWMeu86psZ0TELbfcMup43n333XXqGF5GDaaoq666qtbV1TXy8blz52oLFy6sbdmypY5dja8777yztmrVqnq3MaEiovbwww+PfDw8PFzr7OysffWrXx157sSJE7Xm5ubad77znTp0OD7+eDtrtVpt48aNtQ984AN16WeiPP/887WIqG3fvr1Wq/3vsWtsbKw99NBDIzW/+tWvahFR27FjR73aHLM/3s5arVb7f//v/9X++q//un5NQYIrgExJg4ODsWvXrli7du3Ic9OmTYu1a9fGjh076tjZ+Nu/f38sXLgwLr744vj4xz8ezz77bL1bmlCHDh2K7u7uUce2vb09Vq9e/Zo7thERTzzxRMybNy8uu+yy+PSnPx3Hjx+vd0tj0tPTExERHR0dERGxa9euGBoaGnU8ly9fHkuWLJnSx/OPt/MF3/72t+PCCy+Myy+/PDZv3hynTp2qR3vwsmbUuwF4JX7/+9/HuXPnYv78+aOenz9/fjzzzDN16mr8rV69Oh588MG47LLL4ujRo3HXXXfFu9/97ti7d2+0trbWu70J0d3dHRFx3mP7wudeK6677rq48cYbY9myZXHw4MH4/Oc/H+vXr48dO3bE9OnT691e2vDwcNx+++3xzne+My6//PKI+N/j2dTUFHPnzh1VO5WP5/m2MyLiYx/7WCxdujQWLlwYe/bsic997nOxb9+++P73v1/HbuH8BEB4FVu/fv3If69cuTJWr14dS5cujX/5l3+Jm2++uY6dMR4+8pGPjPz3ihUrYuXKlXHJJZfEE088Eddcc00dO3tlurq6Yu/eva+J96m+lBfbzk9+8pMj/71ixYpYsGBBXHPNNXHw4MG45JJLJrtNeEleAmZKuvDCC2P69Ol/8peEx44di87Ozjp1NfHmzp0bb3rTm+LAgQP1bmXCvHD8Sju2EREXX3xxXHjhhVPy+N56663x2GOPxU9/+tNYtGjRyPOdnZ0xODgYJ06cGFU/VY/ni23n+axevToiYkoeT177BECmpKamprjiiiti27ZtI88NDw/Htm3bYs2aNXXsbGKdPHkyDh48GAsWLKh3KxNm2bJl0dnZOerY9vb2xlNPPfWaPrYREc8991wcP358Sh3fWq0Wt956azz88MPxk5/8JJYtWzbq81dccUU0NjaOOp779u2LZ599dkodz5fbzvPZvXt3RMSUOp6Uw0vATFmbNm2KjRs3xpVXXhlXXXVV3HPPPdHf3x+f+MQn6t3auPnMZz4T119/fSxdujSOHDkSd955Z0yfPj0++tGP1ru1MTl58uSoqyKHDh2K3bt3R0dHRyxZsiRuv/32+MpXvhJvfOMbY9myZfHFL34xFi5cGDfccEP9mn4FXmo7Ozo64q677ooNGzZEZ2dnHDx4MD772c/GpZdeGuvWratj1zldXV2xdevW+MEPfhCtra0j7+trb2+PlpaWaG9vj5tvvjk2bdoUHR0d0dbWFrfddlusWbMm3vGOd9S5++pebjsPHjwYW7dujfe///1xwQUXxJ49e+KOO+6Iq6++OlauXFnn7uE86v1nyDAW3/zmN2tLliypNTU11a666qrazp07693SuPrwhz9cW7BgQa2pqan2+te/vvbhD3+4duDAgXq3NWY//elPaxHxJ4+NGzfWarX/vRXMF7/4xdr8+fNrzc3NtWuuuaa2b9+++jb9CrzUdp46dap27bXX1i666KJaY2NjbenSpbVbbrml1t3dXe+2U863fRFRe+CBB0ZqTp8+Xfurv/qr2ute97rarFmzah/84AdrR48erV/Tr8DLbeezzz5bu/rqq2sdHR215ubm2qWXXlr7m7/5m1pPT099G4cX0VCr1WqTGTgBAKgv7wEEACiMAAgAUBgBEACgMAIgAEBhBEAAgMIIgAAAhREAAQAKIwACABRGAAQAKIwACABQGAEQAKAwAiAAQGEEQACAwgiAAACFEQABAAojAAIAFEYABAAojAAIAFAYARAAoDACIABAYQRAAIDCCIAAAIURAAEACiMAAgAURgAEACiMAAgAUBgBEACgMAIgAEBhBEAAgMIIgAAAhREAAQAK8/8ByheAeNvyTS8AAAAASUVORK5CYII=' width=640.0/>\n            </div>\n        ","content_type":"text/html"},"text/plain":{"content":"Canvas(toolbar=Toolbar(toolitems=[('Home', 'Reset original view', 'home', 'home'), ('Back', 'Back to previous …","content_type":"text/plain"}}},"children":[],"key":"knVPCdi71F"}],"key":"Q8VCqGF429"}],"key":"ao85Auj23Q"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here, we are visualizing the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jgoDxOSuUq"},{"type":"inlineCode","value":"dlogits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aAE1AIFmU3"},{"type":"text","value":" tensor that contains ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UadXK8iWLi"},{"type":"text","value":"32","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KSahz00ocB"},{"type":"text","value":" examples and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MIhSkdWJ5z"},{"type":"text","value":"27","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XAOcsOKq9c"},{"type":"text","value":" characters per example. What is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KfQ5OAxPFV"},{"type":"inlineCode","value":"dlogits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CvpxNV75SS"},{"type":"text","value":" intuitively? ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YpS0wug7JC"},{"type":"inlineCode","value":"dlogits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a5bJdm4sGq"},{"type":"text","value":" is the softmax/probabilities matrix of the forward pass! The black squares are the positions of the correct indices where we subtracted a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uJ4lzEUxDY"},{"type":"inlineCode","value":"1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CgSHXsG7v6"},{"type":"text","value":". So what does this mean? Let’s look at the values of the first row:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zo6PMygGIk"}],"key":"rCo5oFAhUA"}],"key":"rghzDhWdut"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"F.softmax(logits, 1)[0]","key":"WKroQnvIKw"},{"type":"outputs","id":"3jC_G-oQP8hm4t9NYTLm9","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":87,"metadata":{},"data":{"text/plain":{"content":"tensor([0.0731, 0.0872, 0.0182, 0.0518, 0.0192, 0.0845, 0.0231, 0.0355, 0.0173,\n        0.0319, 0.0364, 0.0370, 0.0371, 0.0285, 0.0345, 0.0132, 0.0085, 0.0190,\n        0.0148, 0.0545, 0.0513, 0.0209, 0.0247, 0.0721, 0.0584, 0.0259, 0.0215],\n       grad_fn=<SelectBackward0>)","content_type":"text/plain"}}},"children":[],"key":"meaKrLonob"}],"key":"ye2GrK33tN"}],"key":"UqY2BqJBym"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So these are the probabilities of the first row. Whereas:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AQGoBVqsaI"}],"key":"q1y1rHVnBj"}],"key":"oaX3LaZLKz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dlogits[0] * batch_size","key":"fX3Gb1nuqo"},{"type":"outputs","id":"H02z0zijpiBHXZIElHc1u","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":88,"metadata":{},"data":{"text/plain":{"content":"tensor([ 0.0731,  0.0872,  0.0182,  0.0518,  0.0192,  0.0845,  0.0231,  0.0355,\n        -0.9827,  0.0319,  0.0364,  0.0370,  0.0371,  0.0285,  0.0345,  0.0132,\n         0.0085,  0.0190,  0.0148,  0.0545,  0.0513,  0.0209,  0.0247,  0.0721,\n         0.0584,  0.0259,  0.0215], grad_fn=<MulBackward0>)","content_type":"text/plain"}}},"children":[],"key":"PQafQCZ6FT"}],"key":"bKDdrFG5BS"}],"key":"OFyJ7Mmect"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"gives us the derivatives. Which is exactly equal to the probabilities, except that the value at the position of the correct index which has the probability value ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M7A8fYHvUD"},{"type":"inlineCode","value":"p - 1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZAVPVLA0Mf"},{"type":"text","value":"! Also if we sum ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mSgOH8CIGT"},{"type":"inlineCode","value":"dlogits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QDf8zZHiuU"},{"type":"text","value":" of this row, we find out they sum to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Gm3lhcDXHT"},{"type":"inlineCode","value":"0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y7nB3KfMLi"},{"type":"text","value":" (or at least very close to it):","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ScedbZuY8t"}],"key":"SHoOYrkxX9"}],"key":"aqntd3uMYo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dlogits[0].sum()","key":"kDDwgpI7Bb"},{"type":"outputs","id":"DB0OSni7fsaBxK7RvzDDY","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":89,"metadata":{},"data":{"text/plain":{"content":"tensor(1.3970e-09, grad_fn=<SumBackward0>)","content_type":"text/plain"}}},"children":[],"key":"AxLEAO3Fbt"}],"key":"O20sN9VWPV"}],"key":"pe8K3SRhQs"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can think of the gradients of each row here as a ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q2TwGR05w7"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"force","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IdFpyZ9mQR"}],"key":"fDNYNKCbfc"},{"type":"text","value":" that pulls down on the probabilities of the incorrect characters and pulls up the probability at the correct (black dotted) index. And that’s what’s basically happening in each row. And the amount of push and pull is exactly equalized because the sum is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mQFW05Ybve"},{"type":"text","value":"0","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rzdIBOEeKW"},{"type":"text","value":". So the amount to which we pull down in the probabilities and the amount that we push up on the probability of the correct character is equal. So the repulsion and the attraction are equal. So you can think of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A8pZtDIIgf"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V2y0LuMjwj"}],"key":"AVxenaRUb5"},{"type":"text","value":" now as a massive pulley system, or something like that, in which at the level of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H7qqlfFbcZ"},{"type":"inlineCode","value":"dlogits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z9OJx1DZDY"},{"type":"text","value":" we’re pulling down the probabilities of incorrect and pulling up the probability of the correct ones. And in this complicated pulley system, we think of it as sort of like this tension translating to this complicating pulley mechanism and then eventually we get a tug on the weights and the biases. And basically in each update we just kind of like tug in the direction that we’d like for each of these elements and the parameters are slowly given in to the tug and that’s what training the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"spQjynFs8u"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vOYx0IBFCo"}],"key":"xrf8aCUskj"},{"type":"text","value":" kind of looks like on a high level. And so the forces of push and pull in these gradients (e.g. see the values of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XSzx2T8Ctu"},{"type":"inlineCode","value":"dlogits[0] * batch_size","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XUJ6RoULF7"},{"type":"text","value":") are actually very intuitive here we’re pushing and pulling on the correct answer and the amount of force that we’re applying is actually proportional to the probabilities that came out in the forward pass. And so for example if our probabilities came out exactly correct, so they would have had zero everywhere except for one at the correct position then the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iI9AukucJn"},{"type":"inlineCode","value":"dlogits","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nwk7Ma4UrS"},{"type":"text","value":" would be all a row of zeros for that example: there would be no push and pull. So the amount to which your prediction is incorrect is exactly the amount by which you’re going to get a pull or a push in that dimension. So if you have for example a very confidently mispredicted element, then what’s going to happen is that element is going to be pulled down very heavily and the correct answer is going to be pulled up to the same amount and the other characters are not going to be influenced too much. So the amount to which you mispredict is then proportional to the strength of the pull and that’s happening independently in all the dimensions of this tensor and it’s sort of very intuitive and very easy to think through and that’s basically the magic of the cross entropy loss and what it’s doing dynamically in the backward pass of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QNOnpQQDiC"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LOSBXziYys"}],"key":"JZer2CCcHW"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NkOKvMZdsl"}],"key":"Vi7qiKiddK"}],"key":"VqwmWE3OYW"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercise 3: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pX8GhPXvM3"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m8EbuND00J"}],"key":"iniPa9fZwA"},{"type":"text","value":" through ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ewUdPVrWXG"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"batchnorm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dNgbNvvwTh"}],"key":"sw9AQuyD4D"},{"type":"text","value":" but all in one go","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tAI0Cmn1Ye"}],"identifier":"exercise-3-backprop-through-batchnorm-but-all-in-one-go","label":"Exercise 3: backprop through batchnorm but all in one go","html_id":"exercise-3-backprop-through-batchnorm-but-all-in-one-go","implicit":true,"key":"JzrnArFWdQ"}],"key":"YemjiJLgul"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We now get to exercise number three, which is a very fun exercise depending on your definition of fun. We are going to do for ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Hqmi56kYDX"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"batchnorm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eeqnsAEMFu"}],"key":"BL35p4GAt4"},{"type":"text","value":" exactly what we did for cross entropy ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U4Ro89Wqwb"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p5yzRwG2kl"}],"key":"CK49gpxJT5"},{"type":"text","value":" in exercise 2. That is that is we are going to consider it as a glued single mathematical expression and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KPXNwoHQEm"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CrsuGDeet5"}],"key":"V1fI7DGpLq"},{"type":"text","value":" through it in a very efficient manner because we are going to derive a much simpler formula for the backward pass of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uq6xZ1xAaw"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"batchnorm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WVfiKolMkR"}],"key":"Kl3SuvbmF9"},{"type":"text","value":" and we’re going to do that using pen and paper. So previously we’ve broken up ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"npAzBfGU30"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"batchnorm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"e3UZvimQBN"}],"key":"LkO7Zqlo1m"},{"type":"text","value":" into all of the little intermediate pieces and all the atomic operations inside it and then we ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gEFSmS7xbr"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jIyom9v7F9"}],"key":"MiztGr4p7r"},{"type":"text","value":"agated through it one by one. Now, we just have a single forward pass and it’s all glued together:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tG6TTOvdoK"}],"key":"mKS3lqmXtc"}],"key":"sxGXefrHxj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Exercise 3: backprop through batchnorm but all in one go\n# to complete this challenge look at the mathematical expression of the output of batchnorm,\n# take the derivative w.r.t. its input, simplify the expression, and just write it out\n\n# forward pass\n\n# before:\n# bnmeani = 1/n*hprebn.sum(0, keepdim=True)\n# bndiff = hprebn - bnmeani\n# bndiff2 = bndiff**2\n# bnvar = 1/(n-1)*(bndiff2).sum(0, keepdim=True) # note: Bessel's correction (dividing by n-1, not n)\n# bnvar_inv = (bnvar + 1e-5)**-0.5\n# bnraw = bndiff * bnvar_inv\n# hpreact = bngain * bnraw + bnbias\n\n# now:\nhpreact_fast = (\n    bngain\n    * (hprebn - hprebn.mean(0, keepdim=True))\n    / torch.sqrt(hprebn.var(0, keepdim=True, unbiased=True) + 1e-5)\n    + bnbias\n)\nprint(\"max diff:\", (hpreact_fast - hpreact).abs().max())","key":"O03ZK3zHRH"},{"type":"outputs","id":"JFfBtZ_aUFHOGxZvXGn7-","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"max diff: tensor(4.7684e-07, grad_fn=<MaxBackward1>)\n"},"children":[],"key":"ybFrrJU9a4"}],"key":"y9vJjOTs7O"}],"key":"hSebzYi8z6"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And we see that we get the exact same result as before: an almost-zero difference. Now for the backward pass, we’d like to also implement a single formula basically for backpropagating through this entire operation that is the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l4bFRDoHgt"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"batchnorm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LoLi1NzJrC"}],"key":"M3gYfnCBFl"},{"type":"text","value":". So in the forward pass previously we took ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NqHurJQWHP"},{"type":"inlineCode","value":"hprebn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tZpKgSBGy9"},{"type":"text","value":", the hidden states of the pre batch normalization and created ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QmzLX8QMD4"},{"type":"inlineCode","value":"hpreact","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cKZO8UalG0"},{"type":"text","value":" which is the hidden states just before the activation. In the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IIKnaXyUjX"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"batchnorm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IlMHv0ny5E"}],"key":"fJrUZirwx5"},{"type":"text","value":" paper:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vAwdJoYCNk"}],"key":"qAEJZRWwWE"}],"key":"NqaOgXgwIZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from IPython.display import Image, display\n\ndisplay(Image(filename=\"batchnorm_algorithm1.png\"))","key":"C72lO557Gt"},{"type":"outputs","id":"vG7Ct1xMxFu0MezR23_g_","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6ecabca641096f0ba608ebabb87d481d","path":"/build/6ecabca641096f0ba608ebabb87d481d.png"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}},"children":[],"key":"VohFwEFvzr"}],"key":"rscN5PGPiw"}],"key":"WG8StnTHCX"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineCode","value":"hprebn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uOhiyY2Z8W"},{"type":"text","value":" is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"frc5Dt7D0V"},{"type":"inlineMath","value":"x","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"jq7gREIwLQ"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GlBgeiYdnY"},{"type":"inlineCode","value":"hpreact","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Eg0A7Wa0Mm"},{"type":"text","value":" is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lN8ZJS1Pqx"},{"type":"inlineMath","value":"y","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"G8R24J6ZbV"},{"type":"text","value":". So in the backward pass what we’d like to do now is we have ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z9afOwEBzB"},{"type":"inlineCode","value":"dhpreact","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wiJPXw7luY"},{"type":"text","value":" and we’d like to produce ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rPWRvMgkUo"},{"type":"inlineCode","value":"dhprebn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IemWqcJ4DJ"},{"type":"text","value":" and we’d like to do that in a very efficient manner. So that’s the name of the game. Calculate ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QKbGILO2Qf"},{"type":"inlineCode","value":"dhprebn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q5qbLoUueF"},{"type":"text","value":" given ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WMfG0jcKjD"},{"type":"inlineCode","value":"dhpreact","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dz0WQITtFn"},{"type":"text","value":" and for the purposes of this exercise, we’re going to ignore ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ju3Y4l9yAi"},{"type":"inlineCode","value":"gamma","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lFgbCcslyu"},{"type":"text","value":" and ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IcjGx4AFQL"},{"type":"inlineCode","value":"beta","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MVjx3GPTk1"},{"type":"text","value":" and their derivatives, because they take on a very simple form in a very similar way to what we did up above. So let’s calculate ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YhhdnHNpXB"},{"type":"inlineCode","value":"dhprebn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V7Oj6xl71O"},{"type":"text","value":" (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"suGwllmLJ8"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial x_i}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial x_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2074em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"o1eeiJvtiI"},{"type":"text","value":") given ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bh6OX0Q4ge"},{"type":"inlineCode","value":"dhpreact","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kTbbI6Aw6D"},{"type":"text","value":" (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PAGG3bxdzd"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial y_i}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>y</mi><mi>i</mi></msub></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial y_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"Je0x9aNbss"},{"type":"text","value":") (i.e. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LWidx9NvQx"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"foF9JgaWX6"}],"key":"Gcd8h5zS4U"},{"type":"text","value":" through the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Im7GFYvBYk"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"batchnorm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DMKEBrq6mA"}],"key":"Tm7YOpnvvY"},{"type":"text","value":"). According to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fPkr99pQrn"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Algorithm 1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ruKDSnnYFj"}],"key":"zmeudqQ6uh"},{"type":"text","value":" above (from the paper):","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KFJpzesyaJ"}],"key":"Mc0XZRUXik"},{"type":"code","lang":"ascii","value":"       ____μ______(3)_______\n      ╱     ╲               │     \n    (4)      ╲              │\n    ╱         ╲             ↓  \n  [x]---→σ²---(2)---→[x̂]---(1)-----→[y]\n    ╲                       ↑       ╱│\n     ╲______________________│      γ β        ","position":{"start":{"line":4,"column":1},"end":{"line":12,"column":1}},"key":"sSQ9GxFVzy"}],"key":"pXm6J05Wke"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"the bracketed variables represent vectors and the numbering represents the order in which we are going to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SXrii4mFdj"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZIalOJtpmU"}],"key":"QETFE9stWC"},{"type":"text","value":", going from ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wWHrPeHUCX"},{"type":"inlineCode","value":"(1)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SGZngFp9g6"},{"type":"text","value":" (right) all the way to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wtbiZVsMPG"},{"type":"inlineCode","value":"(4)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FWWLYcM7VI"},{"type":"text","value":" (left). Therefore, given ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IbsbomAOjV"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial y_i}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>y</mi><mi>i</mi></msub></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial y_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"hyDB4CGSRZ"},{"type":"text","value":" we want to calculate ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lWZJNgy9m8"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial x_i}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial x_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2074em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"w5gJyUHm4y"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x0KPCBqwSy"}],"key":"nh8eeSkEUy"}],"key":"Q3SKBEuDFg"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l573PtcDIk"}],"key":"uzvPfj5sDt"},{"type":"text","value":". ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"taLG0grDZH"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial \\hat{x}_i} = \\gamma \\dfrac{\\partial L}{\\partial y_i}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>i</mi></msub></mrow></mfrac></mstyle><mo>=</mo><mi>γ</mi><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>y</mi><mi>i</mi></msub></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial \\hat{x}_i} = \\gamma \\dfrac{\\partial L}{\\partial y_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2074em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"XFMx6nRI57"},{"type":"text","value":", easy enough :)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vXyOBz7b9X"}],"key":"DMSYRqHSLM"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"2","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Ov9CrbyeVw"}],"key":"HhLHPuRMuK"},{"type":"text","value":". ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KFkSGPYYqT"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial \\sigma^2} = \\sum_i \\dfrac{\\partial L}{\\partial \\hat{x}_i} \\dfrac{\\partial \\hat{x}_i}{\\partial \\sigma^2}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msup><mi>σ</mi><mn>2</mn></msup></mrow></mfrac></mstyle><mo>=</mo><msub><mo>∑</mo><mi>i</mi></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>i</mi></msub></mrow></mfrac></mstyle><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>i</mi></msub></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msup><mi>σ</mi><mn>2</mn></msup></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial \\sigma^2} = \\sum_i \\dfrac{\\partial L}{\\partial \\hat{x}_i} \\dfrac{\\partial \\hat{x}_i}{\\partial \\sigma^2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2074em;vertical-align:-0.836em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"GxNbgC3Ulr"},{"type":"text","value":", we sum the product of the local and global derivative because ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GuSLwdWJbO"},{"type":"inlineMath","value":"\\sigma^2","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\sigma^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"LovfniOz3Z"},{"type":"text","value":" feeds into each ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MsNLIZ0tbr"},{"type":"inlineMath","value":"\\hat{x}_i","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\hat{x}_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"y4kkLJnLDW"},{"type":"text","value":" of the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LybhWFNnYp"},{"type":"inlineMath","value":"\\hat{x}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\hat{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span></span></span></span>","key":"t2y2HRcSuM"},{"type":"text","value":" vector (so basically there are ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hjlpsP040D"},{"type":"inlineMath","value":"m","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"bd650AzVcf"},{"type":"text","value":" (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NDp6Tb9Zdw"},{"type":"inlineCode","value":"batch_size","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"THXYM7Rm4A"},{"type":"text","value":", e.g. ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IEgHRu4nZ2"},{"type":"text","value":"32","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LkJyZSl8Dq"},{"type":"text","value":") number of arrows feeding from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gctGegZovq"},{"type":"inlineMath","value":"\\hat{x}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\hat{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span></span></span></span>","key":"mGjGvi5gFG"},{"type":"text","value":" back into ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oaWXBQEaHq"},{"type":"inlineMath","value":"\\sigma^2","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\sigma^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"RpH5wVGCdI"},{"type":"text","value":")","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eKVKqSL6e4"}],"key":"eHmd3QfDB1"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"inlineMath","value":"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = \\gamma \\sum_i \\dfrac{\\partial L}{\\partial y_i} \\dfrac{\\partial}{\\partial \\sigma^2} \\left[ ( x_i - \\mu ) (\\sigma^2 + \\epsilon)^{-1/2} \\right]","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>              </mtext><mo>=</mo><mi>γ</mi><msub><mo>∑</mo><mi>i</mi></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>y</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mi mathvariant=\"normal\">∂</mi><mrow><mi mathvariant=\"normal\">∂</mi><msup><mi>σ</mi><mn>2</mn></msup></mrow></mfrac></mstyle><mrow><mo fence=\"true\">[</mo><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mi>μ</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow></msup><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = \\gamma \\sum_i \\dfrac{\\partial L}{\\partial y_i} \\dfrac{\\partial}{\\partial \\sigma^2} \\left[ ( x_i - \\mu ) (\\sigma^2 + \\epsilon)^{-1/2} \\right]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">[</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1/2</span></span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">]</span></span></span></span></span></span>","key":"Y3j2zCjO4y"}],"key":"cQ3copK4Za"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"inlineMath","value":"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = -\\dfrac{\\gamma}{2} \\sum_i \\dfrac{\\partial L}{\\partial y_i} ( x_i - \\mu ) (\\sigma^2 + \\epsilon)^{-3/2}","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>              </mtext><mo>=</mo><mo>−</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mi>γ</mi><mn>2</mn></mfrac></mstyle><msub><mo>∑</mo><mi>i</mi></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>y</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mi>μ</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>3</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = -\\dfrac{\\gamma}{2} \\sum_i \\dfrac{\\partial L}{\\partial y_i} ( x_i - \\mu ) (\\sigma^2 + \\epsilon)^{-3/2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.138em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">3/2</span></span></span></span></span></span></span></span></span></span></span></span>","key":"eoaRS3zorU"}],"key":"x2zvERExdE"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"3","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ZAtFpvM6Mf"}],"key":"o1ZBhpIEyu"},{"type":"text","value":". ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"LBoUuMdDpJ"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial \\mu} = \\sum_i \\dfrac{\\partial L}{\\partial \\hat{x}_i} \\dfrac{\\partial \\hat{x}_i}{\\partial \\mu} + \\dfrac{\\partial L}{\\partial \\sigma^2} \\dfrac{\\partial \\sigma^2}{\\partial \\mu}","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>μ</mi></mrow></mfrac></mstyle><mo>=</mo><msub><mo>∑</mo><mi>i</mi></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>i</mi></msub></mrow></mfrac></mstyle><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>i</mi></msub></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>μ</mi></mrow></mfrac></mstyle><mo>+</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msup><mi>σ</mi><mn>2</mn></msup></mrow></mfrac></mstyle><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msup><mi>σ</mi><mn>2</mn></msup></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>μ</mi></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial \\mu} = \\sum_i \\dfrac{\\partial L}{\\partial \\hat{x}_i} \\dfrac{\\partial \\hat{x}_i}{\\partial \\mu} + \\dfrac{\\partial L}{\\partial \\sigma^2} \\dfrac{\\partial \\sigma^2}{\\partial \\mu}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">μ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">μ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3715em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4911em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">μ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"rcktJoQ7Pn"},{"type":"text","value":", here we also add a second component because as you can see above there are two branches emerging from ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"h946nCIEUB"},{"type":"inlineMath","value":"\\mu","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>μ</mi></mrow><annotation encoding=\"application/x-tex\">\\mu</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">μ</span></span></span></span>","key":"dlbcsWh1r7"},{"type":"text","value":", one into ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"qIzTBBdH9o"},{"type":"inlineMath","value":"\\sigma^2","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\sigma^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"hchOLiQbzP"},{"type":"text","value":" and one into ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ei62pE68Kw"},{"type":"inlineMath","value":"\\hat{x}","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\hat{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span></span></span></span>","key":"lxDxMXLGy9"},{"type":"text","value":". To keep it simple, let’s solve each partial derivative separately:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"FyUJVIXhbZ"}],"key":"dMaae6MhTM"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"inlineMath","value":"\\dfrac{\\partial \\hat{x}_i}{\\partial \\mu} = \\dfrac{\\partial}{\\partial \\mu} \\left[ ( x_i - \\mu )(\\sigma^2 + \\epsilon)^{-1/2} \\right] = -(\\sigma^2 + \\epsilon)^{-1/2}","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>i</mi></msub></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>μ</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mi mathvariant=\"normal\">∂</mi><mrow><mi mathvariant=\"normal\">∂</mi><mi>μ</mi></mrow></mfrac></mstyle><mrow><mo fence=\"true\">[</mo><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mi>μ</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow></msup><mo fence=\"true\">]</mo></mrow><mo>=</mo><mo>−</mo><mo stretchy=\"false\">(</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial \\hat{x}_i}{\\partial \\mu} = \\dfrac{\\partial}{\\partial \\mu} \\left[ ( x_i - \\mu )(\\sigma^2 + \\epsilon)^{-1/2} \\right] = -(\\sigma^2 + \\epsilon)^{-1/2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">μ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">μ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">[</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1/2</span></span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\">−</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.138em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1/2</span></span></span></span></span></span></span></span></span></span></span></span>","key":"H08mGo7y0e"}],"key":"a8CDIHANC0"}],"key":"l3MPLXpLjR"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"inlineMath","value":"\\dfrac{\\partial \\sigma^2}{\\partial \\mu} = \\dfrac{\\partial}{\\partial \\mu}\\left[\\dfrac{1}{m - 1}\\sum_{i=1}^{m} (x_i - \\mu)^2 \\right]","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msup><mi>σ</mi><mn>2</mn></msup></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>μ</mi></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mi mathvariant=\"normal\">∂</mi><mrow><mi mathvariant=\"normal\">∂</mi><mi>μ</mi></mrow></mfrac></mstyle><mrow><mo fence=\"true\">[</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mn>1</mn><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></mfrac></mstyle><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mi>μ</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial \\sigma^2}{\\partial \\mu} = \\dfrac{\\partial}{\\partial \\mu}\\left[\\dfrac{1}{m - 1}\\sum_{i=1}^{m} (x_i - \\mu)^2 \\right]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.3715em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4911em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">μ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">μ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8043em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span>","key":"ni7B3FxBX0"},{"type":"text","value":", notice ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"rU2PjqBBjE"},{"type":"inlineMath","value":"\\dfrac{1}{m - 1}","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mn>1</mn><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{1}{m - 1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.0908em;vertical-align:-0.7693em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"Qn4skuVf1j"},{"type":"text","value":" which is Bessel’s correction","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"JfFMftTaZX"}],"key":"OEuLJCQE1f"}],"key":"URE0xE3TUJ"}],"key":"gJf6WOf4u7"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"inlineMath","value":"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = \\dfrac{-2}{m - 1}\\sum_{i=1}^{m} (x_i - \\mu)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>              </mtext><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mo>−</mo><mn>2</mn></mrow><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></mfrac></mstyle><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mi>μ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = \\dfrac{-2}{m - 1}\\sum_{i=1}^{m} (x_i - \\mu)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0908em;vertical-align:-0.7693em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8043em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mclose\">)</span></span></span></span>","key":"DmLZIqFrwb"}],"key":"kT0Sg3GGcz"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"inlineMath","value":"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = \\dfrac{-2}{m - 1}(\\sum_{i=1}^{m}x_i - \\sum_{i=1}^{m}\\mu)","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>              </mtext><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mo>−</mo><mn>2</mn></mrow><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></mfrac></mstyle><mo stretchy=\"false\">(</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mi>μ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = \\dfrac{-2}{m - 1}(\\sum_{i=1}^{m}x_i - \\sum_{i=1}^{m}\\mu)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0908em;vertical-align:-0.7693em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8043em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.104em;vertical-align:-0.2997em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8043em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">m</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mclose\">)</span></span></span></span>","key":"IkSiQgR0f0"}],"key":"yB8G56kvdT"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"inlineMath","value":"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = \\dfrac{-2}{m - 1}(m\\mu - m\\mu)","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>              </mtext><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mo>−</mo><mn>2</mn></mrow><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></mfrac></mstyle><mo stretchy=\"false\">(</mo><mi>m</mi><mi>μ</mi><mo>−</mo><mi>m</mi><mi>μ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = \\dfrac{-2}{m - 1}(m\\mu - m\\mu)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0908em;vertical-align:-0.7693em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">μ</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">μ</span><span class=\"mclose\">)</span></span></span></span>","key":"ZVgTqnqeNH"}],"key":"NQ1b2FEAZq"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"inlineMath","value":"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = 0","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>              </mtext><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"uWWh1vtmYh"},{"type":"text","value":", ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"LmVG66P5bC"},{"type":"strong","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"WHOA","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"M4NfWlrF1s"}],"key":"j9ixIaaCaQ"},{"type":"text","value":" :)!","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"NbiWYSASrD"}],"key":"IXy8bupapv"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Therefore: ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"rTAi7OeID2"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial \\mu} = \\sum_i \\dfrac{\\partial L}{\\partial \\hat{x}_i} [-(\\sigma^2 + \\epsilon)^{-1/2}] + \\dfrac{\\partial L}{\\partial \\sigma^2} \\cdot 0","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>μ</mi></mrow></mfrac></mstyle><mo>=</mo><msub><mo>∑</mo><mi>i</mi></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>i</mi></msub></mrow></mfrac></mstyle><mo stretchy=\"false\">[</mo><mo>−</mo><mo stretchy=\"false\">(</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow></msup><mo stretchy=\"false\">]</mo><mo>+</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msup><mi>σ</mi><mn>2</mn></msup></mrow></mfrac></mstyle><mo>⋅</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial \\mu} = \\sum_i \\dfrac{\\partial L}{\\partial \\hat{x}_i} [-(\\sigma^2 + \\epsilon)^{-1/2}] + \\dfrac{\\partial L}{\\partial \\sigma^2} \\cdot 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">μ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2074em;vertical-align:-0.836em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.138em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1/2</span></span></span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>","key":"FxNiAxSWk1"}],"key":"dfshFT4vkr"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"inlineMath","value":"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = -\\gamma\\sum_i\\dfrac{\\partial L}{\\partial y_i} (\\sigma^2 + \\epsilon)^{-1/2}","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>                       </mtext><mo>=</mo><mo>−</mo><mi>γ</mi><msub><mo>∑</mo><mi>i</mi></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>y</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mo stretchy=\"false\">(</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = -\\gamma\\sum_i\\dfrac{\\partial L}{\\partial y_i} (\\sigma^2 + \\epsilon)^{-1/2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.138em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1/2</span></span></span></span></span></span></span></span></span></span></span></span>","key":"jpmp6gQ9K2"}],"key":"YpenchquHt"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"strong","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"4","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"hI55rIHj3v"}],"key":"yWmRABcRW5"},{"type":"text","value":". ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"y29SOOSWMZ"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial x_i} = \\dfrac{\\partial L}{\\partial \\hat{x}_i}\\dfrac{\\partial \\hat{x}_i}{\\partial x_i} + \\dfrac{\\partial L}{\\partial \\mu}\\dfrac{\\partial \\mu}{\\partial x_i} + \\dfrac{\\partial L}{\\partial \\sigma^2}\\dfrac{\\partial \\sigma^2}{\\partial x_i}","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>i</mi></msub></mrow></mfrac></mstyle><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>i</mi></msub></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mo>+</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>μ</mi></mrow></mfrac></mstyle><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>μ</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mo>+</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msup><mi>σ</mi><mn>2</mn></msup></mrow></mfrac></mstyle><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msup><mi>σ</mi><mn>2</mn></msup></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial x_i} = \\dfrac{\\partial L}{\\partial \\hat{x}_i}\\dfrac{\\partial \\hat{x}_i}{\\partial x_i} + \\dfrac{\\partial L}{\\partial \\mu}\\dfrac{\\partial \\mu}{\\partial x_i} + \\dfrac{\\partial L}{\\partial \\sigma^2}\\dfrac{\\partial \\sigma^2}{\\partial x_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2074em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2074em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">μ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">μ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3271em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4911em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"w9SFAVDMrI"},{"type":"text","value":", three components (partial derivative products), one for every path exiting reaching ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"CxI0Ekay3L"},{"type":"inlineCode","value":"x","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"YhH78v1HoS"},{"type":"text","value":" from ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"RPKyCdQbWK"},{"type":"inlineCode","value":"L","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"lnwECRwYMy"},{"type":"text","value":" (one through ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"z62yCWXk1b"},{"type":"inlineMath","value":"\\hat{x}","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\hat{x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span></span></span></span>","key":"zMB2Uwm1lL"},{"type":"text","value":", one through ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"UiW64TRPJ2"},{"type":"inlineMath","value":"\\mu","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>μ</mi></mrow><annotation encoding=\"application/x-tex\">\\mu</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">μ</span></span></span></span>","key":"Pqa4uM051Q"},{"type":"text","value":" and one through ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"oyYU34FxfG"},{"type":"inlineMath","value":"\\sigma^2","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>σ</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\sigma^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span>","key":"foL6NM9GVB"},{"type":"text","value":"). Similarly, let’s solve each partial derivative that we do not yet know separately:","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"KR0zZkXTeZ"}],"key":"FGTCBArluF"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":29,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"inlineMath","value":"\\dfrac{\\partial \\hat{x}_i}{\\partial x_i} = \\dfrac{\\partial}{\\partial x_i} \\left[ ( x_i - \\mu )(\\sigma^2 + \\epsilon)^{-1/2} \\right] = (\\sigma^2 + \\epsilon)^{-1/2}","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>i</mi></msub></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mi mathvariant=\"normal\">∂</mi><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mrow><mo fence=\"true\">[</mo><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mi>μ</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow></msup><mo fence=\"true\">]</mo></mrow><mo>=</mo><mo stretchy=\"false\">(</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial \\hat{x}_i}{\\partial x_i} = \\dfrac{\\partial}{\\partial x_i} \\left[ ( x_i - \\mu )(\\sigma^2 + \\epsilon)^{-1/2} \\right] = (\\sigma^2 + \\epsilon)^{-1/2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2074em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2074em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">[</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1/2</span></span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.138em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1/2</span></span></span></span></span></span></span></span></span></span></span></span>","key":"pOIZFFhrvo"}],"key":"yG3Q5FBSWA"}],"key":"pMHP9rnXAN"},{"type":"listItem","spread":true,"position":{"start":{"line":31,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"inlineMath","value":"\\dfrac{\\partial \\mu}{\\partial x_i} = \\dfrac{\\partial}{\\partial x_i}\\left(\\dfrac{1}{m}\\sum_j x_j\\right) = \\dfrac{1}{m}","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>μ</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mi mathvariant=\"normal\">∂</mi><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mrow><mo fence=\"true\">(</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mn>1</mn><mi>m</mi></mfrac></mstyle><msub><mo>∑</mo><mi>j</mi></msub><msub><mi>x</mi><mi>j</mi></msub><mo fence=\"true\">)</mo></mrow><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mn>1</mn><mi>m</mi></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial \\mu}{\\partial x_i} = \\dfrac{\\partial}{\\partial x_i}\\left(\\dfrac{1}{m}\\sum_j x_j\\right) = \\dfrac{1}{m}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2074em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">μ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"SzK1ofm3bZ"}],"key":"SQIzeo0oVw"}],"key":"agMhce3kvj"},{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"inlineMath","value":"\\dfrac{\\partial \\sigma^2}{\\partial x_i} = \\dfrac{\\partial }{\\partial x_i}\\left[\\dfrac{1}{m - 1}\\sum_j (x_j - \\mu)^2 \\right] = \\dfrac{2}{m - 1} (x_i - \\mu)","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msup><mi>σ</mi><mn>2</mn></msup></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mi mathvariant=\"normal\">∂</mi><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mrow><mo fence=\"true\">[</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mn>1</mn><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></mfrac></mstyle><msub><mo>∑</mo><mi>j</mi></msub><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo>−</mo><mi>μ</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo fence=\"true\">]</mo></mrow><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mn>2</mn><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></mfrac></mstyle><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mi>μ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial \\sigma^2}{\\partial x_i} = \\dfrac{\\partial }{\\partial x_i}\\left[\\dfrac{1}{m - 1}\\sum_j (x_j - \\mu)^2 \\right] = \\dfrac{2}{m - 1} (x_i - \\mu)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.3271em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4911em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4em;vertical-align:-0.95em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0908em;vertical-align:-0.7693em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mclose\">)</span></span></span></span>","key":"Ks7CfYnqvN"}],"key":"mNwWloHoo7"}],"key":"GOAbgNJ4b6"}],"key":"RmHfETqNFe"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"Now that we have all the individual derivatives, let’s find the three derivative products, one by one:","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"hz5Pt3yXDd"}],"key":"QSj7IVpAms"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":37,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":37,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial \\hat{x}_i}\\dfrac{\\partial \\hat{x}_i}{\\partial x_i} = (\\sigma^2 + \\epsilon)^{-1/2} \\gamma \\dfrac{\\partial L}{\\partial y_i}","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>i</mi></msub></mrow></mfrac></mstyle><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>i</mi></msub></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mo>=</mo><mo stretchy=\"false\">(</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow></msup><mi>γ</mi><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>y</mi><mi>i</mi></msub></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial \\hat{x}_i}\\dfrac{\\partial \\hat{x}_i}{\\partial x_i} = (\\sigma^2 + \\epsilon)^{-1/2} \\gamma \\dfrac{\\partial L}{\\partial y_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2074em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1/2</span></span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"iA7RFwN3o3"}],"key":"AlYN06Qeg6"}],"key":"r8BbDeisQE"},{"type":"listItem","spread":true,"position":{"start":{"line":39,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial \\mu}\\dfrac{\\partial \\mu}{\\partial x_i} = -\\gamma\\sum_j\\dfrac{\\partial L}{\\partial y_j} (\\sigma^2 + \\epsilon)^{-1/2} \\dfrac{1}{m}","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>μ</mi></mrow></mfrac></mstyle><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>μ</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mo>=</mo><mo>−</mo><mi>γ</mi><msub><mo>∑</mo><mi>j</mi></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>y</mi><mi>j</mi></msub></mrow></mfrac></mstyle><mo stretchy=\"false\">(</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow></msup><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mn>1</mn><mi>m</mi></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial \\mu}\\dfrac{\\partial \\mu}{\\partial x_i} = -\\gamma\\sum_j\\dfrac{\\partial L}{\\partial y_j} (\\sigma^2 + \\epsilon)^{-1/2} \\dfrac{1}{m}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">μ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">μ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3435em;vertical-align:-0.9721em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9721em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1/2</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"q5PUCFGcjf"}],"key":"Yfuvik8kL9"}],"key":"slGjUUWYZ4"}],"key":"mnxi9Dzn2x"},{"type":"paragraph","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"inlineMath","value":"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = -(\\sigma^2 + \\epsilon)^{-1/2}\\dfrac{\\gamma}{m}\\sum_j\\dfrac{\\partial L}{\\partial y_j}","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>                    </mtext><mo>=</mo><mo>−</mo><mo stretchy=\"false\">(</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow></msup><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mi>γ</mi><mi>m</mi></mfrac></mstyle><msub><mo>∑</mo><mi>j</mi></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>y</mi><mi>j</mi></msub></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = -(\\sigma^2 + \\epsilon)^{-1/2}\\dfrac{\\gamma}{m}\\sum_j\\dfrac{\\partial L}{\\partial y_j}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord\">−</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3435em;vertical-align:-0.9721em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1/2</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9721em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"cPmTZUZ3Vk"}],"key":"oYei9sRZuU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":43,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":43,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial \\sigma^2}\\dfrac{\\partial \\sigma^2}{\\partial x_i} = \\left[-\\dfrac{\\gamma}{2} \\sum_j \\dfrac{\\partial L}{\\partial y_j} ( x_j - \\mu ) (\\sigma^2 + \\epsilon)^{-3/2}\\right] \\left[\\dfrac{2}{m - 1} (x_i - \\mu)\\right]","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msup><mi>σ</mi><mn>2</mn></msup></mrow></mfrac></mstyle><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><msup><mi>σ</mi><mn>2</mn></msup></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mo>=</mo><mrow><mo fence=\"true\">[</mo><mo>−</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mi>γ</mi><mn>2</mn></mfrac></mstyle><msub><mo>∑</mo><mi>j</mi></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>y</mi><mi>j</mi></msub></mrow></mfrac></mstyle><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo>−</mo><mi>μ</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>3</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow></msup><mo fence=\"true\">]</mo></mrow><mrow><mo fence=\"true\">[</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mn>2</mn><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></mfrac></mstyle><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mi>μ</mi><mo stretchy=\"false\">)</mo><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial \\sigma^2}\\dfrac{\\partial \\sigma^2}{\\partial x_i} = \\left[-\\dfrac{\\gamma}{2} \\sum_j \\dfrac{\\partial L}{\\partial y_j} ( x_j - \\mu ) (\\sigma^2 + \\epsilon)^{-3/2}\\right] \\left[\\dfrac{2}{m - 1} (x_i - \\mu)\\right]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.3271em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4911em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4221em;vertical-align:-0.9721em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9721em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">3/2</span></span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mclose\">)</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span>","key":"obQu4feAdS"}],"key":"xcvcdniwCn"}],"key":"njfbBZuerL"}],"key":"gKIznvXL21"},{"type":"paragraph","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"inlineMath","value":" \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = (\\sigma^2 + \\epsilon)^{-1/2}\\left[-\\gamma \\sum_j \\dfrac{\\partial L}{\\partial y_j} ( x_j - \\mu ) (\\sigma^2 + \\epsilon)^{-1/2}\\right] \\left[\\dfrac{1}{m - 1} (x_i - \\mu)(\\sigma^2 + \\epsilon)^{-1/2}\\right]","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>               </mtext><mo>=</mo><mo stretchy=\"false\">(</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow></msup><mrow><mo fence=\"true\">[</mo><mo>−</mo><mi>γ</mi><msub><mo>∑</mo><mi>j</mi></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>y</mi><mi>j</mi></msub></mrow></mfrac></mstyle><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>j</mi></msub><mo>−</mo><mi>μ</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow></msup><mo fence=\"true\">]</mo></mrow><mrow><mo fence=\"true\">[</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mn>1</mn><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></mfrac></mstyle><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mi>μ</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow></msup><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\"> \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = (\\sigma^2 + \\epsilon)^{-1/2}\\left[-\\gamma \\sum_j \\dfrac{\\partial L}{\\partial y_j} ( x_j - \\mu ) (\\sigma^2 + \\epsilon)^{-1/2}\\right] \\left[\\dfrac{1}{m - 1} (x_i - \\mu)(\\sigma^2 + \\epsilon)^{-1/2}\\right]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4221em;vertical-align:-0.9721em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1/2</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9721em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1/2</span></span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">μ</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1/2</span></span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span>","key":"r2EmpwJ5AM"}],"key":"z8h7JXXohm"},{"type":"paragraph","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"inlineMath","value":" \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = (\\sigma^2 + \\epsilon)^{-1/2}\\left[-\\gamma \\sum_j \\dfrac{\\partial L}{\\partial y_j} \\dfrac{x_j - \\mu}{\\sqrt{\\sigma^2 + \\epsilon}}\\right] \\left[\\dfrac{1}{m - 1} \\dfrac{x_i - \\mu}{\\sqrt{\\sigma^2 + \\epsilon}}\\right]","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>               </mtext><mo>=</mo><mo stretchy=\"false\">(</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow></msup><mrow><mo fence=\"true\">[</mo><mo>−</mo><mi>γ</mi><msub><mo>∑</mo><mi>j</mi></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>y</mi><mi>j</mi></msub></mrow></mfrac></mstyle><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><msub><mi>x</mi><mi>j</mi></msub><mo>−</mo><mi>μ</mi></mrow><msqrt><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi></mrow></msqrt></mfrac></mstyle><mo fence=\"true\">]</mo></mrow><mrow><mo fence=\"true\">[</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mn>1</mn><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></mfrac></mstyle><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mi>μ</mi></mrow><msqrt><mrow><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi></mrow></msqrt></mfrac></mstyle><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\"> \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = (\\sigma^2 + \\epsilon)^{-1/2}\\left[-\\gamma \\sum_j \\dfrac{\\partial L}{\\partial y_j} \\dfrac{x_j - \\mu}{\\sqrt{\\sigma^2 + \\epsilon}}\\right] \\left[\\dfrac{1}{m - 1} \\dfrac{x_i - \\mu}{\\sqrt{\\sigma^2 + \\epsilon}}\\right]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4221em;vertical-align:-0.9721em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1/2</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9721em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2603em;\"><span style=\"top:-2.1966em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9134em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">ϵ</span></span></span><span style=\"top:-2.8734em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1266em;\"><span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">μ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.93em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2603em;\"><span style=\"top:-2.1966em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9134em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">ϵ</span></span></span><span style=\"top:-2.8734em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1266em;\"><span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">μ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.93em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span>","key":"Q0q9knJOIo"}],"key":"oaWBpzyegW"},{"type":"paragraph","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"inlineMath","value":" \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = (\\sigma^2 + \\epsilon)^{-1/2}\\left[-\\gamma \\sum_j \\dfrac{\\partial L}{\\partial y_j} \\hat{x}_j \\right] \\left[\\dfrac{1}{m - 1} \\hat{x}_i\\right]","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>               </mtext><mo>=</mo><mo stretchy=\"false\">(</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow></msup><mrow><mo fence=\"true\">[</mo><mo>−</mo><mi>γ</mi><msub><mo>∑</mo><mi>j</mi></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>y</mi><mi>j</mi></msub></mrow></mfrac></mstyle><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>j</mi></msub><mo fence=\"true\">]</mo></mrow><mrow><mo fence=\"true\">[</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mn>1</mn><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></mfrac></mstyle><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>i</mi></msub><mo fence=\"true\">]</mo></mrow></mrow><annotation encoding=\"application/x-tex\"> \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ = (\\sigma^2 + \\epsilon)^{-1/2}\\left[-\\gamma \\sum_j \\dfrac{\\partial L}{\\partial y_j} \\hat{x}_j \\right] \\left[\\dfrac{1}{m - 1} \\hat{x}_i\\right]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4221em;vertical-align:-0.9721em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1/2</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9721em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">[</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">]</span></span></span></span></span></span>","key":"pvVEjmjGl8"}],"key":"bWFqoULhW5"},{"type":"paragraph","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"And finally, let’s add up all the product terms to get the final expression for","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"j4ShqbsGQA"}],"key":"EIwefRwZ9r"},{"type":"paragraph","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial x_i} = (\\sigma^2 + \\epsilon)^{-1/2} \\gamma \\dfrac{\\partial L}{\\partial y_i} - (\\sigma^2 + \\epsilon)^{-1/2}\\dfrac{\\gamma}{m}\\sum_j\\dfrac{\\partial L}{\\partial y_j} + (\\sigma^2 + \\epsilon)^{-1/2}\\left(-\\gamma \\sum_j \\dfrac{\\partial L}{\\partial y_j} \\hat{x}_j \\right) \\left(\\dfrac{1}{m - 1} \\hat{x}_i\\right)","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mo>=</mo><mo stretchy=\"false\">(</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow></msup><mi>γ</mi><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>y</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mo>−</mo><mo stretchy=\"false\">(</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow></msup><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mi>γ</mi><mi>m</mi></mfrac></mstyle><msub><mo>∑</mo><mi>j</mi></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>y</mi><mi>j</mi></msub></mrow></mfrac></mstyle><mo>+</mo><mo stretchy=\"false\">(</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow></msup><mrow><mo fence=\"true\">(</mo><mo>−</mo><mi>γ</mi><msub><mo>∑</mo><mi>j</mi></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>y</mi><mi>j</mi></msub></mrow></mfrac></mstyle><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>j</mi></msub><mo fence=\"true\">)</mo></mrow><mrow><mo fence=\"true\">(</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mn>1</mn><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></mfrac></mstyle><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>i</mi></msub><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial x_i} = (\\sigma^2 + \\epsilon)^{-1/2} \\gamma \\dfrac{\\partial L}{\\partial y_i} - (\\sigma^2 + \\epsilon)^{-1/2}\\dfrac{\\gamma}{m}\\sum_j\\dfrac{\\partial L}{\\partial y_j} + (\\sigma^2 + \\epsilon)^{-1/2}\\left(-\\gamma \\sum_j \\dfrac{\\partial L}{\\partial y_j} \\hat{x}_j \\right) \\left(\\dfrac{1}{m - 1} \\hat{x}_i\\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2074em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1/2</span></span></span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3435em;vertical-align:-0.9721em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1/2</span></span></span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9721em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4221em;vertical-align:-0.9721em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1/2</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9721em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span></span></span></span>","key":"a3BcNismha"}],"key":"th2hy8OZGN"},{"type":"paragraph","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"inlineMath","value":" \\ \\ \\ \\ \\ \\ \\ =  \\dfrac{\\gamma}{m}(\\sigma^2 + \\epsilon)^{-1/2} \\left( m\\dfrac{\\partial L}{\\partial y_i} - \\sum_j\\dfrac{\\partial L}{\\partial y_j} - \\dfrac{m}{m - 1} \\hat{x}_i \\sum_j \\dfrac{\\partial L}{\\partial y_j} \\hat{x}_j \\right)","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mtext>       </mtext><mo>=</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mi>γ</mi><mi>m</mi></mfrac></mstyle><mo stretchy=\"false\">(</mo><msup><mi>σ</mi><mn>2</mn></msup><mo>+</mo><mi>ϵ</mi><msup><mo stretchy=\"false\">)</mo><mrow><mo>−</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow></msup><mrow><mo fence=\"true\">(</mo><mi>m</mi><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>y</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mo>−</mo><msub><mo>∑</mo><mi>j</mi></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>y</mi><mi>j</mi></msub></mrow></mfrac></mstyle><mo>−</mo><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mi>m</mi><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow></mfrac></mstyle><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>i</mi></msub><msub><mo>∑</mo><mi>j</mi></msub><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>y</mi><mi>j</mi></msub></mrow></mfrac></mstyle><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>j</mi></msub><mo fence=\"true\">)</mo></mrow></mrow><annotation encoding=\"application/x-tex\"> \\ \\ \\ \\ \\ \\ \\ =  \\dfrac{\\gamma}{m}(\\sigma^2 + \\epsilon)^{-1/2} \\left( m\\dfrac{\\partial L}{\\partial y_i} - \\sum_j\\dfrac{\\partial L}{\\partial y_j} - \\dfrac{m}{m - 1} \\hat{x}_i \\sum_j \\dfrac{\\partial L}{\\partial y_j} \\hat{x}_j \\right)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mspace\"> </span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.7936em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05556em;\">γ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.4221em;vertical-align:-0.9721em;\"></span><span class=\"mord mathnormal\">ϵ</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1/2</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord mathnormal\">m</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9721em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.162em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9721em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span></span></span></span>","key":"dW18C4Dxsd"}],"key":"zBVuhbrgQ1"},{"type":"paragraph","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"And what we end up with at the end is a fairly simple mathematical expression over here that we cannot simplify further. But basically you’ll notice that it only uses the stuff we have (","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"YRjgG440Lj"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial y_i}","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>y</mi><mi>i</mi></msub></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial y_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2519em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"CA61F1Dnlx"},{"type":"text","value":", ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"t0Ax92gTJW"},{"type":"inlineMath","value":"\\hat{x}_i","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mover accent=\"true\"><mi>x</mi><mo>^</mo></mover><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\hat{x}_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8444em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2222em;\"><span class=\"mord\">^</span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"gHsaV1ftMT"},{"type":"text","value":") and it gives us the thing we need (","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"wylZe6hgKw"},{"type":"inlineMath","value":"\\dfrac{\\partial L}{\\partial x_i}","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle displaystyle=\"true\" scriptlevel=\"0\"><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi>L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>x</mi><mi>i</mi></msub></mrow></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\dfrac{\\partial L}{\\partial x_i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.2074em;vertical-align:-0.836em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"Sm9iMoGrKA"},{"type":"text","value":"). Let’s now implement this final result:","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"HMIj01nv2G"}],"key":"kXOTavAYsW"}],"key":"OGTpaHzZRA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dhprebn = (\n    bngain\n    / batch_size\n    * bnvar_inv\n    * (\n        batch_size * dhpreact\n        - dhpreact.sum(0)\n        - batch_size / (batch_size - 1) * bnraw * (dhpreact * bnraw).sum(0)\n    )\n)\ncmp(\"hprebn\", dhprebn, hprebn)  # we can only get approximate correctness ~9e-10","key":"i7G9ynKfIE"},{"type":"outputs","id":"fwyUfOM5CvfNOIHlgKfeJ","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"hprebn          | exact: False | approximate: True  | maxdiff: 9.313225746154785e-10\n"},"children":[],"key":"TqNv0HBWY7"}],"key":"NSg82x3hmU"}],"key":"VNbb42c3ws"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"hprebn.shape, dhprebn.shape, bngain.shape, bnvar_inv.shape, dbnraw.shape, dbnraw.sum(\n    0\n).shape","key":"fIF7IvYsuX"},{"type":"outputs","id":"VhCC1leVrASPWmNhjtEfx","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":93,"metadata":{},"data":{"text/plain":{"content":"(torch.Size([32, 64]),\n torch.Size([32, 64]),\n torch.Size([1, 64]),\n torch.Size([1, 64]),\n torch.Size([32, 64]),\n torch.Size([64]))","content_type":"text/plain"}}},"children":[],"key":"P9wwdhoJXA"}],"key":"ZJ0yYziu8h"}],"key":"qxATbstp7N"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Remember the mathematical expression we analytically calculated applies only to one neuron, whereas the programmatical ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M1vq6ZyfBu"},{"type":"inlineCode","value":"dhprebn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FN5hgGjESs"},{"type":"text","value":" expression applies to all the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RzYXhXktsp"},{"type":"inlineCode","value":"batch_size","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rURFeb6fU2"},{"type":"text","value":" number of neurons we have, in parallel. This is non-trivial, so take your time to see how it is written out with the  broadcasting happening appropriately, so that the shapes work out.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ibPw9TPoMy"}],"key":"GAy4AGrTWQ"}],"key":"ab3smAmm4n"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Exercise 4: training the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dcoxAIK2Hn"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"mlp","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LgoZlJjaEU"}],"key":"GWMQ7GhlRf"},{"type":"text","value":" with our own manual backward pass","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EEJQ4KdqMF"}],"identifier":"exercise-4-training-the-mlp-with-our-own-manual-backward-pass","label":"Exercise 4: training the mlp with our own manual backward pass","html_id":"exercise-4-training-the-mlp-with-our-own-manual-backward-pass","implicit":true,"key":"wvTcfZr7OR"}],"key":"CifASb6l1G"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"For the final exercise 4, we want to put it all together. Meaning, we want to train the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SH0jBKuAzy"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"mlp","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hjBSu8AhUy"}],"key":"CFvBmBvfNf"},{"type":"text","value":" with our own manual backward pass. So first, let’s define a new, simpler forward pass function, a manual backward pass function, a training function and a function to print the loss:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UqF5svEGml"}],"key":"E80xlQXBD2"}],"key":"iEks9N2G2t"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def forward(xb, yb):\n    emb = C[xb]  # embed the characters into vectors\n    embcat = emb.view(emb.shape[0], -1)  # concatenate the vectors\n    # Linear layer\n    hprebn = embcat @ w1 + b1  # hidden layer pre-activation\n    # BatchNorm layer\n    # -------------------------------------------------------------\n    bnmean = hprebn.mean(0, keepdim=True)\n    bnvar = hprebn.var(0, keepdim=True)\n    bnvar_inv = (bnvar + 1e-5) ** -0.5\n    bnraw = (hprebn - bnmean) * bnvar_inv\n    hpreact = bngain * bnraw + bnbias\n    # -------------------------------------------------------------\n    # Non-linearity\n    h = torch.tanh(hpreact)  # hidden layer\n    logits = h @ w2 + b2  # output layer\n    loss = F.cross_entropy(logits, yb)  # loss function\n    return emb, embcat, bnvar_inv, bnraw, h, hpreact, logits, loss","key":"T7SZ4hySYL"},{"type":"outputs","id":"KIiJUKenNUYJuIxHTFDJi","children":[],"key":"zFEjqWGCmz"}],"key":"AjHARdtYW3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def manual_backward(\n    parameters,\n    logits,\n    batch_size,\n    xb,\n    yb,\n    h,\n    hpreact,\n    bnraw,\n    bngain,\n    bnvar_inv,\n    embcat,\n    emb,\n):\n    dlogits = F.softmax(logits, 1)\n    dlogits[range(batch_size), yb] -= 1\n    dlogits /= batch_size\n    # 2nd layer backprop\n    dh = dlogits @ w2.T\n    dw2 = h.T @ dlogits\n    db2 = dlogits.sum(0)\n    # tanh\n    dhpreact = (1.0 - h**2) * dh\n    # batchnorm backprop\n    dbngain = (bnraw * dhpreact).sum(0, keepdim=True)\n    dbnbias = dhpreact.sum(0, keepdim=True)\n    dhprebn = (\n        bngain\n        / batch_size\n        * bnvar_inv\n        * (\n            batch_size * dhpreact\n            - dhpreact.sum(0)\n            - batch_size / (batch_size - 1) * bnraw * (dhpreact * bnraw).sum(0)\n        )\n    )\n    # 1st layer\n    dembcat = dhprebn @ w1.T\n    dw1 = embcat.T @ dhprebn\n    db1 = dhprebn.sum(0)\n    # embedding\n    demb = dembcat.view(emb.shape)\n    dC = torch.zeros_like(C)\n    dC.index_add_(0, xb.flatten(), demb.view(-1, 10))\n    grads = [dC, dw1, db1, dw2, db2, dbngain, dbnbias]\n    return grads","key":"CuAsnpaNFJ"},{"type":"outputs","id":"5qR6S2SuBnoQv9i50M9Sn","children":[],"key":"bGBghynsTI"}],"key":"mJ38vDQcOF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def train(\n    x,\n    y,\n    parameters,\n    maxsteps=200000,\n    batchsize=32,\n    initial_lr=0.1,\n    run_torch_backward=False,\n    break_at_step=None,\n):\n    lossi = []\n    # use this context manager to enable or disable gradient tracking\n    with torch.set_grad_enabled(run_torch_backward):\n        # kick off optimization\n        for i in range(maxsteps):\n            xb, yb = construct_minibatch()\n            emb, embcat, bnvar_inv, bnraw, h, hpreact, logits, loss = forward(xb, yb)\n            for p in parameters:\n                p.grad = None\n            if run_torch_backward:\n                for t in [emb, embcat, bnvar_inv, bnraw, h, hpreact, logits]:\n                    t.retain_grad()\n                loss.backward()\n            grads = manual_backward(\n                parameters=parameters,\n                batch_size=batch_size,\n                xb=xb,\n                yb=yb,\n                logits=logits,\n                h=h,\n                hpreact=hpreact,\n                bnraw=bnraw,\n                bngain=bngain,\n                bnvar_inv=bnvar_inv,\n                embcat=embcat,\n                emb=emb,\n            )\n            # update\n            lr = (\n                initial_lr if i < 100000 else initial_lr / 10\n            )  # step learning rate decay\n            for p, grad in zip(parameters, grads):\n                p.data += -lr * (p.grad if run_torch_backward else grad)\n            # track stats\n            if i % 10000 == 0:  # print every once in a while\n                print(f\"{i:7d}/{maxsteps:7d}: {loss.item():.4f}\")\n            lossi.append(loss.log10().item())\n            if break_at_step is not None and i >= break_at_step:\n                break\n    return grads, lossi","key":"hsm3CaPr1c"},{"type":"outputs","id":"w6vYe_DeKreoFMeF1NnFj","children":[],"key":"Y0NGI8joCg"}],"key":"AFRS9vDdbm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"@torch.no_grad()  # this decorator disables gradient tracking\ndef print_loss(x, y, prefix=\"\"):\n    loss = forward(x, y)[-1]\n    print(f\"{prefix} {loss}\")\n    return loss","key":"ehI81JOHO6"},{"type":"outputs","id":"lDL-t2kA8ZV45wYeCHpnz","children":[],"key":"zEEJPjpZ4H"}],"key":"X0EfjPimqy"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Cool. Now, we will simply train our ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Eaj5PmRbyu"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MEjXKOwyzA"}],"key":"bpMGM77ziN"},{"type":"text","value":" using the backprop expressions we calculated manually (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"enWa2FHuGj"},{"type":"inlineCode","value":"manual_backward()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aptdBHBaC3"},{"type":"text","value":") instead of having PyTorch do it for us (i.e. ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"neMIREyf9G"},{"type":"inlineCode","value":"loss.backward()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xKGgACUtuM"},{"type":"text","value":"). Basically, we have plucked out all the operations that PyTorch would calculate and we have instead implemented them manually. Of course, our manual results are identical to the automated ones, as we have verified already. So, let’s train and do both classic PyTorch backpropagation and our manual propagation and break the training loop at ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IQrHxjGQXF"},{"type":"text","value":"100","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RfoH4wcXcQ"},{"type":"text","value":" epochs and check whether gradients match the PyTorch ones:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"h6fSGGcG56"}],"key":"qZScj352I9"}],"key":"HDVZ2N7kCM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Exercise 4: putting it all together!\n# Train the MLP neural net with your own backward pass\nparameters = define_nn(n_hidden=200, n_embd=10)\ngrads, lossi = train(\n    xtrain, ytrain, parameters, run_torch_backward=True, break_at_step=100\n)\n# check gradients against PyTorch\nfor p, g in zip(parameters, grads):\n    cmp(str(tuple(p.shape)), g, p)","key":"NBIGzm5Zq3"},{"type":"outputs","id":"7RIOsHcYREj6GQUfqh5Z3","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"12297\n      0/ 200000: 3.8279\n(27, 10)        | exact: False | approximate: True  | maxdiff: 9.313225746154785e-09\n(30, 200)       | exact: False | approximate: True  | maxdiff: 7.916241884231567e-09\n(200,)          | exact: False | approximate: True  | maxdiff: 5.587935447692871e-09\n(200, 27)       | exact: False | approximate: True  | maxdiff: 2.2351741790771484e-08\n(27,)           | exact: False | approximate: True  | maxdiff: 7.450580596923828e-09\n(1, 200)        | exact: False | approximate: True  | maxdiff: 1.979060471057892e-09\n(1, 200)        | exact: False | approximate: True  | maxdiff: 4.6566128730773926e-09\n"},"children":[],"key":"fXoJtEzPvl"}],"key":"SVDmIxO6Bh"}],"key":"ZIP9TOuqlo"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"So here we see that our gradients are mostly, but not exactly, equal. Most are approximately equal with only tiny differences of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"k6rrBrqLI7"},{"type":"inlineCode","value":"e-9","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VTVl9xftvk"},{"type":"text","value":" magnitude. Which is totally fine. Can you figure out why we don’t get exact correctness for all the gradients? If we now redefine our ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a8YyWdlHWj"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WvMJiQp3u9"}],"key":"cA3m4Dbblz"},{"type":"text","value":" and train without breaking and only do our manual ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oNLbEUC5Mo"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"backprop","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lbnSVVP6w7"}],"key":"pIqVLyyxEo"},{"type":"text","value":" (feels amazing to realize we don’t need the automatic backward pass anymore!):","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"igdKylnOU3"}],"key":"TxX361f14x"}],"key":"CTNbeOMNqQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"parameters = define_nn(n_hidden=200, n_embd=10)\ngrads, lossi = train(xtrain, ytrain, parameters)","key":"YjS4vVlLk3"},{"type":"outputs","id":"coch6-Rggqq1SrJ_FSH_S","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"12297\n      0/ 200000: 3.8279\n  10000/ 200000: 2.1609\n  20000/ 200000: 2.4227\n  30000/ 200000: 2.4362\n  40000/ 200000: 2.0088\n  50000/ 200000: 2.4084\n  60000/ 200000: 2.4508\n  70000/ 200000: 2.1090\n  80000/ 200000: 2.3592\n  90000/ 200000: 2.2353\n 100000/ 200000: 1.9750\n 110000/ 200000: 2.3438\n 120000/ 200000: 2.0156\n 130000/ 200000: 2.4772\n 140000/ 200000: 2.3107\n 150000/ 200000: 2.1108\n 160000/ 200000: 1.9497\n 170000/ 200000: 1.8004\n 180000/ 200000: 2.0284\n 190000/ 200000: 1.8848\n"},"children":[],"key":"UoM3eTL6xS"}],"key":"ReftPAtbKv"}],"key":"xZxvHA4orf"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"After training, we will calibrate the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IQNOJlAVBW"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"batchnorm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yj2cc8OnZi"}],"key":"TCMcYs2jmi"},{"type":"text","value":" parameters as we did not keep track of the running mean and variance in the training loop:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZTIkrYrzzR"}],"key":"lhxaauiNTx"}],"key":"JGw4PQI9Ha"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# calibrate the batch norm at the end of training\nwith torch.no_grad():\n    # pass the training set through\n    emb = C[xtrain]\n    embcat = emb.view(emb.shape[0], -1)\n    hpreact = embcat @ w1 + b1\n    # measure the mean/std over the entire training set\n    bnmean = hpreact.mean(0, keepdim=True)\n    bnvar = hpreact.var(0, keepdim=True, unbiased=True)","key":"wfZXPQeuCR"},{"type":"outputs","id":"Yh4WhZVyccfQUltFXWXHw","children":[],"key":"DEMfncqwHA"}],"key":"fo0R5nXDLg"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And print both the training and validation losses:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yYdxHZEg61"}],"key":"FHXT8Zhbce"}],"key":"pyYCw8kwwS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print_loss(xtrain, ytrain, prefix=\"train\")\nprint_loss(xval, yval, prefix=\"val\");","key":"yOgtIMA9zm"},{"type":"outputs","id":"HK2-1L8saXm4g3CcBn70o","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"train 2.0673816204071045\nval 2.1060986518859863\n"},"children":[],"key":"QBUHN1qxD5"}],"key":"Q4SSn5ZUah"}],"key":"dBJbFseqKr"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We achieve a pretty good loss, very similar to what we achieved in our previous lecture! Now, all that remains is to sample from our model:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xGY7l4Qx7P"}],"key":"A1pIymOfUI"}],"key":"gxuWKqbN6O"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# sample from the model\ng = torch.Generator().manual_seed(SEED + 10)\nfor _ in range(20):\n    out = []\n    context = [0] * block_size  # initialize with all ...\n    while True:\n        # ------------\n        # forward pass:\n        # Embedding\n        emb = C[torch.tensor([context])]  # (1,block_size,d)\n        embcat = emb.view(emb.shape[0], -1)  # concat into (N, block_size * n_embd)\n        hpreact = embcat @ w1 + b1\n        hpreact = bngain * (hpreact - bnmean) * (bnvar + 1e-5) ** -0.5 + bnbias\n        h = torch.tanh(hpreact)  # (N, n_hidden)\n        logits = h @ w2 + b2  # (N, vocab_size)\n        # ------------\n        # Sample\n        probs = F.softmax(logits, dim=1)\n        ix = torch.multinomial(probs, num_samples=1, generator=g).item()\n        context = context[1:] + [ix]\n        out.append(ix)\n        if ix == 0:\n            break\n    print(\"\".join(itoc[i] for i in out))","key":"NrcPEcTg4G"},{"type":"outputs","id":"xeZ8ziTuVlaOGOR3KsyuB","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"mora.\nmayah.\nsee.\nmad.\nryla.\nren.\nruthadraegen.\nchedielin.\nshi.\njenleigh.\nsananaraelyn.\nmalaia.\nnoshubergihirael.\nkindreth.\nkonnie.\ncayu.\nzayven.\njamyleyeh.\nyuma.\nmyston.\n"},"children":[],"key":"oK0lOp0OGn"}],"key":"jJbGYkE3Oj"}],"key":"EPuJngrr34"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"And we see the sort of name-like gibberish that we have been used to. Which of course means that the model works, as before 😃!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YTc1CAUWY2"}],"key":"MDm31bA71e"}],"key":"Gr6gjjBDI3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"epBFteuMkM"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"nIwik1KfOd"}],"key":"mMjrSz5kTA"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Everything is the same except that we didn’t use ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cxxEUuIymM"},{"type":"inlineCode","value":"loss.backward()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yRln1YIzMP"},{"type":"text","value":" or ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GJchP7bQfY"},{"type":"link","url":"https://pytorch.org/docs/stable/autograd.html#","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineCode","value":"torch.autograd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OIrAzOSURt"}],"urlSource":"https://pytorch.org/docs/stable/autograd.html#","key":"wEfWnCG2RI"},{"type":"text","value":" and we estimated the gradients ourselves, by hand. And so hopefully you’re looking at the the manual backward pass we did through this ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QfSP8VweQA"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aH2oL0dKVZ"}],"key":"JLwwBW0NJY"},{"type":"text","value":" and you’re thinking to yourself “actually that’s not too complicated”. Each one of these layers is like three lines of code or something like that and most of it is fairly straightforward potentially with the notable exception of the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pfpr5sxZ9O"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"batchnorm","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vnj12Gko61"}],"key":"QOUdK6MBzs"},{"type":"text","value":" backward pass. And that’s everything we wanted to cover in this lecture. So hopefully you found this interesting and what is noteworthy about it honestly is that it gave us a very nice diversity of layers to backpropagate through. It should give us a pretty nice and comprehensive sense of how these backward passes are implemented and how they work and you’d be able to derive them yourself. But of course in practice you probably don’t want to: you want to use ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hnp9T7q7Oh"},{"type":"link","url":"https://pytorch.org/docs/stable/autograd.html#","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineCode","value":"torch.autograd","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m7gpvmdllI"}],"urlSource":"https://pytorch.org/docs/stable/autograd.html#","key":"UisTF3tkul"},{"type":"text","value":" instead. But hopefully now you have some intuition about how gradients flow backwards through the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YbkFAJCJgF"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"nn","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GphTQyIjl5"}],"key":"yB7lxQY2tE"},{"type":"text","value":" starting at the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UqlGE2S8Nz"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"J88Gm2etUZ"}],"key":"hR4avLBMfr"},{"type":"text","value":" and how they flow through all the variables. And if you understood a good chunk of it and if you now have a sense of that, you should proudly count yourself as one of these buff doges on the left instead of the sorry little one on the right here:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GjCSwjFC7A"}],"key":"oqizWPBvAi"}],"key":"Ehdi2Ok8Hj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from IPython.display import Image, display\n\ndisplay(Image(filename=\"backwardmemelol.png\"))","key":"dHJEZwU9it"},{"type":"outputs","id":"DYliP_QKR1n7lUD8Xs1di","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2dd075d2b68f3d715688a3eb11b30dfe","path":"/build/2dd075d2b68f3d715688a3eb11b30dfe.png"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}},"children":[],"key":"dphumhQelb"}],"key":"e0MvY4ow18"}],"key":"L6Uia7Ek65"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Outro","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yvBwlEzpjA"}],"identifier":"outro","label":"Outro","html_id":"outro","implicit":true,"key":"Rjb3kEPMAp"}],"key":"mmHRS9AXyd"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now in the next lecture we’re actually going to go to LSTMs and all the other variants of RNNs and we’re going to start to complexify the architecture and start to achieve better log likelihoods and what not. Now there’s something to look forward to! Time for new adventures! See you there.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p67ktV23Lo"}],"key":"lbXVHWMqsu"}],"key":"y1qn3L82Xa"}],"key":"yVwWRHM23B"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"4. makemore (part 3): activations & gradients, batchnorm","url":"/micrograduate/makemore3","group":"microgra∇uate"},"next":{"title":"6. makemore (part 5): building a WaveNet","url":"/micrograduate/makemore5","group":"microgra∇uate"}}},"domain":"http://localhost:3000"}